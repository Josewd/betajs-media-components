/*!
betajs-media-components - v0.0.471 - 2024-04-22
Copyright (c) Ziggeo,Oliver Friedmann,Rashad Aliyev
Apache-2.0 Software License.
*/
!function(){var e=this.subScope();e.binding("module","global:BetaJS.MediaComponents"),e.binding("base","global:BetaJS"),e.binding("browser","global:BetaJS.Browser"),e.binding("media","global:BetaJS.Media"),e.binding("dynamics","global:BetaJS.Dynamics"),e.define("module:",function(){return{guid:"7a20804e-be62-4982-91c6-98eb096d2e70",version:"0.0.471",datetime:1713792408231}}),e.assumeVersion("base:version","~1.0.96"),e.assumeVersion("browser:version","~1.0.65"),e.assumeVersion("dynamics:version","~0.0.83"),e.assumeVersion("media:version","~0.0.191"),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x7684;&#x97F3;&#x983B;&#x9577;&#x5EA6;&#x4E0D;&#x7B26;&#x5408;&#x8981;&#x6C42; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-audiorecorder.upload-error-duration"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x64AD;&#x653E;&#x3002;",["ba-common-settingsmenu.tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6240;&#x6709;&#x8A2D;&#x5B9A;",["ba-common-settingsmenu.setting-menu"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A2D;&#x5B9A;&#x503C;",["ba-videorecorder-controlbar.settings"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7981;&#x6B62;&#x8A2A;&#x554F;&#x5A92;&#x9AD4;&#x3002;&#x9EDE;&#x64CA;&#x91CD;&#x8A66;&#x3002;",["ba-imagecapture.access-forbidden"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x60A8;&#x7684;&#x5F71;&#x7247;&#x904E;&#x5927; (%s) &#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x65B0;&#x9078;&#x64C7;&#x5C0F;&#x4E00;&#x9EDE;&#x5F71;&#x7247;&#x518D;&#x8A66;&#x4E00;&#x6B21;&#x3002;",["ba-videorecorder.video_file_too_large"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A2D;&#x7F6E;",["ba-videoplayer-controlbar.settings"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6DFB;&#x52A0;&#x6D41;",["ba-videorecorder-controlbar.add-stream"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8F38;&#x5165;&#x5168;&#x5C4F;",["ba-imageviewer-controlbar.fullscreen-image"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x60A8;&#x7684;&#x5716;&#x7247;&#x6587;&#x4EF6;&#x592A;&#x5927;&#xFF08;%s&#xFF09; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x518D;&#x6B21;&#x5617;&#x8A66;&#x4F7F;&#x7528;&#x8F03;&#x5C0F;&#x7684;&#x5716;&#x7247;&#x6587;&#x4EF6;&#x3002;",["ba-imagecapture.image_file_too_large"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x65CB;&#x8F49;&#x60A8;&#x7684;&#x8A2D;&#x5099;&#x4EE5;&#x6A6B;&#x5411;&#x6A21;&#x5F0F;&#x9304;&#x88FD;&#x3002;",["ba-imagecapture.orientation-landscape-required"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7121;&#x6CD5;&#x66AB;&#x505C;",["ba-videoplayer-controlbar.pause-video-disabled"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5149;&#x7DDA;&#x826F;&#x597D;",["ba-videorecorder-controlbar.camerahealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x78BA;&#x8A8D;&#x5F71;&#x7247;",["ba-common-settingsmenu.submit-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x6211;&#x9304;&#x5F71;",["ba-videorecorder-controlbar.record-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x756B;&#x4E2D;&#x756B;",["ba-common-settingsmenu.picture-in-picture"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x91CD;&#x8A66;",["ba-videoplayer-playbutton.rerecord"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5B57;&#x5E55;&#x8A9E;&#x8A00;",["ba-videoplayer-tracks.select-text-track-language"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x62C;&#x648;&#x691;&#x62A;&#x6D2; &#x648;&#x642;&#x62A; &#x627;&#x6CC;&#x6A9; &#x62E;&#x631;&#x627;&#x628;&#x6CC; &#x62A;&#x6BE;&#x6CC;&#x60C; &#x628;&#x631;&#x627;&#x6C1; &#x6A9;&#x631;&#x645; &#x62F;&#x648;&#x628;&#x627;&#x631;&#x6C1; &#x6A9;&#x648;&#x634;&#x634; &#x6A9;&#x631;&#x646;&#x6D2; &#x6A9;&#x6D2; &#x644;&#x6CC;&#x6D2; &#x6A9;&#x644;&#x6A9; &#x6A9;&#x631;&#x6CC;&#x6BA;&#x6D4;",["ba-video-call.connection-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5728;%d&#x4E4B;&#x5F8C;&#x8DF3;&#x904E;",["ba-videoplayer-adslot.can-skip-after"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4F60;&#x771F;&#x7684;&#x60F3;&#x53D6;&#x6D88;&#x97F3;&#x983B;&#x4E0A;&#x50B3;&#x55CE;&#xFF1F;",["ba-audiorecorder.cancel-confirm"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7B49;&#x5F85;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x8981;&#x6C42;&#x3002;&#x60A8;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5728;&#x5B8C;&#x6210;&#x5F8C;&#x5237;&#x65B0;&#x9801;&#x9762;&#x3002;",["ba-audiorecorder.software-waiting"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9996;&#x5148;&#x9078;&#x64C7;&#x5340;&#x57DF;&#x8A2D;&#x7F6E;",["ba-videoplayer-tracks.info-select-locale-first"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8B80;&#x53D6;&#x4E2D;...",["ba-videoplayer-loader.tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x9019;&#x88E1;&#x53D6;&#x6D88;&#x3002;",["ba-audiorecorder-controlbar.cancel-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9A57;&#x8B49;&#x5931;&#x6557; - &#x55AE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-imagecapture.verifying-failed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8DF3;&#x904E;",["ba-videoplayer-playbutton.skip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4FEE;&#x526A;",["ba-videoplayer-controlbar.trim-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7F3A;&#x5C11;&#x5FC5;&#x9700;&#x7684;&#x97F3;&#x983B;&#x6216;&#x8996;&#x983B;&#x8ECC;&#x9053;",["ba-videorecorder.missing-track"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x5931;&#x6557; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-imagecapture.uploading-failed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6A9;&#x627;&#x644; &#x686;&#x6BE;&#x648;&#x691; &#x62F;&#x648;",["ba-call-controlbar.leave-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A2D;&#x7F6E;&#x97F3;&#x91CF;",["ba-videoplayer-adslot.volume-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6355;&#x7372;&#x5716;&#x50CF;",["ba-imagecapture-chooser.image-capture"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4F60;&#x60F3;&#x4FEE;&#x526A;&#x4F60;&#x7684;&#x8996;&#x983B;&#x55CE;&#xFF1F;",["ba-videorecorder.trim-prompt"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7B49;&#x5F85;&#x8981;&#x6C42;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x3002;&#x5B8C;&#x6210;&#x5F8C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5237;&#x65B0;&#x9801;&#x9762;&#x3002;",["ba-videorecorder.software-waiting"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x73A9;",["ba-audioplayer-controlbar.play-audio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7C21;&#x6B77;&#x8A18;&#x9304;&#x5668;",["ba-videorecorder-controlbar.resume-recorder"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x91CD;&#x8A66;",["ba-videorecorder-controlbar.rerecord"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9A57;&#x8B49;",["ba-audiorecorder.verifying"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x9078;&#x64AD;&#x653E;",["ba-videoplayer-playbutton.tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x79FB;&#x52D5;&#x958B;&#x59CB;&#x548C;&#x7D50;&#x675F;&#x6A19;&#x8A18;&#x4EE5;&#x4FEE;&#x526A;&#x8996;&#x983B;",["ba-videorecorder.trim-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7403;&#x54E1;&#x901F;&#x5EA6;",["ba-videoplayer-controlbar.player-speed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6536;&#x97F3;&#x826F;&#x597D;",["ba-videorecorder-controlbar.microphonehealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x591A;&#x6D41;",["ba-videorecorder-chooser.multi-stream"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x767C;&#x751F;&#x4E86;&#x4E00;&#x500B;&#x932F;&#x8AA4;&#x3002;&#x8ACB;&#x7A0D;&#x5F8C;&#x91CD;&#x8A66;&#x3002;&#x9EDE;&#x64CA;&#x91CD;&#x8A66;&#x3002;",["ba-imagecapture.recorder-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x6211;&#x505C;&#x6B62;",["ba-videorecorder-controlbar.stop-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x9019;&#x88E1;&#x91CD;&#x505A;&#x3002;",["ba-imagecapture-controlbar.rerecord-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9032;&#x5EA6;",["ba-videoplayer-controlbar.video-progress"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5149;&#x6E90;&#x4E0D;&#x4F73;",["ba-videorecorder-controlbar.cameraunhealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x66AB;&#x505C;",["ba-audioplayer-controlbar.pause-audio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x505C;&#x6B62;",["ba-videorecorder-controlbar.stop"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x5716;&#x7247;",["ba-imagecapture-chooser.upload-image"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x5C01;&#x9762;",["ba-videorecorder-imagegallery.upload-covershot"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7C21;&#x6B77;&#x8A18;&#x9304;&#x5668;",["ba-audiorecorder-controlbar.resume-recorder"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x932F;&#x8AA4;&#x767C;&#x751F;&#xFF0C;&#x8ACB;&#x7A0D;&#x5F8C;&#x518D;&#x8A66;(&#x9EDE;&#x6211;)",["ba-videoplayer.video-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7121;&#x6CD5;&#x5B58;&#x53D6;&#x651D;&#x5F71;&#x6A5F;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x700F;&#x89BD;&#x5668;&#x6216;&#x662F;&#x88DD;&#x7F6E;&#x7684;&#x9650;&#x5236;&#xFF0C;&#x8ACB;&#x5617;&#x8A66;&#x5B89;&#x88DD; Flash &#x5916;&#x639B;&#x7A0B;&#x5F0F;&#x6216;&#x900F;&#x904E;&#x5B89;&#x5168;&#x9023;&#x7DDA;&#x4F86;&#x4F7F;&#x7528;&#x3002;",["ba-videorecorder.attach-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x66AB;&#x505C;&#x9304;&#x97F3;&#x6A5F;",["ba-audiorecorder-controlbar.pause-recorder"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6700;&#x77ED;&#x9304;&#x88FD;&#x6642;&#x9593;&#x70BA;%d&#x79D2;",["ba-audiorecorder-controlbar.stop-available-after"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8B8A;&#x66F4;&#x89E3;&#x6790;&#x5EA6;",["ba-videoplayer-controlbar.change-resolution"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x55AE;&#x64CA;&#x4E0B;&#x65B9;&#x4EE5;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x4EE5;&#x4E0B;&#x8981;&#x6C42;&#x4EE5;&#x7E7C;&#x7E8C;&#x3002;",["ba-audiorecorder.software-required"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7D50;&#x675F;&#x5168;&#x87A2;&#x5E55;",["ba-videoplayer-controlbar.exit-fullscreen-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x91CD;&#x505A;&#xFF1F;",["ba-imageviewer-controlbar.rerecord-image"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5EE3;&#x544A;&#x5C07;&#x5728;%s&#x4E4B;&#x5F8C;&#x7D50;&#x675F;",["ba-videoplayer-adslot.ad-will-end-after"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4F60;&#x771F;&#x7684;&#x60F3;&#x91CD;&#x62CD;&#x4F60;&#x7684;&#x5F62;&#x8C61;&#x55CE;&#xFF1F;",["ba-imagecapture.rerecord-confirm"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7BC0;&#x7701;&#x6642;&#x9593;",["ba-audioplayer-controlbar.elapsed-time"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6A9;&#x627;&#x644; &#x628;&#x646;&#x627;&#x626;&#x6CC;&#x6BA;",["ba-call-lobby.title-create"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x91CD;&#x505A;&#xFF1F;",["ba-audioplayer-controlbar.rerecord-audio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9000;&#x51FA;&#x5168;&#x5C4F;",["ba-imageviewer-controlbar.exit-fullscreen-image"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6AF;&#x632;&#x631;&#x627; &#x648;&#x642;&#x62A;",["ba-ads-controlbar.elapsed-time"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9A57;&#x8B49;&#x5931;&#x6557;&#xFF0C;&#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x8A66;",["ba-videorecorder.verifying-failed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x645;&#x637;&#x644;&#x648;&#x628;&#x6C1; &#x622;&#x688;&#x6CC;&#x648; &#x679;&#x631;&#x6CC;&#x6A9; &#x63A;&#x627;&#x626;&#x628; &#x6C1;&#x6D2;",["ba-audiorecorder.missing-track"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x6211;&#x4E0A;&#x50B3;&#x81EA;&#x8A02;&#x7684;&#x5C01;&#x9762;",["ba-videorecorder-controlbar.upload-covershot-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A2D;&#x5B9A;&#x9078;&#x9805;",["ba-common-settingsmenu.set-menu-option"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8996;&#x983B;&#x5E40;&#x7387;&#x975E;&#x5E38;&#x4F4E;&#x3002;&#x6211;&#x5011;&#x5EFA;&#x8B70;&#x95DC;&#x9589;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x7A0B;&#x5E8F;&#x548C;&#x700F;&#x89BD;&#x5668;&#x9078;&#x9805;&#x5361;&#x6216;&#x4F7F;&#x7528;&#x66F4;&#x5FEB;&#x7684;&#x8A08;&#x7B97;&#x6A5F;&#x3002;",["ba-videorecorder.framerate-warning"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5207;&#x63DB;&#x76F8;&#x6A5F;",["ba-videorecorder.switch-camera"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A2D;&#x5B9A;&#x97F3;&#x91CF;",["ba-audioplayer-controlbar.volume-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x5F71;&#x7247;",["ba-videorecorder-chooser.upload-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x622;&#x648;&#x627;&#x632; &#x628;&#x646;&#x62F; &#x6A9;&#x631;&#x6CC;&#x6BA;",["ba-ads-controlbar.volume-mute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9A57;&#x8B49;&#x5931;&#x6557; - &#x55AE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-audiorecorder.verifying-failed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5DF2;&#x9078;&#x64C7;&#x9644;&#x52A0;&#x6D41;",["ba-videorecorder-controlbar.stream-already-selected"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x8996;&#x983B;&#x7684;&#x9577;&#x5EA6;&#x4E0D;&#x7B26;&#x5408;&#x8981;&#x6C42; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-videorecorder.upload-error-duration"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x622;&#x648;&#x627;&#x632; &#x6A9;&#x648; &#x686;&#x627;&#x644;&#x648; &#x6A9;&#x631;&#x6CC;&#x6BA;",["ba-ads-controlbar.volume-unmute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x64AD;&#x653E;&#x901F;&#x5EA6;",["ba-common-settingsmenu.player-speed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x628;&#x646;&#x627;&#x646;&#x627;",["ba-call-lobby.create-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A2D;&#x7F6E;",["ba-audiorecorder-controlbar.settings"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x64AD;&#x653E;",["ba-videoplayer-controlbar.play-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x91CD;&#x8A66;?",["ba-videoplayer-controlbar.rerecord-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x932F;&#x8AA4;&#x767C;&#x751F;&#xFF0C;&#x8ACB;&#x7A0D;&#x5F8C;&#x518D;&#x8A66;(&#x9EDE;&#x6211;)",["ba-videorecorder.recorder-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6E96;&#x5099;&#x7832;&#x5F48;",["ba-videorecorder.prepare-covershot"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9A57;&#x8B49;&#x4E2D;",["ba-videorecorder.verifying"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x4F7F;&#x7528;&#x5F71;&#x7247;&#x683C;&#x5F0F;: %s - &#x9EDE;&#x6211;&#x91CD;&#x8A66;",["ba-videorecorder.unsupported_video_type"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x78BA;&#x8A8D;",["ba-videoplayer-playbutton.submit-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7E3D;&#x9577;&#x5EA6;",["ba-audioplayer-controlbar.total-time"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6E96;&#x5099;&#x5C0B;&#x627E;&#x7E2E;&#x7565;&#x5716;",["ba-videorecorder.prepare-thumbnails"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7684;Airplay",["ba-videoplayer-controlbar.airplay"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7121;&#x6CD5;&#x5B58;&#x53D6;&#x651D;&#x5F71;&#x6A5F;&#xFF0C;&#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x8A66;&#x3002;",["ba-videorecorder.access-forbidden"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x975C;&#x97F3;",["ba-videoplayer-adslot.volume-mute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("... &#x645;&#x646;&#x633;&#x644;&#x6A9; &#x6C1;&#x648; &#x631;&#x6C1;&#x627; &#x6C1;&#x6D2;",["ba-video-call.connecting"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x767C;&#x751F;&#x4E86;&#x4E00;&#x500B;&#x932F;&#x8AA4;&#x3002;&#x8ACB;&#x7A0D;&#x5F8C;&#x91CD;&#x8A66;&#x3002;&#x9EDE;&#x64CA;&#x91CD;&#x8A66;&#x3002;",["ba-imageviewer.image-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x60A8;&#x9078;&#x64C7;&#x7684;&#x6587;&#x4EF6;&#x8207;&#x6240;&#x9700;&#x7684;&#x5206;&#x8FA8;&#x7387;&#x4E0D;&#x5339;&#x914D; - &#x55AE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-videorecorder.resolution-constraint-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x66AB;&#x505C;&#x8A18;&#x9304;&#x5668;",["ba-videorecorder-controlbar.pause-recorder"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7167;&#x660E;&#x4E0D;&#x662F;&#x6700;&#x4F73;&#x7684;",["ba-imagecapture-controlbar.cameraunhealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6E90;&#x8CEA;&#x91CF;",["ba-common-settingsmenu.source-quality"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x65CB;&#x8F49;&#x8A2D;&#x5099;&#x4EE5;&#x7E31;&#x5411;&#x6A21;&#x5F0F;&#x9304;&#x88FD;&#x3002;",["ba-imagecapture.orientation-portrait-required"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6A9;&#x627;&#x644; &#x645;&#x6CC;&#x6BA; &#x634;&#x627;&#x645;&#x644; &#x6C1;&#x648;&#x6BA;",["ba-call-lobby.title-join"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9304;&#x88FD;&#x97F3;&#x983B;",["ba-audiorecorder-chooser.record-audio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x975C;&#x97F3;",["ba-videoplayer-controlbar.volume-mute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x6311;&#x9078;&#x4E00;&#x5F35;&#x5C01;&#x9762;",["ba-videorecorder.pick-covershot"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7121;&#x6CD5;&#x63A5;&#x807D;&#x4EFB;&#x4F55;&#x8072;&#x97F3;",["ba-audiorecorder-controlbar.microphoneunhealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7F3A;&#x5C11;&#x984D;&#x5916;&#x7684;&#x8996;&#x983B;&#x8F38;&#x5165;&#x6E90;",["ba-videorecorder-controlbar.no-video-source"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7981;&#x6B62;&#x8A2A;&#x554F;&#x5A92;&#x9AD4;&#x3002;&#x9EDE;&#x64CA;&#x91CD;&#x8A66;&#x3002;",["ba-audiorecorder.access-forbidden"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x91CD;&#x505A;",["ba-imagecapture-controlbar.rerecord"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x767C;&#x751F;&#x4E86;&#x4E00;&#x500B;&#x932F;&#x8AA4;&#x3002;&#x8ACB;&#x7A0D;&#x5F8C;&#x91CD;&#x8A66;&#x3002;&#x9EDE;&#x64CA;&#x91CD;&#x8A66;&#x3002;",["ba-audiorecorder.recorder-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x55AE;&#x64CA;&#x4EE5;&#x9078;&#x4E2D;&#x6587;&#x4EF6;",["ba-videoplayer-tracks.select-text-track-file"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7565;&#x904E;",["ba-videorecorder-controlbar.skip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x55AE;&#x64CA;&#x4E0B;&#x65B9;&#x4EE5;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x4EE5;&#x4E0B;&#x8981;&#x6C42;&#x4EE5;&#x7E7C;&#x7E8C;&#x3002;",["ba-imagecapture.software-required"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x628;&#x631;&#x627;&#x624;&#x632;&#x631; &#x6A9;&#x6CC; &#x637;&#x631;&#x641; &#x633;&#x6D2; &#x627;&#x62C;&#x627;&#x632;&#x62A; &#x633;&#x6D2; &#x627;&#x646;&#x6A9;&#x627;&#x631;&#x60C; &#x628;&#x631;&#x627;&#x6C1; &#x6A9;&#x631;&#x645; &#x631;&#x633;&#x627;&#x626;&#x6CC; &#x641;&#x631;&#x627;&#x6C1;&#x645; &#x6A9;&#x631;&#x6CC;&#x6BA; &#x627;&#x648;&#x631; &#x635;&#x641;&#x62D;&#x6C1; &#x6A9;&#x648; &#x62F;&#x648;&#x628;&#x627;&#x631;&#x6C1; &#x644;&#x648;&#x688; &#x6A9;&#x631;&#x6CC;&#x6BA;",["ba-audiorecorder.browser-permission-denied"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x73FE;&#x5728;&#x7121;&#x6CD5;&#x64AD;&#x653E;&#x8996;&#x983B;&#xFF0C;&#x4E0A;&#x50B3;&#x4ECD;&#x5728;&#x9032;&#x884C;&#x4E2D;",["ba-videorecorder.uploading-src-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ABF;&#x6574;&#x97F3;&#x91CF;",["ba-videoplayer-controlbar.volume-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6211;&#x5011;&#x7121;&#x6CD5;&#x8A2A;&#x554F;&#x5A92;&#x9AD4;&#x754C;&#x9762;&#x3002;&#x60A8;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5B89;&#x88DD;Flash&#x6216;&#x901A;&#x904E;SSL&#x8A2A;&#x554F;&#x8A72;&#x9801;&#x9762;&#xFF0C;&#x5177;&#x9AD4;&#x53D6;&#x6C7A;&#x65BC;&#x8A2D;&#x5099;&#x548C;&#x700F;&#x89BD;&#x5668;&#x3002;",["ba-imagecapture.attach-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;",["ba-audiorecorder.uploading"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x4E0A;&#x50B3;&#xFF1A;%s  - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-audiorecorder.unsupported_audio_type"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A2D;&#x7F6E;",["ba-imagecapture-controlbar.settings"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6DFB;&#x52A0;&#x65B0;&#x6D41;",["ba-videorecorder.adding-new-stream"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x622;&#x648;&#x627;&#x632; &#x628;&#x646;&#x62F; &#x6A9;&#x631;&#x6CC;&#x6BA;",["ba-call-lobby.mute-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;",["ba-imagecapture.uploading"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7B49;&#x5F85;&#x4FEE;&#x526A;&#x547D;&#x4EE4;...",["ba-videorecorder.wait-for-trim"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x53D6;&#x6D88;",["ba-imagecapture-controlbar.cancel"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x9019;&#x88E1;&#x53D6;&#x6D88;&#x3002;",["ba-videorecorder-controlbar.cancel-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x767C;&#x751F;&#x4E86;&#x4E00;&#x500B;&#x932F;&#x8AA4;&#x3002;&#x8ACB;&#x7A0D;&#x5F8C;&#x91CD;&#x8A66;&#x3002;&#x9EDE;&#x64CA;&#x91CD;&#x8A66;&#x3002;",["ba-audioplayer.audio-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x622;&#x67E; &#x6A9;&#x6D2; &#x627;&#x646; &#x67E;&#x679; &#x622;&#x644;&#x627;&#x62A; &#x645;&#x6CC;&#x6BA; &#x633;&#x6D2; &#x6A9;&#x645; &#x627;&#x632; &#x6A9;&#x645; &#x627;&#x6CC;&#x6A9; &#x67E;&#x6C1;&#x644;&#x6D2; &#x633;&#x6D2; &#x627;&#x633;&#x62A;&#x639;&#x645;&#x627;&#x644; &#x645;&#x6CC;&#x6BA; &#x6C1;&#x6D2;",["ba-audiorecorder.device-already-in-use"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6A9;&#x6CC;&#x645;&#x631;&#x6C1;",["ba-call-lobby.camera-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x986F;&#x793A;CC",["ba-videoplayer-controlbar.show-tracks"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5168;&#x5C4F;",["ba-videoplayer.full-screen"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x628;&#x631;&#x627;&#x6C1; &#x6A9;&#x631;&#x645; &#x6A9;&#x648;&#x626;&#x6CC; &#x62F;&#x648;&#x633;&#x631;&#x627; &#x627;&#x646; &#x67E;&#x679; &#x688;&#x6CC;&#x648;&#x627;&#x626;&#x633; &#x645;&#x646;&#x62A;&#x62E;&#x628; &#x6A9;&#x631;&#x646;&#x6D2; &#x6A9;&#x6D2; &#x644;&#x6CC;&#x6D2; &#x6A9;&#x644;&#x6A9; &#x6A9;&#x631;&#x6CC;&#x6BA; &#x6CC;&#x627; &#x62F;&#x648;&#x628;&#x627;&#x631;&#x6C1; &#x6A9;&#x627;&#x631;&#x631;&#x648;&#x627;&#x626;&#x6CC; &#x6A9;&#x6CC; &#x6A9;&#x648;&#x634;&#x634; &#x6A9;&#x631;&#x6CC;&#x6BA;&#x6D4;",["ba-videorecorder.re-choose-action"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x634;&#x645;&#x648;&#x644;&#x6CC;&#x62A;",["ba-call-lobby.join-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4F60;&#x771F;&#x7684;&#x60F3;&#x53D6;&#x6D88;&#x4F60;&#x7684;&#x8996;&#x983B;&#x4E0A;&#x50B3;&#xFF1F;",["ba-videorecorder.cancel-confirm"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x53D6;&#x6D88;",["ba-videorecorder-controlbar.cancel"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6A9;&#x6D2; &#x628;&#x639;&#x62F; &#x686;&#x6BE;&#x648;&#x691; &#x62F;&#x6CC;&#x6BA; %d &#x627;&#x634;&#x62A;&#x6BE;&#x627;&#x631; &#x6A9;&#x648;",["ba-ads-controlbar.can-skip-after"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("",["ba-ads-controlbar.ad-will-end-after"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x91CD;&#x505A;",["ba-audiorecorder-controlbar.rerecord"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4F60;&#x771F;&#x7684;&#x60F3;&#x8981;&#x91CD;&#x505A;&#x4F60;&#x7684;&#x97F3;&#x983B;&#x55CE;&#xFF1F;",["ba-audiorecorder.rerecord-confirm"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7D93;&#x904E;&#x6642;&#x9593;",["ba-videoplayer-controlbar.elapsed-time"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6700;&#x77ED;&#x8A18;&#x9304;&#x6642;&#x9593;&#x662F;%d&#x79D2;",["ba-videorecorder-controlbar.stop-available-after"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6240;&#x6709;&#x8A2D;&#x5B9A;",["ba-audioplayer.all-settings"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7167;&#x660E;&#x5F88;&#x597D;",["ba-imagecapture-controlbar.camerahealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6355;&#x7372;",["ba-imagecapture-controlbar.record"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x9019;&#x88E1;&#x8A18;&#x9304;&#x3002;",["ba-audiorecorder-controlbar.record-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x78BA;&#x8A8D;",["ba-audioplayer-controlbar.submit-audio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6A9;&#x6CC;&#x645;&#x631;&#x6C1; &#x62F;&#x6A9;&#x6BE;&#x627;&#x626;&#x6CC;&#x6BA;/&#x686;&#x6BE;&#x67E;&#x627;&#x626;&#x6CC;&#x6BA;&#x6D4;",["ba-call-controlbar.camera-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8DF3;&#x904E;&#x5EE3;&#x544A;",["ba-videoplayer-adslot.skip-ad"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x622;&#x648;&#x627;&#x632; &#x628;&#x646;&#x62F; &#x6A9;&#x631;&#x6CC;&#x6BA; / &#x622;&#x648;&#x627;&#x632; &#x6A9;&#x648; &#x686;&#x627;&#x644;&#x648; &#x6A9;&#x631;&#x6CC;&#x6BA;",["ba-call-controlbar.mute-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9304;&#x97F3;",["ba-videorecorder-chooser.record-audio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x60A8;&#x7684;&#x97F3;&#x983B;&#x6587;&#x4EF6;&#x592A;&#x5927;&#xFF08;%s&#xFF09; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x518D;&#x6B21;&#x5617;&#x8A66;&#x4F7F;&#x7528;&#x8F03;&#x5C0F;&#x7684;&#x97F3;&#x983B;&#x6587;&#x4EF6;&#x3002;",["ba-audiorecorder.audio_file_too_large"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x700F;&#x89BD;&#x5668;&#x62D2;&#x7D55;&#x6B64;&#x6B0A;&#x9650;&#xFF0C;&#x8ACB;&#x6388;&#x4E88;&#x8A2A;&#x554F;&#x6B0A;&#x9650;&#x4E26;&#x91CD;&#x65B0;&#x52A0;&#x8F09;&#x9801;&#x9762;",["ba-videorecorder.browser-permission-denied"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x66AB;&#x505C;",["ba-videoplayer-controlbar.pause-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x53D6;&#x6D88;&#x975C;&#x97F3;",["ba-videoplayer-adslot.volume-unmute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x78BA;&#x8A8D;",["ba-videoplayer-controlbar.submit-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5206;&#x4EAB;",["ba-videoplayer-share.share"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8F09;&#x5165;&#x4E2D;...",["ba-audioplayer-loader.tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x4E0A;&#x50B3;&#xFF1A;%s  - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-imagecapture.unsupported_image_type"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x4E2D;",["ba-videorecorder.uploading"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8072;&#x97F3;&#x5F88;&#x597D;",["ba-audiorecorder-controlbar.microphonehealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x62C;&#x628; &#x622;&#x67E; &#x62A;&#x6CC;&#x627;&#x631; &#x6C1;&#x648;&#x6BA; &#x62A;&#x648; &#x6A9;&#x627;&#x644; &#x645;&#x6CC;&#x6BA; &#x634;&#x627;&#x645;&#x644; &#x6C1;&#x648;&#x646;&#x6D2; &#x6A9;&#x6D2; &#x644;&#x6CC;&#x6D2; &#x646;&#x6CC;&#x686;&#x6D2; &#x62F;&#x6CC;&#x626;&#x6D2; &#x6AF;&#x626;&#x6D2; &#x628;&#x679;&#x646; &#x67E;&#x631; &#x6A9;&#x644;&#x6A9; &#x6A9;&#x631;&#x6CC;&#x6BA;&#x6D4;",["ba-call-lobby.description-join"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x9019;&#x88E1;&#x91CD;&#x505A;&#x3002;",["ba-audiorecorder-controlbar.rerecord-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A18;&#x9304;&#x5C4F;&#x5E55;",["ba-videorecorder-chooser.record-screen"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6240;&#x6709;&#x8A2D;&#x7F6E;",["ba-videoplayer.all-settings"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9078;&#x64C7;",["ba-videoplayer-controlbar.select-frame"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x60A8;&#x9078;&#x64C7;&#x7684;&#x6587;&#x4EF6;&#x8207;&#x6240;&#x9700;&#x7684;&#x5206;&#x8FA8;&#x7387;&#x4E0D;&#x5339;&#x914D; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-imagecapture.resolution-constraint-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x505C;&#x6B62;&#x3002;",["ba-audiorecorder-controlbar.stop-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6536;&#x97F3;&#x4E0D;&#x826F;",["ba-videorecorder-controlbar.microphoneunhealthy"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x505C;&#x6B62;",["ba-audiorecorder-controlbar.stop"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x78BA;&#x5B9A;&#x8981;&#x91CD;&#x65B0;&#x9304;&#x88FD;&#x60A8;&#x7684;&#x5F71;&#x7247;?",["ba-videorecorder.rerecord-confirm"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x645;&#x642;&#x627;&#x645;&#x6CC; &#x6A9;&#x6CC;&#x645;&#x631;&#x6D2; &#x633;&#x6D2; &#x645;&#x646;&#x633;&#x644;&#x6A9; &#x6A9;&#x631;&#x62A;&#x6D2; &#x648;&#x642;&#x62A; &#x627;&#x6CC;&#x6A9; &#x62E;&#x631;&#x627;&#x628;&#x6CC; &#x62A;&#x6BE;&#x6CC;&#x6D4; &#x62F;&#x648;&#x628;&#x627;&#x631;&#x6C1; &#x6A9;&#x648;&#x634;&#x634; &#x6A9;&#x631;&#x646;&#x6D2; &#x6A9;&#x6D2; &#x644;&#x6CC;&#x6D2; &#x6A9;&#x644;&#x6A9; &#x6A9;&#x631;&#x6CC;&#x6BA;&#x6D4;",["ba-local-view.local-camera-connection-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x645;&#x648;&#x688; &#x645;&#x6CC;&#x6BA; &#x6C1;&#x648;&#x646;&#x627; &#x686;&#x627;&#x6C1;&#x6CC;&#x6D2;&#x6D4;&#x27;%s&#x27;&#x645;&#x6CC;&#x688;&#x6CC;&#x627; &#x631;&#x6CC;&#x632;&#x648;&#x644;&#x648;&#x634;&#x646;",["ba-videorecorder.supported-mode"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x95DC;&#x9589;CC",["ba-videoplayer-controlbar.close-tracks"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;",["ba-videorecorder-controlbar.upload-covershot"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x65CB;&#x8F49;&#x8A2D;&#x5099;&#x4EE5;&#x6A6B;&#x5411;&#x6A21;&#x5F0F;&#x9304;&#x88FD;&#x3002;",["ba-videorecorder.orientation-landscape-required"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9A57;&#x8B49;",["ba-imagecapture.verifying"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x78BA;&#x8A8D;",["ba-imageviewer-controlbar.submit-image"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x9019;&#x88E1;&#x53D6;&#x6D88;&#x3002;",["ba-imagecapture-controlbar.cancel-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7B49;&#x5F85;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x8981;&#x6C42;&#x3002;&#x60A8;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5728;&#x5B8C;&#x6210;&#x5F8C;&#x5237;&#x65B0;&#x9801;&#x9762;&#x3002;",["ba-imagecapture.software-waiting"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9000;&#x51FA;&#x5168;&#x5C4F;",["ba-common-settingsmenu.exit-fullscreen-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x5931;&#x6557;&#xFF0C;&#x8ACB;&#x9EDE;&#x6211;&#x91CD;&#x8A66;",["ba-videorecorder.uploading-failed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4FEE;&#x526A;",["ba-videoplayer-playbutton.trim"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x53D6;&#x6D88;&#x975C;&#x97F3;",["ba-audioplayer-controlbar.volume-unmute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8A18;&#x9304;",["ba-audiorecorder-controlbar.record"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x9EDE;&#x64CA;&#x4E0B;&#x9762;&#x7684;&#x5B89;&#x88DD;/&#x6FC0;&#x6D3B;&#x4EE5;&#x4E0B;&#x8981;&#x6C42;&#x624D;&#x80FD;&#x7E7C;&#x7E8C;&#x3002;",["ba-videorecorder.software-required"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x66F2;&#x76EE;&#x6587;&#x672C;&#x6587;&#x4EF6;",["ba-videoplayer-tracks.upload-text-tracks"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x62C;&#x628; &#x622;&#x67E; &#x62A;&#x6CC;&#x627;&#x631; &#x6C1;&#x648;&#x6BA; &#x62A;&#x648; &#x6A9;&#x627;&#x644; &#x6A9;&#x631;&#x646;&#x6D2; &#x6A9;&#x6D2; &#x644;&#x6CC;&#x6D2; &#x646;&#x6CC;&#x686;&#x6D2; &#x62F;&#x6CC;&#x626;&#x6D2; &#x6AF;&#x626;&#x6D2; &#x628;&#x679;&#x646; &#x67E;&#x631; &#x6A9;&#x644;&#x6A9; &#x6A9;&#x631;&#x6CC;&#x6BA;&#x6D4;",["ba-call-lobby.description-create"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x6211;&#x7565;&#x904E;",["ba-videorecorder-controlbar.skip-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x648;&#x627;&#x644;&#x6CC;&#x648;&#x645; &#x633;&#x6CC;&#x679; &#x6A9;&#x631;&#x6CC;&#x6BA;",["ba-ads-controlbar.volume-button"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5443;&#x6642;&#x9593;",["ba-videoplayer-adslot.elapsed-time"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x5269;&#x9918;&#x6642;&#x9593;",["ba-videoplayer-controlbar.remaining-time"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x6355;&#x6349;&#x3002;",["ba-imagecapture-controlbar.record-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x60A8;&#x7684;&#x81F3;&#x5C11;&#x4E00;&#x500B;&#x8F38;&#x5165;&#x8A2D;&#x5099;&#x5DF2;&#x5728;&#x4F7F;&#x7528;&#x4E2D;",["ba-videorecorder.device-already-in-use"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x975C;&#x97F3;",["ba-audioplayer-controlbar.volume-mute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x97F3;&#x983B;",["ba-audiorecorder-chooser.upload-audio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x5716;&#x7247;&#x7684;&#x9577;&#x5EA6;&#x4E0D;&#x7B26;&#x5408;&#x8981;&#x6C42; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-imagecapture.upload-error-duration"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6211;&#x5011;&#x7121;&#x6CD5;&#x8A2A;&#x554F;&#x5A92;&#x9AD4;&#x754C;&#x9762;&#x3002;&#x60A8;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x5B89;&#x88DD;Flash&#x6216;&#x901A;&#x904E;SSL&#x8A2A;&#x554F;&#x8A72;&#x9801;&#x9762;&#xFF0C;&#x5177;&#x9AD4;&#x53D6;&#x6C7A;&#x65BC;&#x8A2D;&#x5099;&#x548C;&#x700F;&#x89BD;&#x5668;&#x3002;",["ba-audiorecorder.attach-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x627;&#x634;&#x62A;&#x6BE;&#x627;&#x631; &#x6A9;&#x648; &#x686;&#x6BE;&#x648;&#x691; &#x62F;&#x6CC;&#x6BA;",["ba-ads-controlbar.skip-ad"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x53D6;&#x6D88;",["ba-audiorecorder-controlbar.cancel"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("Airplay&#x5716;&#x6A19;&#x3002;",["ba-videoplayer-controlbar.airplay-icon"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7403;&#x54E1;&#x901F;&#x5EA6;",["ba-videoplayer.player-speed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9032;&#x5165;&#x5168;&#x87A2;&#x5E55;",["ba-videoplayer-controlbar.fullscreen-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x4E0A;&#x50B3;&#x5931;&#x6557; - &#x9EDE;&#x64CA;&#x6B64;&#x8655;&#x91CD;&#x8A66;&#x3002;",["ba-audiorecorder.uploading-failed"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x627;&#x628; &#x622;&#x688;&#x6CC;&#x648; &#x648;&#x627;&#x67E;&#x633; &#x686;&#x644;&#x627;&#x646;&#x6D2; &#x633;&#x6D2; &#x642;&#x627;&#x635;&#x631;&#x60C; &#x627;&#x67E; &#x644;&#x648;&#x688;&#x646;&#x6AF; &#x627;&#x628;&#x6BE;&#x6CC; &#x62C;&#x627;&#x631;&#x6CC; &#x6C1;&#x6D2;",["ba-audiorecorder.uploading-src-error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9304;&#x88FD;&#x5F71;&#x7247;",["ba-videorecorder-chooser.record-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6B64;&#x8A2D;&#x5099;&#x4E0D;&#x652F;&#x6301;&#x5C4F;&#x5E55;&#x9304;&#x50CF;&#x6A5F;",["ba-videorecorder.screen-recorder-is-not-supported"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x80CC;&#x90E8;",["ba-videoplayer-tracks.back"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9078;&#x64C7;&#x8981;&#x7528;&#x4F5C;&#x63A9;&#x8B77;&#x7684;&#x5E40;&#x3002;",["ba-videorecorder.pick-covershot-frame"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9032;&#x5C55;",["ba-audioplayer-controlbar.audio-progress"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x66AB;&#x505C;&#x4E0D;&#x53D7;&#x652F;&#x6301;",["ba-audioplayer-controlbar.pause-audio-disabled"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x6A9;&#x627;&#x644; &#x62E;&#x62A;&#x645; &#x6C1;&#x648; &#x6AF;&#x626;&#x6CC;&#x6D4;",["ba-video-call.call-ended"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x7E3D;&#x9577;&#x5EA6;",["ba-videoplayer-controlbar.total-time"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9EDE;&#x6211;&#x91CD;&#x8A66;",["ba-videorecorder-controlbar.rerecord-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x8ACB;&#x65CB;&#x8F49;&#x8A2D;&#x5099;&#x4EE5;&#x7E31;&#x5411;&#x6A21;&#x5F0F;&#x9304;&#x88FD;&#x3002;",["ba-videorecorder.orientation-portrait-required"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9032;&#x5165;&#x5168;&#x5C4F;",["ba-common-settingsmenu.fullscreen-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x89E3;&#x9664;&#x975C;&#x97F3;",["ba-videoplayer-controlbar.volume-unmute"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x9304;&#x5F71;",["ba-videorecorder-controlbar.record"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCB5;&#xCBF;&#xC9C;&#xCCD;&#xC9E;&#xCBE;&#xCAA;&#xCA8; &#xC86;&#xCAF;&#xCCD;&#xC95;&#xCC6;&#xC97;&#xCB3;&#xCC1;",["ba-adsplayer.ad-choices"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCAA;&#xCC2;&#xCB0;&#xCCD;&#xCA3; &#xCAA;&#xCB0;&#xCA6;&#xCC6;&#xCAF;&#xCA8;&#xCCD;&#xCA8;&#xCC1; &#xCAC;&#xCBF;&#xC9F;&#xCCD;&#xC9F;&#xCC1;&#xCB9;&#xCCB;&#xC97;&#xCBF;",["ba-ads-controlbar.exit-fullscreen-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xC89;&#xCAA;&#xC95;&#xCB0;&#xCA3;&#xCB5;&#xCA8;&#xCCD;&#xCA8;&#xCC1; &#xCA8;&#xCCB;&#xCA1;&#xCBF;",["ba-videoplayer-tooltip.tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xC95;&#xCCA;&#xCA8;&#xCC6;&#xC97;&#xCC6; &#xCA8;&#xCBF;&#xCB2;&#xCCD;&#xCB2;&#xCBF;&#xCB8;&#xCB2;&#xCC1; &#xC9F;&#xCC2;&#xCB2;&#xCCD; &#xC9F;&#xCBF;&#xCAA;&#xCCD; &#xCB9;&#xCCA;&#xC82;&#xCA6;&#xCBF;&#xCB0;&#xCBF;",["ba-videoplayer-tooltip.hover-to-pause-tooltip-close"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCA8;&#xCBF;&#xCB2;&#xCCD;&#xCB2;&#xCBF;&#xCB8;&#xCB2;&#xCC1; &#xCAC;&#xCC7;&#xC95;&#xCBE;&#xCA6; &#xCAC;&#xCC6;&#xC82;&#xCAC;&#xCB2;&#xCB5;&#xCBF;&#xCB2;&#xCCD;&#xCB2;",["ba-ads-controlbar.pause-video-disabled"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCAE;&#xCC1;&#xC9A;&#xCCD;&#xC9A;&#xCBF;",["ba-adsplayer.close-ad"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCAA;&#xCC2;&#xCB0;&#xCCD;&#xCA3; &#xCAA;&#xCB0;&#xCA6;&#xCC6;&#xCAF;&#xCB2;&#xCCD;&#xCB2;&#xCBF; &#xCB9;&#xCCB;&#xC97;&#xCBF;",["ba-ads-controlbar.fullscreen-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCB5;&#xCBF;&#xC9C;&#xCCD;&#xC9E;&#xCBE;&#xCAA;&#xCA8; &#xC86;&#xCAF;&#xCCD;&#xC95;&#xCC6;&#xC97;&#xCB3;&#xCC1;",["ba-videoplayer-floating-sidebar.ad-choices"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCB5;&#xCBF;&#xC9C;&#xCCD;&#xC9E;&#xCBE;&#xCAA;&#xCA8;&#xCB5;&#xCA8;&#xCCD;&#xCA8;&#xCC1; &#xCAA;&#xCC1;&#xCA8;&#xCB0;&#xCBE;&#xCB0;&#xC82;&#xCAD;&#xCBF;&#xCB8;&#xCBF;",["ba-adsplayer.replay-ad"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCAA;&#xCCD;&#xCB0;&#xCB8;&#xCCD;&#xCA4;&#xCC1;&#xCA4;&#xCBF;&#xCB8;&#xCC1;",["ba-ads-controlbar.play-ad"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xCB5;&#xCC0;&#xCA1;&#xCBF;&#xCAF;&#xCCA; &#xCA8;&#xCBF;&#xCB2;&#xCCD;&#xCB2;&#xCBF;&#xCB8;&#xCC1;",["ba-ads-controlbar.pause-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xC87;&#xCA8;&#xCCD;&#xCA8;&#xCB7;&#xCCD;&#xC9F;&#xCC1; &#xCA4;&#xCBF;&#xCB3;&#xCBF;&#xCAF;&#xCBF;&#xCB0;&#xCBF;",["ba-adsplayer.learn-more"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xC87;&#xCA8;&#xCCD;&#xCA8;&#xCB7;&#xCCD;&#xC9F;&#xCC1; &#xCA4;&#xCBF;&#xCB3;&#xCBF;&#xCAF;&#xCBF;&#xCB0;&#xCBF;",["ba-videoplayer-floating-sidebar.learn-more"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("Ad Choices",["ba-ads-choices-link.ad-choices"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("Content will resume after this advertisement.",["ba-videoplayer-sidebar.continue-on-ads-end"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("Learn More",["ba-ads-learn-more-button.learn-more"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#x43F;&#x443;&#x43F;&#x443;&#x43F;&#x443;",["ba-videoplayer-sidebar.up-next"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("Enter fullscreen",["ba-circle-progress.fullscreen-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA95;&#xAB5;&#xAB0; &#xAB6;&#xACB;&#xA9F;",["ba-videorecorder-settings.cover-shot"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAAD;&#xABE;&#xAB7;&#xABE;",["ba-videorecorder-settings.language"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA4;&#xAAE;&#xABE;&#xAB0;&#xAC0; &#xA93;&#xAA1;&#xABF;&#xAAF;&#xACB; &#xAB0;&#xAC7;&#xA95;&#xAC9;&#xAB0;&#xACD;&#xAA1; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAAE;&#xABE;&#xA82; &#xAAD;&#xAC2;&#xAB2; &#xAA5;&#xA88; &#xA9B;&#xAC7;. &#xAAE;&#xAB9;&#xAC7;&#xAA8;&#xAA4; &#xA95;&#xAB0;&#xAC0;&#xAA8;&#xAC7; &#xAAB;&#xAB0;&#xAC0; &#xAA5;&#xAB5;&#xABE;&#xAA8;&#xACB; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;.",["ba-videorecorder-audiorecording.error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA95;&#xAB5;&#xAB0; &#xAB5;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xACB;",["ba-videorecorder-settings.cover-video"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA5;&#xAAF;&#xAC1;&#xA82;",["ba-videorecorder-settings.done"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA4;&#xAAE;&#xABE;&#xAB0;&#xAC0; &#xA95;&#xAB5;&#xAB0; &#xAB6;&#xACB;&#xA9F; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAAE;&#xABE;&#xA82; &#xAAD;&#xAC2;&#xAB2; &#xAA5;&#xA88; &#xA9B;&#xAC7;. &#xAAE;&#xAB9;&#xAC7;&#xAA8;&#xAA4; &#xA95;&#xAB0;&#xAC0;&#xAA8;&#xAC7; &#xAAB;&#xAB0;&#xAC0; &#xAA5;&#xAB5;&#xABE;&#xAA8;&#xACB; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;.",["ba-videorecorder-uploadcovershot.error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAB0;&#xAA6; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-settings.cancel"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA85;&#xAB9;&#xAC0;&#xA82; &#xA95;&#xACD;&#xAB2;&#xABF;&#xA95; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAA5;&#xAC0; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xAA5;&#xAB0;&#xAC0; &#xAB0;&#xABE;&#xA96;&#xACB;",["ba-videorecorder-controlbar.stop-upload-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA95;&#xAB5;&#xAB0; &#xAB6;&#xACB;&#xA9F; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-settings.instructions-covershot"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA86;&#xAAE;&#xAC7; &#xAAE;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xABE; &#xA87;&#xAA8; &#xAB8;&#xAA4;&#xACD;&#xAA4;&#xABE;&#xAA8;&#xAC7; &#xAAC;&#xACD;&#xAB0;&#xABE;&#xA89;&#xA9D; &#xA95;&#xAB0;&#xAC0; &#xAB6;&#xA95;&#xAA4;&#xABE;&#xA82; &#xAA8;&#xAA5;&#xAC0;. &#xA86; &#xAAA;&#xACD;&#xAB0;&#xA95;&#xABE;&#xAB0;&#xAA8;&#xAC0; &#xAAA;&#xACD;&#xAB0;&#xAA4;&#xABF;&#xAAC;&#xAA6;&#xACD;&#xAA7;&#xAA4;&#xABE; &#xAAB;&#xA95;&#xACD;&#xAA4; Safari (MacOS only) &#xAAC;&#xACD;&#xAB0;&#xABE;&#xA89;&#xA9D;&#xAB0; &#xAA6;&#xACD;&#xAB5;&#xABE;&#xAB0;&#xABE; &#xAAA;&#xACD;&#xAB0;&#xAA6;&#xABE;&#xAA8; &#xA95;&#xAB0;&#xAC7; &#xA9B;&#xAC7;. &#xAB5;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xACB; &#xAB0;&#xAC7;&#xA95;&#xAC9;&#xAB0;&#xACD;&#xAA1; &#xAAE;&#xABE;&#xA9F;&#xAC7;, Chrome, Firefox, Edge, Safari (MacOS only) &#xAAC;&#xACD;&#xAB0;&#xABE;&#xA89;&#xA9D;&#xAB0;&#xACD;&#xAB8; &#xAAE;&#xABE;&#xA82; &#xAAF;&#xACB;&#xA97;&#xACD;&#xAAF; &#xA9B;&#xAC7;.",["ba-videorecorder.attach-error-safari"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA8;&#xACD;&#xAAF;&#xAC2;&#xAA8;&#xAA4;&#xAAE; &#xAA6;&#xAB0;&#xAAE;&#xABF;&#xAAF;&#xABE;&#xAA8;",["ba-videorecorder-settings.min-duration"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAB5;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xACB; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-settings.instructions-upload"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA86;&#xAAE;&#xAC7; &#xAAE;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xABE; &#xA87;&#xAA8; &#xAB8;&#xAA4;&#xACD;&#xAA4;&#xABE;&#xAA8;&#xAC7; &#xAAC;&#xACD;&#xAB0;&#xABE;&#xA89;&#xA9D; &#xA95;&#xAB0;&#xAC0; &#xAB6;&#xA95;&#xAA4;&#xABE;&#xA82; &#xAA8;&#xAA5;&#xAC0;. &#xA86; &#xAAA;&#xACD;&#xAB0;&#xA95;&#xABE;&#xAB0;&#xAA8;&#xAC0; &#xAAA;&#xACD;&#xAB0;&#xAA4;&#xABF;&#xAAC;&#xAA6;&#xACD;&#xAA7;&#xAA4;&#xABE; Edge &#xAAC;&#xACD;&#xAB0;&#xABE;&#xA89;&#xA9D;&#xAB0; &#xAA6;&#xACD;&#xAB5;&#xABE;&#xAB0;&#xABE; &#xAAA;&#xACD;&#xAB0;&#xAA6;&#xABE;&#xAA8; &#xA95;&#xAB0;&#xAC7; &#xA9B;&#xAC7;. &#xAB5;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xACB; &#xAB0;&#xAC7;&#xA95;&#xAC9;&#xAB0;&#xACD;&#xAA1; &#xAAE;&#xABE;&#xA9F;&#xAC7;, Chrome, Firefox, Edge, Safari (MacOS only) &#xAAC;&#xACD;&#xAB0;&#xABE;&#xA89;&#xA9D;&#xAB0;&#xACD;&#xAB8; &#xAAE;&#xABE;&#xA82; &#xAAF;&#xACB;&#xA97;&#xACD;&#xAAF; &#xA9B;&#xAC7;.",["ba-videorecorder.attach-error-edge"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA4;&#xAAE;&#xABE;&#xAB0;&#xAC0; &#xAA4;&#xAB8;&#xACD;&#xAB5;&#xAC0;&#xAB0; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAAE;&#xABE;&#xA82; &#xAAD;&#xAC2;&#xAB2; &#xAA5;&#xA88; &#xA9B;&#xAC7;. &#xAAE;&#xAB9;&#xAC7;&#xAA8;&#xAA4; &#xA95;&#xAB0;&#xAC0;&#xAA8;&#xAC7; &#xAAB;&#xAB0;&#xAC0; &#xAA5;&#xAB5;&#xABE;&#xAA8;&#xACB; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;.",["ba-videorecorder-imagegallery.error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA85;&#xAB9;&#xAC0;&#xA82; &#xA95;&#xACD;&#xAB2;&#xABF;&#xA95; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAA5;&#xAC0; &#xAAA;&#xAC1;&#xAA8;&#xA83; &#xA9A;&#xABE;&#xAB2;&#xAC1; &#xA95;&#xAB0;&#xACB;.",["ba-videorecorder-controlbar.replay-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA85;&#xAB9;&#xAC0;&#xA82; &#xA95;&#xACD;&#xAB2;&#xABF;&#xA95; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAA5;&#xAC0; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xAAA;&#xACD;&#xAB0;&#xABE;&#xAB0;&#xA82;&#xAAD; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-controlbar.resume-upload-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xAAA;&#xACD;&#xAB0;&#xABE;&#xAB0;&#xA82;&#xAAD; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-controlbar.resume-upload"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA4;&#xAAE;&#xABE;&#xAB0;&#xAC0; &#xAB5;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xACB; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAAE;&#xABE;&#xA82; &#xAAD;&#xAC2;&#xAB2; &#xAA5;&#xA88; &#xA9B;&#xAC7;. &#xAAE;&#xAB9;&#xAC7;&#xAA8;&#xAA4; &#xA95;&#xAB0;&#xAC0;&#xAA8;&#xAC7; &#xAAB;&#xAB0;&#xAC0; &#xAA5;&#xAB5;&#xABE;&#xAA8;&#xACB; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;.",["ba-videorecorder-uploadvideo.error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAB8;&#xA82;&#xAAA;&#xACD;&#xAB0;&#xAC7;&#xA95;&#xACD;&#xAB7;&#xACD;&#xAAF; &#xAA6;&#xAB0;&#xAAE;&#xABF;&#xAAF;&#xABE;&#xAA8;",["ba-videorecorder-settings.aspect-ratio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAAA;&#xAC1;&#xAA8;&#xA83; &#xA9A;&#xABE;&#xAB2;&#xAC1; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-controlbar.replay"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA4;&#xAAE;&#xABE;&#xAB0;&#xAC0; &#xA95;&#xAB5;&#xAB0; &#xAA5;&#xAAE;&#xACD;&#xAAC;&#xAA8;&#xAC7;&#xAB2; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAAE;&#xABE;&#xA82; &#xAAD;&#xAC2;&#xAB2; &#xAA5;&#xA88; &#xA9B;&#xAC7;. &#xAAE;&#xAB9;&#xAC7;&#xAA8;&#xAA4; &#xA95;&#xAB0;&#xAC0;&#xAA8;&#xAC7; &#xAAB;&#xAB0;&#xAC0; &#xAA5;&#xAB5;&#xABE;&#xAA8;&#xACB; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;.",["ba-videorecorder-uploadthumbnail.error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-settings.upload"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA85;&#xAB9;&#xAC0;&#xA82; &#xA95;&#xACD;&#xAB2;&#xABF;&#xA95; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAA5;&#xAC0; &#xA95;&#xAB5;&#xAB0; &#xAB5;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xACB; &#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-controlbar.upload-cover-video-tooltip"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAB8;&#xA82;&#xAAA;&#xACD;&#xAB0;&#xAC7;&#xA95;&#xACD;&#xAB7;&#xACD;&#xAAF; &#xAA6;&#xAB0;&#xAAE;&#xABF;&#xAAF;&#xABE;&#xAA8; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-settings.instructions-aspect-ratio"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAB8;&#xACD;&#xA9F;&#xACD;&#xAB0;&#xAC0;&#xAAE;&#xACD;&#xAB8; &#xA9A;&#xAAF;&#xAA8; &#xA95;&#xAB0;&#xACB;",["ba-videorecorder-settings.instructions-streams"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAA4;&#xAAE;&#xABE;&#xAB0;&#xAC0; &#xAB5;&#xAC0;&#xAA1;&#xABF;&#xAAF;&#xACB; &#xAB0;&#xAC7;&#xA95;&#xAC9;&#xAB0;&#xACD;&#xAA1; &#xA95;&#xAB0;&#xAB5;&#xABE;&#xAAE;&#xABE;&#xA82; &#xAAD;&#xAC2;&#xAB2; &#xAA5;&#xA88; &#xA9B;&#xAC7;. &#xAAE;&#xAB9;&#xAC7;&#xAA8;&#xAA4; &#xA95;&#xAB0;&#xAC0;&#xAA8;&#xAC7; &#xAAB;&#xAB0;&#xAC0; &#xAA5;&#xAB5;&#xABE;&#xAA8;&#xACB; &#xAAA;&#xACD;&#xAB0;&#xAAF;&#xABE;&#xAB8; &#xA95;&#xAB0;&#xACB;.",["ba-videorecorder-videorecording.error"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAB8;&#xACD;&#xA9F;&#xACD;&#xAB0;&#xAC0;&#xAAE;&#xACD;&#xAB8;",["ba-videorecorder-settings.streams"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xAAE;&#xAB9;&#xAA4;&#xACD;&#xAA4;&#xAAE; &#xAA6;&#xAB0;&#xAAE;&#xABF;&#xAAF;&#xABE;&#xAA8;",["ba-videorecorder-settings.max-duration"]),{}}),e.define("module:Assets.Languages.",["module:Assets"],function(e){return e.strings.register("&#xA85;&#xAAA;&#xAB2;&#xACB;&#xAA1; &#xAA5;&#xAB0;&#xAC0; &#xAB0;&#xABE;&#xA96;&#xACB;",["ba-videorecorder-controlbar.stop-upload"]),{}}),e.define("module:Ads.IMALoader",["base:Promise","browser:Loader"],function(s,n){return{loadSDK:function(e){var t=s.create();try{"undefined"==typeof google||"undefined"==typeof google.ima?n.loadScript("https://imasdk.googleapis.com/js/sdkloader/ima3.js",function(){t.asyncSuccess(e&&this.adsLoader(e))},this):t.asyncSuccess(e&&this.adsLoader(e))}catch(i){t.asyncError(i)}return t},loadIAS:function(){var e=s.create();try{"undefined"==typeof googleImaVansAdapter?n.loadScript("https://static.adsafeprotected.com/vans-adapter-google-ima.js",function(){e.asyncSuccess(!0)},this):e.asyncSuccess(!0)}catch(t){e.asyncError(t)}return e},adContainer:function(e){e=new google.ima.AdDisplayContainer(e.adContainer,e.videoElement);return e.initialize(),e},adsLoader:function(e){return new google.ima.AdsLoader(this.adContainer(e))}}}),e.define("module:Ads.IMA.AdsManager",["base:Class","base:Objs","base:Types","base:Events.EventsMixin"],function(e,i,o,t,s){return e.extend({scoped:s},[t,function(t){return{constructor:function(e){if(t.constructor.call(this,e),!e.adContainer)throw Error("Missing adContainer");if(null===e.videoElement)throw Error("Missing videoElement");this._options=e,google&&google.ima&&e.IMASettings&&this._setIMASettings(e),this._adDisplayContainer=new google.ima.AdDisplayContainer(e.adContainer,e.videoElement,e.customclickthrough||null),this._adsLoader=new google.ima.AdsLoader(this._adDisplayContainer),this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this),!1),this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1)},_setIMASettings:function(e){e=e.IMASettings;google&&google.ima&&"number"==typeof e.vpaidMode&&[google.ima.ImaSdkSettings.VpaidMode.DISABLED,google.ima.ImaSdkSettings.VpaidMode.ENABLED,google.ima.ImaSdkSettings.VpaidMode.INSECURE].includes(e.vpaidMode)?google.ima.settings.setVpaidMode(e.vpaidMode):google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.INSECURE),e.autoPlayAdBreaks&&google.ima.settings.setAutoPlayAdBreaks(autoPlayAdBreaks),e.cookiesEnabled&&google.ima.settings.setCookiesEnabled(e.cookiesEnabled),e.disableCustomPlaybackForIOS10Plus&&google.ima.settings.setDisableCustomPlaybackForIOS10Plus(e.disableCustomPlaybackForIOS10Plus),e.locale&&google.ima.settings.setLocale(e.locale),e.numRedirects&&google.ima.settings.setNumRedirects(e.numRedirects),e.companionBackfillMode&&google.ima.settings.setCompanionBackfill(companionBackfillMode)},destroy:function(){this._adsLoader&&(this._adsLoader.destroy(),this._adsLoader=null),this._adsManager&&(this._adsManager.destroy(),this._adsManager=null),t.destroy.call(this)},requestAds:function(e){this._adsRequest=new google.ima.AdsRequest,e.adTagUrl?this._adsRequest.adTagUrl=e.adTagUrl:e.inlinevastxml&&(this._adsRequest.adsResponse=e.inlinevastxml),this._adsRequest.linearAdSlotWidth=e.linearAdSlotWidth,this._adsRequest.linearAdSlotHeight=e.linearAdSlotHeight,this._adsRequest.nonLinearAdSlotWidth=e.nonLinearAdSlotWidth,this._adsRequest.nonLinearAdSlotHeight=e.nonLinearAdSlotHeight,this._adsRequest.setAdWillAutoPlay(e.adWillAutoPlay),this._adsRequest.setAdWillPlayMuted(e.adWillPlayMuted),this._adsRequest.setContinuousPlayback(e.continuousPlayback),this._adsLoader.getSettings().setAutoPlayAdBreaks(e.autoPlayAdBreaks),this._adsLoader.requestAds(this._adsRequest)},onAdsManagerLoaded:function(e){var t=new google.ima.AdsRenderingSettings;if(this._options&&this._options.adsRenderingSettings)for(var i in this._options.adsRenderingSettings)if("uiElements"===i){var s=this._options.adsRenderingSettings[i];const r=[google.ima.UiElements.AD_ATTRIBUTION,google.ima.UiElements.COUNTDOWN];o.is_array(s)?0<=(s=s.filter(function(e){return r.includes(e)})).length&&(t[i]=s):console.log("IMA: uiElements must be an array of allowed UI elements. See https://developers.google.com/interactive-media-ads/docs/sdks/html5/client-side/reference/js/google.ima#.UiElements for more information.")}else t[i]=this._options.adsRenderingSettings[i];try{this._adsManager=e.getAdsManager(this._options.videoElement,t),e.getUserRequestContext()?this._adsManager.setVolume(e.getUserRequestContext().options.volume):this._adsManager.setVolume(this._options?.videoElement?.volume||0)}catch(n){n instanceof google.ima.AdError?this.onAdError(n):this.onAdError({message:`Getting Ads Manager failed to load with settings: ${JSON.stringify(t)}. 
 More details: `+JSON.stringify(n)})}this.addEventListeners(),this.__methods().forEach(function(e){this[e]=this._adsManager[e].bind(this._adsManager)}.bind(this)),this.trigger(e.type,e)},onAdEvent:function(e){this.trigger(e.type,e)},onAdError:function(e){var t=e.message||e.errorMessage||e;e.getError&&(e=e.getError())&&(t=e.getMessage()+" Code: "+e.getErrorCode()),this.trigger("ad-error",t)},addEventListeners:function(){i.iter(this.__events(),function(e){this._adsManager.addEventListener(e,function(e){return e.type===google.ima.AdErrorEvent.Type.AD_ERROR?this.onAdError(e):this.onAdEvent(e)},!1,this)},this)},contentComplete:function(){this._adsLoader&&this._adsLoader.contentComplete()},reset:function(){this._adsManager&&this._adsManager.destroy()},start:function(e){if(!this._adsManager)return this.once("adsManagerLoaded",function(){this.start(e)},this);try{this._adDisplayContainer.initialize(),this._adsManager.init(e.width,e.height,google.ima.ViewMode.NORMAL),this._adsManager.setVolume(e.volume),this._adsManager.start()}catch(t){throw this.onAdError(t),t}},adDisplayContainerInitialized:function(){return!!this.__adDisplayContainerInitialized},initializeAdDisplayContainer:function(){this.__adDisplayContainerInitialized||(this._adDisplayContainer.initialize(),this.__adDisplayContainerInitialized=!0)},__methods:function(){return["collapse","discardAdBreak","focus","getAdSkippableState","getCuePoints","getCurrentAd","getRemainingTime","getVolume","isCustomClickTrackingUsed","isCustomPlaybackUsed","pause","resize","resume","setVolume","skip","stop","updateAdsRenderingSettings"]},__events:function(){return[google.ima.AdErrorEvent.Type.AD_ERROR,google.ima.AdEvent.Type.AD_CAN_PLAY,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.VIDEO_CLICKED,google.ima.AdEvent.Type.AD_PROGRESS,google.ima.AdEvent.Type.DURATION_CHANGE,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.LINEAR_CHANGED,google.ima.AdEvent.Type.VOLUME_CHANGED,google.ima.AdEvent.Type.VOLUME_MUTED,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,google.ima.AdEvent.Type.INTERACTION,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.VIDEO_ICON_CLICKED,google.ima.AdEvent.Type.AD_BUFFERING,google.ima.AdEvent.Type.AD_METADATA,google.ima.AdEvent.Type.AD_BREAK_READY,google.ima.AdEvent.Type.LOG]}}}])}),e.define("module:Ads.AbstractVideoAdProvider",["base:Class"],function(e,t){return e.extend({scoped:t},function(t){return{constructor:function(e){t.constructor.call(this),this._options=e},options:function(){return this._options},_newPrerollAd:function(e){},_initAdsLoader:function(e){},_newAdsRequester:function(e,t,i){},newPrerollAd:function(e){return this._newPrerollAd(e)},initAdsLoader:function(e){return this._initAdsLoader(e)},newAdsRequester:function(e,t,i){return this._newAdsRequester(e,t,i)},register:function(e){this.cls.registry[e]=this}}},{registry:{}})}),e.define("module:Assets",["base:Classes.LocaleTable","browser:Info"],function(e,t){e=new e;return e.setWeakLocale(t.language()),{strings:e,playerthemes:{},recorderthemes:{},imageviewerthemes:{},imagecapturethemes:{},audioplayerthemes:{},audiorecorderthemes:{}}}),e.define("module:AudioVisualization",["base:Class","base:Maths","browser:Dom","browser:Info"],function(e,n,s,t,i){return e.extend({scoped:i},function(i){return{constructor:function(e,t){i.constructor.call(this),this.stream=e,this.recorder=null,this.theme=t.theme,t.recorder?this.recorder=t.recorder:(e=window.AudioContext||window.webkitAudioContext,this.audioContext=new e),this.createVisualizationCanvas(t.height,t.element),this.frameID=null},createVisualizationCanvas:function(e,t){e=e||120,t=t.firstElementChild||t.firstChild;t.style.minHeight=e+"px",this.canvas=t.querySelector("canvas"),this.canvas.style.display="block",this.canvas.width=parseFloat(window.getComputedStyle(t).width),this.canvas.height=e,this.canvasContext=this.canvas.getContext("2d")},_clearCanvas:function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},initializeVisualEffect:function(){try{var e;this.recorder&&(this._analyser=this.recorder._analyser,this.analyser=this._analyser._analyserNode,this.audioContext=this._analyser._audioContext,this.analyser.fftSize=256),this.audioContext||this.stream?("suspended"===this.audioContext.state&&s.userInteraction(function(){this.audioContext.resume()},this),this.stream instanceof HTMLElement&&(e=this.audioContext.createMediaElementSource(this.stream),this.analyser=this.audioContext.createAnalyser(),e.connect(this.analyser),this.analyser.fftSize=256,this.analyser.connect(this.audioContext.destination)),this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.barWidth=this.canvasWidth/this.bufferLength*2.5,this.barHeight=0,this.x=0,window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)})):console.warn("Seems there is limitation by browser to create AudioContext instance")}catch(t){console.warn("Web Audio API not supported",t)}},start:function(){this._renderFrame()},pause:function(){this._cancelFrame()},stop:function(){this._cancelFrame(),this._clearCanvas()},destroy:function(){this.canvas&&this.canvas.remove(),i.destroy.call(this)},_renderFrame:function(){this.frameID=requestAnimationFrame(function(){this._renderFrame()}.bind(this)),this.analyser.getByteFrequencyData(this.dataArray),"red-bars"===this.theme?this._drawRedBars():this._drawBigBalloon()},_cancelFrame:function(){cancelAnimationFrame(this.frameID)},updateSourceStream:function(){this._cancelFrame(),this.initializeVisualEffect()},_drawRedBars:function(){this.x=0,this.canvasContext.fillStyle="#000",this.canvasContext.fillRect(0,0,this.canvasWidth,this.canvasHeight);for(var e=0;e<this.bufferLength;e++){this.barHeight=this.dataArray[e]/2;var t=this.barHeight+e/this.bufferLength*25,i=e/this.bufferLength*250;this.canvasContext.fillStyle="rgb("+t+","+i+",50)",this.canvasContext.fillRect(this.x,this.canvasHeight-this.barHeight,this.barWidth,this.barHeight),this.x+=this.barWidth+1}},_drawBigBalloon:function(){this.__canvasBackground(235),this.canvasContext.fillStyle="#000";var e=this.__getRMS();this.canvasContext.fillStyle=this.__rgb(2*e),this.__HfillEllipse(this.canvasWidth/2,this.canvasHeight/2,5*e,5*e)},__getRMS:function(){for(var e=0,t=0;t<this.bufferLength;t++)e+=this.dataArray[t]*this.dataArray[t];return e/=this.dataArray.length,e=Math.sqrt(e)},__canvasBackground:function(e,t,i,s){this.canvasContext.fillStyle=void 0===t?this.__rgb(e,e,e):void 0===i&&void 0===s?rgba(e,e,e,t):void 0===s?this.__rgb(e,t,i):this.__rgba(e,t,i,s),this.canvasContext.fillRect(0,0,this.canvasWidth,this.canvasHeight)},__HfillEllipse:function(e,t,i,s){this.__Hellipse(e,t,i,s=void 0===s?i:s),this.canvasContext.fill(),this.canvasContext.beginPath()},__Hellipse:function(e,t,i,s){"use strict";void 0===s&&(s=i),this.canvasContext.beginPath();for(var n=0;n<2*Math.PI;n+=Math.PI/64)this.canvasContext.lineTo(e+Math.cos(n)*i/2,t+Math.sin(n)*s/2);this.canvasContext.closePath()},__rgb:function(e,t,i){return void 0===t&&(t=e),void 0===i&&(i=e),"rgb("+n.clamp(Math.round(e),0,255)+", "+n.clamp(Math.round(t),0,255)+", "+n.clamp(Math.round(i),0,255)+")"},__rgba:function(e,t,i,s){return void 0===t?"rgb("+n.clamp(Math.round(e),0,255)+", "+n.clamp(Math.round(e),0,255)+", "+n.clamp(Math.round(e),0,255)+")":void 0===i?"rgba("+n.clamp(Math.round(e),0,255)+", "+n.clamp(Math.round(e),0,255)+", "+n.clamp(Math.round(e),0,255)+", "+n.clamp(t,0,1)+")":void 0===s?"rgba("+n.clamp(Math.round(e),0,255)+", "+n.clamp(Math.round(t),0,255)+", "+n.clamp(Math.round(i),0,255)+", 1)":"rgba("+n.clamp(Math.round(e),0,255)+", "+n.clamp(Math.round(t),0,255)+", "+n.clamp(Math.round(i),0,255)+", "+n.clamp(s,0,1)+")"}}},{supported:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}})}),e.define("module:DatasetProperties",["base:Properties.Properties"],function(e,t){return e.extend({scoped:t},function(s){return{constructor:function(e,t,i){this.element=e,s.constructor.call(this,t,i)},_afterSet:function(e,t){this.element.dataset[e]=t}}})}),e.define("module:Common.Dynamics.Helperframe",["dynamics:Dynamic","base:Async","base:Timers.Timer","base:Objs","browser:Events","browser:Geometry","browser:Info"],function(e,s,n,r,o,i,a,t){return e.extend({scoped:t},function(e){return{attrs:{css:"ba-videorecorder",framereversable:!0,framedragable:!0,frameresizeable:!1,framepositionx:5,framepositiony:5,frameminwidth:120,frameminheight:95,initialpositionx:null,initialpositiony:null,initialwidth:null,initialheight:null,flipframe:!1,frameproportional:!0,framemainstyle:{opacity:.5,position:"absolute",cursor:"pointer",zIndex:100}},types:{framereversable:"boolean",framedragable:"boolean",frameresizeable:"boolean",frameproportional:"boolean",framepositionx:"int",framepositiony:"int",frameminwidth:"int",frameminheight:"int"},computed:{},events:{"change:framepositionx change:framepositiony change:framewidth change:frameheight":function(e){"undefined"!=typeof this.recorder&&("object"==typeof this.recorder._recorder&&this.__visibleDimensions.accessible?this.recorder._recorder.updateMultiStreamPosition(this.get("framepositionx"),this.get("framepositiony"),this.get("framewidth"),this.get("frameheight")):this.recorder=this.__parent.recorder)}},create:function(){var e,t,i=0;this.__parent=this.parent(),this.__initialSettings={reversable:this.get("framereversable"),dragable:this.get("framedragable"),resizeable:this.get("frameresizeable")},r.iter(this.get("framemainstyle"),function(e,t){this.activeElement().style[t]=e},this),this.get("initialpositionx")&&this.get("initialpositiony")||(this.set("initialpositionx",this.get("framepositionx")),this.set("initialpositiony",this.get("framepositiony"))),e=a.isTouchable()&&!a.isDesktop()?"touch":"click",this._frameInteractionEventHandler=this.auto_destroy(new o),this.recorder=this.__parent.recorder,this.player=this.__parent.player,this.__visibleDimensions={},this.__setHelperFrameDimensions(),this.__visibleDimensions.accessible||(t=new n({context:this,fire:function(){this.recorder._recorder._videoTrackSettings&&"object"==typeof this.recorder._recorder._videoTrackSettings.videoElement&&t&&(this.set("framewidth",this.__parent.get("addstreampositionwidth")),this.set("frameheight",this.__parent.get("addstreampositionheight")),this.get("initialwidth")&&this.get("initialheight")||(this.set("initialwidth",this.get("framewidth")),this.set("initialheight",this.get("frameheight"))),this.fitFrameViewOnScreenVideo(),t.stop())},delay:10,destroy_on_stop:!0,immediate:!0})),this.recorder?(this.recorder._recorder.on("multistream-camera-switched",function(e,t){this.__initialSettings.resizeable&&this.__resizerElement&&(this.set("frameresizeable",t),this.__resizerElement.style.display=t?"none":"block"),this.set("framewidth",e.width),this.set("frameheight",e.height)},this),this.get("framereversable")&&this._frameInteractionEventHandler.on(this.activeElement(),e,function(e){1===++i&&s.eventually(function(){i=0},this,400),2<=i&&this.recorder.reverseCameraScreens()},this),this.get("framedragable")&&this.addDragOption(this.__parent.activeElement()),this.get("frameresizeable")&&this.addResize(a.isTouchable()&&!a.isDesktop(),null,{width:"7px",height:"7px",borderRight:"1px solid white",borderBottom:"1px solid white",bottom:0,right:0,position:"absolute",cursor:"nwse-resize",zIndex:200})):this.player},functions:{},fitFrameViewOnScreenVideo:function(){var e,t=this.recorder._recorder._videoTrackSettings;t&&(e=(this.__parent.get("height")?t.videoElement:t.videoInnerFrame).height,this.__vts||(this.__vts=t),this.__translate=i.padFitBoxInBox(t.width,t.height,t.videoElement.width,e),this.__resizing||(this.__visibleDimensions.x=this.__translate.offsetX+this.get("framepositionx")*this.__translate.scale,this.__visibleDimensions.y=this.__translate.offsetY+this.get("framepositiony")*this.__translate.scale),this.__visibleDimensions.width=this.get("framewidth")*this.__translate.scale,this.__visibleDimensions.height=this.get("frameheight")*this.__translate.scale,this.__visibleDimensions.accessible=!0,this.__dragging||this.__resizing||(this.__positions={initialX:this.__visibleDimensions.x,initialY:this.__visibleDimensions.y,currentX:this.__visibleDimensions.x,currentY:this.__visibleDimensions.y,bottomX:this.__visibleDimensions.x+this.__visibleDimensions.width,bottomY:this.__visibleDimensions.y+this.__visibleDimensions.height,xOffset:0,yOffset:0}),this.__setHelperFrameDimensions())},addDragOption:function(e){this._draggingEvent=this.auto_destroy(new o);var t=a.isTouchable()&&!a.isDesktop(),i=t?"touchmove":"mousemove",s=t?"touchstart":"mousedown";this._draggingEvent.on(e,t?"touchend":"mouseup",this.__handleMouseEndEvent,this),this._draggingEvent.on(e,i,this.__handleMouseMoveEvent,this),this._draggingEvent.on(e,s,this.__handleMouseStartEvent,this)},addResize:function(e,t,i){t=t||this.activeElement(),this.__resizerElement=document.createElement("div"),r.iter(i,function(e,t){this.__resizerElement.style[t]=e},this),t.append(this.__resizerElement),this.__resizeEvent=this.auto_destroy(new o)},__handleMouseStartEvent:function(e){e.preventDefault(),"undefined"==typeof this.__visibleDimensions.accessible?this.fitFrameViewOnScreenVideo():(this.__dragging=e.target===this.activeElement(),this.__resizing=e.target===this.__resizerElement,"object"==typeof this.__positions&&("touchstart"===e.type?(this.__positions.initialX=e.touches[0].clientX-this.__positions.xOffset,this.__positions.initialY=e.touches[0].clientY-this.__positions.yOffset):(this.__dragging&&(this.__positions.initialX=e.clientX-this.__positions.xOffset,this.__positions.initialY=e.clientY-this.__positions.yOffset),this.__positions.bottomX=this.__positions.initialX+this.__visibleDimensions.width,this.__positions.bottomY=this.__positions.initialY+this.__visibleDimensions.height)))},__handleMouseMoveEvent:function(e){var t,i,s,n;e.preventDefault(),(this.__dragging||this.__resizing)&&(this.activeElement().style.cursor="move",this.activeElement().style.opacity="0","touchmove"===e.type?(this.__positions.currentX=e.touches[0].clientX-this.__positions.initialX,this.__positions.currentY=e.touches[0].clientY-this.__positions.initialY):(this.__dragging&&(this.__positions.currentX=e.clientX-this.__positions.initialX,this.__positions.currentY=e.clientY-this.__positions.initialY),this.__resizing&&(n=e.clientX-this.__positions.bottomX,t=e.clientY-this.__positions.bottomY)),this.__dragging&&(this.__positions.xOffset=this.__positions.currentX,this.__positions.yOffset=this.__positions.currentY,e=this.activeElement(),i=this.__positions.currentX,s=this.__positions.currentY,e.style.transform="translate3d("+i+"px, "+s+"px, 0)",this.set("framepositionx",this.__positions.currentX/this.__translate.scale+this.get("initialpositionx")),this.set("framepositiony",this.__positions.currentY/this.__translate.scale+this.get("initialpositiony"))),this.__resizing)&&(e=this.__visibleDimensions.width+n,i=this.get("frameproportional")?e/this.__vts.aspectRatio:this.__visibleDimensions.height+t,this.__positions.bottomX=this.__positions.currentX+e,this.__positions.bottomY=this.__positions.currentY+i,this.set("framewidth",e/this.__translate.scale),this.set("frameheight",i/this.__translate.scale),this.fitFrameViewOnScreenVideo(),s=this.activeElement(),n=i,s.style.width=e,s.style.height=n)},__handleMouseEndEvent:function(e){e.preventDefault(),(this.__dragging||this.__resizing)&&(this.__resizing?(this.__positions.bottomX=this.__positions.currentX+this.__visibleDimensions.width,this.__positions.bottomY=this.__positions.currentY+this.__visibleDimensions.height):(this.__positions.initialX=this.__positions.currentX,this.__positions.initialY=this.__positions.currentY),this.activeElement().style.cursor="pointer",this.activeElement().style.opacity=this.get("framemainstyle").opacity,this.__dragging=!1,this.__resizing=!1)},__setHelperFrameDimensions:function(e){(e=e||this.activeElement())&&(e.style.top=this.__visibleDimensions.y+"px",e.style.left=this.__visibleDimensions.x+"px",e.style.width=this.__visibleDimensions.width+"px",e.style.height=this.__visibleDimensions.height+"px")}}}).register("ba-helperframe")}),e.define("module:FloatHandler",["base:Class","base:Events.EventsMixin","base:Maths","browser:Events","browser:Info"],function(e,t,l,n,i,s){return e.extend({scoped:s},[t,function(s){return{constructor:function(e,t,i){s.constructor.call(this),this.element=e,this.container=t,this.paused=i.paused||!1,this.floatCondition=i.floatCondition,this.noFloatIfBelow=i.noFloatIfBelow||!1,this.noFloatIfAbove=i.noFloatIfAbove||!1,this.threshold=i.threshold,i["static"]||(this.events=this.auto_destroy(new n)),this.floating=!1,this.observing=!1},destroy:function(){this._elementObserver&&this._elementObserver.disconnect(),this._containerObserver&&this._containerObserver.disconnect(),s.destroy.call(this)},init:function(){this._initIntersectionObservers()},pause:function(){this.floating&&this.removeFloatingStyles(),this.paused=!0},start:function(){this.paused=!1,this.elementRect=this.element.getBoundingClientRect(),this.floatCondition&&!this.floatCondition(this.elementRect)||this.elementIsVisible||this.floating||this.transitionToFloat()},stop:function(){this.observing&&(this._elementObserver&&this.element&&this._elementObserver.unobserve(this.element),this._containerObserver&&this.container&&this._containerObserver.unobserve(this.container),this.observing=!1)},resume:function(){this.observing||(this._elementObserver&&this.element&&this._elementObserver.observe(this.element),this._containerObserver&&this.container&&this._containerObserver.observe(this.container),this.observing=!0)},isDragging:function(){return!!this.dragging},stopDragging:function(){this.dragging=!1},transitionToFloat:function(){this.floating=!0,this.trigger("transitionToFloat"),this.addFloatingStyles(),this.events&&this._initEventListeners()},elementWasDragged:function(){return!!this.__elementWasDragged},addFloatingStyles:function(){this._top&&(this.element.style.top=this._top),this._left&&(this.element.style.left=this._left)},removeFloatingStyles:function(){this.element.style.removeProperty("top"),this.element.style.removeProperty("left")},_initIntersectionObservers:function(){var i=!0;this._elementObserver=new IntersectionObserver(function(e,t){this.elementRect=this.element.getBoundingClientRect(),e.forEach(function(e){this.elementIsVisible=e.isIntersecting,i?i=!1:e.isIntersecting||(this.paused||this.floatCondition&&!this.floatCondition(this.elementRect)?this.trigger("transitionOutOfView"):this.transitionToFloat())}.bind(this))}.bind(this),{threshold:this.threshold}),this._containerObserver=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(this.floating=!1,this.trigger("transitionToView"),this.removeFloatingStyles(),this.events&&this.events.off(this.element,"mousedown touchstart"),this.dragging=!1)}.bind(this))}.bind(this),{threshold:this.threshold}),this._elementObserver.observe(this.element),this._containerObserver.observe(this.container),this.observing=!0},_initEventListeners:function(){var t,i,s,n;function r(e){(e=e||window.event).preventDefault(),s=t-e.clientX,n=i-e.clientY,t=e.clientX,i=e.clientY,this.__elementWasDragged=!0,this.dragging=!0,this.element.style.top=l.clamp(this.element.offsetTop-n,0,window.innerHeight-this.element.offsetHeight)+"px",this.element.style.left=l.clamp(this.element.offsetLeft-s,0,window.innerWidth-this.element.offsetWidth)+"px",this._top=this.element.style.getPropertyValue("top"),this._left=this.element.style.getPropertyValue("left")}function o(e){(e=e||window.event).preventDefault(),s=t-e.touches[0].clientX,n=i-e.touches[0].clientY,t=e.touches[0].clientX,i=e.touches[0].clientY,this.__elementWasDragged=!0,this.dragging=!0,this.element.style.top=l.clamp(this.element.offsetTop-n,0,window.innerHeight-this.element.offsetHeight)+"px",this.element.style.left=l.clamp(this.element.offsetLeft-s,0,window.innerWidth-this.element.offsetWidth)+"px",this._top=this.element.style.getPropertyValue("top"),this._left=this.element.style.getPropertyValue("left")}function a(){this.events.off(document,"mousemove mouseup")}function c(){this.events.off(document,"touchmove touchend")}this.events.on(this.element,"mousedown",function(e){(e=e||window.event).preventDefault(),0===e.button&&(t=e.clientX,i=e.clientY,this.events.on(document,"mousemove",r,this),this.events.on(document,"mouseup",a,this))},this),this.events.on(this.element,"touchstart",function(e){(e=e||window.event).preventDefault(),t=e.touches[0].clientX,i=e.touches[0].clientY,this.events.on(document,"touchmove",o,this),this.events.on(document,"touchend",c,this)},this)}}}])}),e.define("module:TrackTags",["base:Class","base:Objs","base:Events.EventsMixin","base:Async","base:Types","base:TimeFormat","browser:Dom","browser:Info","browser:Events"],function(e,h,t,i,m,g,d,a,c,s){return e.extend({scoped:s},[t,function(e){return{constructor:function(e,t){this._dyn=t,this._trackTags=t.get("tracktags"),this._video=t.__video,this._chapters=[],this._chapterLoadedTriggered=!1,this.hasThumbs=!1,t.set("tracktagssupport",this._trackTags&&0<this._trackTags.length&&"track"in document.createElement("track")),this._video&&this._trackTags&&0!==this._trackTags.length&&(this._loadTrackTags(),t.get("tracktagsstyled")&&this._setDefaultTrackOnPlay(),i.eventually(function(){this._loadMetaTrackTags()},this))},showDurationThumb:function(e,t,i){var s,n,r;this._dyn.get("thumbcuelist")[e]&&(e=this._dyn.get("thumbcuelist")[e],i=i||e.startTime+Math.round((e.startTime-e.endTime)/2),n=(s=this.thumbContainer).querySelector("div"),r=s.querySelector("span"),t=t-Math.round(e.thumbWidth/1.5)<=0?5:t-Math.round(e.thumbWidth/1.5),s.style.opacity="0.85",s.style.left=t+"px",n.style.backgroundPositionX="-"+e.positionX+"px",n.style.backgroundPositionY="-"+e.positionY+"px",r.innerText=0<i?g.format(g.ELAPSED_MINUTES_SECONDS,1e3*i):"0:00")},hideDurationThumb:function(){this.thumbContainer.style.opacity="0.00"},_loadTrackTags:function(){this._dyn.get("tracktagssupport")&&h.iter(this._trackTags,function(e,t){var i=document.createElement("track"),s=this.auto_destroy(new c);try{e.content&&!e.src&&(m.is_object(e.content)?i.src=URL.createObjectURL(new Blob([this.generateVTTFromObject(e.content)],{type:"text/vtt"})):i.src=URL.createObjectURL(new Blob([e.content],{type:"text/plain"})))}catch(n){console.warn(n)}switch(e.kind){case"thumbnails":i.id=this._dyn.get("css")+"-track-thumbnails",i.kind="metadata",i.src||(i.src=e.src||null),i.mode="hidden",this.__appendThumbnailTrackTags(e,t,i,s);break;case"chapters":i.id=this._dyn.get("css")+"-track-chapters",i.kind="chapters",i.src=e.src,i.mode="hidden",this.__appendChaptersTrackTags(e,t,i,s);break;default:i.id=this._dyn.get("css")+"-tack-"+t,i.kind=e.kind||"subtitles",i.label=e.label||"English",i.srclang=e.lang||"en",i.src||(i.src=e.src||null),this._dyn.set("hassubtitles",!0),this.__appendTextTrackTags(e,t,i,!0,s),1<this._trackTags.length&&this._dyn.on("switch-track",function(e){this._dyn.set("tracktextvisible",!0),this._dyn.set("trackcuetext",null),this._setSelectedTag(e)},this)}this._video.appendChild(i)},this)},generateVTTFromObject:function(e,n){n=n||2;var t="times",i="words";if(!e||!m.is_object(e))throw new Error('No content provided for tracktags subtitles content. Expected format: "{content: {words: [], times: [{start: number, end: number}]}}"');if(!e[i]||!e[t]||e[t]&&(!m.isNumber(e[t][0]?.end)||!m.isNumber(e[t][0]?.start)))throw new Error("Please provide correct format for tracktags subtitles content object. Expected format: {words: [], times: [{start: number, end: number}]}");const[s,r]=[e[i],e[t]];let o="",a="WEBVTT",c=r[0].start,l=1;const d=/^[,.?;:!]$/gim,u=/\b[.,!?;:]/g;return h.iter(s,(e,t)=>{var i=d.test(e),s=r[t].end;if(0<=(c=c||r[t].start)&&0<=s&&m.is_string(e)&&0<e.length){if(0<o.length)e=i?e:" "+e;else if(i)return a+=e,void(o="");o+=e,(s>c+1e3*n||15<o.length&&u.test(o))&&(t=g.format("HH:MM:ss.l",s),i=g.format("HH:MM:ss.l",c),a+=`

${l}
${i} --> ${t}
`+o.trim(),l++,c=null,o="")}},this),0<o.length&&(a+=`

${l++}
${g.format("HH:MM:ss.l",c)} --> ${g.format("HH:MM:ss.l",r[r.length-1].end)}
`+o.trim()),a},__detectTrackTagFormat:function(e){e=e.trim().split("\n")[0];return"WEBVTT"===e?"VTT":!isNaN(e)&&0<Number(e)?"SRT":"Unknown"},__appendTextTrackTags:function(e,t,i,s,n){e.enabled&&s&&(i.setAttribute("default",""),this._dyn.set("tracktaglang",e.lang),this._dyn.set("tracktextvisible",!0)),i.setAttribute("data-selector","track-tag"),n.on(i,"load",function(){e.enabled&&s?(this.mode="showing",this._video&&(this._video.textTracks[t].mode="showing"),s=!1):(this.mode="hidden",this._video&&(this._video.textTracks[t].mode="hidden"))},this)},__appendChaptersTrackTags:function(e,t,i,s){var n,r=this;i.setAttribute("data-selector","chapters-track-tag"),s.on(i,"load",function(e){this.hasChapters=!0,n=this.track,(n=n.cues)?r.__generateChapters(n):console.warn("Provided source for the chapters is not correct")})},__appendThumbnailTrackTags:function(e,t,i,s){var n,r,o,a,c,l=this;i.setAttribute("data-selector","thumb-track-tag"),s.on(i,"load",function(e){(n=this.track).cues[0].text&&(o=n.cues[0].text.split("#xywh="),c=o[0],a=n.cues[0].text.split("#xywh=")[1].split(","),(r=new Image).src=c,s.on(r,"load",function(){this.hasThumbs=!0;var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("span");d.elementAddClass(e,this._dyn.get("css")+"-seeking-thumb-container"),e.style.opacity="0.00",t.style.height=+a[3]+"px",t.style.width=+a[2]+"px",t.style.backgroundImage="url('"+c+"')",t.style.backgroundRepeat="no-repeat",t.style.backgroundAttachment="background-attachment",e.appendChild(t),e.appendChild(i),this._dyn.set("thumbimage",{image:r,url:r.src,height:r.naturalHeight||r.height,width:r.naturalWidth||r.width,thumbWidth:Number(a[2]),thumbHeight:Number(a[3])}),this.thumbContainer=e,this.__generateThumbnails(n)},l))})},__generateThumbnails:function(e){h.iter(e.cues,function(e,t){var i;"object"==typeof e&&(i=e.text.trim().split("#xywh=")[1].split(","),this.get("thumbcuelist").push({startTime:e.startTime,endTime:e.endTime,positionX:i[0],positionY:i[1],thumbWidth:i[2],thumbHeight:i[3]}))},this._dyn)},__generateChapters:function(i){h.iter(i,function(e,t){"object"==typeof e&&this._chapters.push({index:t,startTime:e.startTime,endTime:e.endTime,title:e.text}),i.length!==this._chapters.length||this._chapterLoadedTriggered||(this._dyn.trigger("chaptercuesloaded",this._chapters,i.length),this._chapterLoadedTriggered=!0)},this)},_showTracksInCustomElement:function(i,e){var s,e=e||this._dyn.get("tracktaglang"),n=this._dyn,r=n.__video.currentTime;i.language===e&&(s=i.cues,h.iter(s,function(e,t){"object"==typeof s[t]&&s[t]&&(e.startTime<r&&e.endTime>r&&n.set("trackcuetext",e.text),e.onenter=function(e){i.mode="hidden",n.get("tracktextvisible")&&n.set("trackcuetext",this.text)},e.onexit=function(e){n.set("trackcuetext",null)})},this))},_loadMetaTrackTags:function(){this._video&&h.iter(this._video.textTracks,function(e,t){"object"==typeof this._video.textTracks[t]&&this._video.textTracks[t]&&("metadata"===(t=this._video.textTracks[t]).kind&&(t.mode="hidden"),"chapters"===t.kind)&&(t.mode="showing")},this)},_setDefaultTrackOnPlay:function(){this._dyn.player.once("playing",function(){h.iter(this._trackTags,function(e,t){t=this._video.textTracks[t];"object"==typeof t&&t&&"showing"===t.mode&&this._showTracksInCustomElement(t,t.language)},this)},this)},_setSelectedTag:function(i){var s=null,n=null;h.iter(this._video.textTracks,function(e,t){"object"==typeof(n=this._video.textTracks[t])&&n&&(s=n.language===i.lang?this._dyn.get("tracktagsstyled")?"hidden":"showing":"disabled",this._dyn.get("tracktextvisible")||(s="disabled"),n.mode=s,n.language===i.lang)&&this._triggerTrackChange(this._video,n,s,i.lang)},this)},_triggerTrackChange:function(e,t,i,s){var n=e.querySelector("#"+t.id),r=!0,o=this.auto_destroy(new c);t.oncuechange===undefined||(a.isInternetExplorer()||a.isEdge())&&this._dyn.get("tracktagsstyled")?o(e,"timeupdate",function(){i.length&&(t.mode=i),this._dyn.get("tracktagsstyled")&&this._showTracksInCustomElement(t,s)},this):o.on(t,"cuechange",function(){r&&(i.length&&(t.mode=i),this._dyn.get("tracktagsstyled")?this._showTracksInCustomElement(t,s):n&&(n.mode=i),r=!1)},this)}}}])}),e.define("module:Common.Dynamics.CircleProgress",["dynamics:Dynamic","base:Objs","base:Async","base:Timers.Timer","browser:Dom","browser:Events","module:Assets"],[],function(e,t,i,s,n,r,o,a){return e.extend({scoped:a},function(e){return{construct:function(){e.constructor.call(this)},template:'<div class="{{cssprogressbar}}-container">\n    <div class="{{cssprogressbar}}-circle"\n         data-countdown="{{showpercentage ? progress : (countdown || timeout)}}"\n         ba-styles="{{itemStyles}}"\n    >\n        <svg class="{{cssprogressbar}}-svg" viewBox="2 -2 28 40"\n             xmlns="http://www.w3.org/2000/svg"\n        >\n            <circle\n                class="{{cssprogressbar}}-svg__background"\n                r="16" cx="16" cy="16"\n            ></circle>\n            <circle\n                class="{{cssprogressbar}}-svg__progress"\n                stroke="{{progresscolor}}"\n                r="16" cx="16" cy="16"\n                ba-styles="{{circleStyle}}"\n            ></circle>\n        </svg>\n\n    </div>\n</div>\n',attrs:{css:"ba-common",csscommon:"ba-commoncss",cssplayer:"ba-player",cssprogressbar:"ba-progressbar",timeout:5e3,interval:200,autostart:!1,progresstext:null,stepelements:[],linewidth:2,size:45,showpercentage:!1,progresscolor:"#FF9933",progresscachedcolor:"transparent"},types:{css:"string",csscommon:"string",cssplayer:"string",cssprogressbar:"string",timeout:"int",interval:"int",autostart:"boolean",progresstext:"string",stepelements:"array",size:"int",showpercentage:"boolean",progresscolor:"string",progresscachedcolor:"string"},computed:{"itemStyles:size":function(e){return{width:e=parseInt(e)+"px",height:e}},"circleStyle:progress":function(e){return{strokeDashoffset:-1*e,strokeWidth:parseInt(this.get("linewidth"))+"px"}}},create:function(){this.set("countdown",Number(parseFloat(1e3<this.get("timeout")?this.get("timeout")/1e3:this.get("timeout")).toFixed(2))),this.set("timeout",this.get("countdown"))},_afterActivate:function(){this.init(),this.get("autostart")&&this.start()},functions:{start:function(){this.call("start")},pause:function(){this.call("pause")},resume:function(){this.call("resume")},stop:function(){this.call("stop")},restart:function(){this.call("restart")}},init:function(){this.set("counter",0),this.set("progress",0),this.set("passedseconds",0),this.progressTimer=this._auto_destroy(new s({delay:this.get("interval"),fire:function(){var e;this.get("paused")||(Math.floor(this.get("counter")*this.get("interval")/1e3)>=this.get("passedseconds")+1&&(this.get("countdown")-1<=0&&this.stop(),this.set("countdown",this.get("countdown")-1),this.set("passedseconds",this.get("passedseconds")+1)),e=this.get("counter")*this.get("interval")/1e3/this.get("timeout"),this.set("progress",100*e),100<=this.get("progress")&&this.stop(),this.set("counter",this.get("counter")+1))}.bind(this),context:this,start:this.get("autostart"),immediate:this.get("autostart"),destroy_on_stop:!0}))},start:function(){this.progressTimer.start()},pause:function(){this.progressTimer.pause()},resume:function(){this.progressTimer.resume()},stop:function(){this.progressTimer&&!this.__stopped&&(this.progressTimer.stop(),this.__stopped=!0)},restart:function(){this.stop(),this.init()}}}).register("ba-circle-progress").registerFunctions({cssprogressbar:function(e){return e.cssprogressbar},"showpercentage ? progress : (countdown || timeout)":function(e){return e.showpercentage?e.progress:e.countdown||e.timeout},itemStyles:function(e){return e.itemStyles},progresscolor:function(e){return e.progresscolor},circleStyle:function(e){return e.circleStyle}}).attachStringTable(o.strings).addStrings({"fullscreen-video":"Enter fullscreen"})}),e.define("module:StylesMixin",["base:Objs"],function(t){return{_applyStyles:function(i,s,e){t.iter(e,function(e,t){t in s||i.style.removeProperty(t)}),t.extend(i.style,s)}}}),e.define("module:Common.Dynamics.Settingsmenu",["dynamics:Dynamic","base:Objs","base:Async","base:Timers.Timer","browser:Dom","browser:Events","module:Assets"],["dynamics:Partials.ClickPartial","dynamics:Partials.RepeatElementPartial"],function(e,n,t,a,i,s,r,o){return e.extend({scoped:o},function(e){return{template:'<div if="{{visiblesettings.length > 0}}" class="{{csscommon}}-settings-menu {{csstheme}}-settings-menu" role="settingsblock">\n    <div class="{{csscommon}}-settings-menu-overlay">\n        <div ba-if="{{root}}"\n             class="{{csscommon}}-settings-menu-item"\n             ba-repeat-element="{{setting :: visiblesettings}}"\n             title="{{string(setting.label)}}"\n             ba-click="{{select_setting(setting.id)}}"\n        >\n            <div class="{{csscommon}}-settings-menu-label" role="settingslabel">\n                {{string(setting.label) || setting.label}}\n            </div>\n\n            <div ba-if="{{setting.options}}" class="{{csscommon}}-settings-menu-value {{csscommon}}-setting-option-value"\n                 role="settingsvalue"\n            >\n                {{setting.value}}\n            </div>\n\n            <div ba-if="{{!setting.options}}" class="{{csscommon}}-settings-menu-value "\n                 role="settingicon"\n            >\n                <div ba-if="{{setting.showicon}}"\n                     style="{{setting.value ? setting.icontruestyle : setting.iconfalsestyle}}"\n                     class="{{csscommon}}-setting-menu-icon {{csscommon + (setting.value ? \'-setting-on\' : \'-setting-off\')}}">\n                    {{setting.value ? setting.trueicon : setting.falseicon}}\n                </div>\n            </div>\n\n        </div>\n\n        <div ba-if="{{!root}}">\n            <div class="{{csscommon}}-setting-menu-options-title {{csscommon}}-settings-menu-options-item"\n                 ba-click="{{show_root()}}"\n            > <div>{{ string(selected.label) || string(\'setting-menu\')}}</div></div>\n            <div\n                class="{{csscommon}}-settings-menu-options-item"\n                ba-repeat-element="{{option :: visiblesettings}}"\n                title="{{string(selected.label) || string(\'\')}}"\n                ba-click="{{select_value(option)}}"\n            >\n                <div>\n                    <i ba-if="{{option === selected.value}}" class="{{csscommon}}-icon-check"></i>\n                    {{option.label || option}}\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n',attrs:{css:"ba-common",csscommon:"ba-commoncss",cssplayer:"ba-player",settings:[],visiblesettings:[],selected:null,root:!0,"default":{value:!1,label:"setting-item",visible:!0,mobileSupport:!0,showicon:!0,trueicon:"&#x2713;",falseicon:"&#x2573;",icontruestyle:"color: #5dbb96;",iconfalsestyle:"color: #dd4b39"},predefined:{player:[{id:"playerspeeds",label:"player-speed",value:1,options:[.5,.75,1,1.25,1.5,1.75,2],func:function(e,t){return"function"==typeof this.functions.set_speed&&0<t?(this.functions.set_speed.call(this,t,!0),!0):(console.error("Wrong argument or function provided"),!1)}}],recorder:[{}]}},computed:{settings:function(){var e="object"!=typeof this.__parent.recorder?this.get("predefined").player:this.get("predefined").recorder;return n.iter(e,function(e,t){!e.visible&&"undefined"!=typeof e.visible||this.addSetting(e)},this),this.get("settings")}},events:{"change:visiblesettings":function(e){e=n.peek(e);"object"==typeof e&&e?(this.set("selected",null),e.hasOwnProperty("id")&&this.set("root",!0)):(this.set("root",!1),this._animateFade(!1,this.activeElement()))}},functions:{show_root:function(){this.switchToRoot()},select_setting:function(i){n.iter(this.get("settings"),function(e,t){e.id===i&&this.build_setting(e,i)},this)},select_value:function(e){this._setSettingWithMethod(e)},add_new_settings_item:function(e){!e.visible&&"undefined"!=typeof e.visible||this.addSetting(e)},update_new_settings_item:function(e,t){this.updateSetting(e,t)},remove_settings_item:function(e){this.removeSetting(e)}},create:function(){this.domEvents=this.auto_destroy(new s),this.domEvents.on(document,"click touchstart",function(e){!this.activeElement().contains(e.target)&&this.activeElement()&&this.parent().set("settingsmenu_active",!1)},this)},build_setting:function(e,i){e&&i?1<n.count(e.options)?(this.set("selected",e),this._buildChildMenu(e)):n.iter(this.get("settings"),function(e,t){e.id===i&&(e.value=!e.value,this.set("selected",e),this._setSettingWithMethod(!1,t))},this):console.warn("At least on of the arguments are required")},switchToRoot:function(){this.set("visiblesettings",this.get("settings"))},_buildChildMenu:function(e){this.set("selected",e),this.set("visiblesettings",e.options)},_setSettingWithMethod:function(i,e){"function"==typeof this.get("selected").func&&"boolean"==typeof this.get("selected").func.call(this.__parent,this,i,e)&&(this.get("selected").value=i||!this.get("selected").value,n.iter(this.get("settings"),function(e,t){this.get("selected")&&e&&this.get("selected").id===e.id&&(i||(this.get("settings")[t].value=!this.get("settings")[t].value),this.get("settings")[t]=this.get("selected"),this.set("visiblesettings",[]),this.set("visiblesettings",this.get("settings")))},this))},addSetting:function(t){"object"!=typeof t?console.warn("Sorry you should add new option as an Object"):(n.iter(this.get("settings"),function(e){e.id===t.id&&this.removeSetting(e.id)},this),t.func&&t.id?"function"!=typeof t.func?console.warn("Sorry func key has to be function type"):this.mergeAndRebuildSettings(this.get("default"),t):console.warn("Your added new setting missing mandatory `id`, `func` or `label` keys, please add them"))},updateSetting:function(i,s){"object"!=typeof s?console.warn("Sorry you should provide any new option as an Object"):n.iter(this.get("settings"),function(e,t){e.id===i&&(this.get("settings")[t]=n.tree_merge(this.get("settings")[t],s),this.set("visiblesettings",[]),this.set("visiblesettings",this.get("settings")))},this)},removeSetting:function(i){"string"!=typeof i?console.warn("Sorry you should provide setting ID"):n.iter(this.get("settings"),function(e,t){e.id===i&&(this.get("settings").splice(t),this.set("visiblesettings",[]),this.set("visiblesettings",this.get("settings")))},this)},mergeAndRebuildSettings:function(e,t){e=n.tree_merge(e,t),t=this.get("settings");t.push(e),this.set("visiblesettings",[]),this.set("visiblesettings",t),this.set("settings",t)},_animateFade:function(e,t,i){var s,n,r,o;i?t.style.opacity=e?"0":"1":(n=e?1:0,r=e?-.1:.1,o=e?0:1,t.style.opacity=n,s=this.auto_destroy(new a({context:this,fire:function(){t.style.opacity=n,n+=r,(e&&n<o||!e&&o<n)&&(this.__animationInProcess=!1,s.destroy())},delay:30,immediate:!0})))}}}).register("ba-common-settingsmenu").registerFunctions({"visiblesettings.length > 0":function(e){return 0<e.visiblesettings.length},csscommon:function(e){return e.csscommon},csstheme:function(e){return e.csstheme},root:function(e){return e.root},visiblesettings:function(e){return e.visiblesettings},"string(setting.label)":function(e){return e.string(e.setting.label)},"select_setting(setting.id)":function(e){return e.select_setting(e.setting.id)},"string(setting.label) || setting.label":function(e){return e.string(e.setting.label)||e.setting.label},"setting.options":function(e){return e.setting.options},"setting.value":function(e){return e.setting.value},"!setting.options":function(e){return!e.setting.options},"setting.showicon":function(e){return e.setting.showicon},"setting.value ? setting.icontruestyle : setting.iconfalsestyle":function(e){return e.setting.value?e.setting.icontruestyle:e.setting.iconfalsestyle},"csscommon + (setting.value ? '-setting-on' : '-setting-off')":function(e){return e.csscommon+(e.setting.value?"-setting-on":"-setting-off")},"setting.value ? setting.trueicon : setting.falseicon":function(e){return e.setting.value?e.setting.trueicon:e.setting.falseicon},"!root":function(e){return!e.root},"show_root()":function(e){return e.show_root()},"string(selected.label) || string('setting-menu')":function(e){return e.string(e.selected.label)||e.string("setting-menu")},"string(selected.label) || string('')":function(e){return e.string(e.selected.label)||e.string("")},"select_value(option)":function(e){return e.select_value(e.option)},"option === selected.value":function(e){return e.option===e.selected.value},"option.label || option":function(e){return e.option.label||e.option}}).attachStringTable(r.strings).addStrings({tooltip:"Click to play.","setting-menu":"All settings","source-quality":"Source quality","player-speed":"Player speed","set-menu-option":"Set option","submit-video":"Confirm video","picture-in-picture":"Picture in picture","exit-fullscreen-video":"Exit fullscreen","fullscreen-video":"Enter fullscreen"})}),e.define("module:Common.Dynamics.Spinner",["dynamics:Dynamic"],[],function(e,t){return e.extend({scoped:t},function(e){return{construct:function(){e.constructor.call(this)},template:'<div class="{{cssspinner}}-container">\n    <div ba-styles="{{ {width: size, height: size} }}">\n        <svg viewBox="0 0 100 100" fill="none"\n             xmlns="http://www.w3.org/2000/svg"\n        >\n            <path\n                d="M95 50C95 58.9002 92.3608 67.6004 87.4161 75.0007C82.4715 82.4009 75.4434 88.1686 67.2208 91.5746C58.9981 94.9805 49.9501 95.8717 41.2209 94.1353C32.4918 92.399 24.4736 88.1132 18.1802 81.8198C11.8868 75.5264 7.601 67.5082 5.86466 58.7791C4.12833 50.0499 5.01948 41.0019 8.42542 32.7792C11.8314 24.5566 17.5991 17.5285 24.9993 12.5839C32.3996 7.6392 41.0998 5 50 5"\n                stroke="url(#ba-paint-spinner-line)"\n                stroke-width="{{linewidth}}" stroke-linecap="round"\n                stroke-linejoin="round"\n            />\n            <defs>\n                <linearGradient\n                    id="ba-paint-spinner-line" x1="50" y1="1.29144e-07" x2="96" y2="4.66667"\n                    gradientUnits="userSpaceOnUse"\n                >\n                    <stop stop-color="{{color}}" />\n                    <stop offset="0.397391" stop-color="{{color}}" stop-opacity="0.59" />\n                    <stop offset="0.903685" stop-color="{{color}}" stop-opacity="0" />\n                </linearGradient>\n            </defs>\n        </svg>\n    </div>\n</div>\n',attrs:{css:"ba-common",csscommon:"ba-commoncss",cssplayer:"ba-player",cssspinner:"ba-spinner",speed:1.4,size:"50px",linewidth:10,color:"white"},types:{css:"string",csscommon:"string",cssplayer:"string",cssspinner:"string",speed:"number",size:"string",linewidth:"number",color:"string"}}}).register("ba-spinner").registerFunctions({cssspinner:function(e){return e.cssspinner},"{width: size, height: size}":function(e){return{width:e.size,height:e.size}},linewidth:function(e){return e.linewidth},color:function(e){return e.color}})}),e.define("module:PopupHelper",["base:Class","base:Events.EventsMixin","browser:Dom","browser:Events"],function(e,t,i,s,n){var r=e.extend({scoped:n},[t,function(t){return{constructor:function(e){t.constructor.call(this),this.popupContainer=document.createElement("div"),this.backgroundContainer=document.createElement("div"),this.backgroundContainer.className="ba-popup-helper-overlay-background",this.popupContainer.appendChild(this.backgroundContainer),this.overlayContainer=document.createElement("div"),this.overlayContainer.className="ba-popup-helper-overlay",this.popupContainer.appendChild(this.overlayContainer),this.containerInner=document.createElement("div"),this.containerInner.className="ba-popup-helper-overlay-inner",this.overlayContainer.appendChild(this.containerInner),this.domEvents=this.auto_destroy(new s),this.domEvents.on(this.backgroundContainer,"click touchstart",function(){this.hide()},this),this.domEvents.on(this.containerInner,"click touchstart",function(e){e.stopPropagation()})},show:function(){return this.recursionProtection("show",function(){i.elementAddClass(document.body,"ba-popup-helper-overlay-body"),document.body.appendChild(this.popupContainer),this.trigger("show")})},hide:function(){return this.recursionProtection("hide",function(){var e=this.popupContainer;this.trigger("hide"),document.body.removeChild(e),i.elementRemoveClass(document.body,"ba-popup-helper-overlay-body")})}}}],{mixin:function(t){return{constructor:function(e){this.__popup=new r((e=e||{}).popup),this.__popup.on("hide",this.destroy,this),e.element=this.__popup.containerInner,t.constructor.call(this,e)},activate:function(){this.__popup.show(),t.activate.call(this)},destroy:function(){this.__popup.hide(),this.__popup.destroy(),t.destroy.call(this)}}}});return r}),e.define("module:IframeHelper",["dynamics:Dynamic","base:Objs","base:Types","base:Net.Uri"],function(e,t,i,s,n){return e.extend({scoped:n},function(e){return{template:'<iframe src="{{computeSrc()}}" style="width:100%;height:100%" allow="{{computeAllow()}}" scrolling="no" frameborder="0"></iframe>',getAllowModifiers:function(){return[]},getSrc:function(){return""},filteredAttrs:function(){return t.filter(this.properties().getAll(),function(e,t){return!i.is_object(e)&&!i.is_array(e)},this)},functions:{computeSrc:function(){return s.appendUriParams(this.getSrc(),this.filteredAttrs())},computeAllow:function(){return this.getAllowModifiers().map(function(e){return e+" *"}).join("; ")}},iframe:function(){return this.activeElement().querySelector("iframe")},_afterActivate:function(){e._afterActivate.apply(this,arguments);var t=this.iframe();this.getAllowModifiers().forEach(function(e){t["allow"+e]="allow"+e})}}}).registerFunctions({"computeSrc()":function(e){return e.computeSrc()},"computeAllow()":function(e){return e.computeAllow()}})}),e.define("module:Ads.Dynamics.Player",["base:Objs","browser:Info","base:Maths","base:Types","base:Timers","browser:Dom","module:Assets","dynamics:Dynamic","module:Ads.IMALoader","module:Ads.IMA.AdsManager"],["module:Ads.Dynamics.Controlbar"],function(f,i,t,y,s,b,e,n,r,o,a){return n.extend({scoped:a},function(e){return{template:'<div\n    class="ba-ad-container {{linear ? (css + \'-overlay\') : \'\'}}\n    {{cssadsplayer + (linear ? \'-linear-ad-container\' : \'-non-linear-ad-container\')}}\n    {{hideoninactivity ? (cssplayer + \'-controlbar-hidden\') : \'\'}}"\n    ba-styles="{{floating ? {} : parentcontainersizingstyles}}"\n    data-video="ima-ad-container" data-testid="{{testid}}-ads-player-container"\n>\n    <ba-ads-choices-link\n        ba-if="{{showadchoices && adchoiceslink && adchoicesontop && adsplaying && !floating && !sidebar_active}}"\n        ba-adchoiceslink="{{adchoiceslink}}"\n        ba-cssadsplayer="{{cssadsplayer}}"\n        ba-datatestselector="top-ads-choices-button"\n        data-testid="{{testid}}-top-ads-choices-button"\n    ></ba-ads-choices-link>\n\n    <div ba-if="{{showactionbuttons && isoutstream}}"\n        class="{{cssadsplayer}}-actions-button-container {{csscommon}}-center-all"\n    >\n        <div ba-if="{{showlearnmorebutton && moredetailslink}}">\n            <button class="{{cssadsplayer}}-action-button" ba-click="{{redirect(moredetailslink)}}"\n                title="{{moredetailstext ? moredetailstext : string(\'learn-more\')}}"\n                data-testid="{{testid}}-ads-player-more-details-button"\n            >\n                <i class="{{csscommon}}-icon-share"></i>\n                {{moredetailstext ? moredetailstext : string(\'learn-more\')}}\n            </button>\n        </div>\n        <div ba-if="{{showrepeatbutton}}">\n            <button class="{{cssadsplayer}}-action-button" ba-click="{{replay()}}"\n                    title="{{repeatbuttontext ? repeatbuttontext : string(\'replay-ad\')}}"\n                    data-testid="{{testid}}-ads-player-replay-button"\n            >\n                <i class="{{csscommon}}-icon-cw"></i>\n                {{repeatbuttontext ? repeatbuttontext : string(\'replay-ad\')}}\n            </button>\n        </div>\n        <div ba-if="{{!hideclosebutton}}">\n            <button class="{{cssadsplayer}}-action-button {{cssadsplayer}}-reversed-color"\n                    title="{{string(\'close-ad\')}}" ba-click="{{close()}}"\n                    data-testid="{{testid}}-ads-player-close-button"\n            >\n                <i class="{{csscommon}}-icon-cancel"></i>\n                {{string(\'close-ad\')}}\n            </button>\n        </div>\n    </div>\n    <div ba-if="{{ adsclicktroughurl && customclickthrough }}"\n         data-selector="ba-ads-clickthrough-container"\n         class="{{css}}-overlay {{csscommon}}-clickable"\n    ></div>\n    <div ba-if="{{!userhadplayerinteraction && unmuteonclick && linear}}"\n         class="{{css}}-overlay {{cssadsplayer}}-ad-click-tracker {{csscommon}}-clickable"\n         ba-click="{{ad_clicked()}}"\n    ></div>\n</div>\n<ba-{{dyncontrolbar}}\n    ba-if="{{!hidecontrolbar && linear && !showactionbuttons}}"\n    ba-css="{{css}}"\n    ba-csscommon="{{csscommon}}"\n    ba-cssadsplayer="{{cssadsplayer}}"\n    ba-testid="{{testid}}"\n    ba-template="{{tmplcontrolbar}}"\n    ba-linear={{linear}}\n    ba-duration="{{duration}}"\n    ba-volume="{{volume}}"\n    ba-muted="{{muted}}"\n    ba-remaining="{{=remaining}}"\n    ba-unmuteonclick="{{unmuteonclick}}"\n    ba-playing={{playing}}\n    ba-skipvisible="{{skipvisible}}"\n    ba-userhadplayerinteraction="{{userhadplayerinteraction}}"\n    ba-currenttime={{=currenttime}}\n    ba-hideoninactivity={{hideoninactivity}}\n    ba-fullscreened="{{fullscreened}}"\n    ba-view_type="{{view_type}}"\n    ba-floating="{{floating}}"\n    ba-adchoicesontop="{{adchoicesontop}}"\n    ba-adchoiceslink="{{adchoiceslink}}"\n    ba-adchoicesstring="{{string(\'ad-choices\')}}"\n    ba-controlbarstyles="{{controlbarstyles}}"\n    ba-showadchoices="{{showadchoices}}"\n    ba-event:resume="resume"\n    ba-event:pause="pause"\n    ba-event:stop="stop"\n    ba-event:volume="set_volume"\n    ba-event:fullscreen="{{trigger(\'fullscreen\')}}"\n    ba-event:toggle_volume="{{toggle_volume}}"\n></ba-{{dyncontrolbar}}>\n',attrs:{dyncontrolbar:"ads-controlbar",tmplcontrolbar:"",cssadsplayer:"ba-adsplayer",commoncss:"",linear:!0,playing:!1,currenttime:0,volume:0,isoutstream:!1,hidecontrolbar:!1,showactionbuttons:!1,showrepeatbutton:!0,showlearnmore:!1,hideclosebutton:!1,adscompleted:!1,moredetailslink:null,moredetailstext:null,repeatbuttontext:null,adsplaying:!1,companionads:[],companionadcontent:null,customclickthrough:!1,persistentcompanionad:!1},events:{"change:volume":function(e){if(this.adsManager&&this.adsManager.setVolume)return 0<(e=t.clamp(e,0,1))&&this.get("unmuteonclick")?setTimeout(function(){this.adsManager&&this.adsManager.setVolume&&this.adsManager.setVolume(e)}.bind(this),200):this.adsManager.setVolume(e)},"change:imaadsrenderingsetting":function(e){this.adsManager&&y.is_object(e)&&this.adsManager.updateAdsRenderingSettings(e)}},_deferActivate:function(){return!this._loadedSDK&&(r.loadSDK().success(function(){this.__iasConfig()?r.loadIAS().success(function(){this._loadedSDK=!0,this.activate()},this):(this._loadedSDK=!0,this.activate())},this),!0)},_baseRequestAdsOptions:function(){var e={adTagUrl:this.get("adtagurl"),IMASettings:this.get("imasettings"),inlinevastxml:this.get("inlinevastxml"),continuousPlayback:!0,linearAdSlotWidth:this.getAdWidth(),linearAdSlotHeight:this.getAdHeight(),nonLinearAdSlotWidth:this.getAdWidth(),nonLinearAdSlotHeight:this.getAdHeight()/3,adWillAutoPlay:this.getAdWillAutoPlay(),adWillPlayMuted:this.getAdWillPlayMuted(),autoPlayAdBreaks:!0,width:this.getAdWidth(),height:this.getAdHeight(),volume:this.getAdWillPlayMuted()?0:this.get("volume")};return this.get("adsrendertimeout")&&0<this.get("adsrendertimeout")&&(e.vastLoadTimeout=this.get("adsrendertimeout")),e},channels:{"ads:ad-error":function(){this.set("adsplaying",!1),this.parent().get("outstream")&&this.parent().hidePlayerContainer()},"ads:render-timeout":function(){this.adsManager&&"function"==typeof this.adsManager.destroy&&!this.adsManager.destroyed()&&this.adsManager.destroy();var e=this.parent();e&&(e.stopAdsRenderFailTimeout(!0),e.channel("ads").trigger("ad-error"))},"ads:load":function(){this.set("skipvisible",!1),this.call("load"),this.set("quartile","first")},"ads:firstQuartile":function(){this.set("quartile","second")},"ads:midpoint":function(){this.set("quartile","third")},"ads:thirdQuartile":function(){this.set("quartile","fourth")},"ads:start":function(e){this._onStart(e)},"ads:skippableStateChanged":function(e){this.set("skipvisible",!0)},"ads:complete":function(e){this._onAdComplete(e)},"ads:allAdsCompleted":function(){this.parent()&&(this.parent().get("outstreamoptions").noEndCard||this.parent().get("outstreamoptions.allowRepeat"))||this.call("reset")},"ads:discardAdBreak":function(){this.call("discardAdBreak")},"ads:contentComplete":function(){this.call("contentComplete")},"ads:loaded":function(e){var t=e.getAd(),t=(this.set("ad",t),this.setEndCardBackground(this.getAdWidth(),this.getAdHeight()),e.getAdData()),e=t.clickThroughUrl;this.set("addata",t),this.get("adsunmuted")&&this.adsManager.setVolume(this.get("volume")),this._setVolume(this.adsManager.getVolume(),!1),this.set("duration",t.duration),this.set("moredetailslink",e),this.set("adsclicktroughurl",e)},"ads:outstreamCompleted":function(e){this._outstreamCompleted(e)},"ads:outstreamStarted":function(e){this._outstreamStarted(e)},"ads:pause":function(){this.get("playing")&&(this.call("pause"),this.set("playing",!1))},"ads:resume":function(){this.get("playing")||(this.call("resume"),this.set("playing",!0))},"ads:contentResumeRequested":function(){this.set("adsplaying",!1)},"ads:contentPauseRequested":function(){this.set("adsplaying",!0)}},__iasConfig:function(){return this.parent().get("ias-config")},create:function(){var e=this.parent(),t={adContainer:this.getAdContainer(),adsRenderingSettings:this.get("imaadsrenderingsetting"),IMASettings:this.get("imasettings")};!i.isMobile()&&this.getVideoElement()?t.videoElement=this.getVideoElement():(t.customclickthrough=this.getClickTroughElement(),this.set("customclickthrough",!!t.customclickthrough)),this.adsManager=this.auto_destroy(new o(t,e)),this.adsManager.requestAds(this._baseRequestAdsOptions()),this.adsManager.on("all",function(e,t){"adsManagerLoaded"===e&&(this.set("adsmanagerloaded",!0),this.__iasConfig()&&"undefined"!=typeof googleImaVansAdapter&&googleImaVansAdapter.init(google,this.adsManager,this.getVideoElement(),f.extend({campId:(this.getAdWidth()||640)+"x"+(this.getAdHeight()||360)},this.__iasConfig)),this._setLoadVideoTimeout()),this.channel("ads").trigger(e,t)},this),this.shouldShowFirstFrameAsEndcard()&&this.on("change:endcardbackgroundsrc",function(e){e&&(this.getAdContainer().style.backgroundImage=`url("${e}")`)}),e&&(e.initAdsRenderFailTimeout(),e.on("resize",function(e){var t=this.getAdWidth(),i=this.getAdHeight();t&&i&&(this.adsManager&&"function"==typeof this.adsManager.resize&&this.adsManager.resize(t,i,google.ima.ViewMode.NORMAL),this.setEndCardBackground(t,i))},this))},functions:{load:function(){if(!this.adsManager)return this.once("dynamic-activated",function(){this.call("load")},this);this.adsManager.start({width:this.getAdWidth(),height:this.getAdHeight(),volume:this.getAdWillPlayMuted()?0:this.get("volume")})},ad_clicked:function(){this.get("userhadplayerinteraction")||this.parent().set("userhadplayerinteraction",!0)},reset:function(){this.set("linear",!0),this.set("adscompleted",!0),this.set("adsplaying",!1),this.adsManager.reset()},reload:function(){this.call("requestAds")},discardAdBreak:function(){this.adsManager.discardAdBreak()},requestAds:function(e){this.adsManager.requestAds(f.extend(this._baseRequestAdsOptions(),e))},contentComplete:function(){this.adsManager.contentComplete()},pause:function(){return this.checkIfAdHasMediaUrl(),this.adsManager.pause()},resume:function(){return this.adsManager.resume()},set_volume:function(e){this._onPlayerEngaged(),this._setVolume(t.clamp(e,0,1),!0)},stop:function(){return this.adsManager.stop()},fullscreen:function(){this.trigger("fullscreen")},toggle_volume:function(){this._onPlayerEngaged()},replay:function(){this._replay()},redirect:function(e){e&&window.open(e,"_blank")},close:function(){return this._hideContentPlayer()},hideCompanionAd:function(){return this._hideCompanionAd()},renderCompanionAd:function(){return this._renderCompanionAd()}},getAdWidth:function(){return this.activeElement()?(this.get("sidebar_active")||this.get("sticky")||this.get("floating"))&&this.parent()?b.elementDimensions(this.parent().__playerContainer).width:(this.activeElement().firstChild?this.activeElement().firstChild:this.activeElement()).clientWidth:null},getAdHeight:function(){return this.activeElement()?(this.get("sticky")||this.get("floating"))&&this.parent()?b.elementDimensions(this.parent().activeElement().firstChild).height:(this.activeElement().firstChild?this.activeElement().firstChild:this.activeElement()).clientHeight:null},getAdContainer:function(){return this._adContainer||(this._adContainer=this.activeElement().querySelector(".ba-ad-container")),this._adContainer},getVideoElement:function(){return this._videoElement||(this._videoElement=this.parent()&&this.parent().activeElement().querySelector("[data-video='video']")),this._videoElement},isImageBlack:function(e,t,i){for(var s=e.getImageData(0,0,t,i).data,n=0;n<s.length;n+=4){var r=s[n],o=s[n+1],a=s[n+2];if(0!==r||0!==o||0!==a)return!1}return!0},checkIfAdHasMediaUrl:function(){this.get("ad")?.data?.mediaUrl},renderVideoFrame:function(e,i,s){const t=document.createElement("video");t.crossOrigin="anonymous",t.src=e,t.muted=!0,t.play(),t.addEventListener("loadeddata",e=>{this.parent()._drawFrame(t,this.get("currenttime"),i,s,(e,t)=>{this.isImageBlack(t,i,s)&&(this.getAdContainer().style.backgroundImage=`url(${e.toDataURL("image/png")})`)})})},captureAdEndCardBackground:function(e,t){var i=this.get("ad");i&&this.generateEndCardImage(i,e,t)},setEndCardBackground:function(e,t){this.shouldShowFirstFrameAsEndcard()&&e&&t&&this.captureAdEndCardBackground(e,t)},generateEndCardImage:function(e,t,i){this._video&&this._canvas&&this._mediaUrl?this.resizeCanvas(t,i):(this._video=document.createElement("video"),this._canvas=document.createElement("canvas"),this._mediaUrl=e?.data?.mediaUrl,this._mediaUrl&&fetch(this._mediaUrl).then(e=>e.blob()).then(e=>(this._video.src=URL.createObjectURL(e),this._video.crossOrigin="anonymous",this._video.muted=!0,this._video.play())).then(()=>{this.parent()._drawFrame(this._video,.8,t,i,(e,t)=>{this._canvas=e,this.set("endcardbackgroundsrc",this._canvas.toDataURL("image/png")),this._video.pause()})})["catch"](e=>console.log("Error: "+e)))},resizeCanvas:function(e,t){this._canvas.width=e,this._canvas.height=t,this._canvas.getContext("2d").drawImage(this._video,0,0,this._canvas.width,this._canvas.height),this.set("endcardbackgroundsrc",this._canvas.toDataURL("image/png"))},shouldShowFirstFrameAsEndcard:function(){var e=this.parent(),t=!e.get("outstreamoptions").noEndCard,i=!e.get("outstreamoptions.allowRepeat"),s=e.get("outstreamoptions.firstframeasendcard");return e&&(t||i)&&s},getClickTroughElement:function(){return this.activeElement().querySelector('[data-selector="ba-ads-clickthrough-container"]')||null},getAdWillAutoPlay:function(){return this.parent()&&(this.parent().get("autoplay-allowed")||this.parent().get("autoplay"))},getAdWillPlayMuted:function(){return this.get("muted")||0===this.get("volume")},_onStart:function(e){var t;this.set("playing",!0),this.set("currenttime",0),this.set("remaining",this.get("duration")),this.set("showactionbuttons",!1),this.set("adscompleted",!1),e&&y.is_function(e.getAd)&&(t=(e=e.getAd()).isLinear(),this.set("linear",t),this.set("hidecontrolbar",!t||this.get("hideadscontrolbar")),t||(this.set("non-linear-min-suggestion",e.getMinSuggestedDuration()),this._minSuggestionCalcualationTimer=this.auto_destroy(new s.Timer({delay:1e3,fire:function(){this.get("non-linear-min-suggestion")<0?this._minSuggestionCalcualationTimer.destroy():this.set("non-linear-min-suggestion",this.get("non-linear-min-suggestion")-1)}.bind(this)}))),!t&&this.get("isoutstream")&&(this.adsManager.reset(),this.adsManager.requestAds(this._baseRequestAdsOptions())),e)&&this._getCompanionAds(e),this.parent().stopAdsRenderFailTimeout(!0),this._setLoadVideoTimeout(),this.get("sidebar_active")&&this.adsManager&&this.parent()},_onAdComplete:function(e){i.isSafari()&&this.getAdContainer().style.backgroundImage&&(this.getAdContainer().style.backgroundImage="none"),this.get("persistentcompanionad")||(this.get("companionads")&&0<this.get("companionads").length&&this.set("companionads",[]),this.get("multicompanionads")&&0<this.get("multicompanionads").length&&f.iter(this.get("multicompanionads"),function(e,t){e.innerHTML="",delete this.get("multicompanionads")[t]},this),this.__companionAdElement&&(this.__companionAdElement.innerHTML=""))},_setLoadVideoTimeout:function(){var e;0<this.get("adsrendertimeout")&&this.get("adsrendertimeout")!==this.get("imaadsrenderingsetting.loadVideoTimeout")&&(e=this.parent())&&e.set("imaadsrenderingsetting",{...e.get("imaadsrenderingsetting"),loadVideoTimeout:e.get("adsrendertimeout")})},_onPlayerEngaged:function(){var e=this.parent();e&&y.is_function(e.setPlayerEngagement)&&e.setPlayerEngagement()},_outstreamCompleted:function(e){if(e=e||this.parent(),y.is_undefined(e.activeElement))throw Error("Wrong dynamics instance was provided to _outstreamCompleted");if(e.get("outstreamoptions")){if(e.get("outstreamoptions.hideOnCompletion"))return void this._hideContentPlayer(e);var t=e.get("outstreamoptions.moredetailslink");if(e.get("outstreamoptions.noEndCard"))return;e.get("outstreamoptions.moreText")&&this.set("moredetailstext",e.get("outstreamoptions.moreText")),this.set("showrepeatbutton",!!e.get("outstreamoptions.allowRepeat")),e.get("outstreamoptions.repeatText")&&this.set("repeatbuttontext",e.get("outstreamoptions.repeatText")),t&&this.set("moredetailslink",t),this.set("hideclosebutton",!!e.get("outstreamoptions.hideclose")),this.set("showlearnmorebutton",!!e.get("outstreamoptions.showlearnmore"))}this.set("showactionbuttons",!0)},_getCompanionAds:function(e){e=e||this.get("ad");var t;return google&&google.ima&&e&&y.is_function(e.getCompanionAds)?((t=new google.ima.CompanionAdSelectionSettings).resourceType=google.ima.CompanionAdSelectionSettings.ResourceType.ALL,t.creativeType=google.ima.CompanionAdSelectionSettings.CreativeType.ALL,t.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE,(t=e.getCompanionAds(0,0,t))&&0<t.length&&this.set("companionads",t),t):[]},_renderCompanionAd:function(e,t){if(!y.is_boolean(t)||Boolean(t)){e=e||this.get("ad"),t=t||this.get("companionad");var i,s,n,r,o,a,c=[];if(y.is_string(t)?(0<t.split("|").length&&(l=t.split("|")[1]||"bottom"),s=(t=t.replace(/\].*/g,"$'").split("["))[0]):l=(this.get("sticky")||this.get("floating"))&&this.get("withsidebar")?null:"bottom",this.__companionAdElement=s?document.getElementById(s):this.__companionAdElement||document.createElement("div"),this.__companionAdElement){if(this.__companionAdElement.innerHTML="",i=this.parent().activeElement(),s=b.elementDimensions(i.firstChild),this.get("companionads")&&this.get("companionads").length<=0){if((h="fluid"===(t=t[1]?t[1].split(","):[0,0])[0])||(m=Number(t&&t[0]&&0<t[0]?t[0]:s.width),g=Number(t&&t[1]&&0<t[1]?t[1]:s.height)),(t=new google.ima.CompanionAdSelectionSettings).resourceType=google.ima.CompanionAdSelectionSettings.ResourceType.ALL,t.creativeType=google.ima.CompanionAdSelectionSettings.CreativeType.ALL,h?(t.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.SELECT_FLUID,c=e.getCompanionAds(0,0,t)):(t.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE,m&&g&&(c=e.getCompanionAds(m,g,t))),"undefined"==typeof c[0])return}else c=this.get("companionads");n=s.width/s.height,f.iter(c,function(e,t){e=e.data,e=e.width/e.height,e=Math.abs(e-n);(0===t||e<a)&&(a=e,o=t),c.length===t+1&&(r=c[o])},this),this.set("companionadcontainer",this.__companionAdElement),this.__companionAdElement.innerHTML=r.getContent(),b.elementAddClass(this.__companionAdElement,this.get("cssplayer")+"-companion-ad-container"+(this.get("mobileviewport")?"-mobile":"-desktop"));var l,d,u,h,m,g,p=(this.get("sticky")||this.get("floating"))&&!this.get("withsidebar");if(p?(l=this.get("mobileviewport")?null:"top",d=this.parent().get("containerSizingStyles"),u={position:"relative"},(h=this.__companionAdElement.querySelector("img"))&&s&&r.data&&(m=r.data.width/r.data.height,g=s.width*(m<=1?m:r.data.height/r.data.width),h.width=s.width,h.height=g,u.bottom=20+g+"px")):this.__companionAdElement.removeAttribute("style"),(this.get("sticky")||this.get("floating"))&&!this.get("mobileviewport")&&p&&(t=this.parent().activeElement().querySelector(".ba-player-content"))&&(i=t),l)switch(l){case"left":this.__companionAdElement.style.display="inline-block",this.__companionAdElement.style["float"]="left",i.insertAdjacentElement("beforebegin",this.__companionAdElement);break;case"top":p&&d&&this.parent()._applyStyles(this.__companionAdElement,u),i.insertAdjacentElement("beforebegin",this.__companionAdElement);break;case"right":this.__companionAdElement.style.display="inline-block",i.style["float"]="left",i.insertAdjacentElement("afterend",this.__companionAdElement);break;default:i.insertAdjacentElement("afterend",this.__companionAdElement)}}}},_hideCompanionAd:function(){this.get("persistentcompanionad")||this.__companionAdElement&&y.is_function(this.__companionAdElement.remove)&&this.__companionAdElement.remove()},_outstreamStarted:function(e,t){this.set("isoutstream",!0),y.is_defined(this.get("outstreamoptions.persistentcompanionad"))&&this.set("persistentcompanionad",this.get("outstreamoptions.persistentcompanionad"))},_replay:function(e){if(e=e||this.parent(),y.is_undefined(e.activeElement))throw Error("Wrong dynamics instance was provided to _reply");this.set("repeat",!0),this.channel("ads").trigger("replayOutstream")},_hideContentPlayer:function(e){if(e=e||this.parent(),y.is_undefined(e.activeElement))throw Error("Wrong dynamics instance was provided to _hideContentPlayer");this._hideCompanionAd(),e.hidePlayerContainer()},_setVolume:function(e,t){(t=t||!1)&&this.parent()&&(this.parent().set("volume",e),this.parent().set("muted",e<=0)),this.set("volume",e),this.set("adsunmuted",0<e)}}}).register("ba-adsplayer").registerFunctions({"linear ? (css + '-overlay') : ''":function(e){return e.linear?e.css+"-overlay":""},"cssadsplayer + (linear ? '-linear-ad-container' : '-non-linear-ad-container')":function(e){return e.cssadsplayer+(e.linear?"-linear-ad-container":"-non-linear-ad-container")},"hideoninactivity ? (cssplayer + '-controlbar-hidden') : ''":function(e){return e.hideoninactivity?e.cssplayer+"-controlbar-hidden":""},"floating ? {} : parentcontainersizingstyles":function(e){return e.floating?{}:e.parentcontainersizingstyles},testid:function(e){return e.testid},"showadchoices && adchoiceslink && adchoicesontop && adsplaying && !floating && !sidebar_active":function(e){return e.showadchoices&&e.adchoiceslink&&e.adchoicesontop&&e.adsplaying&&!e.floating&&!e.sidebar_active},adchoiceslink:function(e){return e.adchoiceslink},cssadsplayer:function(e){return e.cssadsplayer},"showactionbuttons && isoutstream":function(e){return e.showactionbuttons&&e.isoutstream},csscommon:function(e){return e.csscommon},"showlearnmorebutton && moredetailslink":function(e){return e.showlearnmorebutton&&e.moredetailslink},"redirect(moredetailslink)":function(e){return e.redirect(e.moredetailslink)},"moredetailstext ? moredetailstext : string('learn-more')":function(e){return e.moredetailstext||e.string("learn-more")},showrepeatbutton:function(e){return e.showrepeatbutton},"replay()":function(e){return e.replay()},"repeatbuttontext ? repeatbuttontext : string('replay-ad')":function(e){return e.repeatbuttontext||e.string("replay-ad")},"!hideclosebutton":function(e){return!e.hideclosebutton},"string('close-ad')":function(e){return e.string("close-ad")},"close()":function(e){return e.close()},"adsclicktroughurl && customclickthrough":function(e){return e.adsclicktroughurl&&e.customclickthrough},css:function(e){return e.css},"!userhadplayerinteraction && unmuteonclick && linear":function(e){return!e.userhadplayerinteraction&&e.unmuteonclick&&e.linear},"ad_clicked()":function(e){return e.ad_clicked()},dyncontrolbar:function(e){return e.dyncontrolbar},"!hidecontrolbar && linear && !showactionbuttons":function(e){return!e.hidecontrolbar&&e.linear&&!e.showactionbuttons},tmplcontrolbar:function(e){return e.tmplcontrolbar},linear:function(e){return e.linear},duration:function(e){return e.duration},volume:function(e){return e.volume},muted:function(e){return e.muted},remaining:function(e){return e.remaining},unmuteonclick:function(e){return e.unmuteonclick},playing:function(e){return e.playing},skipvisible:function(e){return e.skipvisible},userhadplayerinteraction:function(e){return e.userhadplayerinteraction},currenttime:function(e){return e.currenttime},hideoninactivity:function(e){return e.hideoninactivity},fullscreened:function(e){return e.fullscreened},view_type:function(e){return e.view_type},floating:function(e){return e.floating},adchoicesontop:function(e){return e.adchoicesontop},"string('ad-choices')":function(e){return e.string("ad-choices")},controlbarstyles:function(e){return e.controlbarstyles},showadchoices:function(e){return e.showadchoices},"trigger('fullscreen')":function(e){return e.trigger("fullscreen")},toggle_volume:function(e){return e.toggle_volume}}).attachStringTable(e.strings).addStrings({"replay-ad":"Replay Video","close-ad":"Close","ad-choices":"Ad Choices","learn-more":"Learn More"})}),e.define("module:Ads.Dynamics.ChoicesLink",["dynamics:Dynamic","module:Assets"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'<div class="{{cssadsplayer}}-ad-choices-container">\n    <a href="{{ adchoiceslink }}" title="{{string(\'ad-choices\')}}"\n       ba-click="{{click_action(adchoiceslink)}}" role="button"\n       data-test-selector="{{datatestselector}}"\n       target="_blank"\n       ba-styles="{{ {width: size, height: size} }}"\n    >\n        <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n            <rect width="16" height="16" transform="matrix(1 0 0 -1 0 16)" fill="url(#ba-ad-choice-pattern-sidebar)"/>\n            <defs>\n                <pattern id="ba-ad-choice-pattern-sidebar" patternContentUnits="objectBoundingBox" width="1" height="1">\n                    <use xlink:href="#ba-ad-choices-image" transform="scale(0.00208333)"/>\n                </pattern>\n                <image id="ba-ad-choices-image" width="480" height="480" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAALxUExURQAAAP////n+//L8//r///f9//r+//v///j+//f+//n///f///z///z+//3///L+//n9//j9//r9//j///v+//T8/8v0//j8//7///T7/+v8//f7//P+//39//v4//n8/8jh//b7//f8//X///38/+36//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n///n+//n+//n+//n+//n+//n+//n+//n+//n+//f///n+//n+//n+//n+//n+//n+//n+//n+//n+//r+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//z///n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//r///n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//v///r+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//j+//n+//n+//n+//n+//n+//n+//n+//n+//r+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n///n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+//n+/////yUvWvEAAAD5dFJOUwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGy0cBgdu1uvarGIfY/j92IQoFczefBlD9clLAW3uA4nyV5nADQGgGqEINHeIaC4Dnr5wmsfbuTIUh+jnMdUhAQ8MBZbjeJPi/sJVCo0r6fewBHIk5O+c3OUidhZ5wfZbeiNS+rRGFxBf/PGfARhpzeYlb9F13R3TE9D7xWUma15dv/nhbKlYYQuznfNRq7K4T+w4AQQJfQEqWUVAj1ytSagnkQI+9KRWzhIp8AfEo0FEZ7bIWjBzgowRN067TIqmjteXAzoCm0jqxpjSe4Uz7UKiHgIKuAYAAAABYktHRAH/Ai3eAAAAB3RJTUUH5wQaECAXB8CStAAABJdJREFUWMPNl3lcFFUcwPf9WmbGbd0W14ruGwHlXpLLSAXUNZIARSBBk9gthaIgUfLMLERUPFBTC0NJ7AAji0IrjG47LCuzsuywy+5z/uu92Z15Mzs7O7v7j/3+e/N5v++83/F+v98zGP4fgkCQM4woZP2wyBFR0QAMhIRgIGbkqNi4+ITEMHyOEBAsl5TMY7GnXD0aYAgTvAWpabxH0jMygz8EgjHX8JJkXTs2WAKCcbxMxo/MBlNQACPkyAF87oQgAcyZExUAfpIDEDIPtZwVoCUw+TolIC4PRDEHAuAmX68ExE+Bsfk3FBQWTQ0sIgw7zaNZPG56SWnZjTOgvGImXs4quckK4fr5Pczm8cHsSoCbqyKd4LrFQ7x1TjkAN1wHwYTPdW8vOZs9hyGWV1aL1tTcdnst/sD6D6P1DvfuDI/BcGcddUj9XWPm6biC5Tx50CAC5i+Q+7Tx7hkWv/fUzBV4AaIWKsOyqGIxwLkmpAdYIgLy4ngvSZm+FNvB6ACWKQGx9yynBHvpvU6MiPALWKEEzL7v/uImikhe2ezy7U0twKhV0LK6dA1FrG3NXwcmNUITsB7/MHXDxhqKaMvZZAXkjdACpGQCcx5A5uYtMkTcA7hknc+gQABbtwEuNjg1Ixu2U0RNWsKDABb5KbQA1YvBQOqVCSCq4SG7hGjf8fBSxU3XArR1gLBEnA0gb2dWu4RYk7UL35Ch2oDIMjmAIPApUjsfoYjdrXk0omqAO5W7KkE6JTJGALTsmUW9+WgVgCZgfQpZbimnAIwwWQEeW0vNeFzKbDXgiUnCP+bJAUILje6mR+ixaZ6AgZ3Y2r1PwgXegOxeCigAP4Dawqf2JbiU7WE4Dt3Tz0j6dX1woRaAjAvPPqe4OIjFy/4kWmjs+w9IV1PtA7jo+RdedMhKIcth+wd6kyX9poNOyQIVAMHFL3XVLB9MFLdEkL+//EojtX/B5n5ZbVADXk0ny9deB9GgqW8MvknVcw/lXyKvLWrAW0Liv/0OBiDmUoB351Ln8Yd7m99TFhY1oLmeLN93gGB85px0qt545IMY70ahBjhb8RHqNwjt1bE6TVbWuj90qfuMGgAtH+3r3kX+5Go+upuWgo+POX21KVUYzXjXFDz0wWWf9ByWFaNPV+FvRoNBF4A9R/IGEj+TdaiZxzcBXO6zVasBBqL/eeF2qr730BfrNDukz1SOOVFMC3rTl18Rh1gMvoUN/9q9bz+HBHUGDvR9I0ucjQlVfqcdo/Wke2MF2WTEe+cfl/X3rctw9eIYP/3daPUMGD2IseDEqU36lqrXHcTTL+t/UrLavnNvLm3Bf//+h14a+dwjfT/qD1pgOyXe0REdJ6bF0rw7+lN0IHMac8UpUeXnNnrl7b8cc/hOHG8ZZvuVV8tve1LJgKavTvx+UqW+8PdtOO+YwGZdM2R4qXfldFh9DQIagqDTLlev/mM0CkKdAP78i6qPn1g0JMjHF4LalaJ6ffyA3ljpQzj4e5Gg3r5jQn9gkfMOw5UD/5TFlg12lpM7F8K7D6tl/1tEXp5hob08DSZOKKBXhfr2PZ3yH3LVRJc70d2PAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTA0LTI2VDE2OjMyOjA3KzAwOjAwPnuJagAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wNC0yNlQxNjozMjowNyswMDowME8mMdYAAAAodEVYdGRhdGU6dGltZXN0YW1wADIwMjMtMDQtMjZUMTY6MzI6MjMrMDA6MDCuWTNnAAAAAElFTkSuQmCC"/>\n            </defs>\n        </svg>\n    </a>\n</div>\n',attrs:{css:"ba-videoplayer",cssadsplayer:"ba-adsplayer",datatestselector:"ba-ads-choices-link",size:"16px"},functions:{click_action:function(e){this.trigger("click_action",e)}}}}).register("ba-ads-choices-link").registerFunctions({cssadsplayer:function(e){return e.cssadsplayer},adchoiceslink:function(e){return e.adchoiceslink},"string('ad-choices')":function(e){return e.string("ad-choices")},"click_action(adchoiceslink)":function(e){return e.click_action(e.adchoiceslink)},datatestselector:function(e){return e.datatestselector},"{width: size, height: size}":function(e){return{width:e.size,height:e.size}}}).attachStringTable(t.strings).addStrings({"ad-choices":"Ad Choices"})}),e.define("module:Ads.Dynamics.Controlbar",["dynamics:Dynamic","base:Maths","base:TimeFormat","module:Assets"],function(e,o,t,i,s){return e.extend({scoped:s},function(e){return{template:'<div class="{{!linear ? (cssadsplayer + \'-non-linear-controlbar\') : \'\'}}"\n     xmlns:ba-hotkey="http://www.w3.org/1999/xhtml"\n     ba-styles="{{controlbarstyles}}"\n>\n    <div ba-show="{{skippable}}" class="{{cssadsplayer}}-skipbutton-container"\n         ba-click="{{skip_linear_ad()}}"\n         data-testid="{{testid}}-ads-controlbar-ads-skip-button"\n    >\n        <p class="{{cssadsplayer}}-skipbutton">\n            {{lefttillskip > 0 ? string(\'can-skip-after\').replace(\'%d\', lefttillskip) : string(\'skip-ad\') }}\n        </p>\n    </div>\n\n    <div ba-if="{{showbanner && media}}" class="{{cssadsplayer}}-media-container"\n         data-ads="banner-container"\n         data-testid="{{testid}}-ads-controlbar-banner-container"\n    >\n        \n        \n        <span class="{{cssadsplayer}}-banner-close-button"\n              ba-click="{{skip_non_linear_ad()}}"\n        >\n            <i class="{{csscommon}}-icon-cancel"></i>\n        </span>\n    </div>\n\n    <div ba-if="{{customcontroller && !media}}" class="{{css}}-overlay {{cssadsplayer}}-ad-click-tracker\n        {{clickthroughurl && controlbarisvisible ? csscommon + \'-clickable\' : \'\'}}"\n         ba-click="{{ad_clicked()}}"\n         data-testid="{{testid}}-ads-clickable-container"\n    ></div>\n\n    <div ba-if="{{!hideoninactivity && linear}}"\n         class="{{cssadsplayer}}-controlbar{{passactivitydelta && linear ? \'-hidden\' : \'\'}} {{controlbarisvisible ? \'\' : (cssplayer + \'-dashboard-hidden\')}}"\n    >\n        <div class="{{cssadsplayer}}-progressbar-inside-controller">\n            <div class="{{cssadsplayer}}-progressbar-played"\n                 ba-styles="{{{width: Math.round(duration ? currenttime / duration * 100 : 0) + \'%\'}}}"\n            ></div>\n        </div>\n        <div tabindex="1" ba-hotkey:space^enter="{{toggle_player()}}"\n             onmouseout="this.blur()" class="{{css}}-leftbutton-container"\n             autofocus\n        >\n            <div ba-if="{{!playing}}" class="{{css}}-button-inner"\n                 ba-on:touchend="{{resume()}}"\n                 ba-click="{{resume()}}" title="{{string(\'play-ad\')}}"\n                 data-testid="{{testid}}-ads-controlbar-play-button"\n            >\n                <i class="{{csscommon}}-icon-play"></i>\n            </div>\n            <div ba-if="{{playing}}" class="{{css}}-button-inner" ba-click="{{pause()}}"\n                 ba-on:touchend="{{pause()}}"\n                 title="{{disablepause ? string(\'pause-video-disabled\') : string(\'pause-video\')}}"\n                 data-testid="{{testid}}-ads-controlbar-pause-button"\n            >\n                <i class="{{csscommon}}-icon-pause"></i>\n            </div>\n        </div>\n\n        <div class="{{cssadsplayer}}-time-container">\n            <div class="{{cssadsplayer}}-time-value" title="{{string(\'elapsed-time\')}}"\n                 data-testid="{{testid}}-ads-controlbar-timer"\n            >\n                {{formatTime(remaining)}} / {{formatTime(duration)}}\n            </div>\n        </div>\n\n        <div tabindex="4" ba-if="{{supportsfullscreen}}"\n             title="{{ fullscreened ? string(\'exit-fullscreen-video\') : string(\'fullscreen-video\') }}"\n             ba-hotkey:space^enter="{{toggle_fullscreen()}}" onmouseout="this.blur()"\n             ba-on:touchend="{{toggle_fullscreen()}}"\n             class="{{css}}-rightbutton-container" ba-click="{{toggle_fullscreen()}}"\n             data-testid="{{testid}}-ads-controlbar-fullscreen-button"\n        >\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-resize-{{fullscreened ? \'small\' : \'full\'}}"></i>\n            </div>\n        </div>\n\n        <div tabindex="3" class="{{cssadsplayer}}-volumebar"\n             ba-hotkey:right="{{set_volume(volume + 0.1)}}" ba-hotkey:left="{{set_volume(volume - 0.1)}}"\n             ba-hotkey:up="{{set_volume(1)}}" ba-hotkey:down="{{set_volume(0)}}"\n             data-testid="{{testid}}-ads-controlbar-volumebar"\n        >\n            <div data-selector="button-volume-bar"\n                 class="{{cssadsplayer}}-volumebar-inner"\n                 onmousedown="{{startUpdateVolume(domEvent, currElement)}}"\n                 ontouchstart="{{startUpdateVolume(domEvent, currElement)}}"\n                 data-testid="{{testid}}-ads-controlbar-volume-progressbar"\n            >\n                <div class="{{cssadsplayer}}-volumebar-position"\n                     ba-styles="{{{width: Math.min(100, Math.round(volume * 100)) + \'%\'}}}"\n                >\n                    <div class="{{cssadsplayer}}-volumebar-button"\n                         title="{{string(\'volume-button\')}}"\n                    ></div>\n                </div>\n            </div>\n        </div>\n\n        <div tabindex="2" class="{{cssadsplayer}}-rightbutton-container"\n             ba-click="{{toggle_volume()}}"\n             ba-hotkey:space^enter="{{toggle_volume()}}"\n             ba-on:touchend="{{toggle_volume()}}"\n             title="{{string(volume > 0 ? \'volume-mute\' : \'volume-unmute\')}}"\n             data-testid="{{testid}}-ads-controlbar-volume-{{volume > 0 ? \'mute\' : \'unmute\'}}"\n        >\n            <div class="{{cssadsplayer}}-button-inner">\n                <i class="{{csscommon + \'-icon-volume-\' + (volume >= 0.5 ? \'up\' : (volume > 0 ? \'down\' : \'off\')) }}"></i>\n            </div>\n        </div>\n    </div>\n    <div ba-if="{{hideoninactivity && linear}}" class="{{cssadsplayer}}-progressbar-container">\n        <div class="{{cssadsplayer}}-progressbar">\n            <div class="{{cssadsplayer}}-progressbar-played"\n                 ba-styles="{{{width: Math.round(duration ? currenttime / duration * 100 : 0) + \'%\'}}}"\n                 data-testid="{{testid}}-ads-controlbar-progressbar-played"\n            ></div>\n        </div>\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",showcontrolbar:!0,showbanner:!1,media:null,playing:!1,disablepause:!1,title:null,pausedonclick:!1,clickthroughurl:null,fullscreened:!1,hidebarafter:5e3,controlbarisvisible:!0,skippable:!1,skipoffset:-1},channels:{"ads:adProgress":function(e){this.set("currenttime",e.getAdData().currentTime),this.set("remaining",this.get("duration")-e.getAdData().currentTime)}},create:function(){!this.get("remaining")&&this.get("duration")&&this.set("remaining",this.get("duration"))},functions:{formatTime:function(e){return t.format(t.ELAPSED_MINUTES_SECONDS,1e3*Math.round(e))},ad_clicked:function(){this.parent().call("ad_clicked")},startUpdateVolume:function(e,t){var e=e[0],i="mousedown"===e.type?"mousemove":"touchmove",s="mousedown"===e.type?"mouseup":"touchend",n=t.getBoundingClientRect(),r=(e.preventDefault(),function(e){var t;e.preventDefault(),e=n.width>n.height?(!(t=e.clientX)&&e.touches&&(t=e.touches[0].clientX),o.clamp((t-n.x)/n.width,0,1)):(!(t=e.clientY)&&e.touches&&(t=e.touches[0].clientY),o.clamp((n.bottom-t)/n.height,0,1)),this.trigger("volume",e)}.bind(this));r(e),document.addEventListener(i,r),document.addEventListener(s,function(){document.removeEventListener(i,r)},{once:!0})},resume:function(){this.trigger("resume")},toggle_player:function(){this.get("playing")?this.trigger("pause"):this.trigger("play")},pause:function(){this.trigger("pause")},set_volume:function(e){this.trigger("volume",e)},toggle_volume:function(){this.trigger("toggle_volume");var e=0<(e=this.get("volume"))?(this.__oldVolume=e,0):this.__oldVolume||1;this.trigger("volume",e)},skip_linear_ad:function(){this.trigger("stop")},toggle_fullscreen:function(){this.trigger("fullscreen")}}}}).register("ba-ads-controlbar").registerFunctions({"!linear ? (cssadsplayer + '-non-linear-controlbar') : ''":function(e){return e.linear?"":e.cssadsplayer+"-non-linear-controlbar"},controlbarstyles:function(e){return e.controlbarstyles},skippable:function(e){return e.skippable},cssadsplayer:function(e){return e.cssadsplayer},"skip_linear_ad()":function(e){return e.skip_linear_ad()},testid:function(e){return e.testid},"lefttillskip > 0 ? string('can-skip-after').replace('%d', lefttillskip) : string('skip-ad')":function(e){return 0<e.lefttillskip?e.string("can-skip-after").replace("%d",e.lefttillskip):e.string("skip-ad")},"showbanner && media":function(e){return e.showbanner&&e.media},"skip_non_linear_ad()":function(e){return e.skip_non_linear_ad()},csscommon:function(e){return e.csscommon},"customcontroller && !media":function(e){return e.customcontroller&&!e.media},css:function(e){return e.css},"clickthroughurl && controlbarisvisible ? csscommon + '-clickable' : ''":function(e){return e.clickthroughurl&&e.controlbarisvisible?e.csscommon+"-clickable":""},"ad_clicked()":function(e){return e.ad_clicked()},"!hideoninactivity && linear":function(e){return!e.hideoninactivity&&e.linear},"passactivitydelta && linear ? '-hidden' : ''":function(e){return e.passactivitydelta&&e.linear?"-hidden":""},"controlbarisvisible ? '' : (cssplayer + '-dashboard-hidden')":function(e){return e.controlbarisvisible?"":e.cssplayer+"-dashboard-hidden"},"{width: Math.round(duration ? currenttime / duration * 100 : 0) + '%'}":function(e){return{width:Math.round(e.duration?e.currenttime/e.duration*100:0)+"%"}},"toggle_player()":function(e){return e.toggle_player()},"!playing":function(e){return!e.playing},"resume()":function(e){return e.resume()},"string('play-ad')":function(e){return e.string("play-ad")},playing:function(e){return e.playing},"pause()":function(e){return e.pause()},"disablepause ? string('pause-video-disabled') : string('pause-video')":function(e){return e.disablepause?e.string("pause-video-disabled"):e.string("pause-video")},"string('elapsed-time')":function(e){return e.string("elapsed-time")},"formatTime(remaining)":function(e){return e.formatTime(e.remaining)},"formatTime(duration)":function(e){return e.formatTime(e.duration)},supportsfullscreen:function(e){return e.supportsfullscreen},"fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')":function(e){return e.fullscreened?e.string("exit-fullscreen-video"):e.string("fullscreen-video")},"toggle_fullscreen()":function(e){return e.toggle_fullscreen()},"fullscreened ? 'small' : 'full'":function(e){return e.fullscreened?"small":"full"},"set_volume(volume + 0.1)":function(e){return e.set_volume(e.volume+.1)},"set_volume(volume - 0.1)":function(e){return e.set_volume(e.volume-.1)},"set_volume(1)":function(e){return e.set_volume(1)},"set_volume(0)":function(e){return e.set_volume(0)},"startUpdateVolume(domEvent, currElement)":function(e){return e.startUpdateVolume(e.domEvent,e.currElement)},"{width: Math.min(100, Math.round(volume * 100)) + '%'}":function(e){return{width:Math.min(100,Math.round(100*e.volume))+"%"}},"string('volume-button')":function(e){return e.string("volume-button")},"toggle_volume()":function(e){return e.toggle_volume()},"string(volume > 0 ? 'volume-mute' : 'volume-unmute')":function(e){return e.string(0<e.volume?"volume-mute":"volume-unmute")},"volume > 0 ? 'mute' : 'unmute'":function(e){return 0<e.volume?"mute":"unmute"},"csscommon + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))":function(e){return e.csscommon+"-icon-volume-"+(.5<=e.volume?"up":0<e.volume?"down":"off")},"hideoninactivity && linear":function(e){return e.hideoninactivity&&e.linear}}).attachStringTable(i.strings).addStrings({"skip-ad":"Skip ad","play-ad":"Play","pause-video":"Pause","volume-mute":"Mute sound","volume-button":"Set volume","elapsed-time":"Elapsed time","volume-unmute":"Unmute sound","can-skip-after":"Skip after %d","fullscreen-video":"Enter fullscreen","exit-fullscreen-video":"Exit fullscreen","ad-will-end-after":"Ad will end after %s","pause-video-disabled":"Pause not supported"})}),e.define("module:Ads.Dynamics.LearnMoreButton",["dynamics:Dynamic","module:Assets"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'<div ba-if="{{moredetailslink}}" class="{{cssadsplayer}}-action-button-container">\n    <a\n        href="{{ moredetailslink }}" target="_blank"\n        class="{{cssadsplayer}}-action-button {{cssprefix ? cssprefix + \'-action-button\' : \'\'}}"\n        title="{{ buttontitletext || buttontext || string(\'learn-more\')}}"\n        data-test-selector="{{datatestselector}}"\n        ba-click="{{click_action(moredetailslink)}}"\n    >\n        {{buttontext || string(\'learn-more\')}}\n    </a>\n</div>\n',attrs:{css:"ba-videoplayer",cssadsplayer:"ba-adsplayer",cssprefix:null,buttontext:null,buttontitletext:null,datatestselector:"ba-ads-learn-more-link"},object_functions:["pause_ads"],functions:{click_action:function(e){this.trigger("click_action",e)}}}}).register("ba-ads-learn-more-button").registerFunctions({moredetailslink:function(e){return e.moredetailslink},cssadsplayer:function(e){return e.cssadsplayer},"cssprefix ? cssprefix + '-action-button' : ''":function(e){return e.cssprefix?e.cssprefix+"-action-button":""},"buttontitletext || buttontext || string('learn-more')":function(e){return e.buttontitletext||e.buttontext||e.string("learn-more")},datatestselector:function(e){return e.datatestselector},"click_action(moredetailslink)":function(e){return e.click_action(e.moredetailslink)},"buttontext || string('learn-more')":function(e){return e.buttontext||e.string("learn-more")}}).attachStringTable(t.strings).addStrings({"learn-more":"Learn More"})}),e.define("module:VideoPlayer.Dynamics.Controlbar",["dynamics:Dynamic","base:TimeFormat","base:Comparators","base:Maths","base:Objs","browser:Dom","module:Assets","browser:Info","media:Player.Support","base:Async","base:Timers.Timer","browser:Events"],["dynamics:Partials.StylesPartial","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.ClickPartial","dynamics:Partials.RepeatElementPartial"],function(e,t,s,o,i,n,r,a,c,l,d,u,h){return e.extend({scoped:h},function(e){return{template:'<div class="{{cssplayer}}-dashboard {{((prominent_title_closed || title_hide_class) && controlbar_hide_class) ? cssplayer + \'-dashboard-hidden\' : \'\'}}">\n    <div tabindex="{{skipinitial ? 2 : 1}}" data-selector="progress-bar-inner"\n         class="{{css}}-progressbar {{controlbar_hide_class}} {{activitydelta < 2500 || ismobile ? \'\' : (css + \'-progressbar-small\')}} {{disableseeking ? cssplayer + \'-disabled\' : \'\'}}"\n         ba-hotkey:right="{{seek(position + skipseconds)}}"\n         ba-hotkey:left="{{seek(position - skipseconds)}}"\n         ba-hotkey:alt+right="{{seek(position + skipseconds * 3)}}"\n         ba-hotkey:alt+left="{{seek(position - skipseconds * 3)}}"\n         onmouseout="this.blur()"\n         ontouchstart="{{startUpdatePosition(domEvent)}}"\n         onmousedown="{{startUpdatePosition(domEvent)}}"\n         data-testid="{{testid}}-progress-bar-inner"\n    >\n        <div class="{{css}}-progressbar-chapters" ba-show="{{true}}">\n            <div class="{{css}}-chapters-list-container"\n                ba-repeat="{{chapter :: chapterslist}}"\n            >\n                <div\n                    class="{{css}}-chapters-list-item"\n                    data-selector="chapter-index-{{chapter.index}}"\n                    ba-styles="{{{left: Math.round(duration ? chapter.startTime / duration * 100 : 0) + \'%\'}}}"\n                    onmouseenter="{{showChapterText(chapter)}}"\n                    onmouseleave="{{hideChapterText()}}"\n                >\n                    <div class="{{css}}-chapters-item-text" ba-show="{{visibleindex === chapter.index && showchaptertext}}">\n                        {{chapter.title}}\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="{{css}}-progressbar-cache" ba-styles="{{{width: Math.round(duration ? cached / duration * 100 : 0) + \'%\'}}}"></div>\n        <div class="{{css}}-progressbar-position" ba-styles="{{{width: Math.round(duration ? position / duration * 100 : 0) + \'%\'}}}" title="{{string(\'video-progress\')}}">\n            <div class="{{css}}-progressbar-button"></div>\n        </div>\n        <div class="{{css}}-progressbar-marker"\n             data-selector="trim-start-marker"\n             ba-if="{{trimmingmode}}"\n             ba-styles="{{{left: Math.round(duration && trimstart ? trimstart / duration * 100 : 0) + \'%\'}}}"\n        ></div>\n        <div class="{{css}}-progressbar-marker"\n             data-selector="trim-end-marker"\n             ba-if="{{trimmingmode}}"\n             ba-styles="{{{left: \'auto\', right: 100 - Math.round(duration && trimend ? trimend / duration * 100 : 100) + \'%\'}}}"\n        ></div>\n    </div>\n\n    <div class="{{css}}-backbar"></div>\n\n    <div class="{{css}}-controlbar">\n\n        <div tabindex="0" data-selector="submit-video-button"\n             ba-hotkey:space^enter="{{submit()}}" onmouseout="this.blur()"\n             class="{{css}}-leftbutton-container {{controlbar_hide_class}}"\n             ba-if="{{submittable}}" ba-click="{{submit()}}"\n        >\n            <div class="{{css}}-button-inner">\n                {{string(\'submit-video\')}}\n            </div>\n        </div>\n\n        <div tabindex="0" data-selector="button-icon-ccw"\n             ba-hotkey:space^enter="{{rerecord()}}" onmouseout="this.blur()"\n             class="{{css}}-leftbutton-container {{controlbar_hide_class}}" ba-if="{{rerecordable}}"\n             ba-click="{{rerecord()}}" title="{{string(\'rerecord-video\')}}"\n        >\n            <div class="{{css}}-button-inner {{controlbar_hide_class}}">\n                <i class="{{csscommon}}-icon-ccw"></i>\n            </div>\n        </div>\n\n        <div tabindex="{{skipinitial ? 0 : 2}}" data-selector="button-icon-play"\n             ba-hotkey:space^enter="{{toggle_player()}}" onmouseout="this.blur()"\n             class="{{css}}-leftbutton-container {{controlbar_hide_class}}" title="{{string(\'play-video\')}}"\n             onkeydown="{{tab_index_move(domEvent, null, \'button-icon-pause\')}}" ba-if="{{!playing}}"\n             ba-click="{{play()}}" ba-on:touchend="{{play()}}"\n             data-testid="{{testid}}-content-play-button"\n        >\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-play"></i>\n            </div>\n        </div>\n\n        <div tabindex="{{skipinitial ? 0 : 2}}" data-selector="button-icon-pause"\n             ba-hotkey:space^enter="{{toggle_player()}}" onmouseout="this.blur()"\n             class="{{css}}-leftbutton-container {{disablepause ? cssplayer + \'-disabled\' : \'\'}} {{controlbar_hide_class}}"\n             onkeydown="{{tab_index_move(domEvent, null, \'button-icon-play\')}}" ba-if="{{playing}}"\n             ba-click="{{pause()}}" ba-on:touchend="{{pause()}}"\n             title="{{disablepause ? string(\'pause-video-disabled\') : string(\'pause-video\')}}"\n             data-testid="{{testid}}-content-pause-button"\n        >\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-pause"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-time-container {{csscommon}}-clickable {{controlbar_hide_class}}"\n             ba-click="{{toggle_position_info()}}"\n             data-testid="{{testid}}-timer-container"\n        >\n            <div class="{{css}}-time-value"\n                 title="{{revertposition ? string(\'remaining-time\') : string(\'elapsed-time\')}}"\n            >\n                {{(revertposition && duration > 0) ? "-" : ""}}\n                {{(revertposition && duration > 0) ? (formatTime(duration - position)) : formatTime(position)}}\n            </div>\n            <div class="{{css}}-time-sep">/</div>\n            <div class="{{css}}-time-value {{css}}-time-total-duration" title="{{string(\'total-time\')}}">{{formatTime(duration || position)}}</div>\n        </div>\n\n        <div data-selector="video-title-block" class="{{css}}-title-container {{title_hide_class}}" ba-if="{{title && !prominent_title_closed}}">\n            <p class="{{css}}-title" data-testid="{{testid}}-player-title">\n                <span ba-if="{{closeable_title}}" ba-click="{{prominent_title_closed=true}}">&#10006;</span>\n                {{title}}\n            </p>\n        </div>\n\n        <div tabindex="12" class="{{css}}-rightbutton-container {{controlbar_hide_class}}" ba-if="{{frameselectionmode}}">\n            <div data-selector="select-frame-button"\n                 onmouseout="this.blur()"\n                 ba-click="{{select_frame()}}"\n                 class="{{css}}-primary-button">\n                 {{string(\'select-frame\')}}\n            </div>\n        </div>\n\n        <div tabindex="12" class="{{css}}-rightbutton-container {{controlbar_hide_class}}" ba-if="{{trimmingmode}}">\n            <div data-selector="trim-video-button"\n                 onmouseout="this.blur()"\n                 ba-click="{{trim()}}"\n                 class="{{css}}-primary-button">\n                 {{string(\'trim-video\')}}\n            </div>\n        </div>\n\n        <div tabindex="11" data-selector="button-icon-settings"\n             ba-hotkey:space^enter="{{toggle_settings_menu()}}" onmouseout="this.blur()"\n             class="{{css}}-rightbutton-container {{cssplayer}}-button-{{settingsmenuactive ? \'active\' : \'inactive\'}} {{controlbar_hide_class}}"\n             onkeydown="{{tab_index_move(domEvent)}}"\n             ba-on:touchend="{{toggle_settings_menu()}}"\n             ba-if="{{settingsmenubutton}}" ba-click="{{toggle_settings_menu()}}"\n             title="{{string(\'settings\')}}"\n             data-testid="{{testid}}-player-settings-button"\n        >\n            <div class="{{css}}-button-inner {{css}}-settings-button">\n                <i class="{{csscommon}}-icon-cog"></i>\n            </div>\n        </div>\n\n        <div tabindex="10" data-selector="cc-button-container"\n             ba-hotkey:space^enter="{{toggle_tracks()}}" onmouseout="this.blur()"\n             ba-if="{{(tracktags.length > 0 && showsubtitlebutton) || allowtexttrackupload}}"\n             class="{{css}}-rightbutton-container {{cssplayer}}-button-{{tracktextvisible ? \'active\' : \'inactive\'}} {{controlbar_hide_class}}"\n             title="{{ tracktextvisible ? string(\'close-tracks\') : string(\'show-tracks\')}}"\n             ba-click="{{toggle_tracks()}}"\n             onmouseover="{{hover_cc(true)}}"\n             onmouseleave="{{hover_cc(false)}}"\n             data-testid="{{testid}}-player-cc-button"\n        >\n            <div class="{{css}}-button-inner {{controlbar_hide_class}}">\n                <i class="{{csscommon}}-icon-subtitle"></i>\n            </div>\n        </div>\n\n        <div tabindex=9 data-selector="button-icon-resize-full" ba-if="{{fullscreen}}"\n             ba-hotkey:space^enter="{{toggle_fullscreen()}}" onmouseout="this.blur()"\n             class="{{css}}-rightbutton-container {{controlbar_hide_class}}"\n             onkeydown="{{tab_index_move(domEvent)}}"\n             ba-click="{{toggle_fullscreen()}}" ba-on:touchend="{{toggle_fullscreen()}}"\n             title="{{ fullscreened ? string(\'exit-fullscreen-video\') : string(\'fullscreen-video\') }}">\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-resize-{{fullscreened ? \'small\' : \'full\'}}"></i>\n            </div>\n        </div>\n\n        <div tabindex="7" data-selector="button-airplay"\n             ba-hotkey:space^enter="{{show_airplay_devices()}}" onmouseout="this.blur()"\n             class="{{css}}-rightbutton-container {{controlbar_hide_class}}"\n             ba-show="{{airplaybuttonvisible}}" ba-click="{{show_airplay_devices()}}">\n            <div class="{{css}}-airplay-container">\n                <svg width="16px" height="11px" viewBox="0 0 16 11" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                    \n                    <title>{{string(\'airplay\')}}</title>\n                    <desc>{{string(\'airplay-icon\')}}</desc>\n                    <defs></defs>\n                    <g stroke="none" stroke-width="1" fill-rule="evenodd" sketch:type="MSPage">\n                        <path d="M4,11 L12,11 L8,7 L4,11 Z M14.5454545,0 L1.45454545,0 C0.654545455,0 0,0.5625 0,1.25 L0,8.75 C0,9.4375 0.654545455,10 1.45454545,10 L4.36363636,10 L4.36363636,8.75 L1.45454545,8.75 L1.45454545,1.25 L14.5454545,1.25 L14.5454545,8.75 L11.6363636,8.75 L11.6363636,10 L14.5454545,10 C15.3454545,10 16,9.4375 16,8.75 L16,1.25 C16,0.5625 15.3454545,0 14.5454545,0 L14.5454545,0 Z" sketch:type="MSShapeGroup"></path>\n                    </g>\n                </svg>\n            </div>\n        </div>\n\n        <div data-selector="button-chromecast" class="{{css}}-rightbutton-container {{css}}-cast-button-container {{controlbar_hide_class}}" ba-show="{{castbuttonvisble}}">\n            <button tabindex="0" class="{{css}}-gcast-button" is="google-cast-button"></button>\n        </div>\n\n        <div tabindex="6" data-selector="button-stream-label"\n             ba-hotkey:space^enter="{{toggle_stream()}}" onmouseout="this.blur()"\n             class="{{css}}-rightbutton-container {{controlbar_hide_class}}"\n             ba-if="{{streams.length > 1 && currentstream}}" ba-click="{{toggle_stream()}}"\n             title="{{string(\'change-resolution\')}}"\n        >\n            <div class="{{css}}-button-inner {{controlbar_hide_class}}">\n                <span class="{{css}}-button-text">{{currentstream_label}}</span>\n            </div>\n        </div>\n\n        <div class="{{css}}-volumebar {{controlbar_hide_class}}" ba-show="{{!hidevolumebar}}">\n            <div tabindex="5" data-selector="button-volume-bar"\n                 ba-hotkey:right="{{set_volume(volume + 0.1)}}" ba-hotkey:left="{{set_volume(volume - 0.1)}}"\n                 ba-hotkey:up="{{set_volume(1)}}" ba-hotkey:down="{{set_volume(0)}}"\n                 onmouseout="this.blur()"\n                 class="{{css}}-volumebar-inner"\n                 ontouchstart="{{startUpdateVolume(domEvent, currElement)}}"\n                 onmousedown="{{startUpdateVolume(domEvent, currElement)}}"\n            >\n                <div class="{{css}}-volumebar-position" ba-styles="{{{width: Math.min(100, Math.round(volume * 100)) + \'%\'}}}">\n                    <div class="{{css}}-volumebar-button" title="{{string(\'volume-button\')}}"></div>\n                </div>\n            </div>\n        </div>\n\n        <div tabindex="4" data-selector="button-icon-volume"\n             ba-hotkey:space^enter="{{toggle_volume()}}" onmouseout="this.blur()"\n             class="{{css}}-rightbutton-container {{controlbar_hide_class}}"\n             ba-on:touchend="{{toggle_volume()}}"\n             ba-click="{{toggle_volume()}}" title="{{string(volume > 0 ? \'volume-mute\' : \'volume-unmute\')}}"\n             data-testid="{{testid}}-volume-{{volume > 0 ? \'mute\' : \'unmute\'}}-button"\n        >\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon + \'-icon-volume-\' + (volume >= 0.5 ? \'up\' : (volume > 0 ? \'down\' : \'off\')) }}"></i>\n            </div>\n        </div>\n\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",duration:0,position:0,cached:0,volume:1,expandedprogress:!0,playing:!1,rerecordable:!1,submittable:!1,manuallypaused:!1,streams:[],currentstream:null,fullscreen:!0,fullscreened:!1,activitydelta:0,hidebarafter:5e3,preventinteraction:!1,revertposition:!1,title:"",settingsmenubutton:!1,hoveredblock:!1,allowtexttrackupload:!1,thumbisvisible:!1,chapterslist:[],showchaptertext:!0,visibleindex:-1,title_hide_class:"",controlbar_hide_class:""},computed:{"currentstream_label:currentstream":function(){var e=this.get("currentstream");return e?e.label||c.resolutionToLabel(e.width,e.height):""}},events:{"change:activitydelta":function(e){!this.get("prominent_title")&&e>this.get("hidebarafter")&&this.get("hideoninactivity")?this.set("title_hide_class",this.get("cssplayer")+"-dashboard-hidden"):this.set("title_hide_class",""),e>this.get("hidebarafter")&&this.get("hideoninactivity")?this.set("controlbar_hide_class",this.get("cssplayer")+"-dashboard-hidden"):this.set("controlbar_hide_class","")}},functions:{formatTime:function(e){return e=Math.max(e||0,.1),t.format(t.ELAPSED_MINUTES_SECONDS,1e3*e)},startUpdatePosition:function(e){var t,i;this.get("disableseeking")||(e[0]&&-1===e[0].type.indexOf("touch")&&e[0].preventDefault(),this.__parent.get("playing")||!this.__parent.player||this.get("manuallypaused")||this.__parent.player.play(),t=e[0].currentTarget,this.set("dimensions",t.getBoundingClientRect()),this.set("isseeking",!0),this.call("progressUpdatePosition",e[0]),(i=this.get("events")).on(document,"mousemove touchmove",function(e){-1===e.type.indexOf("touch")&&e.preventDefault(),this.call("progressUpdatePosition",e)},this),i.on(document,"mouseup touchend",function(e){-1===e.type.indexOf("touch")&&e.preventDefault(),this.call("stopUpdatePosition"),i.off(document,"mouseup touchend mousemove touchmove")},this))},progressUpdatePosition:function(e){var t=this.__parent,i=0===e.clientX?0:e.clientX||e.targetTouches[0].clientX,e=this.get("dimensions"),s=-1,s=i<e.left?0:i>e.left+e.width?1:(i-e.left)/(e.width||1),n=this.get("duration")*s;if(this.get("isseeking")||"undefined"!=typeof t.__trackTags){e=t.player;if("undefined"!=typeof t.__trackTags&&this.__parent.__trackTags.hasThumbs){if(-1<this.get("visibleindex")&&this.get("showchaptertext"))return;var r=t.__trackTags,o=t.get("thumbcuelist").length;if(0<n){for(var a,c=(a=Math.floor(o*s))-2;c<o;c++)if(t.get("thumbcuelist")[c]){var l=t.get("thumbcuelist")[c];if(l.startTime<n&&l.endTime>n){r.showDurationThumb(c,i,n);break}}}else a=Math.floor(o*s),r.showDurationThumb(a,i);this.set("thumbisvisible",!0),this.activeElement().appendChild(r.thumbContainer)}this.get("isseeking")&&(this.set("position",n),"undefined"!=typeof e._broadcastingState&&e._broadcastingState.googleCastConnected?e.trigger("google-cast-seeking",this.get("position")):this.trigger("position",this.get("position")))}},stopUpdatePosition:function(){this.set("isseeking",!1),this._hideThumb()},startUpdateVolume:function(e,t){var e=e[0],i="mousedown"===e.type?"mousemove":"touchmove",s="mousedown"===e.type?"mouseup":"touchend",n=t.getBoundingClientRect(),r=(e.preventDefault(),function(e){var t;e.preventDefault(),e=n.width>n.height?(!(t=e.clientX)&&e.touches&&(t=e.touches[0].clientX),o.clamp((t-n.x)/n.width,0,1)):(!(t=e.clientY)&&e.touches&&(t=e.touches[0].clientY),o.clamp((n.bottom-t)/n.height,0,1)),this.trigger("volume",e)}.bind(this));r(e),document.addEventListener(i,r),document.addEventListener(s,function(){document.removeEventListener(i,r)},{once:!0})},showChapterText:function(e){this.set("visibleindex",e.index),this._hideThumb()},hideChapterText:function(){this.set("visibleindex",-1)},stopVerticallyUpdateVolume:function(e){e[0].preventDefault(),this.set("_updateVolume",!1)},play:function(){this.trigger("play")},pause:function(){this.trigger("pause")},toggle_player:function(){this.trigger("toggle_player")},toggle_volume:function(){var e;this.trigger("toggle_volume"),this.get("unmuteonclick")||(e=0<(e=this.get("volume"))?(this.__oldVolume=e,0):this.__oldVolume||1,this.trigger("volume",e))},toggle_position_info:function(){this.set("revertposition",!this.get("revertposition"))},toggle_fullscreen:function(){this.trigger("fullscreen")},toggle_settings_menu:function(){this.trigger("settings_menu")},rerecord:function(){this.trigger("rerecord")},seek:function(e){this.trigger("seek",e)},set_volume:function(e){this.trigger("volume",e)},submit:function(){this.set("submittable",!1),this.set("rerecordable",!1),this.trigger("submit")},select_frame:function(){var e=this.parent().player,t=e.position(),i=!1,s=(e.pause(),new d({context:this,start:!1,fire:function(){e.setPosition(t),e.play(),e.pause(),e.loaded()&&e.createSnapshotPromise().success(function(e){s.stop(),i||(i=!0,this.parent().trigger("image-selected",e))},this)},delay:300,fire_max:5,destroy_on_stop:!0}));e.loaded()?e.createSnapshotPromise().success(function(e){this.parent().trigger("image-selected",e)},this).error(function(){s.start()},this):s.start()},toggle_stream:function(){var e=this.get("streams"),i=e.length-1;e.forEach(function(e,t){s.deepEqual(e,this.get("currentstream"))&&(i=t)},this),this.set("currentstream",e[(i+1)%e.length])},show_airplay_devices:function(){var e=this.__parent;e.player._broadcastingState.airplayConnected&&e._broadcasting.lookForAirplayDevices(e.player._element)},toggle_tracks:function(){return this.parent().toggleTrackTags()},hover_cc:function(e){this.parent().get("settingsmenu_active")||l.eventually(function(){this.parent().set("tracksshowselection",e)},this,300)},tab_index_move:function(e,t,i){this.trigger("tab_index_move",e[0],t,i)},hover_block:function(e){l.eventually(function(){this.parent().set("hoveredblock",e)},this,300)},toggle_settings:function(){this.trigger("toggle_settings")},trim:function(){this.parent().trigger("video-trimmed",this.get("trimstart")||0,this.get("trimend")||this.get("duration"))},addTrimmingEventListeners:function(){var i=this.get("events"),e=this.activeElement().querySelector('[data-selector="trim-start-marker"]'),t=this.activeElement().querySelector('[data-selector="trim-end-marker"]');i.on(e,"mousedown touchstart",function(e){e.preventDefault(),e.stopPropagation();var t=this.get("progressbarElement").getBoundingClientRect();this.call("updateTrimStart",e,t),i.on(document,"mousemove touchmove",function(e){e.preventDefault(),this.call("updateTrimStart",e,t)},this),i.on(document,"mouseup touchend",function(e){e.preventDefault(),i.off(document,"mouseup touchend mousemove touchmove")},this)},this),i.on(t,"mousedown touchstart",function(e){e.preventDefault(),e.stopPropagation();var t=this.get("progressbarElement").getBoundingClientRect();this.call("updateTrimEnd",e,t),i.on(document,"mousemove touchmove",function(e){e.preventDefault(),this.call("updateTrimEnd",e,t)},this),i.on(document,"mouseup touchend",function(e){e.preventDefault(),i.off(document,"mouseup touchend mousemove touchmove")},this)},this)},updateTrimStart:function(e,t){var e=this.call("calculatePosition",e,t),t=this.get("trimend")||this.get("duration"),i=this.get("timeminlimit")||1;t-i<e?this.set("trimstart",t-i):this.set("trimstart",e)},updateTrimEnd:function(e,t){var e=this.call("calculatePosition",e,t),t=this.get("trimstart")||0,i=this.get("timeminlimit")||1;e<t+i?this.set("trimend",t+i):this.set("trimend",e)},getClientX:function(e){return 0===e.clientX?0:e.clientX||e.targetTouches[0].clientX},calculatePosition:function(e,t){var e=this.call("getClientX",e),i=-1,i=e<t.left?0:e>t.left+t.width?1:(e-t.left)/(t.width||1);return this.get("duration")*i}},_hideThumb:function(){"undefined"!=typeof this.__parent.__trackTags&&this.__parent.__trackTags.hasThumbs&&this.get("thumbisvisible")&&(this.set("thumbisvisible",!1),this.__parent.__trackTags.hideDurationThumb())},create:function(){this.set("ismobile",a.isMobile()),this.set("events",new u),this.set("progressbarElement",this.activeElement().querySelector('[data-selector="progress-bar-inner"]')),this.get("trimmingmode")&&this.call("addTrimmingEventListeners")}}}).register("ba-videoplayer-controlbar").registerFunctions({cssplayer:function(e){return e.cssplayer},"((prominent_title_closed || title_hide_class) && controlbar_hide_class) ? cssplayer + '-dashboard-hidden' : ''":function(e){return(e.prominent_title_closed||e.title_hide_class)&&e.controlbar_hide_class?e.cssplayer+"-dashboard-hidden":""},"skipinitial ? 2 : 1":function(e){return e.skipinitial?2:1},css:function(e){return e.css},controlbar_hide_class:function(e){return e.controlbar_hide_class},"activitydelta < 2500 || ismobile ? '' : (css + '-progressbar-small')":function(e){return e.activitydelta<2500||e.ismobile?"":e.css+"-progressbar-small"},"disableseeking ? cssplayer + '-disabled' : ''":function(e){return e.disableseeking?e.cssplayer+"-disabled":""},"seek(position + skipseconds)":function(e){return e.seek(e.position+e.skipseconds)},"seek(position - skipseconds)":function(e){return e.seek(e.position-e.skipseconds)},"seek(position + skipseconds * 3)":function(e){return e.seek(e.position+3*e.skipseconds)},"seek(position - skipseconds * 3)":function(e){return e.seek(e.position-3*e.skipseconds)},"startUpdatePosition(domEvent)":function(e){return e.startUpdatePosition(e.domEvent)},testid:function(e){return e.testid},"true":function(e){return!0},chapterslist:function(e){return e.chapterslist},"chapter.index":function(e){return e.chapter.index},"{left: Math.round(duration ? chapter.startTime / duration * 100 : 0) + '%'}":function(e){return{left:Math.round(e.duration?e.chapter.startTime/e.duration*100:0)+"%"}},"showChapterText(chapter)":function(e){return e.showChapterText(e.chapter)},"hideChapterText()":function(e){return e.hideChapterText()},"visibleindex === chapter.index && showchaptertext":function(e){return e.visibleindex===e.chapter.index&&e.showchaptertext},"chapter.title":function(e){return e.chapter.title},"{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}":function(e){return{width:Math.round(e.duration?e.cached/e.duration*100:0)+"%"}},"{width: Math.round(duration ? position / duration * 100 : 0) + '%'}":function(e){return{width:Math.round(e.duration?e.position/e.duration*100:0)+"%"}},"string('video-progress')":function(e){return e.string("video-progress")},trimmingmode:function(e){return e.trimmingmode},"{left: Math.round(duration && trimstart ? trimstart / duration * 100 : 0) + '%'}":function(e){return{left:Math.round(e.duration&&e.trimstart?e.trimstart/e.duration*100:0)+"%"}},"{left: 'auto', right: 100 - Math.round(duration && trimend ? trimend / duration * 100 : 100) + '%'}":function(e){return{left:"auto",right:100-Math.round(e.duration&&e.trimend?e.trimend/e.duration*100:100)+"%"}},"submit()":function(e){return e.submit()},submittable:function(e){return e.submittable},"string('submit-video')":function(e){return e.string("submit-video")},"rerecord()":function(e){return e.rerecord()},rerecordable:function(e){return e.rerecordable},"string('rerecord-video')":function(e){return e.string("rerecord-video")},csscommon:function(e){return e.csscommon},"skipinitial ? 0 : 2":function(e){return e.skipinitial?0:2},"toggle_player()":function(e){return e.toggle_player()},"string('play-video')":function(e){return e.string("play-video")},"tab_index_move(domEvent, null, 'button-icon-pause')":function(e){return e.tab_index_move(e.domEvent,null,"button-icon-pause")},"!playing":function(e){return!e.playing},"play()":function(e){return e.play()},"disablepause ? cssplayer + '-disabled' : ''":function(e){return e.disablepause?e.cssplayer+"-disabled":""},"tab_index_move(domEvent, null, 'button-icon-play')":function(e){return e.tab_index_move(e.domEvent,null,"button-icon-play")},playing:function(e){return e.playing},"pause()":function(e){return e.pause()},"disablepause ? string('pause-video-disabled') : string('pause-video')":function(e){return e.disablepause?e.string("pause-video-disabled"):e.string("pause-video")},"toggle_position_info()":function(e){return e.toggle_position_info()},"revertposition ? string('remaining-time') : string('elapsed-time')":function(e){return e.revertposition?e.string("remaining-time"):e.string("elapsed-time")},'(revertposition && duration > 0) ? "-" : ""':function(e){return e.revertposition&&0<e.duration?"-":""},"(revertposition && duration > 0) ? (formatTime(duration - position)) : formatTime(position)":function(e){return e.revertposition&&0<e.duration?e.formatTime(e.duration-e.position):e.formatTime(e.position)},"string('total-time')":function(e){return e.string("total-time")},"formatTime(duration || position)":function(e){return e.formatTime(e.duration||e.position)},title_hide_class:function(e){return e.title_hide_class},"title && !prominent_title_closed":function(e){return e.title&&!e.prominent_title_closed},closeable_title:function(e){return e.closeable_title},"prominent_title_closed=true":function(e){return e.prominent_title_closed=!0},title:function(e){return e.title},frameselectionmode:function(e){return e.frameselectionmode},"select_frame()":function(e){return e.select_frame()},"string('select-frame')":function(e){return e.string("select-frame")},"trim()":function(e){return e.trim()},"string('trim-video')":function(e){return e.string("trim-video")},"toggle_settings_menu()":function(e){return e.toggle_settings_menu()},"settingsmenuactive ? 'active' : 'inactive'":function(e){return e.settingsmenuactive?"active":"inactive"},"tab_index_move(domEvent)":function(e){return e.tab_index_move(e.domEvent)},settingsmenubutton:function(e){return e.settingsmenubutton},"string('settings')":function(e){return e.string("settings")},"toggle_tracks()":function(e){return e.toggle_tracks()},"(tracktags.length > 0 && showsubtitlebutton) || allowtexttrackupload":function(e){return 0<e.tracktags.length&&e.showsubtitlebutton||e.allowtexttrackupload},"tracktextvisible ? 'active' : 'inactive'":function(e){return e.tracktextvisible?"active":"inactive"},"tracktextvisible ? string('close-tracks') : string('show-tracks')":function(e){return e.tracktextvisible?e.string("close-tracks"):e.string("show-tracks")},"hover_cc(true)":function(e){return e.hover_cc(!0)},"hover_cc(false)":function(e){return e.hover_cc(!1)},fullscreen:function(e){return e.fullscreen},"toggle_fullscreen()":function(e){return e.toggle_fullscreen()},"fullscreened ? string('exit-fullscreen-video') : string('fullscreen-video')":function(e){return e.fullscreened?e.string("exit-fullscreen-video"):e.string("fullscreen-video")},"fullscreened ? 'small' : 'full'":function(e){return e.fullscreened?"small":"full"},"show_airplay_devices()":function(e){return e.show_airplay_devices()},airplaybuttonvisible:function(e){return e.airplaybuttonvisible},"string('airplay')":function(e){return e.string("airplay")},"string('airplay-icon')":function(e){return e.string("airplay-icon")},castbuttonvisble:function(e){return e.castbuttonvisble},"toggle_stream()":function(e){return e.toggle_stream()},"streams.length > 1 && currentstream":function(e){return 1<e.streams.length&&e.currentstream},"string('change-resolution')":function(e){return e.string("change-resolution")},currentstream_label:function(e){return e.currentstream_label},"!hidevolumebar":function(e){return!e.hidevolumebar},"set_volume(volume + 0.1)":function(e){return e.set_volume(e.volume+.1)},"set_volume(volume - 0.1)":function(e){return e.set_volume(e.volume-.1)},"set_volume(1)":function(e){return e.set_volume(1)},"set_volume(0)":function(e){return e.set_volume(0)},"startUpdateVolume(domEvent, currElement)":function(e){return e.startUpdateVolume(e.domEvent,e.currElement)},"{width: Math.min(100, Math.round(volume * 100)) + '%'}":function(e){return{width:Math.min(100,Math.round(100*e.volume))+"%"}},"string('volume-button')":function(e){return e.string("volume-button")},"toggle_volume()":function(e){return e.toggle_volume()},"string(volume > 0 ? 'volume-mute' : 'volume-unmute')":function(e){return e.string(0<e.volume?"volume-mute":"volume-unmute")},"volume > 0 ? 'mute' : 'unmute'":function(e){return 0<e.volume?"mute":"unmute"},"csscommon + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))":function(e){return e.csscommon+"-icon-volume-"+(.5<=e.volume?"up":0<e.volume?"down":"off")}}).attachStringTable(r.strings).addStrings({"video-progress":"Progress","rerecord-video":"Redo?","submit-video":"Confirm","play-video":"Play","pause-video":"Pause","pause-video-disabled":"Pause not supported","elapsed-time":"Elapsed time","total-time":"Total length of","fullscreen-video":"Enter fullscreen","volume-button":"Set volume","volume-mute":"Mute sound","volume-unmute":"Unmute sound","change-resolution":"Change resolution","exit-fullscreen-video":"Exit fullscreen","close-tracks":"Close CC","show-tracks":"Show CC","player-speed":"Player speed",settings:"Settings",airplay:"Airplay","airplay-icon":"Airplay icon.","remaining-time":"Remaining time","select-frame":"Select","trim-video":"Trim"})}),e.define("module:VideoPlayer.Dynamics.Loader",["dynamics:Dynamic","module:Assets"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'<div class="{{cssplayer}}-loader-container">\n    <div data-selector="loader-block" class="{{cssplayer}}-loader-loader" title="{{string(\'tooltip\')}}">\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player"}}}).register("ba-videoplayer-loader").registerFunctions({cssplayer:function(e){return e.cssplayer},"string('tooltip')":function(e){return e.string("tooltip")}}).attachStringTable(t.strings).addStrings({tooltip:"Loading..."})}),e.define("module:VideoPlayer.Dynamics.Message",["dynamics:Dynamic"],["dynamics:Partials.ClickPartial"],function(e,t){return e.extend({scoped:t},function(e){return{template:'\n<div class="{{css}}-message-container" ba-click="{{click()}}">\n    <div data-selector="message-block" class=\'{{css}}-message-message\'>\n        <p> {{message}} </p>\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",message:""},functions:{click:function(){this.trigger("click")}}}}).registerFunctions({css:function(e){return e.css},"click()":function(e){return e.click()},message:function(e){return e.message}}).register("ba-videoplayer-message")}),e.define("module:VideoPlayer.Dynamics.Next",["dynamics:Dynamic","browser:Canvas","browser:Info","module:Assets"],function(e,i,t,s,n){return e.extend({scoped:n},function(e){return{template:'<div class="{{cssplayer}}-toggle-next-container {{cssplayer}}-next-style-{{style}}">\n    <div class="{{cssplayer}}-next-button-container">\n        <a class="{{cssplayer}}-next-button-stay {{cssplayer}}-next-button"\n        ontouchstart="{{stay(domEvent)}}"\n        ba-click="{{stay(domEvent)}}"\n        >Stay</a>\n        <a ontouchstart="{{next(domEvent)}}"\n        ba-click="{{next(domEvent)}}"\n           class="{{cssplayer}}-next-button-next {{cssplayer}}-next-button"\n        >\n            <span class="{{cssplayer}}-next-progress"\n                  ba-styles="{{{width: ((position - shownext) / noengagenext * 100) + \'%\'}}}"\n            ></span>\n            <span>Next</span>\n        </a>\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",style:"mobile"},computed:{"nextvideoposter:playlist,current_video_from_playlist":function(e,t){if(e&&e[t+1])return e[t+1].poster}},events:{"change:nextvideoposter":function(e){var t;e&&((t=new Image).crossOrigin="anonymous",t.onload=function(){this.set("hidenextvideoposter",i.isImageBlack(t))}.bind(this),t.src=e)}},functions:{stay:function(e){e&&"touchstart"===e[0].type&&(e[0].preventDefault(),e[0].stopPropagation()),this.channel("next").trigger("setStay")},next:function(e){e&&"touchstart"===e[0].type&&(e[0].preventDefault(),e[0].stopPropagation()),this.channel("next").trigger("manualPlayNext"),this.channel("next").trigger("playNext",!1)}}}}).register("ba-videoplayer-next").registerFunctions({cssplayer:function(e){return e.cssplayer},style:function(e){return e.style},"stay(domEvent)":function(e){return e.stay(e.domEvent)},"next(domEvent)":function(e){return e.next(e.domEvent)},"{width: ((position - shownext) / noengagenext * 100) + '%'}":function(e){return{width:(e.position-e.shownext)/e.noengagenext*100+"%"}}}).attachStringTable(s.strings)}),e.define("module:VideoPlayer.Dynamics.Playbutton",["dynamics:Dynamic","base:TimeFormat","module:Assets"],["dynamics:Partials.ClickPartial"],function(e,t,i,s){return e.extend({scoped:s},function(e){return{template:'\n<div tabindex="0" data-selector="play-button"\n     ba-hotkey:space^enter="{{play()}}" onmouseout="this.blur()"\n     onkeydown="{{tab_index_move(domEvent, null, \'player-toggle-overlay\')}}"\n     class="{{css}}-playbutton-container" ba-click="{{play()}}" title="{{string(\'tooltip\')}}"\n>\n\t<div class="{{css}}-playbutton-button"></div>\n</div>\n<div ba-show="{{showduration && (duration != 0 && duration != undefined)}}" class="{{css}}-playbutton-duration">\n\t{{formatTime(duration)}}\n</div>\n<div class="{{css}}-rerecord-bar" ba-if="{{rerecordable || submittable}}">\n\t<div class="{{css}}-rerecord-backbar"></div>\n\t<div class="{{css}}-rerecord-frontbar">\n        <div class="{{css}}-rerecord-button-container" ba-if="{{submittable && !trimmingmode}}">\n            <div tabindex="0" data-selector="player-submit-button"\n                 ba-hotkey:space^enter="{{submit()}}" onmouseout="this.blur()"\n                 class="{{css}}-rerecord-button" onclick="{{submit()}}">\n                {{string(\'submit-video\')}}\n            </div>\n        </div>\n        <div class="{{css}}-rerecord-button-container" ba-if="{{rerecordable && !trimmingmode}}">\n        \t<div tabindex="0" data-selector="player-rerecord-button"\n                 ba-hotkey:space^enter="{{rerecord()}}" onmouseout="this.blur()"\n                 class="{{css}}-rerecord-button" onclick="{{rerecord()}}">\n        \t\t{{string(\'rerecord\')}}\n        \t</div>\n        </div>\n        <div class="{{css}}-rerecord-button-container" ba-if="{{trimmingmode}}">\n        \t<div tabindex="0" data-selector="player-trim-button"\n                 ba-hotkey:space^enter="{{play()}}" onmouseout="this.blur()"\n                 class="{{css}}-rerecord-button" onclick="{{play()}}">\n        \t\t{{string(\'trim\')}}\n        \t</div>\n        </div>\n        <div class="{{css}}-rerecord-button-container" ba-if="{{trimmingmode}}">\n        \t<div tabindex="0" data-selector="player-skip-button"\n                 ba-hotkey:space^enter="{{skip()}}" onmouseout="this.blur()"\n                 class="{{css}}-rerecord-button" onclick="{{skip()}}">\n        \t\t{{string(\'skip\')}}\n        \t</div>\n        </div>\n\t</div>\n</div>\n',attrs:{css:"ba-videoplayer",csstheme:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",rerecordable:!1,submittable:!1,showduration:!1},functions:{play:function(){this.trigger("play")},skip:function(){this.parent().trigger("skip")},submit:function(){this.set("submittable",!1),this.set("rerecordable",!1),this.trigger("submit")},rerecord:function(){this.trigger("rerecord")},tab_index_move:function(e,t,i){this.trigger("tab_index_move",e[0],t,i)},formatTime:function(e){return 3600<(e=Math.max(e||0,1))?t.format(t.ELAPSED_HOURS_MINUTES_SECONDS,1e3*e):t.format(t.ELAPSED_MINUTES_SECONDS,1e3*e)}}}}).register("ba-videoplayer-playbutton").registerFunctions({"play()":function(e){return e.play()},"tab_index_move(domEvent, null, 'player-toggle-overlay')":function(e){return e.tab_index_move(e.domEvent,null,"player-toggle-overlay")},css:function(e){return e.css},"string('tooltip')":function(e){return e.string("tooltip")},"showduration && (duration != 0 && duration != undefined)":function(e){return e.showduration&&0!=e.duration&&e.duration!=undefined},"formatTime(duration)":function(e){return e.formatTime(e.duration)},"rerecordable || submittable":function(e){return e.rerecordable||e.submittable},"submittable && !trimmingmode":function(e){return e.submittable&&!e.trimmingmode},"submit()":function(e){return e.submit()},"string('submit-video')":function(e){return e.string("submit-video")},"rerecordable && !trimmingmode":function(e){return e.rerecordable&&!e.trimmingmode},"rerecord()":function(e){return e.rerecord()},"string('rerecord')":function(e){return e.string("rerecord")},trimmingmode:function(e){return e.trimmingmode},"string('trim')":function(e){return e.string("trim")},"skip()":function(e){return e.skip()},"string('skip')":function(e){return e.string("skip")}}).attachStringTable(i.strings).addStrings({tooltip:"Click to play.",rerecord:"Redo","submit-video":"Confirm video",trim:"Trim",skip:"Skip"})}),e.define("module:VideoPlayer.Dynamics.Player",["dynamics:Dynamic","module:Assets","module:DatasetProperties","module:FloatHandler","module:StylesMixin","module:TrackTags","browser:Info","browser:Dom","media:Player.VideoPlayerWrapper","media:Player.Broadcasting","media:Player.Support","base:Types","base:Objs","base:Strings","base:Collections.Collection","base:Maths","base:Time","base:Timers","base:Promise","base:TimeFormat","base:States.Host","base:Classes.ClassRegistry","base:Async","base:Functions","module:VideoPlayer.Dynamics.PlayerStates.Initial","module:VideoPlayer.Dynamics.PlayerStates","module:Ads.AbstractVideoAdProvider","browser:Events"],["module:Ads.Dynamics.Player","module:Common.Dynamics.Settingsmenu","module:VideoPlayer.Dynamics.Playbutton","module:VideoPlayer.Dynamics.Message","module:VideoPlayer.Dynamics.Loader","module:VideoPlayer.Dynamics.Share","module:VideoPlayer.Dynamics.Next","module:VideoPlayer.Dynamics.Controlbar","module:VideoPlayer.Dynamics.Topmessage","module:VideoPlayer.Dynamics.Tracks","module:VideoPlayer.Dynamics.Sidebar","module:VideoPlayer.Dynamics.Tooltip","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.TogglePartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial","module:VideoPlayer.Dynamics.PlayerStates.TextTrackUploading","module:VideoPlayer.Dynamics.PlayerStates.FatalError","module:VideoPlayer.Dynamics.PlayerStates.Initial","module:VideoPlayer.Dynamics.PlayerStates.LoadPlayer","module:VideoPlayer.Dynamics.PlayerStates.LoadPlayerDirectly","module:VideoPlayer.Dynamics.PlayerStates.LoadError","module:VideoPlayer.Dynamics.PlayerStates.PosterReady","module:VideoPlayer.Dynamics.PlayerStates.Outstream","module:VideoPlayer.Dynamics.PlayerStates.LoadAds","module:VideoPlayer.Dynamics.PlayerStates.PlayOutstream","module:VideoPlayer.Dynamics.PlayerStates.PlayAd","module:VideoPlayer.Dynamics.PlayerStates.PrerollAd","module:VideoPlayer.Dynamics.PlayerStates.MidrollAd","module:VideoPlayer.Dynamics.PlayerStates.PostrollAd","module:VideoPlayer.Dynamics.PlayerStates.PosterError","module:VideoPlayer.Dynamics.PlayerStates.LoadVideo","module:VideoPlayer.Dynamics.PlayerStates.ErrorVideo","module:VideoPlayer.Dynamics.PlayerStates.PlayVideo","module:VideoPlayer.Dynamics.PlayerStates.NextVideo"],function(e,t,i,n,s,r,o,u,a,c,l,h,m,g,d,p,f,y,b,v,x,_,A,w,k,C,E,S,D){return e.extend({scoped:D},[s,function(s){return{template:'<div itemscope itemtype="http://schema.org/VideoObject"\n     class="{{css}}-container {{cssplayer}}-size-{{csssize}} {{iecss}}-{{ie8 ? \'ie8\' : \'noie8\'}} {{csstheme}}\n     {{cssplayer}}-{{fullscreened ? \'fullscreen\' : \'normal\'}}-view {{cssplayer}}-{{firefox ? \'firefox\' : \'common\'}}-browser\n     {{cssplayer}}-{{themecolor}}-color {{cssplayer}}-device-type-{{mobileview ? \'mobile\' : \'desktop\'}}\n     {{cssplayer}}-viewport-{{mobileviewport ? \'mobile\' : \'desktop\'}}\n     {{is_floating ? cssfloatingclasses : \'\'}}\n     {{presetkey ? cssplayer + \'-preset-\' + presetkey : \'\'}}\n     {{(sidebar_active && gallerysidebar) ? cssplayer + \'-with-sidebar-gallery\' : \'\'}}\n     {{(sidebar_active && show_sidebar) ? cssplayer + \'-with-sidebar\' : csscommon + \'-full-width\'}}\n     {{cssplayer + (((activity_delta > hidebarafter) && hideoninactivity) ? \'-controlbar-hidden\' : \'-controlbar-visible\')}}"\n     ba-on:mousemove="{{user_activity()}}"\n     ba-on:mousedown="{{user_activity(true)}}"\n     ba-on:touchstart="{{user_activity(true)}}"\n     ba-styles="{{containerSizingStyles}}"\n     data-testid="{{testid}}-player-container"\n>\n    <meta itemprop="name" content="{{title || \'Video Player\'}}" />\n    <meta itemprop="description" content="{{description || \'Video Player\'}}" />\n    <meta itemprop="uploadDate" content="{{uploaddate}}" />\n    <meta itemprop="caption" content="{{title}}" />\n    <meta itemprop="thumbnailUrl" content="{{thumbnailurl}}" />\n    <meta itemprop="contentUrl" content="{{contenturl}}" />\n    <div class="{{cssplayer}}-content" data-selector="ba-player-container"\n         ba-styles="{{playercontainerstyles}}"\n    >\n        <ba-{{dynnext}}\n            ba-if="{{next_active && !playing_ad}}"\n            ba-is_floating="{{is_floating}}"\n            ba-style="{{layout}}"\n            ba-with_sidebar="{{with_sidebar}}"\n            ba-playlist="{{playlist}}"\n            ba-current_video_from_playlist="{{current_video_from_playlist}}"\n            ba-position="{{position}}"\n            ba-shownext="{{shownext}}"\n            ba-noengagenext="{{noengagenext}}"\n            ba-gallerysidebar="{{gallerysidebar}}"\n        ></ba-{{dynnext}}>\n        <div class="{{css}}-tooltips-list-container"\n             ba-repeat="{{tooltip :: tooltips}}"\n        >\n            <ba-{{dyntooltip}}\n                ba-if="{{tooltip.tooltiptext}}"\n                ba-tooltip="{{tooltip}}"\n                ba-playing="{{playing}}"\n                ba-adsplaying="{{adsplaying}}"\n            ></ba-{{dyntooltip}}>\n        </div>\n        <div ba-show="{{(videoelement_active || !imageelement_active) && !silent_attach}}" class="{{css}}-video-container">\n            <video tabindex="-1" class="{{css}}-video {{csscommon}}-{{videofitstrategy}}-fit" data-video="video"\n                   preload="{{preload ? \'auto\' : \'metadata\'}}"\n                   ba-toggle:playsinline="{{!playfullscreenonmobile}}"\n            ></video>\n        </div>\n        <div ba-show="{{(imageelement_active && !videoelement_active) || silent_attach}}" class="{{css}}-poster-container">\n            <img tabindex="-1" data-image="image" alt="{{posteralt}}" class="{{csscommon}}-{{posterfitstrategy}}-fit"/>\n        </div>\n        <ba-{{dynadsplayer}}\n            ba-if="{{adsplayer_active}}"\n            ba-ad="{{=ad}}"\n            ba-addata="{{=addata}}"\n            ba-adsmanagerloaded="{{=adsmanagerloaded}}"\n            ba-css="{{css}}"\n            ba-cssplayer="{{cssplayer}}"\n            ba-csscommon="{{csscommon}}"\n            ba-testid="{{testid}}"\n            ba-duration="{{=adduration}}"\n            ba-volume="{{adsunmuted ? volume : 0}}"\n            ba-muted="{{muted}}"\n            ba-containerstyle="{{containerSizingStyles}}"\n            ba-unmuteonclick="{{unmuteonclick}}"\n            ba-adtagurl="{{adtagurl}}"\n            ba-adchoiceslink="{{adchoiceslink}}"\n            ba-adsunmuted="{{=adsunmuted}}"\n            ba-inlinevastxml="{{inlinevastxml}}"\n            ba-outstreamoptions="{{outstreamoptions}}"\n            ba-quartile="{{=adsquartile}}"\n            ba-userhadplayerinteraction="{{userhadplayerinteraction}}"\n            ba-controlbarstyles="{{controlbarstyles}}"\n            ba-sidebar_active="{{sidebar_active}}"\n            ba-imasettings="{{imasettings}}"\n            ba-event:fullscreen="toggle_fullscreen"\n            ba-fullscreened="{{fullscreened}}"\n            ba-hidecontrolbar="{{!adscontrolbar_active}}"\n            ba-hideadscontrolbar="{{hideadscontrolbar}}"\n            ba-tmplcontrolbar="{{tmpladscontrolbar}}"\n            ba-dyncontrolbar="{{dynadscontrolbar}}"\n            ba-companionad="{{companionad}}"\n            ba-companionads="{{=companionads}}"\n            ba-hideoninactivity="{{(activity_delta > hidebarafter) && hideoninactivity}}"\n            ba-view_type="{{view_type}}"\n            ba-adsplaying="{{=adsplaying}}"\n            ba-playing="{{=adnotpaused}}"\n            ba-showlearnmorebutton="{{showlearnmorebutton}}"\n            ba-moredetailslink="{{=moredetailslink}}"\n            ba-moredetailstext="{{=moredetailstext}}"\n            ba-mobileview="{{mobileview}}"\n            ba-floating="{{is_floating}}"\n            ba-withsidebar="{{with_sidebar}}"\n            ba-floatingoptions="{{floatingoptions}}"\n            ba-mobileviewport="{{mobileviewport}}"\n            ba-adchoicesontop="{{adchoicesontop && !gallerysidebar}}"\n            ba-presetedtooltips="{{presetedtooltips}}"\n            ba-showadchoices="{{showadchoices}}"\n            ba-imaadsrenderingsetting="{{imaadsrenderingsetting}}"\n            ba-adsrendertimeout="{{adsrendertimeout}}"\n        ></ba-{{dynadsplayer}}>\n        <div class="{{css}}-overlay {{hasplaceholderstyle ? (css + \'-overlay-with-placeholder\') : \'\'}}"\n             ba-show="{{!showbuiltincontroller && !outstream && !adsplaying}}" style="{{placeholderstyle}}"\n             data-testid="{{testid}}-content-player-container"\n        >\n            <div tabindex="-1" class="{{css}}-player-toggle-overlay" data-selector="player-toggle-overlay"\n                 ba-hotkey:right="{{seek(position + skipseconds)}}" ba-hotkey:left="{{seek(position - skipseconds)}}"\n                 ba-hotkey:alt+right="{{seek(position + skipseconds * 3)}}" ba-hotkey:alt+left="{{seek(position - skipseconds * 3)}}"\n                 ba-hotkey:up="{{set_volume(volume + 0.1)}}" ba-hotkey:down="{{set_volume(volume - 0.1)}}"\n                 ba-hotkey:space^enter="{{toggle_player(true)}}"\n                 ba-click="{{toggle_player(true)}}"\n            ></div>\n            <ba-{{dyntrimmer}}\n                ba-if="{{trimmingmode && videoelement_active}}"\n                ba-playing="{{playing}}"\n                ba-startposition="{{=starttime}}"\n                ba-position="{{position}}"\n                ba-endposition="{{=endtime}}"\n                ba-minduration="{{timeminlimit}}"\n                ba-duration="{{duration}}"\n                ba-source="{{source}}"\n                ba-event:play="play"\n                ba-event:pause="pause"\n                ba-event:seek="seek"\n            ></ba-{{dyntrimmer}}>\n            <ba-{{dyncontrolbar}}\n                ba-css="{{csscontrolbar || css}}"\n                ba-cssplayer="{{cssplayer || css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-testid="{{testid}}"\n                ba-logo="{{controlbar_logo}}"\n                ba-themecolor="{{themecolor}}"\n                ba-template="{{tmplcontrolbar}}"\n                ba-show="{{controlbar_active && !hidecontrolbar}}"\n                ba-playing="{{playing}}"\n                ba-showcontroll="{{showcontroll}}"\n                ba-playwhenvisible="{{playwhenvisible}}"\n                ba-playerspeeds="{{playerspeeds}}"\n                ba-playercurrentspeed="{{playercurrentspeed}}"\n                ba-playlist="{{playlist}}"\n                ba-airplay="{{airplay}}"\n                ba-airplaybuttonvisible="{{airplaybuttonvisible}}"\n                ba-chromecast="{{chromecast}}"\n                ba-castbuttonvisble="{{castbuttonvisble}}"\n                ba-sidebar_active="{{sidebar_active}}"\n                ba-tabindex="{{tabindex}}"\n                ba-showchaptertext="{{showchaptertext}}"\n                ba-chapterslist="{{chapterslist}}"\n                ba-tracktextvisible="{{tracktextvisible}}"\n                ba-tracktags="{{tracktags}}"\n                ba-showsubtitlebutton="{{hassubtitles && tracktagssupport}}"\n                ba-allowtexttrackupload="{{allowtexttrackupload}}"\n                ba-tracksshowselection="{{tracksshowselection}}"\n                ba-volume="{{volume}}"\n                ba-muted="{{muted}}"\n                ba-unmuteonclick="{{unmuteonclick}}"\n                ba-duration="{{duration}}"\n                ba-cached="{{buffered}}"\n                ba-title="{{title}}"\n                ba-prominent_title="{{prominent_title}}"\n                ba-closeable_title="{{closeable_title}}"\n                ba-position="{{position}}"\n                ba-activitydelta="{{activity_delta}}"\n                ba-hasnext="{{hasnext}}"\n                ba-hideoninactivity="{{hideoninactivity}}"\n                ba-hidebarafter="{{hidebarafter}}"\n                ba-rerecordable="{{rerecordable}}"\n                ba-submittable="{{submittable}}"\n                ba-frameselectionmode="{{frameselectionmode}}"\n                ba-timeminlimit="{{timeminlimit}}"\n                ba-streams="{{streams}}"\n                ba-currentstream="{{=currentstream}}"\n                ba-fullscreen="{{fullscreensupport && !nofullscreen}}"\n                ba-fullscreened="{{fullscreened}}"\n                ba-source="{{source}}"\n                ba-disablepause="{{disablepause}}"\n                ba-disableseeking="{{disableseeking}}"\n                ba-skipseconds="{{skipseconds}}"\n                ba-skipinitial="{{skipinitial}}"\n                ba-settingsmenubutton="{{showsettingsmenu}}"\n                ba-settingsmenuactive="{{settingsmenu_active}}"\n                ba-hidevolumebar="{{hidevolumebar}}"\n                ba-manuallypaused="{{manuallypaused}}"\n                ba-view_type="{{view_type}}"\n                ba-is_floating="{{is_floating}}"\n                ba-isseeking="{{=isseeking}}"\n                ba-with_sidebar="{{with_sidebar}}"\n                ba-event:rerecord="rerecord"\n                ba-event:submit="submit"\n                ba-event:play="play"\n                ba-event:pause="pause"\n                ba-event:position="seek"\n                ba-event:volume="set_volume"\n                ba-event:set_speed="set_speed"\n                ba-event:settings_menu="toggle_settings_menu"\n                ba-event:fullscreen="toggle_fullscreen"\n                ba-event:toggle_player="toggle_player"\n                ba-event:tab_index_move="tab_index_move"\n                ba-event:seek="seek"\n                ba-event:toggle_tracks="toggle_tracks"\n                ba-event:toggle_volume="toggle_volume"\n            ></ba-{{dyncontrolbar}}>\n\n            <ba-{{dyntracks}}\n                ba-css="{{csstracks || css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-cssplayer="{{cssplayer || css}}"\n                ba-show="{{tracktagssupport || allowtexttrackupload}}"\n                ba-tracksshowselection="{{tracksshowselection}}"\n                ba-trackselectorhovered="{{trackselectorhovered}}"\n                ba-tracktags="{{tracktags}}"\n                ba-hidebarafter="{{hidebarafter}}"\n                ba-tracktagsstyled="{{tracktagsstyled}}"\n                ba-trackcuetext="{{trackcuetext}}"\n                ba-allowtexttrackupload="{{allowtexttrackupload}}"\n                ba-uploadtexttracksvisible="{{uploadtexttracksvisible}}"\n                ba-acceptedtracktexts="{{acceptedtracktexts}}"\n                ba-uploadlocales="{{uploadlocales}}"\n                ba-activitydelta="{{activity_delta}}"\n                ba-hideoninactivity="{{hideoninactivity}}"\n                ba-event:selected_label_value="selected_label_value"\n                ba-event:upload-text-tracks="upload_text_tracks"\n                ba-event:move_to_option="move_to_option"\n            ></ba-{{dyntracks}}>\n\n            <ba-{{dynsettingsmenu}}\n                ba-css="{{css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-show="{{settingsmenu_active}}"\n                ba-template="{{tmplsettingsmenu}}"\n                ba-toggle_settings_menu="{{toggle_settings_menu}}"\n                ba-toggle_share="{{toggle_share}}"\n            ></ba-{{dynsettingsmenu}}>\n\n            <ba-{{dynplaybutton}}\n                ba-css="{{cssplaybutton || css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-cssplayer="{{cssplayer || css}}"\n                ba-theme-color="{{themecolor}}"\n                ba-template="{{tmplplaybutton}}"\n                ba-show="{{playbutton_active}}"\n                ba-rerecordable="{{rerecordable}}"\n                ba-submittable="{{submittable}}"\n                ba-trimmingmode="{{trimmingmode}}"\n                ba-showduration="{{showduration}}"\n                ba-duration="{{duration}}"\n                ba-event:play="playbutton_click"\n                ba-event:rerecord="rerecord"\n                ba-event:submit="submit"\n                ba-event:tab_index_move="tab_index_move"\n            ></ba-{{dynplaybutton}}>\n\n            <ba-{{dynloader}}\n                ba-css="{{cssloader || css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-cssplayer="{{cssplayer || css}}"\n                ba-theme-color="{{themecolor}}"\n                ba-template="{{tmplloader}}"\n                ba-playwhenvisible="{{playwhenvisible}}"\n                ba-show="{{loader_active}}"\n            ></ba-{{dynloader}}>\n\n            <ba-{{dynshare}}\n                ba-css="{{cssshare || css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-cssplayer="{{cssplayer || css}}"\n                ba-theme-color="{{themecolor}}"\n                ba-template="{{tmplshare}}"\n                ba-show="{{sharevideourl && sharevideo.length > 0 && share_active}}"\n                ba-visible="{{=share_active}}"\n                ba-url="{{sharevideourl}}"\n                ba-shares="{{sharevideo}}"\n            ></ba-{{dynshare}}>\n\n            <ba-{{dynmessage}}\n                ba-css="{{cssmessage || css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-cssplayer="{{cssplayer || css}}"\n                ba-theme-color="{{themecolor}}"\n                ba-template="{{tmplmessage}}"\n                ba-show="{{message_active}}"\n                ba-message="{{message}}"\n                ba-event:click="message_click"\n            ></ba-{{dynmessage}}>\n\n            <ba-{{dyntopmessage}}\n                ba-css="{{csstopmessage || css}}"\n                ba-csstheme="{{csstheme || css}}"\n                ba-cssplayer="{{cssplayer || css}}"\n                ba-theme-color="{{themecolor}}"\n                ba-template="{{tmpltopmessage}}"\n                ba-show="{{topmessage}}"\n                ba-topmessage="{{topmessage}}"\n            ></ba-{{dyntopmessage}}>\n        </div>\n        <div ba-show="{{useAspectRatioFallback}}" ba-styles="{{aspectRatioFallback}}"></div>\n    </div>\n    <div ba-show="{{show_sidebar}}" class="{{cssplayer}}-sidebar" ba-styles="{{sidebarstyles}}">\n        <ba-{{dynsidebar}}\n            ba-if="{{sidebar_active}}"\n            ba-css="{{css}}"\n            ba-cssplayer="{{cssplayer}}"\n            ba-csscommon="{{csscommon}}"\n            ba-csstheme="{{csstheme || css}}"\n            ba-ad="{{ad}}"\n            ba-title="{{next_active ? \'\' : title || \'Video Player\'}}"\n            ba-addata="{{addata}}"\n            ba-companionads="{{companionads}}"\n            ba-fullscreened="{{fullscreened}}"\n            ba-is_floating="{{is_floating}}"\n            ba-showlearnmorebutton="{{showlearnmorebutton}}"\n            ba-sidebaroptions="{{sidebaroptions}}"\n            ba-floatingoptions="{{floatingoptions}}"\n            ba-floatingsidebar="{{floatingsidebar}}"\n            ba-showsidebargallery="{{showsidebargallery}}"\n            ba-gallerysidebar="{{gallerysidebar}}"\n            ba-adchoiceslink="{{adchoiceslink}}"\n            ba-moredetailslink="{{moredetailslink}}"\n            ba-moredetailstext="{{moredetailstext}}"\n            ba-adsplaying="{{adsplaying}}"\n            ba-linear="{{=linear}}"\n            ba-playlist="{{playlist}}"\n            ba-playing="{{playing}}"\n            ba-position="{{position}}"\n            ba-shownext="{{shownext}}"\n            ba-nextactive="{{next_active}}"\n            ba-noengagenext="{{noengagenext}}"\n            ba-mobileviewport="{{mobileviewport}}"\n            ba-showadchoices="{{showadchoices}}"\n            ba-unknownadsrc="{{unknownadsrc}}"\n            ba-event:pause_ads="pause_ads"\n        ></ba-{{dynsidebar}}>\n    </div>\n    <div ba-if="{{!fullscreened && is_floating && floatingoptions.closeable}}"\n         class="{{cssplayer}}-close-container"\n         ba-click="close_floating()"\n         ba-on:touchend="{{close_floating()}}"\n    >\n        <svg viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">\n            <path\n                d="m17.459 16.014 8.239-8.194a.992.992 0 0 0 0-1.414 1.016 1.016 0 0 0-1.428 0l-8.232 8.187L7.73 6.284a1.009 1.009 0 0 0-1.428 0 1.015 1.015 0 0 0 0 1.432l8.302 8.303-8.332 8.286a.994.994 0 0 0 0 1.414 1.016 1.016 0 0 0 1.428 0l8.325-8.279 8.275 8.276a1.009 1.009 0 0 0 1.428 0 1.015 1.015 0 0 0 0-1.432l-8.269-8.27z"\n                class="{{cssplayer}}-close-svg-button"\n            ></path>\n        </svg>\n    </div>\n</div>\n',attrs:function(){return{brightness:0,current_video_from_playlist:0,next_video_from_playlist:0,sample_brightness:!1,sample_brightness_rate:10,sample_brightness_sample_size:250,css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",iecss:"ba-videoplayer",cssplaybutton:"",cssloader:"",cssmessage:"",csstopmessage:"",csscontrolbar:"",csstracks:"",testid:"ba-testid",width:"",height:"",presetkey:null,availablepresetoptions:{},showsidebargallery:!1,sidebaroptions:{presetwidth:24,afteradsendtext:null,gallerytitletext:null,headerlogourl:null,headerlogoimgurl:null,headerlogoname:null,fluid:!1,preferredratio:1.778,showcompanionad:!1,hidevideoafterplay:!1,autonext:!0,nextunplayed:!1},"popup-width":"","popup-height":"",aspectratio:null,"fallback-aspect-ratio":"1280/720","floating-fallback-mobile-height":75,"floating-fallback-desktop-height":240,theme:"",csstheme:"",themecolor:"",dynadscontrolbar:"ads-controlbar",dynadsplayer:"adsplayer",dynplaybutton:"videoplayer-playbutton",dynloader:"videoplayer-loader",dynmessage:"videoplayer-message",dyntopmessage:"videoplayer-topmessage",dyncontrolbar:"videoplayer-controlbar",dynshare:"videoplayer-share",dyntracks:"videoplayer-tracks",dynsidebar:"videoplayer-sidebar",dynsettingsmenu:"common-settingsmenu",dyntrimmer:"videorecorder-trimmer",dynnext:"videoplayer-next",dyntooltip:"videoplayer-tooltip",tmpladcontrolbar:"",tmplplaybutton:"",tmplloader:"",tmplmessage:"",tmplshare:"",tmpltopmessage:"",tmplcontrolbar:"",tmpltracks:"",tmplsettingsmenu:"",poster:"",showlearnmorebutton:!1,source:"",sources:[],sourcefilter:{},state:"",streams:[],currentstream:null,hasnext:!1,playlist:null,volume:1,title:"",description:"",uploaddate:"",contenturl:"",thumbnailurl:"",initialseek:null,sharevideo:[],sharevideourl:"",share_active:!0,visibilityfraction:.8,disableadpreload:!0,reloadonplay:!1,"ias-config":undefined,playonclick:!0,pauseonclick:!0,unmuteonclick:!1,muted:!1,nextwidget:!1,shownext:3,noengagenext:5,stayengaged:!1,next_active:!1,presetedtooltips:{onplayercreate:null},adprovider:null,preroll:!1,outstream:!1,outstreamoptions:{},imasettings:{},imaadsrenderingsetting:{},adtagurl:null,adchoiceslink:null,adtagurlfallbacks:[],nextadtagurls:[],inlinevastxml:null,midrollminintervalbeforeend:5,mindurationnext:0,hidebeforeadstarts:!0,hideadscontrolbar:!1,showplayercontentafter:null,adsposition:null,vmapads:!1,"non-linear":null,adsunmuted:!1,companionad:null,companionads:[],adsrendertimeout:null,linearadplayer:!0,customnonlinear:!1,minadintervals:5,"non-linear-min-duration":10,midrollads:[],adchoicesontop:!0,mobilebreakpoint:560,allowpip:!0,rerecordable:!1,submittable:!1,autoplay:!1,autoplaywhenvisible:!1,continuousplayback:!0,preload:!1,loop:!1,loopall:!1,popup:!1,nofullscreen:!1,fullscreenmandatory:!1,playfullscreenonmobile:!1,fitonwidth:!1,fitonheight:!1,hideoninactivity:!0,hidebarafter:5e3,preventinteraction:!1,skipinitial:!1,topmessage:"",totalduration:null,playwhenvisible:!1,disablepause:!1,disableseeking:!1,tracktextvisible:!1,airplay:!1,chromecast:!1,broadcasting:!1,chromecastreceiverappid:null,skipseconds:5,floating:!1,sticky:!1,"sticky-starts-paused":!0,"sticky-threshold":undefined,floatingoptions:{"starts-paused":!0,threshold:undefined,sidebar:!0,floatingonly:!1,closeable:!0,hideplayeronclose:!1,showcompanionad:!1,desktop:{position:"bottom-right",height:197,bottom:30,sidebar:!1,companionad:!1},mobile:{position:"top",height:75,sidebar:!0,companionad:!0,positioning:{relativeSelector:null,applySelector:"div.ba-player-floating",applyProperty:"margin-top"}}},tracktags:[],tracktagsstyled:!0,tracktaglang:"en",tracksshowselection:!1,showchaptertext:!0,thumbimage:{},thumbcuelist:[],showduration:!1,infiniteduration:!1,showsettings:!0,showsettingsmenu:!0,posteralt:"",hidevolumebar:!1,hidecontrolbar:!1,allowtexttrackupload:!1,useAspectRatioFallback:o.isSafari()&&o.safariVersion()<15||o.isInternetExplorer(),uploadtexttracksvisible:!1,acceptedtracktexts:null,uploadlocales:[{lang:"en",label:"English"}],ttuploadervisible:!1,videofitstrategy:"pad",posterfitstrategy:"crop",slim:!1,adsplaying:!1,adshassource:!1,showbuiltincontroller:!1,airplaybuttonvisible:!1,castbuttonvisble:!1,fullscreened:!1,initialoptions:{hideoninactivity:null,volumelevel:null,autoplay:null,adsrendertimeout:null,outstreamoptions:{hideOnCompletion:!0,recurrenceperiod:3e4,maxadstoshow:-1,noEndCard:!1,allowRepeat:!0,persistentcompanionad:!1},imaadsrenderingsetting:{enablePreloading:!0,useStyledNonLinearAds:!0,restoreCustomPlaybackStateOnAdBreakComplete:!0,uiElements:[]}},silent_attach:!1,inpipmode:!1,lastplaylistitem:!1,manuallypaused:!1,playedonce:!1,preventinteractionstatus:!1,ready:!0,tracktagssupport:!1,playbackcount:0,playbackended:0,currentchapterindex:0,chapterslist:[],userengagedwithplayer:!1,userhadplayerinteraction:!1,states:{poster_error:{ignore:!1,click_play:!0},dimensions:{width:null,height:null},hiddenelement:{visible:!0}},placeholderstyle:"",hasplaceholderstyle:!1,playerorientation:undefined,forciblymuted:!1,"autoplay-allowed":!1,"autoplay-requires-muted":!0,"autoplay-requires-playsinline":null,volumeafterinteraction:!1,"prominent-title":!1,"closeable-title":!1,showadchoices:!0,unknownadsrc:!1}},types:{allowpip:"boolean",hidecontrolbar:"boolean",muted:"boolean",nextwidget:"boolean",shownext:"float",state:"string",noengagenext:"float",unmuteonclick:"boolean",rerecordable:"boolean",loop:"boolean",loopall:"boolean",autoplay:"boolean",autoplaywhenvisible:"boolean",infiniteduration:"boolean",continuousplayback:"boolean",preload:"boolean",ready:"boolean",nofullscreen:"boolean",fullscreenmandatory:"boolean",preroll:"boolean",hideoninactivity:"boolean",hidebarafter:"integer",preventinteraction:"boolean",skipinitial:"boolean",volume:"float",popup:"boolean","popup-width":"int","popup-height":"int",showlearnmorebutton:"boolean",aspectratio:"float","fallback-aspect-ratio":"string",outstreamoptions:"json",initialseek:"float",fullscreened:"boolean","ias-config":"json",sharevideo:"array",sharevideourl:"string",playfullscreenonmobile:"boolean",themecolor:"string",totalduration:"float",playwhenvisible:"boolean",playedonce:"boolean",disablepause:"boolean",disableseeking:"boolean",playonclick:"boolean",pauseonclick:"boolean",airplay:"boolean",airplaybuttonvisible:"boolean",chromecast:"boolean",chromecastreceiverappid:"string",skipseconds:"integer",floating:"boolean",streams:"jsonarray",sources:"jsonarray",tracktags:"jsonarray",tracktagsstyled:"boolean",allowtexttrackupload:"boolean",uploadtexttracksvisible:"boolean",acceptedtracktexts:"string",uploadlocales:"array",playerspeeds:"array",playercurrentspeed:"float",showsettings:"boolean",showsettingsmenu:"boolean",showduration:"boolean",visibilityfraction:"float",showchaptertext:"boolean",title:"string",description:"string",uploaddate:"string",contenturl:"string",thumbnailurl:"string",videofitstrategy:"string",posterfitstrategy:"string",adtagurl:"string",adchoiceslink:"string",adtagurlfallbacks:"array",nextadtagurls:"array",hideadscontrolbar:"boolean",inlinevastxml:"string",imasettings:"jsonarray",adsposition:"string","non-linear":"string",adchoicesontop:"boolean",minadintervals:"int","non-linear-min-duration":"int",slim:"boolean","prominent-title":"boolean","closeable-title":"boolean",floatingoptions:"jsonarray",presetedtooltips:"object",presetkey:"string",availablepresetoptions:"object",showsidebargallery:"boolean",hidebeforeadstarts:"boolean",sidebaroptions:"object",showadchoices:"boolean",unknownadsrc:"boolean",adsrendertimeout:"int",imaadsrenderingsetting:"object"},__INTERACTION_EVENTS:["click","mousedown","touchstart","keydown","keypress"],extendables:["states"],registerchannels:["ads","next"],scopes:{adsplayer:">[tagname='ba-adsplayer']",settingsmenu:">[tagname='ba-common-settingsmenu']",floatingsidebar:">[tagname='ba-videoplayer-sidebar']"},collections:{tooltips:{}},events:{"change:uploaddate":function(e){"number"==typeof e&&this.set("uploaddate",v.format("yyyy-mm-dd",1e3*e))},"change:starttime":function(e){e>this.getCurrentPosition()&&this.player.setPosition(e)},"change:endtime":function(e){e&&e!==this.get("duration")?(e<this.getCurrentPosition()&&this.player.setPosition(e),this.get("_timeUpdateEventHandler")||this.set("_timeUpdateEventHandler",this.auto_destroy(new S)),this.get("_timeUpdateEventHandler").__callbacks.timeupdate||this.get("_timeUpdateEventHandler").on(this.player._element,"timeupdate",function(){this.getCurrentPosition()>=this.get("endtime")&&(this.player.trigger("ended"),this.get("loop")||this.player.pause())},this)):this.get("_timeUpdateEventHandler")&&this.get("_timeUpdateEventHandler").clear()},"change:placeholderstyle":function(e){this.set("hasplaceholderstyle",10<e.length)},"change:position":function(t,i){if(this.get("nextwidget")&&!this.get("stayengaged")&&!this.get("adsplaying")){if(1<t-i)return this.channel("next").trigger("setStay");i=this.get("playlist");if(Array.isArray(i)&&0<i.length&&(1!==i.length||i[0].title!==this.get("title"))){var i=Number(this.get("shownext"))||0,s=i+(Number(this.get("noengagenext"))||0);let e=this.get("mindurationnext");e=e||s,this.get("duration")>=e&&i&&i<t&&!this.get("next_active")&&this.set("next_active",!0),this.get("duration")>=e&&s<t&&0<s&&(this.channel("next").trigger("autoPlayNext"),this.channel("next").trigger("playNext",!0))}}},"change:volume":function(e){this.isBroadcasting()&&this._broadcasting.player.trigger("change-google-cast-volume",e),this.videoLoaded()&&(this.player.setVolume(e),this.player.setMuted(e<=0)),this.set("muted",0===e)},"change:muted":function(e){h.is_boolean(e)&&(this.player?this.player.setMuted(e):this.__video&&(this.__video.mute=e))},"change:companionads":function(e){this.__repeatOutstream&&this.get("outstreamoptions.persistentcompanionad")||e&&0<e.length&&this.get("companionad")&&(this.get("companionad.locations")?this._renderMultiCompanionAds():this.scopes.adsplayer&&h.is_string(this.get("companionad"))||h.is_boolean(this.get("companionad"))?this.scopes.adsplayer.execute("renderCompanionAd",this.get("ad"),this.get("companionad")):console.warn('Please set correct companion ad attribute. It can be object with locations, string with "|" character seperated or boolean'))}},channels:{"next:setStay":function(){this.set("stayengaged",!0),this.set("next_active",!1),this.setPlayerEngagement()},"next:playNext":function(e){this.trigger("play_next"),this.set("next_active",!1),e||this.setPlayerEngagement()},"next:resetNextWidget":function(){this.set("stayengaged",!1),this.set("next_active",!1)}},computed:{"aspectRatioFallback:aspectratio,fallback-aspect-ratio":function(e,t){t=t.split("/");return{paddingTop:100/(e||t[0]/t[1])+"%"}},"aspect_ratio:aspectratio,fallback-aspect-ratio":function(e,t){return e||t},"hide_sidebar:with_sidebar,is_floating,showsidebargallery,playlist":function(e,t,i,s){!i&&h.is_defined(this.get("initialoptions.nextwidget"))&&this.set("nextwidget",this.get("initialoptions.nextwidget"));e=e&&t||i&&s&&0<=s.length;return!0!==this.get("sidebar_active")&&e&&this.set("sidebar_active",!0),!e},"show_sidebar:outstream,hide_sidebar,is_floating,with_sidebar,fullscreened,mobileviewport":function(e,t,i,s,n,r){return!n&&(this.set("floatingsidebar",!t&&i&&s),this.set("gallerysidebar",!t&&!i&&h.is_defined(r)&&!r&&!e),this.get("gallerysidebar")&&(!this.get("nextwidget")&&h.is_undefined(this.set("initialoptions.nextwidget"))&&this.set("initialoptions.nextwidget",!1),this.set("nextwidget",this.set("sidebaroptions.autonext"))),this.get("floatingsidebar")||this.get("gallerysidebar"))},"playercontainerstyles:show_sidebar,gallerysidebar,sidebaroptions.presetwidth,fullscreened,videowidth,is_floating":function(e,i,t,s,n,r){let o,a;if(this.set("sidebarstyles",{maxWidth:e&&i&&!r?"30%":"50%"}),e&&i&&!s)if(t="string"==typeof t?t.includes("%")?parseFloat(t).toFixed(2):t:t){if(o=o||("number"==typeof t?100-t+"%":`calc(100% - ${t})`),window&&window.CSS&&(a=window.CSS.supports("width",o)),o&&h.is_defined(a)&&a)return this.set("controlbarstyles",{width:o}),{width:o,position:"relative"}}else if(n&&this.__video&&this.get("width")&&this.activeElement()){let t;r=u.elementDimensions(this.__video).width,e=u.elementDimensions(this.__video).height,i=u.elementDimensions(this.activeElement()).width,s=u.elementDimensions(this.activeElement()).height;if(0<s&&e){let e=this.get("sidebaroptions.preferredratio")||1.7778;if(h.is_string(e)&&(e.includes("/")?e=parseFloat(e.split("/").reduce((e,t)=>e/t)):e.includes(":")&&(e=parseFloat(e.split(":").reduce((e,t)=>e/t)))),e=Number(parseFloat(e).toFixed(2)),(t="number"==typeof e?i-s*e:t)&&0<t)return this.get("sidebaroptions.fluid")||this.set("sidebaroptions.presetwidth",t+"px"),this.set("sidebarstyles",{maxWidth:t+"px"}),this.set("controlbarstyles",{maxWidth:i-t+"px"}),{minWidth:i-t+"px",flexBasis:0};if(r)return this.set("controlbarstyles",{maxWidth:r+"px"}),{minWidth:r+"px"}}}return this.set("sidebarstyles",{}),this.set("controlbarstyles",{}),{}},"adsinitialized:playing,adtagurl,inlinevastxml":function(e,t,i){return this.get("adsinitialized")||e?(this.__adInitilizeChecker&&this.__adInitilizeChecker.clear(),!0):!!(t||i&&!this.get("adshassource"))&&(this.set("adshassource",!0),this.initAdsRenderFailTimeout(),this.get("disableadpreload")||this.set("adsplayer_active",!this.get("delayadsmanagerload")),!this.__adInitilizeChecker&&this.get("showplayercontentafter")&&(this.__adInitilizeChecker=A.eventually(function(){this.get("adsinitialized")||this.set("adsinitialized",!0)},this,this.get("showplayercontentafter"))),this.once("ad:adCanPlay",function(){this.__adInitilizeChecker&&this.__adInitilizeChecker.clear(),this.set("adsinitialized",!0)}),void this.once("ad:ad-error",function(){this.__adInitilizeChecker&&this.__adInitilizeChecker.clear(),this.set("adsinitialized",!0)},this))},"hideplayer:autoplay,autoplaywhenvisible,adshassource,adsinitialized,hidden,hidebeforeadstarts":function(e,t,i,s,n,r){return n||!(!e&&!t||!r||!i||s)},"containerSizingStyles:outstream,aspect_ratio,height,width,is_floating,hideplayer,floatingoptions.floatingonly,fullscreened,showsidebargallery,gallerysidebar,layout":function(e,t,i,s,n,r,o,a,c,l,d){t={aspectRatio:t};return!a&&l&&(t.aspectRatio=this.get("sidebaroptions.aspectratio")||838/360),i&&(t.height=isNaN(i)?i:parseFloat(i).toFixed(2)+"px"),s&&(t.width=isNaN(s)?s:parseFloat(s).toFixed(2)+"px"),i=o?{height:0}:m.extend({},t),l||!c||"desktop"!==d||a||e||(i.aspectRatio=this.get("sidebaroptions.aspectratio")||838/360),n&&(o=(s=this.__calculateFloatingDimensions()).floating_top,l=s.floating_bottom,c=s.floating_right,d=s.floating_left,o!==undefined&&(t.top=parseFloat(o).toFixed()+"px"),c!==undefined&&(t.right=parseFloat(c).toFixed()+"px"),l!==undefined&&(t.bottom=parseFloat(l).toFixed()+"px"),d!==undefined&&(t.left=parseFloat(d).toFixed()+"px"),e=s.floating_width,o=s.floating_height,e&&(t.width=isNaN(e)?e:parseFloat(e).toFixed(2)+"px"),o)&&(t.height=isNaN(o)?o:parseFloat(o).toFixed(2)+"px"),r&&(t.opacity=0,n)?t.display="none":(this.activeElement()&&(i.width&&i.width.toString().includes("%")&&t.width.toString().includes("%")&&(i.width="100%"),this._applyStyles(this.activeElement(),i,this.__lastContainerSizingStyles),this.__lastContainerSizingStyles=i),a&&(delete t.width,delete t.height)),t},"cssfloatingclasses:floatingoptions.desktop.position":function(e){return[this.get("cssplayer")+"-floating",this.get("csscommon")+"-sticky",this.get("csscommon")+"-sticky-"+e||"bottom-right",this.FloatHandler&&this.FloatHandler.elementWasDragged()?"ba-commoncss-fade-up":""].join(" ")},"buffering:buffered,position,last_position_change_delta,playing":function(e,t,i,s){return s&&this.__playedStats(t,this.get("duration")),this.get("playing")&&this.get("buffered")<this.get("position")&&1e3<this.get("last_position_change_delta")},"is_floating:view_type,fullscreened":function(e,t){return!t&&("float"===e||e&&this.get("floatingoptions.floatingonly"))},"layout:mobileviewport":function(e){return this.applyPresets(),e?"mobile":"desktop"},"placement:outstream":function(e){return e?"outstream":"instream"},"quartile:passed-quarter,playing":function(e,t){return 0!==this.get("position")||t?["first","second","third","fourth"][e]:null},"orientation:videowidth,videoheight,fallback-aspect-ratio":function(e,t,i){i=i.split("/"),e=e||i[0],t=t||i[1];return e===t?"square":t<e?"landscape":"portrait"}},remove_on_destroy:!0,create:function(){this.get("autoplaywhenvisible")?(this.set("autoplay",!0),u.onScrollIntoView(this.activeElement(),this.get("visibilityfraction"),function(){this.destroyed()||this.set("autoplaywhenvisible",!1)},this)):!this.get("autoplay")&&0<this.get("volume")&&!this.get("unmuteonclick")&&(this.set("muted",!1),this.set("adsunmuted",!0)),this.__attachPlayerInteractionEvents(),this.set("clearDebounce",0),this.__mergeDeepAttributes(),this.__mergeWithInitialOptions(),this._dataset=this.auto_destroy(new i(this.activeElement())),this._dataset.bind("layout",this.properties()),this._dataset.bind("placement",this.properties()),this._dataset.bind("quartile",this.properties()),this._dataset.bind("adsquartile",this.properties()),this._dataset.bind("adsplaying",this.properties()),this._dataset.bind("visibility",this.properties(),{secondKey:"view_type"}),this._dataset.bind("orientation",this.properties()),void 0!==this.get("showsettings")&&this.set("showsettingsmenu",this.get("showsettings")),this.delegateEvents(null,this.channel("ads"),"ad"),this.delegateEvents(null,this.channel("next"),"next"),this.set("prominent_title",this.get("prominent-title")),this.set("closeable_title",this.get("closeable-title")),this.__initFloatingOptions(),this._observer=new ResizeObserver(function(e){for(var t=0;t<e.length;t++)this.trigger("resize",{width:e[t].contentRect.width,height:e[t].contentRect.height})}.bind(this)),this.initAdSources(),this._observer.observe(this.activeElement().firstChild),this._validateParameters(),this.set("initialoptions",m.tree_merge(this.get("initialoptions"),{volumelevel:this.get("volume"),autoplay:this.get("autoplay")})),this.get("sample_brightness")&&(this.__brightnessSampler=this.auto_destroy(new y.Timer({delay:1e3/(this.get("sample_brightness_rate")||10),fire:function(){var e;this.player&&(e=this.player.lightLevel(this.get("sample_brightness_sample_size"),this.get("sample_brightness_sample_areas")),e=Array.isArray(e)?e.map(function(e){return 100*e/255}):100*e/255,this.set("brightness",e))}.bind(this),start:!1}))),!this.get("fullscreenmandatory")||document.fullscreenEnabled||document.mozFullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled||(this.set("skipinitial",!0),this.set("showbuiltincontroller",!0)),(this.get("autoplay")||this.get("playwhenvisible"))&&(this.__testAutoplayOptions(),o.isSafari())&&this.set("preload",!o.isMobile()),this.get("presetedtooltips")&&this.get("presetedtooltips.onplayercreate")&&this.showTooltip(this.get("presetedtooltips.onplayercreate")),this.get("theme")&&this.set("theme",this.get("theme").toLowerCase()),this.get("theme")in t.playerthemes&&m.iter(t.playerthemes[this.get("theme")],function(e,t){this.isArgumentAttr(t)||this.set(t,e)},this),this.get("themecolor")||this.set("themecolor","default"),this.get("playlist")&&0<this.get("playlist").length&&(e=this.get("playlist")[0])&&h.is_object(e)&&(this.set("poster",e.poster),this.set("source",e.source),this.set("sources",e.sources)),this.get("streams")&&!this.get("currentstream")&&this.set("currentstream",this.get("streams")[0]),this.get("preventinteraction")&&!this.get("hideoninactivity")?(this.set("hideoninactivity",!0),this.set("initialoptions",m.tree_merge(this.get("initialoptions"),{hideoninactivity:!0}))):this.set("initialoptions",m.tree_merge(this.get("initialoptions"),{hideoninactivity:this.get("hideoninactivity")})),this.set("ie8",o.isInternetExplorer()&&o.internetExplorerVersion()<9),this.set("firefox",o.isFirefox()),this.set("mobileview",o.isMobile()),this.set("mobileviewport",this.__isInMobileViewport()),this.applyPresets(),this.set("hasnext",this.get("loop")||this.get("loopall")||this.get("playlist")&&1<this.get("playlist").length),this.set("hidevolumebar",o.isMobile()&&o.isiOS()),this.set("duration",this.get("totalduration")||0),this.set("position",0),this.set("buffered",0),this.set("passed-quarter",0),this.set("played-seconds",0),this.set("last-played-position",0),this.set("player-started",!1),this.set("last-seen-position",.2<this.get("volume")?1:0),this.set("message",""),this.set("fullscreensupport",!1),this.set("csssize","normal"),this.set("with_sidebar",!1),this.set("isAndroid",o.isMobile()&&!o.isiOS()),this.set("last_activity",f.now()),this.set("activity_delta",0),this.set("passed_after_play",0),this.set("playing",!1),this.__attachRequested=!1,this.__activated=!1,this.__error=null,document.onkeydown&&(this.activeElement().onkeydown=this._keyDownActivity.bind(this,this.activeElement())),this.on("change:tracktags",function(){"undefined"!=typeof this.__video&&(this.__trackTags=new r({},this))},this),this.host=this.auto_destroy(new x({stateRegistry:new _(this.cls.playerStates())})),(this.host.dynamic=this).set("state",this._initialState.classname?this._initialState.classname.split(".").slice(-1)[0]:this._initialState),this.host.on("next",function(e){this.set("state",e)},this),this.host.initialize(this._initialState),this.__adsControlPosition=0,this._timer=this.auto_destroy(new y.Timer({context:this,fire:this._timerFire,delay:100,start:!0})),this.activeElement().style.setProperty("display","flex"),this.__playerContainer=this.activeElement().querySelector("[data-selector='ba-player-container']");var e=()=>!(this.get("floatingoptions.noFloatOnDesktop")&&!this.get("mobileviewport")||this.get("floatingoptions.noFloatOnMobile")&&this.get("mobileviewport")),e=(this.get("floatingoptions.floatingonly")&&e()&&this.set("view_type","float"),this.get("sticky")||this.get("floating"));e&&!this.get("floatingoptions.floatingonly")&&(e={threshold:this.get("sticky-threshold")||this.get("floatingoptions.threshold"),paused:this.get("sticky-starts-paused")||this.get("floatingoptions.starts-paused")||!e,"static":this.get("floatingoptions.static"),floatCondition:function(e){return!(this.get("floatingoptions.noFloatOnDesktop")&&!this.get("mobileviewport")||this.get("floatingoptions.noFloatOnMobile")&&this.get("mobileviewport")||this.get("floatingoptions.noFloatIfAbove")&&this.get("mobileviewport")&&0<=e.top||this.get("floatingoptions.noFloatIfBelow")&&this.get("mobileviewport")&&e.top<=0)}.bind(this)},this.floatHandler=this.auto_destroy(new n(this.activeElement().firstChild,this.activeElement(),e)),this.floatHandler.on("transitionToFloat",function(){this.set("view_type","float")},this),this.floatHandler.on("transitionToView",function(){this.set("view_type","default")},this),this.floatHandler.on("transitionOutOfView",function(){this.set("view_type","out_of_view")},this),this.delegateEvents(null,this.floatHandler),this.floatHandler.init()),o.isSafari()&&(this.vidEle=document.createElement("video"),this.imgEle=document.createElement("img"))},initAdsRenderFailTimeout:function(){var e=Number(this.get("adsrendertimeout"));!this.__adsRenderFailTimer&&e&&0<e&&(this.__adsRenderFailTimer=new y.Timer({fire:function(){this.get("adsplaying")&&this.stopAdsRenderFailTimeout();var e=this.get("adsrendertimeout");0<e?this.set("adsrendertimeout",e-200):(this.channel("ads").trigger("render-timeout"),this.brakeAdsManually(!0))}.bind(this),delay:200,start:!0,context:this}),this.auto_destroy(this.__adsRenderFailTimer))},resetAdsRenderFailTimeout:function(){this.__adsRenderFailTimer&&this.stopAdsRenderFailTimeout(!0),this.initAdsRenderFailTimeout()},stopAdsRenderFailTimeout:function(e){(e=e||!1)&&this.set("adsrendertimeout",this.get("initialoptions.adsrendertimeout")),this.__adsRenderFailTimer&&(this.__adsRenderFailTimer.destroyed()||this.__adsRenderFailTimer.stop(),e)&&(this.__adsRenderFailTimer=null)},initMidRollAds:function(){var s=m.map(this.get("adsposition").split(/(?![^)(]*\([^)(]*?\)\)),(?![^\[]*\])/),function(e){return e.trim()},this);0<s.length&&(this.set("midrollads",[]),this.__adMinIntervals=this.get("minadintervals"),this.__adsControlPosition=0,m.iter(s,function(e,t){var i;e=e.toLowerCase(),/^mid\[[\d\s]+(,[\d\s]+|[\d\s]+\%|\%|[\d\s]+\*|\*)*\]*$/i.test(e)?(i=e.replace("mid[","").replace("]",""),m.map(i.split(","),function(s){s=s.trim(),/^[\d\s]+\*$/.test(s)?(s=+s.replace("*",""),this.on("change:duration",function(e){if(0<e&&0===this.get("midrollads").length){var t=Math.floor(e/s);if(this.get("infiniteduration")&&(t=100),s<e)for(var i=1;i<=t;i++)this.get("midrollads").push({position:this.get("position")+i*s})}},this)):/^[\d\s]+\%$/.test(s)?(s=parseInt(s.replace("%","").trim(),10))<100&&0<s&&this.get("midrollads").push({position:parseFloat((s/100).toFixed(2))}):this.get("midrollads").push({position:parseFloat(s)})},this)):(/^mid\[.*?\]$/.test(e)&&console.log("Seems your mid roll settings does not correctly set. It will be played only in the middle of the video."),/^mid$/.test(e)&&this.get("midrollads").push({position:.5})),t+1===s.length&&this._adsRollPositionsCollection&&(this._adsRollPositionsCollection.destroy(),this._adsRollPositionsCollection=null)},this))},getFullscreenElement:function(){let e=this.activeElement().getRootNode().host;for(;e&&e.getRootNode&&e.getRootNode().host;)e=e.getRootNode().host;return e||this.activeElement().childNodes[0]},getMediaType:function(){return"video"},_initialState:k,state:function(){return this.host.state()},videoAttached:function(){return!!this.player},videoLoaded:function(){return this.videoAttached()&&this.player.loaded()},videoError:function(){return this.__error},addSettingsMenuItem:function(e){this.__settingsMenu.execute("add_new_settings_item",e)},updateSettingsMenuItem:function(e,t){this.__settingsMenu.execute("update_new_settings_item",e,t)},removeSettingsMenuItem:function(e){this.__settingsMenu.execute("remove_settings_item",e)},toggle_pip:function(){this.player.isInPIPMode()?this.player.exitPIPMode():this.player.enterPIPMode()},_error:function(e,t){this.__error={error_type:e,error_code:t},this.trigger("error:"+e,t),this.trigger("error",e,t)},_clearError:function(){this.__error=null},_detachImage:function(){this.set("imageelement_active",!1)},_attachImage:function(){var e,t,i="object"==typeof this.get("poster");this.get("poster")?(e=this.activeElement().querySelector("[data-image='image']"),this._clearError(),t=this,e.onerror=function(){t.trigger("error:poster")},e.onload=function(){t.set("imageelement_active",!0),t.trigger("image-attached")},e.src=i?(window.URL||window.webkitURL).createObjectURL(this.get("poster")):this.get("poster")):this.trigger("error:poster")},_drawFrame:function(e,t,i,s,n){const r=document.createElement("canvas"),o=(r.width=i,r.height=s,r.getContext("2d"));e.currentTime=t,setTimeout(function(){o.clearRect(0,0,r.width,r.height),o.drawImage(e,0,0,r.width,r.height),n(r,o)}.bind(this),250)},addSourcToVideo:function(e,t){try{this.vidEle.src=e;const s=t.parentElement;this.imgEle.style.width="100%",this.vidEle.setAttribute("crossorigin","anonymous"),this.vidEle.muted=!0,this.vidEle.addEventListener("loadeddata",e=>{this.vidEle.pause(),this._drawFrame(this.vidEle,0,t.videoWidth,t.videoHeight,e=>{this.imgEle.src=""+e.toDataURL(),s.appendChild(this.imgEle)})})}catch(i){}},_renderVideoFrame:function(e){var t=this.getCurrentPosition();e.style.backgroundColor="transparent";try{this.vidEle.pause(),this.imgEle.src="",this._drawFrame(this.vidEle,t,e.videoWidth,e.videoHeight,e=>{this.imgEle.src=""+e.toDataURL()})}catch(i){}},_detachVideo:function(){this.set("playing",!1),this.player&&this.player.weakDestroy(),this.player=null,this.__video=null,this.set("videoelement_active",!1)},_validateParameters:function(){var e=["crop","pad","original"],t=["top","bottom"],i=(e.includes(this.get("videofitstrategy"))||console.warn("Invalid value for videofitstrategy: "+this.get("videofitstrategy")+"\nPossible values are: "+e.slice(0,-1).join(", ")+" or "+e.slice(-1)),e.includes(this.get("posterfitstrategy"))||console.warn("Invalid value for posterfitstrategy: "+this.get("posterfitstrategy")+"\nPossible values are: "+e.slice(0,-1).join(", ")+" or "+e.slice(-1)),(this.get("stretch")||this.get("stretchwidth")||this.get("stretchheight"))&&console.warn("Stretch parameters were deprecated, your player will stretch to the full container width by default."),this.get("floating")&&!t.includes(this.get("floatingoptions").mobile)&&console.warn("Please choose one of the following values instead:",t),["minheight","minwidth","minheight","minwidth"].forEach(function(e){h.is_string(e)&&this.get(e)&&console.warn(e+" parameter was deprecated, please use CSS instead.")}.bind(this)),{"sticky-position":"floatingoptions.desktop.position"}),s=(Object.keys(i).forEach(function(e){this.get(e)&&console.warn(e+" parameter was deprecated, please use "+i[e]+" instead.")}.bind(this)),{sticky:"floating","sticky-start-pause":"floatingoptions.start-pause","sticky-threshold":"floatingoptions.threshold"});Object.keys(s).forEach(function(e){this.get(e)&&console.warn(e+" parameter will be deprecated on future version, please use "+s[e]+" instead.")}.bind(this))},getCurrentPosition:function(){return this.videoAttached()?this.player._element.currentTime:NaN},_attachVideo:function(t){var i;this.videoAttached()||(this.__activated?(this.__attachRequested=!1,this.set("videoelement_active",!0),i=this.activeElement().querySelector("[data-video='video']"),this.addSourcToVideo(this.get("source"),i),this._clearError(),i.controls=this.get("showbuiltincontroller"),this.get("allowpip")||(i.disablePictureInPicture=!0),a.create(m.extend(this._getSources(),{element:i,onlyaudio:this.get("onlyaudio"),preload:!!this.get("preload"),loop:!!this.get("loop"),reloadonplay:!!(this.get("playlist")&&0<this.get("playlist").length)||!!this.get("reloadonplay"),fullscreenedElement:this.getFullscreenElement(),loadmetadata:o.isChrome()&&this.get("skipinitial")})).error(function(e){this.destroyed()||this._error("attach",e)},this).success(function(e){this.destroyed()||(this.player=e,this.delegateEvents(null,this.player,"player"),this.__video=i,this.set("silent_attach",t&&!this.get("autoplay")||this._prerollAd||!1),this.get("chromecast")&&(this.get("skipinitial")||this.set("skipinitial",!0),this._broadcasting=new c({player:e,commonOptions:{title:this.get("title"),poster:this.player._element.poster,currentPosition:this.get("position"),chromecastReceiverAppId:this.get("chromecastreceiverappid")},castOptions:{canControlVolume:!0,canPause:!this.get("disablepause"),canSeek:!this.get("disableseeking"),displayName:this.get("title"),duration:this.get("duration"),imageUrl:this.player._element.poster,isConnected:this.player._broadcastingState.googleCastConnected,isMuted:!1,isPaused:!this.get("playing")},airplayOptions:{}}),o.isChrome()&&this.get("chromecast")&&(this._broadcasting.attachGoggleCast(),this.player.on("cast-state-changed",function(e,t){this.set("castbuttonvisble",e!==t.NO_DEVICES_AVAILABLE),this.set("chromecasting",e===t.CONNECTED)},this),this.player.on("cast-loaded",function(e,t){this.set("broadcasting",!0),0<this.get("position")&&(this._broadcasting._seekToGoogleCast(this.get("position")),this._broadcasting._googleCastRemotePlay()),this.get("playing")&&this.pause(),this.player.on("cast-paused",function(e){this.set("playing",!e)},this)},this),this.player.on("cast-playpause",function(e){this.set("playing",!e)},this),this.player.on("cast-time-changed",function(e,t){h.is_defined(e)&&0!==e&&(t&&(this.set("cahched",t),this.set("duration",t||0)),this.set("position",e),this.set("videoelement_active",!1),this.set("imageelement_active",!0))},this),this.player.on("proceed-when-ending-googlecast",function(e,t){this.set("broadcasting",!1),this.set("videoelement_active",!0),this.set("imageelement_active",!1),this.player._broadcastingState.googleCastConnected=!1,this.set("playing",!1),this.trigger("seek",e),this.player.setPosition(e)},this)),o.isSafari())&&9<=o.safariVersion()&&window.WebKitPlaybackTargetAvailabilityEvent&&this.get("airplay")&&(this.set("airplaybuttonvisible",!0),this._broadcasting.attachAirplayEvent.call(this,i)),this.get("playwhenvisible")&&(this.set("skipinitial",!0),this._playWhenVisible(i)),this.player.on("fullscreen-change",function(e){this.set("fullscreened",e),e||this.get("hideoninactivity")===this.get("initialoptions").hideoninactivity||this.set("hideoninactivity",this.get("initialoptions").hideoninactivity)},this),this.get("userhadplayerinteraction")||this._checkAutoPlay(this.__video),this.player.on("postererror",function(){this._error("poster")},this),this.get("playedonce")||this.player.once("playing",function(){this.set("playedonce",!0),this.set("playbackcount",1)},this),this.player.on("playing",function(){var e=this.get("sticky")||this.get("floating");this.get("sample_brightness")&&this.__brightnessSampler.start(),e&&this.floatHandler&&this.floatHandler.start(),this.set("playing",!0),this.trigger("playing")},this),this.player.on("loaded",function(){this.set("videowidth",this.player.videoWidth()),this.set("videoheight",this.player.videoHeight()),this.get("sample_brightness")&&this.__brightnessSampler.fire()},this),this.player.on("error",function(e){this._error("video",e)},this),this.player.error()&&this.player.trigger("error",this.player.error()),this.player.on("paused",function(){o.isSafari()&&this._renderVideoFrame(this.__video),this.get("sample_brightness")&&this.__brightnessSampler.stop(),this.set("playing",!1),this.trigger("paused")},this),this.player.on("ended",function(){o.isSafari()&&this._renderVideoFrame(this.__video),this.get("sample_brightness")&&this.__brightnessSampler.stop(),this.set("playing",!1),this.set("playedonce",!0),this.set("playbackended",this.get("playbackended")+1),this.set("settingsmenu_active",!1),this.get("starttime")&&this.player.setPosition(this.get("starttime")||0),this.trigger("ended")},this),this.player._qualityOptions&&(this.addSettingsMenuItem({id:"sourcequality",label:"source-quality",showicon:!0,visible:!0,value:this.player._currentQuality.label,options:this.player._qualityOptions.map(function(e){return e.label}),func:function(e,t){this.player.trigger("setsourcequality",this.player._qualityOptions.find(function(e){return e.label===t}).id)}}),this.player.on("qualityswitched",function(e){this.updateSettingsMenuItem("sourcequality",{value:e.label})}.bind(this))),this.trigger("attached",e),this.player.once("loaded",function(){this.channel("next").trigger("resetNextWidget");var e=Math.min(1,this.get("volume"));this.player.setVolume(e),this.player.setMuted(this.get("muted")||e<=0),!this.__trackTags&&this.get("tracktags").length&&(this.__trackTags=new r({},this)),(this.get("totalduration")||this.player.duration()<Infinity)&&this.set("duration",this.get("totalduration")||this.player.duration()),this.set("fullscreensupport",this.player.supportsFullscreen(this.activeElement().childNodes[0])),this.on("chaptercuesloaded",function(e,t){this.set("chapterslist",e)},this),this.get("initialseek")&&this.player.setPosition(this.get("initialseek")),this.get("allowpip")&&this.addSettingsMenuItem({id:"pip",label:"Picture-in-Picture",showicon:!0,visible:this.player.supportsPIP(),func:function(e){return this.player.on("pip-mode-change",function(e,t){this.set("inpipmode",t),this.updateSettingsMenuItem("pip",{value:t})},this),!!this.toggle_pip()}})},this),this.player.loaded()&&this.player.trigger("loaded"))},this)):this.__attachRequested=!0)},_getSources:function(){var t=this.get("currentstream")?this.get("currentstream").filter:this.get("sourcefilter"),i=this.get("poster"),e=this.get("source"),s=t?m.filter(this.get("sources"),function(e){return m.subset_of(t,e)},this):this.get("sources");return m.iter(s,function(e){e.poster&&(i=e.poster)}),{poster:i,source:e,sources:s}},_afterActivate:function(e){s._afterActivate.call(this,e),this.__activated=!0,this.__settingsMenu=this.scopes.settingsmenu,this.__settingsMenu.get("settings")&&this.set("hassettings",!0),this.__attachRequested&&this._attachVideo(),this.activeElement().classList.add(this.get("csscommon")+"-full-width"),!0===this.get("slim")&&this.activeElement().classList.add(this.get("csscommon")+"-slim");var t=this.activeElement().querySelector('img[data-image="image"]'),i=this.auto_destroy(new S);i.on(t,"load",function(){this.set("fallback-aspect-ratio",t.naturalWidth+"/"+t.naturalHeight),i.destroy()},this)},_playWhenVisible:function(e){var t=this;u.isElementVisible(e,this.get("visibilityfraction"))&&this.player.play(),this._visiblityScrollEvent=this.auto_destroy(new S),this._visiblityScrollEvent.on(document,"scroll",function(){t.get("playedonce")||t.get("manuallypaused")?t.get("playing")&&!u.isElementVisible(e,t.get("visibilityfraction"))&&t.player.pause():u.isElementVisible(e,t.get("visibilityfraction"))?t.player.play():t.get("playing")&&t.player.pause()})},toggleFullscreen:function(){this.call("toggle_fullscreen")},getPlaybackCount:function(){return this.get("playbackcount")},reattachVideo:function(){this.set("reloadonplay",!0),this._detachVideo(),this._attachVideo()},reattachImage:function(){this._detachImage(),this._attachImage()},toggleTrackTags:function(){this.__trackTags&&(this.set("tracktextvisible",!this.get("tracktextvisible")),this.resetTrackTags())},resetTrackTags:function(i){i=h.is_defined(i)?i:this.get("tracktextvisible");const s=this.get("tracktaglang"),e=this.get("tracktagsstyled");let n=i?"showing":"disabled";n=i&&e?"hidden":n,!i&&this.get("tracktagsstyled")&&this.set("trackcuetext",null),this.__trackTags&&!this.__trackTags.destroyed()&&m.iter(this.__video.textTracks,function(e,t){"object"==typeof this.__video.textTracks[t]&&this.__video.textTracks[t]&&"metadata"!==(t=this.__video.textTracks[t]).kind&&t.language===s&&(t.mode=n,this.set("tracktextvisible",i),this.__trackTags._triggerTrackChange(this.__video,t,n,s))},this)},_keyDownActivity:function(e,t){var i;this.get("preventinteractionstatus")||(32!==(i=t.which||t.keyCode)&&37!==i&&38!==i&&39!==i&&40!==i||t.preventDefault(),32!==i&&13!==i&&9!==i||(this._resetActivity(),this.get("fullscreened")&&this.get("hideoninactivity")&&this.set("hideoninactivity",!1)),9===i&&t.shiftKey?(this._resetActivity(),this._findNextTabStop(e,t,function(e,t){e.focus()},-1)):9===i&&(this._resetActivity(),this._findNextTabStop(e,t,function(e,t){e.focus()})))},_findNextTabStop:function(e,t,i,s){var n,r,o,a,c=n=0,l=s||1,d=t.target.tabIndex,u=e.querySelectorAll("[tabindex]");if(u=Array.prototype.slice.call(u,0).filter(function(e){return(0<e.clientWidth||0<e.clientHeight)&&-1!==e.tabIndex&&(c<=e.tabIndex&&(c=e.tabIndex),n>=e.tabIndex&&(n=e.tabIndex),!0)}),1===l&&d===c||-1===s&&d===n||0===c)1<document.querySelectorAll("ba-videoplayer").length&&(this.get("playing")&&this.player.pause(),e.tabIndex=-1,e.blur());else{for(var h=0;h<u.length;h++)u[h]&&(a=(o=u[h].tabIndex)-d,o<n||c<o||Math.sign(a)!==l||(!r||Math.abs(a)<Math.abs(r.tabIndex-d))&&(r=u[h]));r&&(t.preventDefault(),i(r,r.tabIndex))}},_resetActivity:function(){this.get("preventinteractionstatus")||this.set("last_activity",f.now()),this.set("activity_delta",0)},showTooltip:function(e){h.is_object(e)&&e.tooltiptext||console.warn("Provided tooltip has to be an object, at least with 'tooltiptext' key");var t=e.position||"top-right";0<this.get("tooltips").count()&&this.hideTooltip(t),this.get("tooltips").add({id:e.id||f.now(),tooltiptext:e.tooltiptext,position:e.position||"top-right",closeable:e.closeable||!1,pauseonhover:e.pauseonhover||!1,showprogressbar:e.showprogressbar||!1,disappearafterseconds:e.disappearafterseconds||-1,showonhover:e.showonhover||!1,queryselector:e.queryselector||null}),this.get("tooltips").add_secondary_index("position")},hideTooltip:function(e,t){let i;(i=t?this.get("tooltips").queryOne({id:t}):this.get("tooltips").get_by_secondary_index("position",e,!0))&&this.get("tooltips").remove(i)},hideControl:function(){this.auto_destroy(new y.Timer({delay:4e3,fire:function(){this.get("showcontroll")&&this.get("playing")&&this.get("trackUnmute")&&this.set("showcontroll",!1)}.bind(this),once:!0}))},showControll:function(){return this.get("playing")&&!this.get("showcontroll")&&this.get("trackUnmute")&&this.get("isAndroid")?(this.set("showcontroll",!0),this.hideControl(),!0):!this.get("playing")&&this.get("showcontroll")?(this.set("showcontroll",!1),!1):!(!this.get("trackUnmute")&&this.get("playing")&&this.get("isAndroid"))&&void 0},object_functions:["play","rerecord","pause","stop","seek","set_volume","set_speed","toggle_tracks"],functions:{user_activity:function(e){this.get("preventinteractionstatus")||this._resetActivity()},message_click:function(){this.trigger("message:click"),this.setPlayerEngagement()},playbutton_click:function(){this.setPlayerEngagement(),this.trigger("playbuttonclick"),this.host.state().play()},play:function(){this.setPlayerEngagement(),this.trigger("playrequested"),this._delegatedPlayer?this._delegatedPlayer.execute("play"):this.player&&this.get("broadcasting")?this._broadcasting.player.trigger("play-google-cast"):(this.host.state().play(),this.set("manuallypaused",!1))},rerecord:function(){this._delegatedPlayer?this._delegatedPlayer.execute("rerecord"):this.get("rerecordable")&&this.trigger("rerecord")},submit:function(){this._delegatedPlayer?this._delegatedPlayer.execute("submit"):this.get("submittable")&&(this.trigger("submit"),this.set("submittable",!1),this.set("rerecordable",!1))},pause:function(){if(!this.get("preventinteractionstatus"))if(this._delegatedPlayer)this._delegatedPlayer.execute("pause");else if(!this.get("disablepause")){if((this.get("playing_ad")||this.get("adsplaying"))&&this.scopes.adsplayer.execute("pause"),this.get("playing")){if(this.player&&this.get("broadcasting"))return void this._broadcasting.player.trigger("pause-google-cast");this.player.pause()}this.set("manuallypaused",!0)}},stop:function(){this.get("preventinteractionstatus")||(this._delegatedPlayer?this._delegatedPlayer.execute("stop"):this.videoLoaded()&&(this.get("playing")&&this.player.pause(),this.player.setPosition(0),this.trigger("stopped")))},seek:function(t){this.setPlayerEngagement(),this.get("preventinteractionstatus")||(this._delegatedPlayer?this._delegatedPlayer.execute("seek",t):this.get("disableseeking")||(this.get("nextwidget")&&this.channel("next").trigger("setStay"),this.videoLoaded()&&(t<this.get("position")&&this.trigger("rewind"),t>this.player.duration()?this.player.setPosition(this.player.duration()-this.get("skipseconds")):this.get("starttime")&&t<this.get("starttime")?this.player.setPosition(this.get("starttime")):(this.player.setPosition(t),this.trigger("seek",t))),this._adsRollPositionsCollection&&0<this._adsRollPositionsCollection.count()&&this._adsRollPositionsCollection.iterate(function(e){e.get("position")<t&&(this._nextRollPosition=null)},this),this.__playedStats(t,this.get("duration"))))},set_speed:function(e,t){return this.setPlayerEngagement(),!!this.player&&(this.player.setSpeed(e),t||this.updateSettingsMenuItem("playerspeeds",{value:parseFloat(e.toFixed(2))}),e)},set_volume:function(e){this.setPlayerEngagement(),this.get("preventinteractionstatus")||(this._delegatedPlayer?this._delegatedPlayer.execute("set_volume",e):this.set("volume",p.clamp(e,0,1)))},toggle_volume:function(){this.setPlayerEngagement()},toggle_settings_menu:function(){this.set("settingsmenu_active",!this.get("settingsmenu_active"))},toggle_share:function(){this.set("share_active",!this.get("share_active"))},toggle_fullscreen:function(){var e;this.setPlayerEngagement(),this.get("preventinteractionstatus")||(this._delegatedPlayer?this._delegatedPlayer.execute("toggle_fullscreen"):(this.get("fullscreened")?u.documentExitFullscreen():o.isiOS()&&o.isMobile()?(e=this.activeElement().querySelector(this.get("playing_ad")?"[data-video='ima-ad-container'] video":"video"),u.elementEnterFullscreen(e),this.__lastPause=0,this.__changePlayingCB=function(e){e||(this.__lastPause=f.now())}.bind(this),this.on("change:playing",this.__changePlayingCB),this.on("change:adnotpaused",this.__changePlayingCB),e.addEventListener("webkitendfullscreen",function(){this.off("change:playing",this.__changePlayingCB),this.off("change:adnotpaused",this.__changePlayingCB),this.set("fullscreened",!1),this.get("playing")?this.once("paused",function(){this.play()},this):this.get("adnotpaused")?this.once("change:adnotpaused",function(){this.play()},this):f.now()-this.__lastPause<100&&setTimeout(function(){this.play()}.bind(this),500)}.bind(this),{once:!0})):u.elementEnterFullscreen(this.activeElement().childNodes[0]),this.set("fullscreened",!this.get("fullscreened"))))},toggle_player:function(e){this._debouncedToggle||(this._debouncedToggle=w.debounce(function(e){(this.get("sticky")||this.get("floating"))&&this.floatHandler&&this.floatHandler.isDragging()?this.floatHandler.stopDragging():this.get("playing")&&this.get("preventinteractionstatus")||(this._delegatedPlayer?this._delegatedPlayer.execute("toggle_player"):e&&(this.setPlayerEngagement(),this.get("unmuteonclick"))?(this.set("showcontroll",this.get("isAndroid")),this.set("trackUnmute",!1)):this.showControll()||(this.get("playing")&&this.get("pauseonclick")?(this.set("showcontroll",this.get("isAndroid")),this.set("trackUnmute",this.get("isAndroid")),this.trigger("pause_requested"),this.pause()):!this.get("playing")&&this.get("playonclick")&&(this.trigger("play_requested"),this.setPlayerEngagement(),this.play())))}.bind(this),100,!0)),this._debouncedToggle(e)},tab_index_move:function(e,t,i){var s,n;this.get("preventinteractionstatus")||(e=e.which||e.keyCode,n=this.activeElement(),13===e||32===e?i?(s=n.querySelector("[data-selector='"+i+"']"))&&A.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!1})},this,100):(s=n.querySelector('[data-video="video"]'),A.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!0})},this,100)):9===e&&t&&(s=n.querySelector("[data-selector='"+t+"']"))&&A.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!1})},this,100))},upload_text_tracks:function(e,t){return this.host.state().uploadTextTrack(e,t)},move_to_option:function(e,t){var i,s,n,r;t=t||"initial-options-list",t="."+(i=this.get("csscommon")+"-")+t,s=i+"options-list-hidden",n=i+"options-list-visible",t=this.activeElement().querySelector(t),r=this.activeElement().querySelector(i+"text-tracks-overlay"),u.elementHasClass(t,s)&&(e=u.elementFindClosestParent(e,n,i+"text-tracks-overlay"),u.elementHasClass(e,n)&&(u.elementReplaceClasses(t,s,n),u.elementReplaceClasses(e,n,s)),(r||e).focus({preventScroll:!0}))},toggle_interaction_option:function(e){"boolean"==typeof e?this.set("preventinteractionstatus",e):this.set("preventinteractionstatus",!this.get("preventinteractionstatus"))},toggle_tracks:function(){this.toggleTrackTags(!this.get("tracktextvisible"))},pause_ads:function(){this.channel("ads").trigger("pause")},resume_ads:function(){this.setPlayerEngagement(),this.channel("ads").trigger("resume")},close_floating:function(e){e=e||!1,this.trigger("floatingplayerclosed"),!(this.get("sticky")||this.get("floating"))&&!this.get("floatingoptions.floatingonly")||(this.pause(),this.floatHandler&&(e?this.floatHandler.destroy():this.floatHandler.stop()),this.get("floatingoptions.hideplayeronclose"))||this.get("floatingoptions.floatingonly")?(this.hidePlayerContainer(),e&&this.destroy()):this.set("view_type","default")}},destroy:function(){this._observer&&this._observer.disconnect(),this._detachVideo(),s.destroy.call(this)},_timerFire:function(){if(!this.destroyed()){try{var e,t,i,s;this.set("mobileviewport",this.__isInMobileViewport()),this.videoLoaded()&&(e=f.now(),this.set("activity_delta",e-this.get("last_activity")),(t=this.player.position())===this.get("position")&&!this.get("last_position_change")||this.set("last_position_change",e),0<this.get("position")&&this.__previousPostion!==Math.round(this.get("position"))&&(this.__previousPostion=Math.round(this.get("position")),0<this.__previousPostion)&&this.trigger("playing_progress",this.__previousPostion),0<t&&this.get("silent_attach")&&this.set("silent_attach",!1),this.get("preventinteraction")&&(this.get("passed_after_play")<.001?this.set("passed_after_play",e):(e-1e3<(i=e-this.get("passed_after_play"))&&this.set("passed_after_play",i),this.get("hidebarafter")<i&&this.get("playing")&&!this.get("preventinteractionstatus")&&this.set("preventinteractionstatus",!0))),this.get("broadcasting")||(this.set("last_position_change_delta",e-this.get("last_position_change")),this.set("position",t),this.set("buffered",this.player.buffered()),0<(s=this.player.duration())&&s<Infinity?this.set("duration",this.player.duration()):this.set("duration",this.get("totalduration")||t)),this.get("hideoninactivity")&&this.get("activity_delta")>this.get("hidebarafter")&&this.set("settingsmenu_active",!1),this.__adsControlPosition<this.get("position"))&&!this.get("isseeking")&&(this.__adsControlPosition=Math.ceil(this.get("position")),this.__controlAdRolls())}catch(n){}try{this._updateCSSSize()}catch(n){}}},_updateCSSSize:function(){var e=(this.get("is_floating")&&this.get("with_sidebar")?u.elementDimensions(this.__playerContainer||this.activeElement()):u.elementDimensions(this.activeElement())).width;this.set("csssize",400<e?"normal":320<e?"medium":"small"),this.set("mobileview",e<this.get("mobilebreakpoint"))},videoHeight:function(){var e,t;return this.videoAttached()?this.player.videoHeight():(e=this.activeElement().querySelector("img"),h.is_defined(e)&&e.height?(t=window.innerHeight||document.body.clientHeight,e.height>t?t:e.height):NaN)},videoWidth:function(){var e,t;return this.videoAttached()?this.player.videoWidth():(e=this.activeElement().querySelector("img"),h.is_defined(e)&&e.width?(t=window.innerWidth||document.body.clientWidth,e.width>t?t:e.width):NaN)},hidePlayerContainer:function(){this.activeElement()&&!this.get("hidden")&&(this.set("hidden",!0),this.scopes.adsplayer&&this.scopes.adsplayer.execute("hideCompanionAd"),this.set("adsplayer_active",!1),this.get("playing"))&&this.pause()},showHiddenPlayerContainer:function(){this.floatHandler&&!this.floatHandler.destroyed()&&!1===this.floatHandler.observing&&this.floatHandler.resume(),this.get("hidden")&&(this.set("hidden",!1),this.get("playing")||this.play())},resetAdsPlayer:function(){this.get("adsplayer_active")&&this.set("adsplayer_active",!1),this.set("adsplayer_active",!0)},getNextOutstreamAdTagURLs:function(e){e=e||!1;var i=b.create();return 0===this.get("outstreamoptions.maxadstoshow")?i.asyncError("Limit of showing ads exceeded.",!0):(this.get("nextadtagurls")&&0<this.get("nextadtagurls").length||this.get("adtagurlfallbacks")&&0<this.get("adtagurlfallbacks").length?i.asyncSuccess((0<this.get("nextadtagurls").length?this.get("nextadtagurls"):this.get("adtagurlfallbacks")).shift()):A.eventually(function(){var e=this.requestForTheNextAdTagURL(),t="function"==typeof e.then;return h.is_function(this.requestForTheNextAdTagURL)?e[t?"then":"success"](function(e){return i.asyncSuccess(e)},this)[t?"catch":"error"](function(e){return i.asyncError(e)},this):console.log("Please define requestForTheNextAdTagURL method with Promise.")},this,e?100:this.get("outstreamoptions.recurrenceperiod")||3e4),i)},requestForTheNextAdTagURL:function(){var e=b.create();return e.asyncSuccess([]),e},setNextOutstreamAdTagURL:function(t,i,s){t=t||!1,this.getNextOutstreamAdTagURLs(t).success(function(e){if("string"==typeof e)this.set("adtagurl",e);else{if(!(e&&"function"==typeof e.shift&&0<e.length))return this.setNextOutstreamAdTagURL(t,i,s);this.set("adtagurl",e.shift()),0<e.length&&this.set("nextadtagurls",e)}return(!t&&this.scopes.adsplayer||this.get("adsmanagerloaded"))&&this.resetAdsPlayer(),i&&s?i.next(s):i.next("LoadAds",{position:"outstream"})},this).error(function(e,t){if(console.log("Error on getting next outstream tag",e),!t)return i.next("LoadPlayer")},this)},aspectRatio:function(){var e=this.videoHeight();return this.videoWidth()/e},isPortrait:function(){return this.aspectRatio()<1},isLandscape:function(){return!this.isPortrait()},parentWidth:function(){return u.elementDimensions(this.activeElement().parentElement).width},parentHeight:function(){return u.elementDimensions(this.activeElement().parentElement).height},parentAspectRatio:function(){return this.parentWidth()/this.parentHeight()},cloneAttrs:function(){return m.map(h.is_function(this.attrs)?this.attrs.call(this):this.attrs,function(e,t){return this.get(t)},this)},isBroadcasting:function(){return this.player&&this.player._broadcastingState&&this.player._broadcastingState.googleCastConnected},isHD:function(){if(this.videoAttached())return 921600<=this.videoWidth()*this.videoHeight();var e;if(null==this.get("stream")||""===this.get("stream"))e=this.get("video_data").default_stream;else for(var t=0;t<this.get("video_data").streams.length;t++)if(this.get("video_data").streams[t].token===this.get("stream"))return 921600<=this.get("video_data").streams[t].video_width*this.get("video_data").streams[t].video_height;return e?921600<=e.video_width*e.video_height:undefined},isSD:function(){return!this.isHD()},isMobile:function(){return o.isMobile()},popupAttrs:function(){return{autoplay:!0,popup:!1,width:this.get("popup-width"),height:this.get("popup-height")}},initAdSources:function(){var e;this.set("preloadadsmanager",!1),this.set("delayadsmanagerload",!1),Array.isArray(this.get("adtagurlfallbacks"))&&0<this.get("adtagurlfallbacks").length&&!this.get("adtagurl")&&!this.get("inlinevastxml")&&this.set("adtagurl",this.get("adtagurlfallbacks").shift()),this.set("adshassource",!!this.get("adtagurl")||!!this.get("inlinevastxml")),this.get("outstream")&&(this.set("disableadpreload",!1),this.set("autoplay",!0),this.set("skipinitial",!1),this.set("outstreamoptions",m.tree_merge(this.get("initialoptions").outstreamoptions,this.get("outstreamoptions"))),this.set("states.outstreamoptions",this.get("outstreamoptions"))),this.get("adshassource")&&(this.get("adsposition")?(this.set("adsplaypreroll",-1!==this.get("adsposition").indexOf("pre")),this.set("adsplaypostroll",-1!==this.get("adsposition").indexOf("post")),this.initMidRollAds()):this.set("vmapads",!0),this.set("preloadadsmanager",this.get("adsplaypreroll")||this.get("vmapads")||this.get("outstream")),e=this.get("skipinitial")&&!this.get("autoplay"),this.set("delayadsmanagerload",!this.get("preloadadsmanager")||e))},__mergeWithInitialOptions:function(){const i=this.get("initialoptions");i&&h.is_object(i)&&m.iter(i,function(e,t){null===e?this.set("initialoptions."+t,this.get(t)):h.is_defined(e)&&typeof i[t]==typeof this.get(t)&&(e&&this.types[t]&&-1<["json","array","object","jsonarray"].indexOf(this.types[t])&&i[t]&&0<m.count(i[t])?this.set(t,m.tree_merge(i[t],this.get(t))):h.is_object(e)||this.set(t,e))},this)},__mergeDeepAttributes:function(){m.iter(["floatingoptions","outstreamoptions","sidebaroptions"],function(e){h.is_object(this.get(e))&&this.set(e,m.tree_merge(this.attrs()[e],this.get(e)))},this)},__initFloatingOptions:function(){m.iter(["mobile","desktop"],function(i){var e,s=this.get("floatingoptions")[i];s&&s.size&&s.availablesizes&&(e=s.availablesizes,h.is_object(e))&&m.keyMap(e,function(e,t){if(h.is_string(s.size)&&t===s.size.toLowerCase())switch(i){case"mobile":this.set("floatingoptions.mobile.height",e);break;case"desktop":this.set("floatingoptions.desktop.height",e)}},this)},this)},__isInMobileViewport:function(){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=this.get("mobilebreakpoint")||h.is_undefined("mobileviewport")&&o.isMobile()},applyPresets:function(){var e=this.get("presetkey");if(e){var t=this.get("availablepresetoptions");if(h.is_object(t)&&t[e]){const s=e=>h.is_defined(this.attrs()[e])||h.is_string(e)&&e.split(".").some(e=>this.attrs()[e]),n=this.__isInMobileViewport();if(h.is_defined(this.get("initialoptions.mobilepresets")))n?0<m.count(this.get("initialoptions.mobilepresets"))&&m.iter(this.get("initialoptions.mobilepresets"),(e,t)=>s(t)&&this.set(t,e),this):m.iter(t[e],(e,t)=>s(t)&&this.set(t,e),this);else if(this.set("initialoptions.mobilepresets",{}),0<m.count(t)){const r=t[e];m.iter(r,function(e,t){var i=this.get(t);h.is_defined(r.mobile)&&s(t)&&(h.is_boolean(r.mobile)&&!1===r.mobile?this.set("initialoptions.mobilepresets."+t,i):h.is_object(r.mobile)&&r.mobile[t]&&(this.set("initialoptions.mobilepresets."+t,r.mobile[t]),n)&&this.set(t,r.mobile[t])),s(t)&&!n&&this.set(t,e)},this)}}else console.warn(`Make sure presetkey (${e}) is defined as object key, inside 'availablepresetoptions' hashed objects.`)}},__calculateFloatingDimensions:function(){var e,t,i,s,n,r,o,a,c={},l="string"==typeof this.get("aspect_ratio")?this.get("aspect_ratio").split("/"):1.77,d=this.__isInMobileViewport();return h.is_array(l)&&(l=l[0]/l[1]),l=Number(parseFloat(l).toFixed(2)),d?(c.floating_left=0,t="100%",(s=this.get("floatingoptions.mobile"))&&(e=+this.get("floatingoptions.mobile.height"),i=this.get("floatingoptions.mobile.position")),this.activeElement()&&this.activeElement().classList.add(this.get("csscommon")+"-full-width"),h.is_defined(this.get("floatingoptions.mobile.sidebar"))&&this.get("floatingoptions.sidebar")&&this.set("with_sidebar",this.get("floatingoptions.mobile.sidebar")),"object"==typeof this.get("floatingoptions.mobile.positioning")&&(r=this.get("floatingoptions.mobile.positioning.applySelector"),o=this.get("floatingoptions.mobile.positioning.relativeSelector"),a=g.camelCase(this.get("floatingoptions.mobile.positioning.applyProperty")||"margin-top"),"string"==typeof o)&&(n=(n=o?this.activeElement().querySelector(r):n)&&this.activeElement().firstChild,r=document.querySelector(o))&&n&&(o=u.elementDimensions(r).height,n.style[a]=o+"px")):((s=this.get("floatingoptions.desktop"))&&(i=s.position,e=+s.height),this.activeElement()&&this.activeElement().classList.remove(this.get("csscommon")+"-full-width"),h.is_defined(this.get("floatingoptions.desktop.sidebar"))&&this.get("floatingoptions.sidebar")&&this.set("with_sidebar",this.get("floatingoptions.desktop.sidebar"))),i&&m.iter(["top","right","bottom","left"],function(e){i.includes(e)&&(c["floating_"+e]=s[e]||0)},this),e=e?+parseFloat(e).toFixed(2):d?this.get("fallback-floating-mobile-height"):this.get("fallback-floating-desktop-height"),r=Number(parseFloat(1<l?l*e:e/l).toFixed(2)),this.get("with_sidebar")&&!d&&(t=r+Number(1<l?r:e)),c.floating_height=e,c.player_width=r,c.floating_width=t||r,c},__controlAdRolls:function(){var i,t,s,n;0<this.get("midrollads").length&&0<this.get("duration")&&!this._adsRollPositionsCollection?(this._adsRollPositionsCollection=this.auto_destroy(new d),0<this.get("midrollads").length&&(i=null,m.iter(this.get("midrollads"),function(e,t){e.position&&e.position>this.get("position")&&(e=e.position<1?Math.floor(this.get("duration")*e.position):e.position,Math.abs(e-i)>this.__adMinIntervals)&&(this.get("infiniteduration")||e<this.get("duration"))&&(i=e,_nextPositionIndex=t,this._adsRollPositionsCollection.add({position:e,duration:null,type:"linear",isLinear:!0,dimensions:{width:u.elementDimensions(this.activeElement()).width||this.parentWidth(),height:u.elementDimensions(this.activeElement()).height||this.parentHeight()}}))},this))):this.__adMinIntervals=0===this.__adMinIntervals?this.get("minadintervals"):this.__adMinIntervals-1,this._adsRollPositionsCollection&&!this._nextRollPosition&&(t=this._adsRollPositionsCollection.count(),s=null,0<t?(n={position:-1,nextPosition:this.get("duration"),nextIsLast:!0,type:null},this._adsRollPositionsCollection.iterate(function(e){t--,(n.position>e.get("position")&&n.type||-1===n.position)&&(n=(s=e).data()),this.get("position")>=e.get("position")&&this._adsRollPositionsCollection.remove(e),n.position&&n.type&&0===t&&s&&(this._nextRollPosition=n,this._adsRollPositionsCollection.remove(s))},this)):(this._adsRollPositionsCollection.destroy(),this._adsRollPositionsCollection=null)),this._nextRollPosition&&this.get("adshassource")&&this._nextRollPosition.position<this.get("position")&&(this.get("duration")-this.get("position")>this.get("midrollminintervalbeforeend")||this.get("infiniteduration"))&&(0<this.__adMinIntervals||(this.get("adsplayer_active")&&this.scopes.adsplayer&&this.brakeAdsManually(),this.trigger("playnextmidroll"),this._nextRollPosition=null))},__playedStats:function(e,t){t=Math.floor(e/t/.25);1<=Math.abs(this.get("last-seen-position")-e)&&(this.set("last-seen-position",e),this.set("played-seconds",this.get("played-seconds")+1),.2<this.get("volume"))&&this.set("last-played-position",this.get("last-played-position")+1),this.get("passed-quarter")!==t&&(this.set("passed-quarter",t),this.trigger("quarter-passed",t)),this.get("player-started")||this.set("player-started",!0)},_checkAutoPlay:function(e){(e=e||this.__video)&&(this.get("autoplay-requires-muted")||this.get("autoplay-requires-playsinline")||this.get("wait-user-interaction")||this.get("forciblymuted"))&&((this.get("autoplay-requires-muted")||this.get("forciblymuted"))&&(e.muted=!0),this.get("autoplay-requires-playsinline")&&(e.playsinline=!0),u.userInteraction(function(){this.set("autoplay",this.get("initialoptions").autoplay),this.get("unmuteonclick")||this.get("wait-user-interaction")&&this.get("autoplay")&&(this.__testAutoplayOptions(e),this.trigger("user-has-interaction")),this.set("forciblymuted",!1)},this))},_renderMultiCompanionAds:function(){this.set("multicompanionads",[]);const i=this.get("companionads");var e=this.get("companionad.locations");m.iter(e,function(e){const{selector:t,id:s,adslotid:n}=e;if(t&&(s||n)){const r=document.querySelector(t);r?m.map(i,function(e){var t,i=e.data?.content;i&&(t=new RegExp(`id=['"]${s}['"]`,"g").test(e.data?.content),Number(e.getAdSlotId())!==Number(n)&&!t||(r.innerHTML=e.getContent()||i,this.get("multicompanionads").push(r)))},this):console.warn("Non existing element for companion ad selector: "+t)}else console.warn("Please provide selector and adslotid for companion ad")},this)},brakeAdsManually:function(e){e=e||!1;var t=this.scopes.adsplayer;0<t.get("non-linear-min-suggestion")&&!this.get("linear")&&!e||(this.get("adscompleted")||t.get("linear")||this.channel("ads").trigger("allAdsCompleted"),this.stopAdsRenderFailTimeout(!0),this.set("adsplayer_active",!1))},__testAutoplayOptions:function(s){var n=!1,e=[{muted:!0,playsinline:!1},{muted:!0,playsinline:!0}];this.get("muted")||this.get("unmuteonclick")||e.push({muted:!1,playsinline:!1},{muted:!1,playsinline:!0}),m.iter(e,function(i,t){l.canAutoplayVideo(i).success(function(e,t){n||(this.get("autoplay-allowed")||this.set("autoplay-allowed",!!e.result),i.muted||i.playsinline||!e.result||(this.set("wait-user-interaction",!1),this.set("autoplay-requires-muted",!1),n=!0,s&&(i.playsinline?s.setAttribute("playsinline",""):s.removeAttribute("playsinline")),!this.get("playing")&&this.player&&this.player.play()),i.muted&&e.result&&(this.set("forciblymuted",!0),this.set("autoplay-requires-muted",!0),this.set("wait-user-interaction",!1),this.set("volume",0),this.set("muted",!0),n=!0,s&&(s.muted=i.muted),s&&(i.playsinline?s.setAttribute("playsinline",""):s.removeAttribute("playsinline")),!this.get("playing"))&&this.player&&this.player.play(),i.playsinline&&e.result&&(this.set("autoplay-requires-playsinline",!0),this.set("wait-user-interaction",!1),s&&(s.playsinline=!0),i.muted&&(this.set("forciblymuted",!0),this.set("autoplay-requires-muted",!0),s)&&(s.muted=!0),n=!0))},this).error(function(e){console.warn("Error :",e,i,t)},this)},this)},__attachPlayerInteractionEvents:function(){this.__bindedInteractionEvents=[],m.iter(this.__INTERACTION_EVENTS,function(e){var t=this.__setPlayerHadInteraction.bind(this);this.__bindedInteractionEvents.push({type:e,func:t}),this.auto_destroy(this.activeElement().addEventListener(e,t,{once:!1}))},this)},__removePlayerInteractionEvents:function(){m.count(this.__bindedInteractionEvents)<=0||m.iter(this.__INTERACTION_EVENTS,function(t){var e=this.__bindedInteractionEvents.filter(e=>e.type===t)[0];e&&e.func&&(this.__bindedInteractionEvents=this.__bindedInteractionEvents.filter(e=>e.type!==t),this.activeElement().removeEventListener(e.type||t,e.func))},this)},setPlayerEngagement:function(){this.get("userengagedwithplayer")||(this.set("userengagedwithplayer",!0),this.trigger("playerengaged"))},__setPlayerHadInteraction:function(){this.get("unmuteonclick")?this.get("userengagedwithplayer")||this.once("playerengaged",function(){this.__unmuteOnClick(),this.__removePlayerInteractionEvents()},this):(this.__removePlayerInteractionEvents(),this.get("userhadplayerinteraction")||(this.set("userhadplayerinteraction",!0),this.trigger("playerinteracted")))},__unmuteOnClick:function(){clearTimeout(this.get("clearDebounce"));var e=setTimeout(function(){if(!this.get("muted")&&0<this.get("volume"))return this.set("unmuteonclick",!1);this.auto_destroy(new y.Timer({delay:500,fire:function(){this.get("muted")&&(this.set("muted",!1),0<this.get("volume"))&&this.set_volume(this.get("volume")),0===this.get("volume")&&this.set_volume(this.get("volume")||this.get("initialoptions").volumelevel||1),this.get("manuallypaused")||this.setPlayerEngagement(),this.set("unmuteonclick",!1)}.bind(this),once:!0})),this.set("volumeafterinteraction",!0),this.get("forciblymuted")&&this.set("forciblymuted",!1)}.bind(this),1);this.set("clearDebounce",e)}}}],{playerStates:function(){return[C]}}).register("ba-videoplayer").registerFunctions({css:function(e){return e.css},cssplayer:function(e){return e.cssplayer},csssize:function(e){return e.csssize},iecss:function(e){return e.iecss},"ie8 ? 'ie8' : 'noie8'":function(e){return e.ie8?"ie8":"noie8"},csstheme:function(e){return e.csstheme},"fullscreened ? 'fullscreen' : 'normal'":function(e){return e.fullscreened?"fullscreen":"normal"},"firefox ? 'firefox' : 'common'":function(e){return e.firefox?"firefox":"common"},themecolor:function(e){return e.themecolor},"mobileview ? 'mobile' : 'desktop'":function(e){return e.mobileview?"mobile":"desktop"},"mobileviewport ? 'mobile' : 'desktop'":function(e){return e.mobileviewport?"mobile":"desktop"},"is_floating ? cssfloatingclasses : ''":function(e){return e.is_floating?e.cssfloatingclasses:""},"presetkey ? cssplayer + '-preset-' + presetkey : ''":function(e){return e.presetkey?e.cssplayer+"-preset-"+e.presetkey:""},"(sidebar_active && gallerysidebar) ? cssplayer + '-with-sidebar-gallery' : ''":function(e){return e.sidebar_active&&e.gallerysidebar?e.cssplayer+"-with-sidebar-gallery":""},"(sidebar_active && show_sidebar) ? cssplayer + '-with-sidebar' : csscommon + '-full-width'":function(e){return e.sidebar_active&&e.show_sidebar?e.cssplayer+"-with-sidebar":e.csscommon+"-full-width"},"cssplayer + (((activity_delta > hidebarafter) && hideoninactivity) ? '-controlbar-hidden' : '-controlbar-visible')":function(e){return e.cssplayer+(e.activity_delta>e.hidebarafter&&e.hideoninactivity?"-controlbar-hidden":"-controlbar-visible")},"user_activity()":function(e){return e.user_activity()},"user_activity(true)":function(e){return e.user_activity(!0)},containerSizingStyles:function(e){return e.containerSizingStyles},testid:function(e){return e.testid},"title || 'Video Player'":function(e){return e.title||"Video Player"},"description || 'Video Player'":function(e){return e.description||"Video Player"},uploaddate:function(e){return e.uploaddate},title:function(e){return e.title},thumbnailurl:function(e){return e.thumbnailurl},contenturl:function(e){return e.contenturl},playercontainerstyles:function(e){return e.playercontainerstyles},dynnext:function(e){return e.dynnext},"next_active && !playing_ad":function(e){return e.next_active&&!e.playing_ad},is_floating:function(e){return e.is_floating},layout:function(e){return e.layout},with_sidebar:function(e){return e.with_sidebar},playlist:function(e){return e.playlist},current_video_from_playlist:function(e){return e.current_video_from_playlist},position:function(e){return e.position},shownext:function(e){return e.shownext},noengagenext:function(e){return e.noengagenext},gallerysidebar:function(e){return e.gallerysidebar},tooltips:function(e){return e.tooltips},dyntooltip:function(e){return e.dyntooltip},"tooltip.tooltiptext":function(e){return e.tooltip.tooltiptext},tooltip:function(e){return e.tooltip},playing:function(e){return e.playing},adsplaying:function(e){return e.adsplaying},"(videoelement_active || !imageelement_active) && !silent_attach":function(e){return(e.videoelement_active||!e.imageelement_active)&&!e.silent_attach},csscommon:function(e){return e.csscommon},videofitstrategy:function(e){return e.videofitstrategy},"preload ? 'auto' : 'metadata'":function(e){return e.preload?"auto":"metadata"},"!playfullscreenonmobile":function(e){return!e.playfullscreenonmobile},"(imageelement_active && !videoelement_active) || silent_attach":function(e){return e.imageelement_active&&!e.videoelement_active||e.silent_attach},posteralt:function(e){return e.posteralt},posterfitstrategy:function(e){return e.posterfitstrategy},dynadsplayer:function(e){return e.dynadsplayer},adsplayer_active:function(e){return e.adsplayer_active},ad:function(e){return e.ad},addata:function(e){return e.addata},adsmanagerloaded:function(e){return e.adsmanagerloaded},adduration:function(e){return e.adduration},"adsunmuted ? volume : 0":function(e){return e.adsunmuted?e.volume:0},muted:function(e){return e.muted},unmuteonclick:function(e){return e.unmuteonclick},adtagurl:function(e){return e.adtagurl},adchoiceslink:function(e){return e.adchoiceslink},adsunmuted:function(e){return e.adsunmuted},inlinevastxml:function(e){return e.inlinevastxml},outstreamoptions:function(e){return e.outstreamoptions},adsquartile:function(e){return e.adsquartile},userhadplayerinteraction:function(e){return e.userhadplayerinteraction},controlbarstyles:function(e){return e.controlbarstyles},sidebar_active:function(e){return e.sidebar_active},imasettings:function(e){return e.imasettings},fullscreened:function(e){return e.fullscreened},"!adscontrolbar_active":function(e){return!e.adscontrolbar_active},hideadscontrolbar:function(e){return e.hideadscontrolbar},tmpladscontrolbar:function(e){return e.tmpladscontrolbar},dynadscontrolbar:function(e){return e.dynadscontrolbar},companionad:function(e){return e.companionad},companionads:function(e){return e.companionads},"(activity_delta > hidebarafter) && hideoninactivity":function(e){return e.activity_delta>e.hidebarafter&&e.hideoninactivity},view_type:function(e){return e.view_type},adnotpaused:function(e){return e.adnotpaused},showlearnmorebutton:function(e){return e.showlearnmorebutton},moredetailslink:function(e){return e.moredetailslink},moredetailstext:function(e){return e.moredetailstext},mobileview:function(e){return e.mobileview},floatingoptions:function(e){return e.floatingoptions},mobileviewport:function(e){return e.mobileviewport},"adchoicesontop && !gallerysidebar":function(e){return e.adchoicesontop&&!e.gallerysidebar},presetedtooltips:function(e){return e.presetedtooltips},showadchoices:function(e){return e.showadchoices},imaadsrenderingsetting:function(e){return e.imaadsrenderingsetting},adsrendertimeout:function(e){return e.adsrendertimeout},"hasplaceholderstyle ? (css + '-overlay-with-placeholder') : ''":function(e){return e.hasplaceholderstyle?e.css+"-overlay-with-placeholder":""},"!showbuiltincontroller && !outstream && !adsplaying":function(e){return!e.showbuiltincontroller&&!e.outstream&&!e.adsplaying},placeholderstyle:function(e){return e.placeholderstyle},"seek(position + skipseconds)":function(e){return e.seek(e.position+e.skipseconds)},"seek(position - skipseconds)":function(e){return e.seek(e.position-e.skipseconds)},"seek(position + skipseconds * 3)":function(e){return e.seek(e.position+3*e.skipseconds)},"seek(position - skipseconds * 3)":function(e){return e.seek(e.position-3*e.skipseconds)},"set_volume(volume + 0.1)":function(e){return e.set_volume(e.volume+.1)},"set_volume(volume - 0.1)":function(e){return e.set_volume(e.volume-.1)},"toggle_player(true)":function(e){return e.toggle_player(!0)},dyntrimmer:function(e){return e.dyntrimmer},"trimmingmode && videoelement_active":function(e){return e.trimmingmode&&e.videoelement_active},starttime:function(e){return e.starttime},endtime:function(e){return e.endtime},timeminlimit:function(e){return e.timeminlimit},duration:function(e){return e.duration},source:function(e){return e.source},dyncontrolbar:function(e){return e.dyncontrolbar},"csscontrolbar || css":function(e){return e.csscontrolbar||e.css},"cssplayer || css":function(e){return e.cssplayer||e.css},"csstheme || css":function(e){return e.csstheme||e.css},controlbar_logo:function(e){return e.controlbar_logo},tmplcontrolbar:function(e){return e.tmplcontrolbar},"controlbar_active && !hidecontrolbar":function(e){return e.controlbar_active&&!e.hidecontrolbar},showcontroll:function(e){return e.showcontroll},playwhenvisible:function(e){return e.playwhenvisible},playerspeeds:function(e){return e.playerspeeds},playercurrentspeed:function(e){return e.playercurrentspeed},airplay:function(e){return e.airplay},airplaybuttonvisible:function(e){return e.airplaybuttonvisible},chromecast:function(e){return e.chromecast},castbuttonvisble:function(e){return e.castbuttonvisble},tabindex:function(e){return e.tabindex},showchaptertext:function(e){return e.showchaptertext},chapterslist:function(e){return e.chapterslist},tracktextvisible:function(e){return e.tracktextvisible},tracktags:function(e){return e.tracktags},"hassubtitles && tracktagssupport":function(e){return e.hassubtitles&&e.tracktagssupport},allowtexttrackupload:function(e){return e.allowtexttrackupload},tracksshowselection:function(e){return e.tracksshowselection},volume:function(e){return e.volume},buffered:function(e){return e.buffered},prominent_title:function(e){return e.prominent_title},closeable_title:function(e){return e.closeable_title},activity_delta:function(e){return e.activity_delta},hasnext:function(e){return e.hasnext},hideoninactivity:function(e){return e.hideoninactivity},hidebarafter:function(e){return e.hidebarafter},rerecordable:function(e){return e.rerecordable},submittable:function(e){return e.submittable},frameselectionmode:function(e){return e.frameselectionmode},streams:function(e){return e.streams},currentstream:function(e){return e.currentstream},"fullscreensupport && !nofullscreen":function(e){return e.fullscreensupport&&!e.nofullscreen},disablepause:function(e){return e.disablepause},disableseeking:function(e){return e.disableseeking},skipseconds:function(e){return e.skipseconds},skipinitial:function(e){return e.skipinitial},showsettingsmenu:function(e){return e.showsettingsmenu},settingsmenu_active:function(e){return e.settingsmenu_active},hidevolumebar:function(e){return e.hidevolumebar},manuallypaused:function(e){return e.manuallypaused},isseeking:function(e){return e.isseeking},dyntracks:function(e){return e.dyntracks},"csstracks || css":function(e){return e.csstracks||e.css},"tracktagssupport || allowtexttrackupload":function(e){return e.tracktagssupport||e.allowtexttrackupload},trackselectorhovered:function(e){return e.trackselectorhovered},tracktagsstyled:function(e){return e.tracktagsstyled},trackcuetext:function(e){return e.trackcuetext},uploadtexttracksvisible:function(e){return e.uploadtexttracksvisible},acceptedtracktexts:function(e){return e.acceptedtracktexts},uploadlocales:function(e){return e.uploadlocales},dynsettingsmenu:function(e){return e.dynsettingsmenu},tmplsettingsmenu:function(e){return e.tmplsettingsmenu},toggle_settings_menu:function(e){return e.toggle_settings_menu},toggle_share:function(e){return e.toggle_share},dynplaybutton:function(e){return e.dynplaybutton},"cssplaybutton || css":function(e){return e.cssplaybutton||e.css},tmplplaybutton:function(e){return e.tmplplaybutton},playbutton_active:function(e){return e.playbutton_active},trimmingmode:function(e){return e.trimmingmode},showduration:function(e){return e.showduration},dynloader:function(e){return e.dynloader},"cssloader || css":function(e){return e.cssloader||e.css},tmplloader:function(e){return e.tmplloader},loader_active:function(e){return e.loader_active},dynshare:function(e){return e.dynshare},"cssshare || css":function(e){return e.cssshare||e.css},tmplshare:function(e){return e.tmplshare},"sharevideourl && sharevideo.length > 0 && share_active":function(e){return e.sharevideourl&&0<e.sharevideo.length&&e.share_active},share_active:function(e){return e.share_active},sharevideourl:function(e){return e.sharevideourl},sharevideo:function(e){return e.sharevideo},dynmessage:function(e){return e.dynmessage},"cssmessage || css":function(e){return e.cssmessage||e.css},tmplmessage:function(e){return e.tmplmessage},message_active:function(e){return e.message_active},message:function(e){return e.message},dyntopmessage:function(e){return e.dyntopmessage},"csstopmessage || css":function(e){return e.csstopmessage||e.css},tmpltopmessage:function(e){return e.tmpltopmessage},topmessage:function(e){return e.topmessage},useAspectRatioFallback:function(e){return e.useAspectRatioFallback},aspectRatioFallback:function(e){return e.aspectRatioFallback},show_sidebar:function(e){return e.show_sidebar},sidebarstyles:function(e){return e.sidebarstyles},dynsidebar:function(e){return e.dynsidebar},"next_active ? '' : title || 'Video Player'":function(e){return e.next_active?"":e.title||"Video Player"},sidebaroptions:function(e){return e.sidebaroptions},floatingsidebar:function(e){return e.floatingsidebar},showsidebargallery:function(e){return e.showsidebargallery},linear:function(e){return e.linear},next_active:function(e){return e.next_active},unknownadsrc:function(e){return e.unknownadsrc},"!fullscreened && is_floating && floatingoptions.closeable":function(e){return!e.fullscreened&&e.is_floating&&e.floatingoptions.closeable},"close_floating()":function(e){return e.close_floating()}}).attachStringTable(t.strings).addStrings({"video-error":"An error occurred, please try again later. Click to retry.","all-settings":"All settings","player-speed":"Player speed","full-screen":"Full screen"})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.State",["base:States.State","base:Events.ListenMixin","base:Objs"],function(e,t,i,s){return e.extend({scoped:s},[t,{dynamics:["loader"],_start:function(){this.dyn=this.host.dynamic,i.iter(i.extend({adscontrolbar:!1,loader:!1,message:!1,playbutton:!1,controlbar:!1},i.objectify(this.dynamics)),function(e,t){this.dyn.set(t+"_active",e)},this),this.dyn.parent()&&this.dyn.parent().record!==undefined&&this.dyn.parent().host!==undefined&&(this.dyn._isRecorder=!0,this.dyn._recorderDyn=this.dyn.parent(),this.dyn._recorderHost=this.dyn._recorderDyn.host),this._started()},_started:function(){},play:function(){this.dyn.set("autoplay",!0)},uploadTextTrack:function(e,t){try{this.next("TextTrackUploading",{file:e,locale:t})}catch(i){console.warn("Error switch to text track uploading state. Message: ",i),this.nextPlayer()}},nextPlayer:function(){var e=this.dyn.parent();"function"==typeof e.record?e.host.state().next("Player"):this.next("LoadPlayer")},nextToChooser:function(e){var t=this.dyn;return!!t._isRecorder&&"function"==typeof t._recorderHost.next&&(t._recorderHost.next("FatalError",{message:e,retry:"Chooser"}),!0)}}])}),e.define("module:VideoPlayer.Dynamics.PlayerStates.TextTrackUploading",["module:VideoPlayer.Dynamics.PlayerStates.State","browser:Upload.FileUploader","browser:Upload.MultiUploader","browser:Blobs","base:Async","base:Objs"],function(e,a,t,c,i,l,s){return e.extend({scoped:s},{_locals:["file","locale"],dynamics:["text-tracks","loading"],_started:function(){this.uploadTextTrackFile(this._file,this._locale)},uploadTextTrackFile:function(e,i){var t,s,n,r=this.dyn.parent();"function"!=typeof r.record&&(r=this.dyn),s=r.get("tracktags"),filename=r.get("uploadoptions")?{url:r.get("uploadoptions").textTracks}:{url:"/text-track/"+e.value.split(/(\\|\/)/g).pop()+"/lang/"+i.lang+"/label/"+i.label};try{(t=a.create(l.extend({source:e,data:{lang:i.lang,label:i.label}},filename))).upload(),t.on("success",function(t){n=1,r.set("tracktags",null),c.loadFileIntoString(e).success(function(e){t=0<t.length?JSON.parse(t):{lang:i.lang,label:i.label},s.push({lang:t.lang,label:t.label,kind:"subtitles",enabled:!0,content:e}),l.iter(s,function(e){n===s.length&&(r.set("tracktags",s),this.nextPlayer()),n++},this)},this)},this),t.on("error",function(e){var i=r.string("uploading-failed");try{e.forEach(function(e){for(var t in e)r.string("upload-error-"+t)&&(i=this.dyn.string("upload-error-"+t))},this)}catch(t){}r.set("player_active",!1),this.next("FatalError",{message:i,retry:"Player"})},this),t.on("progress",function(e,t){},this)}catch(o){console.warn("Error occurred during uploading text track files. Message: ",o)}}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.FatalError",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["message"],_locals:["message"],_started:function(){this.dyn.set("message",this._message||this.dyn.string("video-error"))}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.Initial",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.set("imageelement_active",!1),this.dyn.set("videoelement_active",!1),this.dyn.get("ready")?this.next("LoadPlayer"):(this.listenOn(this.dyn,"change:ready",function(){this.next("LoadPlayer")},this),this.listenOn(this.dyn,"error:initialize",function(){this.next("LoadError")},this))}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.LoadPlayer",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.get("outstream")?this.next("Outstream"):(this.listenOn(this.dyn,"error:poster",function(){this.next("LoadPlayerDirectly")},this),this.listenOn(this.dyn,"image-attached",function(){this.next("PosterReady")},this),this.dyn.reattachImage())}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.LoadPlayerDirectly",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.listenOn(this.dyn,"error:attach",function(){this.next("LoadError")},this),this.listenOn(this.dyn,"error:poster",function(){this.dyn.get("states").poster_error.ignore||this.next("PosterError")},this),this.listenOn(this.dyn,"attached",function(){this.next("PosterReady")},this),this.dyn.reattachVideo()}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.LoadError",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["message"],_started:function(){this.dyn.set("message",this.dyn.string("video-error")),this.listenOn(this.dyn,"message:click",function(){this.dyn.trigger("error:reloadplayer"),this.next("Initial")},this)}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.PosterReady",["module:VideoPlayer.Dynamics.PlayerStates.State","module:PopupHelper","base:Objs","base:Types","browser:Dom"],function(e,i,s,t,n,r){return e.extend({scoped:r},{dynamics:["playbutton"],_started:function(){this.dyn.set("placeholderstyle",""),!this.dyn.get("skipinitial")&&this.dyn.get("preload")&&this.dyn._attachVideo(!0),this.dyn.trigger("ready_to_play"),this.dyn.trigger("loaded"),this.listenOn(this.dyn,"error:poster",function(){this.dyn.get("states").poster_error.ignore||this.dyn.get("popup")||this.next("PosterError")},this),this.dyn&&this.dyn.get("skipinitial")?this.play():this.dyn&&this.dyn.get("autoplay")&&(this.dyn.get("autoplaywhenvisible")?n.onScrollIntoView(this.dyn.activeElement(),this.dyn.get("visibilityfraction"),function(){this.destroyed()||this.runAutoplay()},this):this.runAutoplay())},play:function(){var e,t;this.dyn.get("popup")?(e=this.auto_destroy(new i),t=this.auto_destroy(new this.dyn.cls({element:e.containerInner,attrs:s.extend(this.dyn.cloneAttrs(),this.dyn.popupAttrs())})),this._delegatedPlayer=t,this.dyn.delegateEvents(null,t),e.on("hide",function(){this._delegatedPlayer=null,t.destroy(),e.destroy()},this),e.show(),t.activate()):this.next("LoadAds",{position:"pre"})},runAutoplay:function(){t.is_defined(this.dyn.get("wait-user-interaction"))?this.dyn.get("wait-user-interaction")?this.dyn.once("user-has-interaction",function(){this.play()},this):this.play():(this.dyn.videoAttached()||this.dyn.get("adsplayer_active")||this.dyn.reattachVideo(),this.listenOn(this.dyn,"change:wait-user-interaction",function(e){e?this.dyn.once("user-has-interaction",function(){this.play()},this):this.play()},this))}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.Outstream",["module:VideoPlayer.Dynamics.PlayerStates.State","browser:Dom"],function(e,t,i){return e.extend({scoped:i},{dynamics:[],_started:function(){if(!this.dyn.get("adshassource"))return this.dyn.get("floatingoptions.floatingonly")||"is_floating"===this.dyn.get("view_type")?this.dyn.execute("close_floating"):"function"==typeof this.dyn.activeElement&&this.dyn.hidePlayerContainer(),console.warn("Please provide ad source for the outstream"),this.dyn.setNextOutstreamAdTagURL(!0,this,"LoadPlayer");this.listenOn(this.dyn.channel("ads"),"ad-error",function(){this.dyn.get("outstream")?(this.dyn.hidePlayerContainer(),this.dyn.get("nextadtagurls")&&0<this.dyn.get("nextadtagurls").length||this.dyn.get("adtagurlfallbacks")&&0<this.dyn.get("adtagurlfallbacks").length?(this.dyn.set("adtagurl",(0<this.dyn.get("nextadtagurls").length?this.dyn.get("nextadtagurls"):this.dyn.get("adtagurlfallbacks")).shift()),this.dyn.scopes.adsplayer.execute("requestAds")):this.dyn.setNextOutstreamAdTagURL(!1,this)):this.dyn.get("adtagurlfallbacks")&&0<this.dyn.get("adtagurlfallbacks").length?(this.dyn.set("adtagurl",this.dyn.get("adtagurlfallbacks").shift()),this.dyn.scopes.adsplayer.execute("requestAds")):this.next(this._nextState())},this),this.dyn.get("adsmanagerloaded")?this._nextState():(this.dyn.get("adsplayer_active")||this.dyn.set("adsplayer_active",!0),this.listenOn(this.dyn.channel("ads"),"adsManagerLoaded",function(){this._nextState()},this))},_nextState:function(){this.dyn.get("is_floating")||this.dyn.get("userhadplayerinteraction")?this.destroyed()||this.next("LoadAds",{position:"outstream"}):t.onScrollIntoView(this.dyn.activeElement(),this.dyn.get("visibilityfraction"),function(){this.destroyed()||this.next("LoadAds",{position:"outstream"})},this)}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.LoadAds",["module:VideoPlayer.Dynamics.PlayerStates.State","browser:Info"],function(e,t,i){return e.extend({scoped:i},{dynamics:["loader"],_locals:["position"],_started:function(){this.dyn.get("adshassource")?this._triggerLoadAds()?this.dyn.get("fullscreened")&&t.isMobile()&&t.isiOS()?(this.dyn.get("adsplayer_active")&&this.dyn.set("adsplayer_active",!1),this.next("LoadVideo")):(this.dyn.get("adsplayer_active")||this.dyn.set("adsplayer_active",!0),this.dyn.channel("ads").trigger("load"),this.listenOn(this.dyn.channel("ads"),"contentResumeRequested",function(){this.dyn.get("adtagurlfallbacks")&&0<this.dyn.get("adtagurlfallbacks").length&&(this.dyn.set("adtagurl",this.dyn.get("adtagurlfallbacks").shift()),this.dyn.scopes.adsplayer.execute("requestAds")),this.next(this._nextState())},this),this.listenOn(this.dyn.channel("ads"),"loaded",function(){this.next(this._nextState())},this),this.listenOn(this.dyn.channel("ads"),"log",function(e){e.getAdData().adError&&this.dyn.get("adtagurlfallbacks")&&0!==this.dyn.get("adtagurlfallbacks").length&&(this.dyn.set("adtagurl",this.dyn.get("adtagurlfallbacks").shift()),this.dyn.brakeAdsManually(),this.dyn.get("adsplayer_active")||this.dyn.set("adsplayer_active",!0),this.listenOnce(this.dyn.channel("ads"),"adsManagerLoaded",function(){this.next("LoadAds",{position:this._position})}.bind(this)))},this),this.listenOn(this.dyn.channel("ads"),"ad-error",function(){this.dyn.get("outstream")?(this.dyn.hidePlayerContainer(),this.dyn.setNextOutstreamAdTagURL(!1,this)):this.dyn.get("adtagurlfallbacks")&&0<this.dyn.get("adtagurlfallbacks").length?(this.dyn.set("adtagurl",this.dyn.get("adtagurlfallbacks").shift()),this.dyn.scopes.adsplayer.execute("requestAds")):this.next(this._nextState())},this)):this.next("LoadVideo"):this.next(this._nextState())},_nextState:function(){return this._position&&"outstream"===this._position?"PlayOutstream":this._position&&"mid"===this._position?"PlayVideo":"LoadVideo"},_triggerLoadAds:function(){return"undefined"!=typeof this._position&&("outstream"===this._position||"mid"===this._position||"pre"===this._position)||!this.dyn.get("delayadsmanagerload")}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.PlayOutstream",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["adscontrolbar"],_started:function(){this.dyn.showHiddenPlayerContainer(),(this.dyn.get("sticky")||this.dyn.get("floating"))&&this.dyn.floatHandler&&this.dyn.floatHandler.start(),this.dyn.channel("ads").trigger("outstreamStarted",this.dyn),this.listenOn(this.dyn.channel("ads"),"allAdsCompleted",function(){this.afterAdCompleted()},this),this.listenOn(this.dyn.channel("ads"),"contentResumeRequested",function(){this.afterAdCompleted()},this),0<this.dyn.get("outstreamoptions.maxadstoshow")&&this.dyn.set("outstreamoptions.maxadstoshow",this.dyn.get("outstreamoptions.maxadstoshow")-1),this.listenOn(this.dyn.channel("ads"),"replayOutstream",function(){this.dyn.__repeatOutstream=!0,this.dyn.set("adsplayer_active",!1),this.next("Outstream")}.bind(this))},afterAdCompleted:function(){this.dyn&&(0!==this.dyn.get("outstreamoptions.maxadstoshow")?this.dyn.setNextOutstreamAdTagURL(!1,this,"LoadPlayer"):this.dyn.get("outstreamoptions.hideOnCompletion")&&this.dyn.hidePlayerContainer(),this.dyn.trigger("outstream-completed"),this.dyn)&&this.dyn.channel("ads").trigger("outstreamCompleted",this.dyn)}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.PosterError",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["message"],_started:function(){this.dyn.set("message",this.dyn.string("video-error")),this.listenOn(this.dyn,"message:click",function(){this.next(this.dyn.get("states").poster_error.click_play?"LoadVideo":"LoadPlayer")},this)}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.LoadVideo",["module:VideoPlayer.Dynamics.PlayerStates.State","browser:Info","browser:Dom","base:Timers.Timer"],function(e,t,i,s,n){return e.extend({scoped:n},{dynamics:["loader"],_started:function(){this.listenOn(this.dyn.channel("ads"),"contentPauseRequested",function(){this.next("PrerollAd")},this),this.dyn.set("hasnext",this.dyn.get("loop")||this.dyn.get("loopall")||this.dyn.get("playlist")&&this.dyn.get("current_video_index_from_playlist")!==this.dyn.get("playlist").length-1),this.dyn.get("videoelement_active")?this.__loadVideo():(this.listenOn(this.dyn,"error:attach",function(){this.next("LoadError")},this),this.listenOn(this.dyn,"error:poster",function(){this.dyn.get("states").poster_error.ignore||this.next("PosterError")},this),this.listenOn(this.dyn,"attached",function(){this.__loadVideo()},this),this.dyn.reattachVideo())},__loadVideo:function(){var e;this.listenOn(this.dyn,"error:video",function(){this.next("ErrorVideo")},this),this.listenOn(this.dyn,"playing",function(){this.destroyed()||this.dyn.destroyed()||(this.dyn.get("autoseek")&&this.dyn.execute("seek",this.dyn.get("autoseek")),this.next("PlayVideo"))},this),this.dyn.get("skipinitial")&&!this.dyn.get("autoplay")?this.next("PlayVideo"):(e=10,this.__started=!1,this.auto_destroy(new s({context:this,fire:function(){this.destroyed()||this.dyn.destroyed()||!this.dyn.player||this.__started||(this.dyn.player.play(),this.__started=!0),0===--e&&this.next("PlayVideo")},delay:200,immediate:!0})))}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.ErrorVideo",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["message"],_started:function(){this.dyn.set("message",this.dyn.string("video-error")),this.listenOn(this.dyn,"message:click",function(){this.nextToChooser(this.dyn.get("message"))||this.next("LoadVideo")},this)}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.PlayVideo",["module:VideoPlayer.Dynamics.PlayerStates.State","base:Objs","base:Timers.Timer"],function(e,t,i,s){return e.extend({scoped:s},{dynamics:["controlbar"],_started:function(){this.dyn.set("autoplay",!1),this.dyn.get("adshassource")&&(this.listenOn(this.dyn.channel("ads"),"contentPauseRequested",function(){this.dyn.pause(),0===this.dyn.getCurrentPosition()?this.next("PrerollAd"):Math.abs(this.dyn.getCurrentPosition()-this.dyn.get("duration"))<.1?this.next("PostrollAd"):this.next("MidrollAd")},this),this.listenOn(this.dyn,"playnextmidroll",function(){this.dyn.get("adsplayer_active")||this.dyn.set("adsplayer_active",!0),this.listenOnce(this.dyn.channel("ads"),"adsManagerLoaded",function(){this.dyn.channel("ads").trigger("load")})},this)),this.dyn.get("loop")&&this.dyn.set("skipinitial",!0),this.listenOn(this.dyn,"change:currentstream",function(){this.dyn.set("autoplay",!0),this.dyn.set("autoseek",this.dyn.player.position()),this.dyn.reattachVideo(),this.next("LoadPlayer")},this),this.__listeningOnPlayNext=!0,this.listenOn(this.dyn,"play_next",function(){this.next("NextVideo")},this),this.listenOn(this.dyn,"ended",function(){this.dyn&&(this.dyn.set("autoseek",null),this.dyn.channel("ads").trigger("contentComplete"),this.auto_destroy(new i({once:!0,fire:function(){this.next("NextVideo")}.bind(this),delay:50})))},this),this.listenOn(this.dyn,"change:buffering",function(){this.dyn.set("loader_active",this.dyn.get("buffering"))},this),this.listenOn(this.dyn,"error:video",function(){this.next("ErrorVideo")},this)},play:function(){!this.dyn.get("disableadpreload")&&this.dyn.get("preloadadsmanager")&&0===this.dyn.get("position")?this.next("LoadAds",{position:"pre"}):this.dyn.player.play()}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.PlayAd",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},function(t){return{dynamics:["adscontrolbar"],_started:function(){if("PlayAd"===this.state_name())throw Error("PlayAd should be an abstract state.");this.dyn.set("playing_ad",!0),this.dyn.get("playing")?this.pause():this.listenOn(this.dyn,"playing",function(){this.pause()},this),this.listenOn(this.dyn.channel("ads"),"log",function(e){e.getAdData().adError&&this.dyn.get("adtagurlfallbacks")&&0!==this.dyn.get("adtagurlfallbacks").length&&(this.dyn.set("adtagurl",this.dyn.get("adtagurlfallbacks").shift()),this.dyn.brakeAdsManually(),this.dyn.get("adsplayer_active")||this.dyn.set("adsplayer_active",!0),this.listenOnce(this.dyn.channel("ads"),"adsManagerLoaded",function(){this.next("LoadAds",{position:this._position})}.bind(this)))},this),this.listenOn(this.dyn.channel("ads"),"ad-error",function(){if(!this.dyn.get("adtagurlfallbacks")||0===this.dyn.get("adtagurlfallbacks").length)return this.resume();this.dyn.set("adtagurl",this.dyn.get("adtagurlfallbacks").shift()),this.dyn&&this.dyn.player&&this.dyn.player.play(),this.dyn.brakeAdsManually(),this.dyn.get("adsplayer_active")||this.dyn.set("adsplayer_active",!0),this.listenOnce(this.dyn.channel("ads"),"adsManagerLoaded",function(){this.next("LoadAds",{position:this._position})}.bind(this))},this),this.listenOn(this.dyn.channel("ads"),"contentResumeRequested",function(){this.resume()},this)},resume:function(){this.dyn&&this.dyn.player&&this.dyn.player.play(),this.next("PlayVideo")},next:function(e){this.dyn.set("playing_ad",!1),t.next.call(this,e)},pause:function(){this.dyn.player.pause()}}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.PrerollAd",["module:VideoPlayer.Dynamics.PlayerStates.PlayAd"],function(e,t){return e.extend({scoped:t},function(e){return{_started:function(){(this.dyn.get("sticky")||this.dyn.get("floating"))&&this.dyn.floatHandler&&this.dyn.floatHandler.start(),e._started.call(this)}}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.MidrollAd",["module:VideoPlayer.Dynamics.PlayerStates.PlayAd"],function(e,t){return e.extend({scoped:t})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.PostrollAd",["module:VideoPlayer.Dynamics.PlayerStates.PlayAd"],function(e,t){return e.extend({scoped:t},{resume:function(){this.next("NextVideo")}})}),e.define("module:VideoPlayer.Dynamics.PlayerStates.NextVideo",["module:VideoPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{_started:function(){var e,t;return console.log("_started: "),this.dyn.set("autoplay",this.dyn.get("continuousplayback")),this.dyn.set("playbackcount",this.dyn.get("playbackcount")+1),this.dyn.get("playlist")&&0<this.dyn.get("playlist").length?(this._resetPlayerAttrs(),this.dyn.get("current_video_from_playlist")===(e=this.dyn.get("next_video_from_playlist"))&&this.dyn.set("next_video_from_playlist",++e),e%=this.dyn.get("playlist").length,this.dyn.set("next_video_from_playlist",e),this.dyn.get("lastplaylistindex")===e?this.dyn.set("lastplaylistitem",!0):this.dyn.set("lastplaylistitem",this.dyn.get("current_video_from_playlist")===this.dyn.get("playlist").length-1),this.dyn.set("hasnext",this.dyn.get("loop")||this.dyn.get("loopall")||!this.dyn.get("lastplaylistitem")),t=this.dyn.get("playlist")[e],console.log("playlist: "+JSON.stringify(this.dyn.get("playlist"))),this.dyn.set("current_video_from_playlist",e),this.dyn.setAll(t),this.dyn.get("lastplaylistitem")&&(0===this.dyn.get("next_video_from_playlist")&&this.dyn.set("autoplay",this.dyn.get("loop")),this.dyn.trigger("last-playlist-item")),this._playNext(t)):(this.dyn.get("loopall")&&(this.dyn.set("loop",!0),this.dyn.set("autoplay",!0),this.dyn.reattachVideo()),this.dyn.get("autoplay")&&this.dyn.get("adshassource")?this.__resetAdPlayer():void this.next("PosterReady"))},_resetPlayerAttrs:function(){this.dyn.set("passed-quarter",0),this.dyn.set("played-seconds",0),this.dyn.set("last-played-position",0),this.dyn.set("currentstream",{}),this.dyn.set("sources",[])},_playNext:function(e){this.dyn.trigger("playlist-next",e),this.dyn.get("adshassource")?this.__resetAdPlayer(!0):this.next("LoadPlayerDirectly")},__resetAdPlayer:function(e){e=e||!1,this.dyn.initAdSources(),this.dyn.brakeAdsManually(!0),this.dyn.set("adsplayer_active",!0),e&&this.dyn.reattachVideo(),this.dyn.player&&this.dyn.player._element&&(this.dyn.player._element.currentTime=0),this.next("LoadAds")}})}),e.define("module:VideoPlayer.Dynamics.Share",["dynamics:Dynamic","module:Assets"],function(e,t,i){var s={facebook:"https://facebook.com/sharer/sharer.php?u=",gplus:"https://plus.google.com/share?url=",linkedin:"https://www.linkedin.com/sharing/share-offsite/?url=",twitter:"https://twitter.com/intent/tweet?text="};return e.extend({scoped:i},function(e){return{template:'<div class="{{cssplayer}}-share-action-container">\n    <div class="{{cssplayer}}-toggle-share-container">\n        <div class="{{cssplayer}}-button-inner" onclick="{{toggleShare()}}">\n            <i class="{{csscommon}}-icon-share"></i>\n        </div>\n    </div>\n    <div class="{{cssplayer}}-social-buttons-container">\n        <ul class="{{cssplayer}}-socials-list" ba-repeat="{{share :: shares}}">\n            <li class="{{cssplayer}}-single-social">\n                <div class="{{cssplayer}}-button-inner">\n                    <i class="{{csscommon}}-icon-{{share}}" onclick="{{shareMedia(share)}}"></i>\n                </div>\n            </li>\n        </ul>\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",url:"",shares:[]},functions:{shareMedia:function(e){window.open(s[e]+this.get("url"),"pop","width=600 height=400")},toggleShare:function(){}}}}).register("ba-videoplayer-share").registerFunctions({cssplayer:function(e){return e.cssplayer},"toggleShare()":function(e){return e.toggleShare()},csscommon:function(e){return e.csscommon},shares:function(e){return e.shares},share:function(e){return e.share},"shareMedia(share)":function(e){return e.shareMedia(e.share)}}).attachStringTable(t.strings).addStrings({share:"Share media"})}),e.define("module:VideoPlayer.Dynamics.Sidebar",["dynamics:Dynamic","base:Objs","base:Async","base:Types","base:Functions","browser:Dom","module:Assets","base:Timers.Timer","module:StylesMixin","browser:DomMutation.MutationObserverNodeInsertObserver"],["module:Common.Dynamics.Spinner","module:Ads.Dynamics.ChoicesLink","module:Ads.Dynamics.LearnMoreButton","module:Common.Dynamics.CircleProgress"],function(e,c,i,n,s,l,t,r,o,a,d){return e.extend({scoped:d},[o,function(t){return{template:'<div ba-if="{{states.gallerysidebar}}"\n     ba-show="{{gallerysidebar}}"\n     class="{{csscommon}}-full-height {{csscommon}}-flex-column"\n>\n    <div class="{{cssgallerysidebar}}-header-container">\n        <div class="{{cssgallerysidebar}}-title">\n            <span ba-if="{{!adsplaying}}">{{gallerytitletext}}</span>\n        </div>\n        <div ba-if="{{ headerlogoimgurl }}"\n             class="{{cssgallerysidebar}}-header-logo"\n        >\n            <a href="{{headerlogourl || headerlogoimgurl }}" title="{{ headerlogoname }}" target="_blank">\n                <img ba-prop:src="{{ headerlogoimgurl }}" alt="{{headerlogoname}}" />\n            </a>\n        </div>\n    </div>\n\n    <div ba-if="{{adsplaying}}" class="{{cssgallerysidebar}}-container {{cssgallerysidebar}}-ads-container">\n        <div class="{{cssgallerysidebar}}-ads-body-container">\n            <div ba-if="{{afteradsendtext}}" class="{{cssgallerysidebar}}-ad-information-text">\n                <p>\n                    {{afteradsendtext}}\n                </p>\n            </div>\n            <div ba-if="{{companionadcontent}}"\n                 class="{{cssfloatingsidebar}}-companion-container"\n            ></div>\n            <div ba-if="{{showlearnmorebutton && !companionadcontent}}">\n                <ba-ads-learn-more-button\n                    ba-if="{{moredetailslink && !companionadcontent}}"\n                    ba-adsplaying="{{adsplaying}}"\n                    ba-cssprefix="{{cssgallerysidebar}}"\n                    ba-moredetailslink="{{moredetailslink}}"\n                    ba-datatestselector="sidebar-ads-learn-more-button"\n                    ba-event:click_action="on_learn_more_click"\n                ></ba-ads-learn-more-button>\n            </div>\n        </div>\n\n        <div class="{{cssgallerysidebar}}-ads-footer-container">\n            <div class="{{cssgallerysidebar}}-ads-footer-right-container">\n                <ba-ads-choices-link\n                    ba-if="{{adchoiceslink && showadchoices && !unknownadsrc}}"\n                    ba-adchoiceslink="{{adchoiceslink}}"\n                    ba-datatestselector="sidebar-ads-choices-button"\n                    ba-event:click_action="on_ads_choices_click"\n                ></ba-ads-choices-link>\n            </div>\n        </div>\n    </div>\n\n    <div ba-show="{{!adsplaying}}" class="{{cssgallerysidebar}}-container">\n        <div class="{{cssgallerysidebar}}-list-container">\n            <div ba-if="{{loading}}" class="{{cssgallerysidebar}}-loading-container">\n                <ba-spinner></ba-spinner>\n            </div>\n            <ul ba-if="{{showplaylist}}"\n                class="{{cssgallerysidebar}}-list" ba-show="{{!loading}}"\n                ba-repeat="{{video :: videos}}"\n            >\n                <li ba-show="{{video.display && !(video.watched && hidevideoafterplay)}}"\n                    class="{{cssgallerysidebar}}-list-item\n                    {{currentindex === video.index ? (cssgallerysidebar + \'-currently-playing-list-item\') : \'\'}}"\n                    data-index="{{video.index}}"\n                    data-index-selector="gallery-item-{{video.index}}"\n                    onclick="{{play_video(video.index)}}"\n                >\n                    <div class="{{cssgallerysidebar}}-list-item-poster-container">\n                        <div class="{{cssgallerysidebar}}-circle-progress-container">\n                            <ba-circle-progress\n                                ba-if="{{shownextloader && nextindex === video.index}}"\n                                ba-autostart="{{true}}"\n                                ba-timeout="{{noengagenext * 1000}}"\n                                ba-noengagenext="{{noengagenext}}"\n                                ba-paused="{{!playing}}"\n                            ></ba-circle-progress>\n                        </div>\n                        <img class="{{cssgallerysidebar}}-list-item-poster"\n                             ba-prop:src="{{video.poster}}" alt="{{video.title}}"\n                        />\n                    </div>\n                    <div class="{{cssgallerysidebar}}-list-item-title">\n                        {{(video.title)?video.title:\'\'}}\n                    </div>\n                </li>\n            </ul>\n\n        </div>\n\n        <div class="{{cssgallerysidebar}}-footer-container"></div>\n    </div>\n</div>\n\n\n<div ba-if="{{floatingsidebar}}"\n     class="{{cssfloatingsidebar}}-container {{csscommon}}-full-height"\n>\n    <div ba-if="{{adsplaying}}"\n         class="{{cssfloatingsidebar}}-ad-playing-container {{csscommon}}-full-height"\n    >\n        <ba-ads-choices-link\n            ba-if="{{adchoiceslink && showadchoices && !unknownadsrc}}"\n            ba-adchoiceslink="{{adchoiceslink}}"\n            ba-datatestselector="sidebar-ads-choices-button"\n            ba-event:click_action="on_ads_choices_click"\n        ></ba-ads-choices-link>\n        \n        <div ba-if="{{companionadcontent}}"\n             class="{{cssfloatingsidebar}}-companion-container"\n        ></div>\n        <div class="{{cssfloatingsidebar}}-content-container" ba-if={{showlearnmorebutton}}>\n            <ba-ads-learn-more-button\n                ba-if="{{moredetailslink && !companionadcontent}}"\n                ba-adsplaying="{{adsplaying}}"\n                ba-cssprefix="{{cssfloatingsidebar}}"\n                ba-moredetailslink="{{moredetailslink}}"\n                ba-datatestselector="sidebar-ads-learn-more-button"\n                ba-event:click_action="on_learn_more_click"\n            ></ba-ads-learn-more-button>\n        </div>\n        <div ba-if="{{!showlearnmorebutton && afteradsendtext}}" class="{{cssfloatingsidebar}}-title">\n            {{afteradsendtext}}\n        </div>\n    </div>\n    <div ba-if="{{!adsplaying}}" class="{{cssfloatingsidebar}}-content-container {{csscommon}}-full-height">\n        <div class="{{cssfloatingsidebar}}-title">\n            {{title}}\n        </div>\n    </div>\n    <div ba-if="{{headerlogoimgurl}}" class="{{cssfloatingsidebar}}-logo">\n        <a href="{{ headerlogourl || headerlogoimgurl }}" title="{{headerlogoname}}" target="_blank">\n            <img ba-prop:src="{{headerlogoimgurl}}" alt="{{headerlogoname}}" />\n        </a>\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",cssadsplayer:"ba-adsplayer",cssgallerysidebar:"ba-gallery-sidebar",cssfloatingsidebar:"ba-floating-sidebar",sidebartitle:null,bodyelementtouched:!1,bodyelementpadding:114,companionadcontent:null,companionads:[],is_floating:!1,gallerytitletext:null,headerlogourl:null,headerlogoname:null,afteradsendtext:null,adchoiceslink:null,playlist:[],blacklisted:[],loaded:[],watched:[],showprogress:!1,nextindex:null,previousindex:null,currentindex:null,loading:!0,hideloaderafter:1700,states:{},shownextloader:!1,nextunplayed:!1},events:{"change:nextindex":function(e){this.__dyn.get("next_video_from_playlist")!==e&&(e?this.checkIndexPlayability(e):this.setNextVideoIndex())},"change:adsplaying":function(e){const t=this.__galleryListContainer;!e&&0<this.get("videos").count()&&this.__lastTopPosition&&t&&i.eventually(()=>{t&&1<Math.abs(t.scrollTop-this.__lastTopPosition)&&t.scroll({top:this.__lastTopPosition,left:0})},this,50)},"change:fullscreened":function(e){e||this.get("adsplaying")||this.scrollTop()}},computed:{"shownextloader:nextactive":function(e){return e&&this.scrollTop(),!!e},"showplaylist:playlist":function(t){if(!t)return!1;if(!(0<t.length))return!1;const i=this.get("videos"),s=i.count();return this.__loaderStarted=!1,0===s&&i.on("add",function(e){this.__checkVideoPoster(e),t.length===this.get("videos").count()&&this.proceedWithLoader()},this),c.iter(t,function(e,t){0<s&&i.get_by_secondary_index("index",t)||n.is_object(e)&&i.add({index:t,title:e.title,poster:e.poster,source:e.source,token:e.token||null,height:null,display:!1,watched:!1,scroll:!0,cached:0})},this),!0}},collections:{videos:{}},create:function(){this.__dyn=this.parent(),this.get("videos").add_secondary_index("index"),this.set("states.shownext",this.get("shownext")),this.set("nextunplayed",this.get("sidebaroptions.nextunplayed")||!1),this.set("headerlogourl",this.get("sidebaroptions.headerlogourl")||null),this.set("headerlogoimgurl",this.get("sidebaroptions.headerlogoimgurl")||null),this.set("headerlogoname",this.get("sidebaroptions.headerlogoname")||"Brand's logo"),this.set("gallerytitletext",this.get("sidebaroptions.gallerytitletext")||this.string("up-next")),this.set("afteradsendtext",this.get("sidebaroptions.afteradsendtext")||this.string("continue-on-ads-end")),this.set("hidevideoafterplay",this.get("sidebaroptions.hidevideoafterplay")||!1),this.get("gallerysidebar")?this.initSidebarGallery():this.__dyn.on("change:show_sidebar",e=>{!this.__sidebarGalleryInited&&e&&this.get("gallerysidebar")&&this.initSidebarGallery()},this)},initSidebarGallery:function(){this.set("states.gallerysidebar",this.get("gallerysidebar")),this.get("adsplaying")||(this.__sidebarGalleryInited=!0,c.iter(["attach","source","video"],function(t){this.__dyn.on("error:"+t,function(e){console.warn("Error on "+t,e),this.setNextVideoIndex(!0)},this)},this),this.__dyn.on("playlist-next",function(e){this.set("shownextloader",!1);e=this.get("videos").queryOne({source:e.source});e&&e.set("watched",!0),this.set("nextindex",null)},this),this.__dyn.on("resize",function(){this.__drawInProcess=!1,s.debounce(this.__drawListedVideos,100).apply(this)},this),this.get("videos").on("change:scroll",(e,t)=>{t&&this.scrollTop()},this),this.get("videos").on("removed",e=>this.scrollTop(),this))},_afterActivate:function(e){t._afterActivate.call(this,e),(this.get("floatingoptions.showcompanionad")&&this.get("floatingsidebar")||this.get("sidebaroptions.showcompanionad")&&this.get("floatingsidebar"))&&(this.get("companionads")&&0<this.get("companionads").length?this.__generateCompanionAdContent():this.on("change:companionads",function(e){this.__generateCompanionAdContent(e)},this))},functions:{play_video:function(e){this.playNextVideo(e)},on_learn_more_click:function(){this.pauseAds()},on_ads_choices_click:function(){this.pauseAds()}},pauseAds:function(){this.get("adsplaying")&&this.trigger("pause_ads")},playNextVideo:function(t){console.log("playNextVideo: "),this.__dyn.trigger("sidebarskip"),this.__dyn.set("next_video_from_playlist",t),this.__dyn.setPlayerEngagement(),t===this.get("currentindex")?(this.__dyn.set("current_video_from_playlist",null),this.__dyn.trigger("play_next",t)):this.get("videos").iterate(function(e){0<=t&&e.get("index")===t&&t!==this.get("currentindex")&&(this.set("previousindex",this.__dyn.get("next_video_from_playlist")),this.__dyn.trigger("play_next",t),this.__dyn.channel("next").trigger("manualPlayNext"),e.set("watched",!0),this.removeVideoFromList(this.get("previousindex")),this.scrollTop())},this)},setNextVideoIndex:function(e){e=e||!1;let t,i,s,n=null;for(var r=this.__getCurrentVideo()?.get("index"),o=(this.get("currentindex")!==r&&this.set("currentindex",r),this.get("videos").iterator());o.hasNext();){var a=o.next(),c=a.get("index");-1!==this.get("blacklisted").indexOf(c)||!a.get("display")||!a.get("watched")&&this.get("nextunplayed")||(r<c&&!n&&(t=a,n=a.get("index")),!s&&c<r&&(i=a,s=a.get("index"))),o.hasNext()||(n=n||s,t=t||i,n?(this.set("nextindex",n),this.scrollTop(),e&&(this.__dyn.__listeningOnPlayNext?this.__dyn.trigger("play_next"):(this.__dyn.setAll({poster:t.get("poster"),source:t.get("source")}),this.__dyn.trigger("message:click")))):this.resetPlaylist())}},proceedWithLoader:function(){this._containerCheckTimer||(this.set("loading",!0),this.__loaderStarted=!0,this.__drawInProcess=!1,this._containerCheckTimer=this.auto_destroy(new r({delay:200,fire:function(){this.get("adsplaying")||((this.get("hideloaderafter")<=0&&0<this.get("loaded").length||this.get("loading")&&5<this.get("loaded").length)&&(this.set("loading",!1),this.setNextVideoIndex(),this.__drawListedVideos(!0),this._containerCheckTimer.stop()),this.set("hideloaderafter",this.get("hideloaderafter")-100))}.bind(this),context:this,immediate:!0,destroy_on_stop:!0})))},removeVideoFromList:function(e){this.get("hidevideoafterplay")&&e&&(e=this.get("videos").get_by_secondary_index("index",e))&&e.setAll({display:!1,scroll:!0})},checkIndexPlayability:function(e){e=e||this.get("nextindex");const t=this.get("videos").get_by_secondary_index("index",e);i.eventually(function(){-1===this.get("blacklisted").indexOf(e)&&t?this.__dyn.set("next_video_from_playlist",e):this.set("nextindex",null)},this,200)},resetPlaylist:function(){var e=this.get("videos").iterator();let t=null;for(;e.hasNext();){var i=e.next();i.get("display")&&(i.setAll({watched:!1,scroll:!0}),t=t||i.get("index")),e.hasNext()||(this.set("nextindex",t||0),this.scrollTop())}},scrollTop:function(e){this.get("is_floating")||this.get("adsplaying")||(e=e||!1,this.__galleryListContainer?(this.__galleryListContainer||e)&&s.debounce(this.__scrollToTop,50).apply(this):(this.__galleryListContainer=this.activeElement().querySelector(`.${this.get("cssgallerysidebar")}-list-container`),s.debounce(this.scrollTop,100).apply(this)))},__scrollToTop:function(){if(this.activeElement()&&this.get("videos")){let n=0;const r=this.__galleryListContainer;this.get("videos").iterate(function(e,t){var i=e.get("height"),s=e.get("index");e.get("display")&&(!i||i<=0?this.__recalculateHeight(e):this.get("nextindex")===s?(this.__lastTopPosition=n-i,r&&r.scrollTo&&r.scrollTo({top:this.__lastTopPosition,left:0,behavior:"smooth"})):n+=i)},this)}},__checkVideoPoster:function(e){const t=this,i=e.get("index");var s=e.get("poster"),n=e.get("source");s&&n&&((n=new Image).onload=function(){e.setAll({display:!0,scroll:!0}),t.get("loaded").push(i)},n.onerror=function(){t.get("blacklisted").push(i)},n.src=s)},__recalculateHeight:function(e){var t=e.get("index"),t=this.activeElement().querySelector(`li[data-index-selector="gallery-item-${t}"]`);t&&0<(t=l.elementDimensions(t).height)&&e.setAll({height:t,display:!0,scroll:!0})},__drawListedVideos:function(s){const n=this;var e;s=s||!1,this.get("adsplaying")||this.get("videos").destroyed()||this.__drawInProcess||(e=this.activeElement().querySelectorAll(`li.${this.get("cssgallerysidebar")}-list-item`))&&0<e.length&&(this.__drawInProcess=!0,e.forEach(function(e){var t=e.dataset.index,i=n.get("videos").get_by_secondary_index("index",parseInt(t),!0);n.get("blacklisted").includes(t)||(t=l.elementDimensions(e).height)&&i.setAll({height:t,scroll:s})}))},__generateCompanionAdContent:function(o){if((o=o||this.get("companionads"))&&0<o.length){var e=this.get("mobileviewport");if(this.get("floatingoptions.desktop.companionad")&&!e||this.get("floatingoptions.mobile.companionad")&&e||this.get("gallerysidebar")&&this.get("sidebaroptions.showcompanionad")&&!e){const a=l.elementDimensions(this.activeElement());let s,n,r;s=a.width/a.height,c.iter(o,function(e,t){var e=e.data,e=e.width/e.height,i=Math.abs(e-s);(0===t||r>i)&&(r=i,n=t),o.length===t+1&&(i=o[n],this.set("companionadcontent",i.getContent()),t=this.activeElement().querySelector("."+this.get("cssfloatingsidebar")+"-companion-container"))&&this.__drawCompanionAdToContainer(t,i,a,s,e)},this)}}},__drawCompanionAdToContainer:function(e,t,i,s,n){e.innerHTML=this.get("companionadcontent");e=e.querySelector("img");e&&n&&i&&((n=t.data.width/t.data.height)<s?(e.height=i.height,e.width=i.height*(n<=1?n:t.data.width/t.data.height)):(e.width=i.width,e.height=i.width*(t.data.height/t.data.width)))},__getCurrentVideo:function(){var e=this.get("videos").queryOne({source:this.__dyn.get("source")}),t=e?e.get("index"):null;return t&&this.set("currentindex",t),e}}}]).register("ba-videoplayer-sidebar").registerFunctions({"states.gallerysidebar":function(e){return e.states.gallerysidebar},gallerysidebar:function(e){return e.gallerysidebar},csscommon:function(e){return e.csscommon},cssgallerysidebar:function(e){return e.cssgallerysidebar},"!adsplaying":function(e){return!e.adsplaying},gallerytitletext:function(e){return e.gallerytitletext},headerlogoimgurl:function(e){return e.headerlogoimgurl},"headerlogourl || headerlogoimgurl":function(e){return e.headerlogourl||e.headerlogoimgurl},headerlogoname:function(e){return e.headerlogoname},adsplaying:function(e){return e.adsplaying},afteradsendtext:function(e){return e.afteradsendtext},companionadcontent:function(e){return e.companionadcontent},cssfloatingsidebar:function(e){return e.cssfloatingsidebar},"showlearnmorebutton && !companionadcontent":function(e){return e.showlearnmorebutton&&!e.companionadcontent},"moredetailslink && !companionadcontent":function(e){return e.moredetailslink&&!e.companionadcontent},moredetailslink:function(e){return e.moredetailslink},"adchoiceslink && showadchoices && !unknownadsrc":function(e){return e.adchoiceslink&&e.showadchoices&&!e.unknownadsrc},adchoiceslink:function(e){return e.adchoiceslink},loading:function(e){return e.loading},showplaylist:function(e){return e.showplaylist},"!loading":function(e){return!e.loading},videos:function(e){return e.videos},"video.display && !(video.watched && hidevideoafterplay)":function(e){return e.video.display&&!(e.video.watched&&e.hidevideoafterplay)},"currentindex === video.index ? (cssgallerysidebar + '-currently-playing-list-item') : ''":function(e){return e.currentindex===e.video.index?e.cssgallerysidebar+"-currently-playing-list-item":""},"video.index":function(e){return e.video.index},"play_video(video.index)":function(e){return e.play_video(e.video.index)},"shownextloader && nextindex === video.index":function(e){return e.shownextloader&&e.nextindex===e.video.index},"true":function(e){return!0},"noengagenext * 1000":function(e){return 1e3*e.noengagenext},noengagenext:function(e){return e.noengagenext},"!playing":function(e){return!e.playing},"video.poster":function(e){return e.video.poster},"video.title":function(e){return e.video.title},"(video.title)?video.title:''":function(e){return e.video.title||""},floatingsidebar:function(e){return e.floatingsidebar},showlearnmorebutton:function(e){return e.showlearnmorebutton},"!showlearnmorebutton && afteradsendtext":function(e){return!e.showlearnmorebutton&&e.afteradsendtext},title:function(e){return e.title}}).attachStringTable(t.strings).addStrings({"up-next":"Up Next khm","continue-on-ads-end":"Content will resume after this advertisement."})}),e.define("module:VideoPlayer.Dynamics.Tooltip",["dynamics:Dynamic","base:Objs","base:Time","base:Async","base:Timers","module:Assets"],function(e,t,i,s,n,r,o){return e.extend({scoped:o},function(e){return{template:'<div ba-if="{{tooltiptext}}" role="tooltip"\n     title="{{(pauseonhover && disappearafter > 0) ? string(\'hover-to-pause-tooltip-close\') : tooltiptext}}"\n     class="{{csscommon}}-tooltip-container {{csscommon}}-tooltip-{{position}}\n     {{csscommon}}-tooltip-container-on-{{playing ? \'playing\' : \'pause\'}}\n     {{csscommon}}-fade-{{tooltiptext ? \'in\' : \'out\'}}\n     {{ adsplaying ? (csscommon + \'-tooltip-container-playing-ads\') : \'\'}}\n     {{ (pauseonhover && disappearafter > 0) ? csscommon + \'-pause-on-hover\' : \'\' }}"\n     onmouseover="{{mouseover()}}" onmouseout="{{mouseout()}}"\n>\n    <div data-selector="tooltip-text" class="{{csscommon}}-tooltip-text">\n        {{tooltiptext}}\n    </div>\n    <div ba-if="{{closeable}}" ba-click="{{close()}}"\n         data-selector="close-tooltip"\n         class="{{csscommon}}-close-tooltip"\n    >\n        <i class="{{csscommon}}-icon-cancel"></i>\n    </div>\n    <div ba-if="{{disappearafter > 0 && showprogressbar}}"\n         data-selector="tooltip-progress" role="progressbar"\n         class="{{csscommon}}-tooltip-progress"\n    >\n        <div class="{{csscommon}}-tooltip-progress-full">\n            <div\n                ba-styles="{{tooltipleftprogressstyle}}"\n                class="{{csscommon}}-tooltip-progress-passed"\n            ></div>\n        </div>\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player"},computed:{"tooltipleftprogressstyle:disappearafter":function(e){return{width:100*Number((e/this.get("disappearafterinitial")).toFixed(2))+"%"}}},events:{"change:tooltiptext":function(e){var t;!e||this.get("disappearafter")<0||(t=this.get("showprogressbar")?100:1e3,this._timer=this.auto_destroy(new n.Timer({context:this,fire:function(){this.get("hovered")||(this.set("disappearafter",this.get("disappearafter")-t),this.get("disappearafter")<=0&&this.destroy())},delay:t,start:!0,destroy_on_stop:!0})))}},functions:{close:function(){this.destroy()},mouseover:function(){this.get("pauseonhover")&&this.set("hovered",!0)},mouseout:function(){this.set("hovered",!1)}},create:function(){var e=this.get("tooltip");e&&"function"==typeof e.get&&(this.set("closeable",e.get("closeable")||!1),this.set("position",e.get("position")||"top-right"),this.set("disappearafterinitial",1e3*(e.get("disappearafterseconds")||2)),this.set("disappearafter",this.get("disappearafterinitial")),this.set("showonhover",e.get("showonhover")||!1),this.set("showprogressbar",e.get("showprogressbar")||!1),this.set("pauseonhover",e.get("pauseonhover")||!1),this.set("tooltiptext",this.get("tooltip").get("tooltiptext")))},destroy:function(){this.set("tooltiptext",null),this.parent().hideTooltip(this.get("position"),this.get("id")),this.destroyed()||e.destroy.call(this)}}}).register("ba-videoplayer-tooltip").registerFunctions({tooltiptext:function(e){return e.tooltiptext},"(pauseonhover && disappearafter > 0) ? string('hover-to-pause-tooltip-close') : tooltiptext":function(e){return e.pauseonhover&&0<e.disappearafter?e.string("hover-to-pause-tooltip-close"):e.tooltiptext},csscommon:function(e){return e.csscommon},position:function(e){return e.position},"playing ? 'playing' : 'pause'":function(e){return e.playing?"playing":"pause"},"tooltiptext ? 'in' : 'out'":function(e){return e.tooltiptext?"in":"out"},"adsplaying ? (csscommon + '-tooltip-container-playing-ads') : ''":function(e){return e.adsplaying?e.csscommon+"-tooltip-container-playing-ads":""},"(pauseonhover && disappearafter > 0) ? csscommon + '-pause-on-hover' : ''":function(e){return e.pauseonhover&&0<e.disappearafter?e.csscommon+"-pause-on-hover":""},"mouseover()":function(e){return e.mouseover()},"mouseout()":function(e){return e.mouseout()},closeable:function(e){return e.closeable},"close()":function(e){return e.close()},"disappearafter > 0 && showprogressbar":function(e){return 0<e.disappearafter&&e.showprogressbar},tooltipleftprogressstyle:function(e){return e.tooltipleftprogressstyle}}).attachStringTable(r.strings).addStrings({tooltip:"Tooltip","hover-to-pause-tooltip-close":"Hold mouse on, to pause tooltip closing"})}),e.define("module:VideoPlayer.Dynamics.Topmessage",["dynamics:Dynamic"],function(e,t){return e.extend({scoped:t},function(e){return{template:"\n<div class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-background'>\n    </div>\n    <div data-selector=\"topmessage-message-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",topmessage:""}}}).registerFunctions({css:function(e){return e.css},topmessage:function(e){return e.topmessage}}).register("ba-videoplayer-topmessage")}),e.define("module:VideoPlayer.Dynamics.Tracks",["dynamics:Dynamic","base:Objs","base:Async","module:Assets"],["dynamics:Partials.ClickPartial","dynamics:Partials.RepeatElementPartial"],function(e,t,i,s,n){return e.extend({scoped:n},function(e){return{template:'<div data-selector="text-tracks-overlay"\n     class="{{cssplayer}}-text-tracks-overlay\n     {{activitydelta > hidebarafter && hideoninactivity ? (cssplayer + \'-track-dashboard-hidden\') : \'\'}}\n">\n\n    <div data-selector="cue-content" ba-show="{{tracktagsstyled && trackcuetext}}" class="{{cssplayer}}-cue-content">\n        <p> {{trackcuetext}} </p>\n    </div>\n    <div class="{{csscommon}}-options-popup {{csscommon}}-options-list-{{tracksshowselection || trackselectorhovered ? \'visible\' : \'hidden\'}}">\n        <div ba-show="{{tracksshowselection || trackselectorhovered}}" tabindex="-1"\n             onmouseenter="{{hover_cc(domEvent, true)}}" onmouseover="{{hover_cc(domEvent, true)}}" onmouseleave="{{hover_cc(domEvent, false)}}"\n        >\n            <div data-selector="tracks-selector-list"\n                 class="{{csscommon}}-initial-options-list {{csscommon}}-tracks-selector-list {{csscommon}}-options-list-visible {{csscommon}}-options-list"\n                 ba-if="{{tracktags}}"\n            >\n                <div ba-repeat-element="{{track :: tracktags}}"\n                     class="{{csscommon}}-tracks-selector {{csscommon}}-options-list-item"\n                     ba-click="{{select_track(track)}}"\n                     ba-show="{{track.label && texttrackslength > 1}}"\n                >\n                    <div class="{{csscommon}}-inner-text">\n                        {{track.label}}\n                    </div>\n                </div>\n                <div data-selector="text-tracks-open-form-button"\n                     class="{{csscommon}}-options-list-item {{csscommon}}-open-next"\n                     ba-if="{{allowtexttrackupload}}" title="{{string(\'upload-text-tracks\')}}"\n                     onclick="{{move_to_option(domEvent, \'text-tracks-uploader-form\')}}"\n                >\n                    <div class="{{csscommon}}-inner-text">{{string(\'upload-text-tracks\')}}</div>\n                    <div class="{{csscommon}}-inner-icon"></div>\n                </div>\n            </div>\n\n            <div data-selector="text-tracks-uploader-form"\n                 class="{{csscommon}}-options-list-hidden {{csscommon}}-options-list {{csscommon}}-text-tracks-uploader-form"\n                 ba-if="{{allowtexttrackupload}}"\n            >\n                <div class="{{csscommon}}-full-width {{csscommon}}-options-list-item">\n                    <div data-selector="close-text-tracks-upload-form"\n                         title="{{string(\'back\')}}"\n                         class="{{csscommon}}-open-previous {{csscommon}}-text-left"\n                         onclick="{{move_to_option(domEvent)}}"\n                    >\n                        <div class="{{csscommon}}-inner-icon"></div>\n                        <div class="{{csscommon}}-inner-text">{{string(\'back\')}}</div>\n                    </div>\n                </div>\n\n                <div class="{{csscommon}}-full-width {{csscommon}}-options-list-item">\n                    <form class="{{csscommon}}-form {{csscommon}}-text-tracks-upload-form">\n                        <div class="{{csscommon}}-form-input {{csscommon}}-select-field {{csscommon}}-direction-pointer">\n                            <select data-selector="select-text-tracks-label" tabindex="-1"\n                                    class="{{csscommon}}-form-input {{csscommon}}-text-tracks-label-input"\n                                    name="{{csscommon}}-text-tracks-label-select"\n                                    onmousedown="{{prevent_un_hover(domEvent)}}"\n                                    onmousemove="{{prevent_un_hover(domEvent)}}"\n                                    onchange="{{selected_label_value(domEvent)}}"\n                            >\n                                <option disabled value selected>\n                                    {{string(\'select-text-track-language\')}}\n                                </option>\n                                <option ba-repeat-element="{{locale :: uploadlocales}}" value="{{locale.lang}}">\n                                    {{locale.label}}\n                                </option>\n                            </select>\n                        </div>\n                        <div class="{{csscommon}}-form-input {{csscommon}}-button" ba-show="{{chosenoption}}">\n                            <input type="file" data-selector="select-text-tracks-file"\n                                   title="{{chosenoption ? string(\'select-text-track-file\') : string(\'info-select-locale-first\')}}"\n                                   onchange="{{upload_text_track(domEvent)}}"\n                                   class="{{csscommon}}-text-tracks-file"\n                                   accept="{{acceptedtracktexts}}"\n                            />\n                            {{chosenoption ? string(\'select-text-track-file\') : string(\'info-select-locale-first\')}}\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n',attrs:{css:"ba-videoplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",trackcuetext:null,acceptedtracktexts:"text/vtt,application/ttml+xml,type/subtype",trackselectorhovered:!1,texttrackslength:0,uploadtexttracksvisible:!1,uploadlocales:[],chosenoption:null},create:function(){t.iter(this.get("tracktags"),function(e){"subtitles"===e.kind&&this.set("texttrackslength",this.get("texttrackslength")+1)},this)},functions:{select_track:function(e){this.parent().set("trackselectorhovered",!1),this.parent().trigger("switch-track",e)},hover_cc:function(e,t){if(!this.parent().get("settingsmenu_active")){if(t||e[0].target!==document.activeElement)return this.parent().set("trackselectorhovered",t);i.eventually(function(){e[0].target.blur()},this,500)}},prevent_un_hover:function(e){return e[0].target.blur(),e="."+this.parent().get("csscommon")+"-options-popup",(e=document.querySelector(e))&&e.focus(),this.parent().set("trackselectorhovered",!0)},selected_label_value:function(e){e=e[0].target.options,e=e[e.selectedIndex];e.value?this.set("chosenoption",{lang:e.value,label:e.text}):this.set("chosenoption",null)},upload_text_track:function(e){this.get("chosenoption")?this.trigger("upload-text-tracks",e[0].target,this.get("chosenoption")):console.warn("can not send empty label")},move_to_option:function(e,t){this.trigger("move_to_option",e[0].target,t)}}}}).register("ba-videoplayer-tracks").registerFunctions({cssplayer:function(e){return e.cssplayer},"activitydelta > hidebarafter && hideoninactivity ? (cssplayer + '-track-dashboard-hidden') : ''":function(e){return e.activitydelta>e.hidebarafter&&e.hideoninactivity?e.cssplayer+"-track-dashboard-hidden":""},"tracktagsstyled && trackcuetext":function(e){return e.tracktagsstyled&&e.trackcuetext},trackcuetext:function(e){return e.trackcuetext},csscommon:function(e){return e.csscommon},"tracksshowselection || trackselectorhovered ? 'visible' : 'hidden'":function(e){return e.tracksshowselection||e.trackselectorhovered?"visible":"hidden"},"tracksshowselection || trackselectorhovered":function(e){return e.tracksshowselection||e.trackselectorhovered},"hover_cc(domEvent, true)":function(e){return e.hover_cc(e.domEvent,!0)},"hover_cc(domEvent, false)":function(e){return e.hover_cc(e.domEvent,!1)},tracktags:function(e){return e.tracktags},"select_track(track)":function(e){return e.select_track(e.track)},"track.label && texttrackslength > 1":function(e){return e.track.label&&1<e.texttrackslength},"track.label":function(e){return e.track.label},allowtexttrackupload:function(e){return e.allowtexttrackupload},"string('upload-text-tracks')":function(e){return e.string("upload-text-tracks")},"move_to_option(domEvent, 'text-tracks-uploader-form')":function(e){return e.move_to_option(e.domEvent,"text-tracks-uploader-form")},"string('back')":function(e){return e.string("back")},"move_to_option(domEvent)":function(e){return e.move_to_option(e.domEvent)},"prevent_un_hover(domEvent)":function(e){return e.prevent_un_hover(e.domEvent)},"selected_label_value(domEvent)":function(e){return e.selected_label_value(e.domEvent)},"string('select-text-track-language')":function(e){return e.string("select-text-track-language")},uploadlocales:function(e){return e.uploadlocales},"locale.lang":function(e){return e.locale.lang},"locale.label":function(e){return e.locale.label},chosenoption:function(e){return e.chosenoption},"chosenoption ? string('select-text-track-file') : string('info-select-locale-first')":function(e){return e.chosenoption?e.string("select-text-track-file"):e.string("info-select-locale-first")},"upload_text_track(domEvent)":function(e){return e.upload_text_track(e.domEvent)},acceptedtracktexts:function(e){return e.acceptedtracktexts}}).attachStringTable(s.strings).addStrings({"upload-text-tracks":"Upload track text files","select-text-track-language":"Subtitle Language","info-select-locale-first":"First select locale","select-text-track-file":"Click to select file",back:"back"})}),e.define("module:VideoRecorder.Dynamics.Chooser",["dynamics:Dynamic","module:Assets","browser:Info"],["dynamics:Partials.RepeatPartial","dynamics:Partials.ClickPartial","dynamics:Partials.IfPartial"],function(e,t,n,i){return e.extend({scoped:i},function(e){return{template:'<div class="{{css}}-chooser-container">\n\t<div ba-if="{{initialmessages.length > 0}}" class="{{csscommon}}-message-container">\n\t\t<ul ba-repeat="{{initialmessage :: initialmessages}}">\n\t\t\t<li ba-if="{{initialmessage.message}}"\n\t\t\t\tclass="{{csscommon}}-message-text {{csscommon}}-message-{{initialmessage.type ? initialmessage.type : \'default\'}}"\n\t\t\t>\n\t\t\t\t{{ initialmessage.message }}\n\t\t\t\t<span ba-if="{{initialmessage.id}}"\n\t\t\t\t\t  class="{{csscommon}}-action-button"\n\t\t\t\t\t  ba-click="close_message(initialmessage.id)"\n\t\t\t\t>\n\t\t\t\t\t<i class="{{csscommon}}-icon-cancel"></i>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t<div class="{{css}}-chooser-button-container">\n\t\t<div ba-repeat="{{action :: actions}}">\n\t\t\t<div ba-hotkey:space^enter="{{click_action(action)}}" onmouseout="this.blur()"\n\t\t\t\t tabindex="0" class="{{css}}-chooser-button-{{action.index}}"\n\t\t\t     ba-click="{{click_action(action)}}"\n\t\t\t>\n\t\t\t\t<input ba-if="{{action.select && action.capture}}"\n\t\t\t\t\t   type="file"\n\t\t\t\t\t   class="{{css}}-chooser-file"\n\t\t\t\t\t   onchange="{{select_file_action(action, domEvent)}}"\n\t\t\t\t\t   onclick="this.value=\'\'"\n\t\t\t\t\t   accept="{{action.accept}}"\n\t\t\t\t\t   capture="{{action.switchcamera}}" />\n\t\t\t\t<input ba-if="{{action.select && !action.capture}}"\n\t\t\t\t\t   type="file"\n\t\t\t\t\t   class="{{css}}-chooser-file"\n\t\t\t\t\t   onchange="{{select_file_action(action, domEvent)}}"\n\t\t\t\t\t   accept="{{action.accept}}"\n\t\t\t\t\t   />\n\t\t\t\t<i class="{{csscommon}}-icon-{{action.icon}}"\n\t\t\t\t   ba-if="{{action.icon}}"></i>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n',attrs:{css:"ba-videorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",allowrecord:!0,allowupload:!0,allowscreen:!1,allowmultistreams:!1,facecamera:!0,primaryrecord:!0,recordviafilecapture:!1,allowcustomupload:!0,allowedextensions:null,onlyaudio:!1,parentpopup:!1,initialmessages:[]},types:{allowedextensions:"array",recordviafilecapture:"boolean",facecamera:"boolean",parentpopup:"boolean",initialmessages:"array"},collections:["actions"],create:function(){var i="",e=(this.get("allowedextensions")&&0<this.get("allowedextensions").length?(n.isEdge()||n.isChrome()||n.isOpera()||n.isFirefox()&&42<=n.firefoxVersion()||n.isInternetExplorer()&&10<=n.internetExplorerVersion())&&(i="."+this.get("allowedextensions").join(",.")):this.get("allowcustomupload")||(i="video/*,video/mp4"),[]),s=(this.get("primaryrecord")?(this.get("allowrecord")&&e.push("record"),this.get("allowscreen")&&e.push("screen"),this.get("allowmultistreams")&&e.push("multistream"),this.get("allowupload")&&e.push("upload")):(this.get("allowscreen")&&e.push("screen"),this.get("allowupload")&&e.push("upload"),this.get("allowrecord")&&e.push("record"),this.get("allowmultistreams")&&e.push("multistream")),this.get("actions"));e.forEach(function(e,t){switch(e){case"record":s.add({type:"record",index:t,icon:this.get("onlyaudio")?"volume-up":"videocam",label:this.string(this.get("onlyaudio")?"record-audio":"record-video"),select:n.isMobile()&&!(n.isAndroid()&&n.isCordova())&&this.get("recordviafilecapture"),capture:!0,accept:"video/*,video/mp4;capture=camcorder",switchcamera:this.get("facecamera")?"user":"environment"});break;case"upload":s.add({type:"upload",index:t,icon:"upload",label:this.string("upload-video"),select:!(n.isiOS()&&n.isCordova()||this.get("parentpopup")),accept:!n.isMobile()||n.isAndroid()&&n.isCordova()?i:"video/*,video/mp4"});break;case"screen":s.add({type:"screen",index:t,icon:"television",label:this.string("record-screen")});break;case"multistream":s.add({type:"multistream",index:t,icon:"plus",label:this.string("multi-stream")})}},this)},functions:{click_action:function(e){var t;e.get("select")||("screen"===e.get("type")||"multistream"===e.get("type")?this.trigger("record-screen","multistream"===e.get("type")):n.isMobile()&&n.isCordova()?(t=this,n.isAndroid()?navigator.device.capture.captureVideo(function(e){t.trigger("upload",e[0])},function(e){},{limit:1,duration:this.get("timelimit")}):n.isiOS()&&navigator.camera.getPicture(function(e){t.trigger("upload",{localURL:e,fullPath:e})},function(e){},{destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,mediaType:Camera.MediaType.VIDEO})):this.trigger("record"))},select_file_action:function(e,t){e.get("select")&&this.trigger("upload",t[0].target)},close_message:function(t){"undefined"!=typeof Array.prototype.filter&&this.set("initialmessages",this.get("initialmessages").filter(function(e){return e.id!==t}))}}}}).registerFunctions({css:function(e){return e.css},"initialmessages.length > 0":function(e){return 0<e.initialmessages.length},csscommon:function(e){return e.csscommon},initialmessages:function(e){return e.initialmessages},"initialmessage.message":function(e){return e.initialmessage.message},"initialmessage.type ? initialmessage.type : 'default'":function(e){return e.initialmessage.type||"default"},"initialmessage.id":function(e){return e.initialmessage.id},actions:function(e){return e.actions},"click_action(action)":function(e){return e.click_action(e.action)},"action.index":function(e){return e.action.index},"action.select && action.capture":function(e){return e.action.select&&e.action.capture},"select_file_action(action, domEvent)":function(e){return e.select_file_action(e.action,e.domEvent)},"action.accept":function(e){return e.action.accept},"action.switchcamera":function(e){return e.action.switchcamera},"action.select && !action.capture":function(e){return e.action.select&&!e.action.capture},"action.icon":function(e){return e.action.icon},"action.label":function(e){return e.action.label}}).register("ba-videorecorder-chooser").attachStringTable(t.strings).addStrings({"record-video":"Record Video","record-audio":"Record Audio","record-screen":"Record Screen","multi-stream":"Multi Stream","upload-video":"Upload Video"})}),e.define("module:VideoRecorder.Dynamics.Controlbar",["dynamics:Dynamic","module:Assets","base:Timers.Timer","browser:Info"],["dynamics:Partials.ShowPartial","dynamics:Partials.RepeatPartial"],function(e,t,i,s,n){return e.extend({scoped:n},function(e){return{template:'<div class="{{css}}-dashboard">\n\t<div class="{{css}}-backbar"></div>\n\t<div data-selector="recorder-settings" class="{{css}}-settings" ba-show="{{settingsvisible && settingsopen}}">\n\t\t<div class="{{css}}-settings-backbar"></div>\n\t\t<div data-selector="settings-list-front" class="{{css}}-settings-front">\n\t\t\t<ul data-selector="add-new-stream" ba-if="{{videoselectnotification}}">\n\t\t\t\t<li>\n\t\t\t\t\t<div data-selector="single-camera-stream">\n\t\t\t\t\t\t<i class="ba-commoncss-icon-plus"></i> {{string(\'add-stream\')}}\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<div data-selector="single-camera-stream" class="{{csscommon}}-text-error">\n\t\t\t\t\t\t{{videoselectnotification}}\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<ul data-selector="add-new-stream" ba-show="{{showaddstreambutton && firefox && allowscreen}}">\n                <li>\n                    <div data-selector="single-camera-stream"\n                         class="{{css}}-add-stream"\n                         onclick="{{addNewStream()}}"\n                         onmouseenter="{{hover(string(\'add-stream\'))}}"\n                    >\n                        <i class="{{csscommon}}-icon-plus"></i> {{string(\'add-stream\')}}\n                    </div>\n                </li>\n\t\t\t</ul>\n\n\t\t\t<ul data-selector="add-new-stream" ba-show="{{showaddstreambutton && !firefox && !videoselectnotification}}" ba-repeat="{{camera :: cameras}}">\n\t\t\t\t<li ba-show="{{(camera.id !== selectedcamera) || allowscreen}}">\n\t\t\t\t\t<div data-selector="single-camera-stream"\n\t\t\t\t\t\t class="{{css}}-add-stream"\n\t\t\t\t\t\t onclick="{{addNewStream(camera.id)}}"\n\t\t\t\t\t\t onmouseenter="{{hover(string(\'add-stream\'))}}"\n\t\t\t\t\t>\n\t\t\t\t\t\t<i class="{{csscommon}}-icon-plus"></i> {{camera.label}}\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\n\t\t\t</ul>\n\t\t\t<hr ba-show="{{(showaddstreambutton && !firefox) || (firefox && allowscreen)}}"/>\n\t\t\t<ul data-selector="camera-settings" ba-repeat="{{camera :: cameras}}" ba-show="{{!novideo && !allowscreen && !ismobile}}">\n\t\t\t\t<li onmouseenter="{{hover(string(\'select-camera\'))}}">\n\t\t\t\t\t<input tabindex="0"\n\t\t\t\t\t\t   ba-hotkey:space^enter="{{selectCamera(camera.id)}}" onmouseout="this.blur()"\n\t\t\t\t\t\t   type=\'radio\' name=\'camera\' value="{{selectedcamera == camera.id}}"\n\t\t\t\t\t\t   onclick="{{selectCamera(camera.id)}}"\n\t\t\t\t\t/>\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<label tabindex="0"\n\t\t\t\t\t\t   ba-hotkey:space^enter="{{selectCamera(camera.id)}}" onmouseout="this.blur()"\n\t\t\t\t\t\t   onclick="{{selectCamera(camera.id)}}"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t</label>\n\t\t\t\t </li>\n\t\t\t</ul>\n\t\t\t<hr ba-show="{{(!noaudio && !novideo) || !allowscreen}}"/>\n\t\t\t<ul data-selector="microphone-settings" ba-repeat="{{microphone :: microphones}}" ba-show="{{!noaudio && !allowscreen}}">\n\t\t\t\t<li tabindex="0"\n\t\t\t\t\tba-hotkey:space^enter="{{selectMicrophone(microphone.id)}}" onmouseout="this.blur()"\n\t\t\t\t\tonmouseenter="{{hover(string(\'select-audio-input\'))}}"\n\t\t\t\t\tonclick="{{selectMicrophone(microphone.id)}}"\n\t\t\t\t>\n\t\t\t\t\t<input type=\'radio\' name=\'microphone\' value="{{selectedmicrophone == microphone.id}}" />\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<label>\n\t\t\t\t\t\t{{microphone.label}}\n\t\t\t\t\t</label>\n\t\t\t\t </li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div data-selector="controlbar" class="{{css}}-controlbar">\n\n\t\t<div class="{{css}}-leftbutton-container" ba-show="{{settingsvisible && ismobile}}">\n\t\t\t<div data-selector="face-mode-toggle-icon" class="{{css}}-mobile-camera-switcher {{css}}-button-inner"\n\t\t\t\t onclick="{{toggleFaceMode()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'switch-camera\'))}}"\n\t\t\t>\n\t\t\t\t<i class="{{csscommon}}-icon-arrows-cw"></i>\n\t\t\t</div>\n\t\t</div>\n\n        <div class="{{css}}-leftbutton-container" ba-show="{{settingsvisible}}">\n            <div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{settingsopen=!settingsopen}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="record-button-icon-cog" class="{{css}}-button-inner {{css}}-button-{{settingsopen ? \'selected\' : \'unselected\'}}"\n                 onclick="{{settingsopen=!settingsopen}}"\n                 onmouseenter="{{hover(string(\'settings\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n                <i class="{{csscommon}}-icon-cog"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-lefticon-container" ba-show="{{settingsvisible && !novideo && !allowscreen}}">\n            <div data-selector="record-button-icon-videocam" class="{{csscommon}}-icon-inner"\n                 onmouseenter="{{hover(string(camerahealthy ? \'camerahealthy\' : \'cameraunhealthy\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n                <i class="{{csscommon}}-icon-videocam {{csscommon}}-icon-state-{{camerahealthy ? \'good\' : \'bad\' }}"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-lefticon-container" ba-show="{{settingsvisible && !noaudio && !allowscreen}}">\n            <div data-selector="record-button-icon-mic" class="{{csscommon}}-icon-inner"\n                 onmouseenter="{{hover(string(microphonehealthy ? \'microphonehealthy\' : \'microphoneunhealthy\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n                <i class="{{csscommon}}-icon-mic {{csscommon}}-icon-state-{{microphonehealthy ? \'good\' : \'bad\' }}"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-lefticon-container" ba-show="{{stopvisible && recordingindication}}">\n            <div data-selector="recording-indicator" class="{{css}}-recording-indication">\n            </div>\n        </div>\n\n        <div class="{{css}}-label-container" ba-show="{{controlbarlabel}}">\n        \t<div data-selector="record-label-block" class="{{css}}-label-label">\n        \t\t{{controlbarlabel}}\n        \t</div>\n        </div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{recordvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{record()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="record-primary-button" class="{{css}}-button-primary"\n                 onclick="{{record()}}"\n                 onmouseenter="{{hover(string(\'record-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'record\')}}\n        \t</div>\n        </div>\n\n        <div class="{{css}}-rightbutton-container" ba-if="{{uploadcovershotvisible}}">\n        \t<div data-selector="covershot-primary-button" class="{{css}}-button-primary"\n                 onmouseenter="{{hover(string(\'upload-covershot-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}">\n                 <input type="file"\n\t\t\t\t       class="{{css}}-chooser-file"\n\t\t\t\t       style="height:100"\n\t\t\t\t       onchange="{{uploadCovershot(domEvent)}}"\n\t\t\t\t       accept="{{covershot_accept_string}}"\n\t\t\t\t />\n                 <span>\n        \t\t\t{{string(\'upload-covershot\')}}\n        \t\t</span>\n        \t</div>\n        </div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{rerecordvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{rerecord()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="rerecord-primary-button" class="{{css}}-button-primary"\n                 onclick="{{rerecord()}}"\n                 onmouseenter="{{hover(string(\'rerecord-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'rerecord\')}}\n        \t</div>\n        </div>\n\n\t\t<div class="{{css}}-rightbutton-container" ba-show="{{cancelvisible}}">\n\t\t\t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{cancel()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="cancel-primary-button" class="{{css}}-button-primary"\n\t\t\t\t onclick="{{cancel()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'cancel-tooltip\'))}}"\n\t\t\t\t onmouseleave="{{unhover()}}"\n\t\t\t>\n\t\t\t\t{{string(\'cancel\')}}\n\t\t\t</div>\n\t\t</div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{stopvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{stop()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="stop-primary-button" class="{{css}}-button-primary {{mintimeindicator ? css + \'-disabled\': \'\'}}"\n\t\t\t\t title="{{mintimeindicator ? string(\'stop-available-after\').replace(\'%d\', timeminlimit) : string(\'stop-tooltip\')}}"\n                 onclick="{{stop()}}"\n                 onmouseenter="{{hover( mintimeindicator ? string(\'stop-available-after\').replace(\'%d\', timeminlimit) : string(\'stop-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'stop\')}}\n        \t</div>\n        </div>\n\n\t\t<div class="{{css}}-rightbutton-container" ba-show="{{pausable && !resumevisible && stopvisible}}">\n\t\t\t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{pause()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="pause-primary-button" class="{{css}}-button-primary"\n\t\t\t\t title="{{string(\'pause-recorder\')}}"\n\t\t\t\t onclick="{{pause()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'pause-recorder\'))}}"\n\t\t\t\t onmouseleave="{{unhover()}}"\n\t\t\t>\n\t\t\t\t<i class="{{csscommon}}-icon-pause"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="{{css}}-rightbutton-container" ba-show="{{pausable && resumevisible}}">\n\t\t\t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{resume()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="resume-primary-button" class="{{css}}-button-primary"\n\t\t\t\t title="{{string(\'resume-recorder\')}}"\n\t\t\t\t onclick="{{resume()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'resume-recorder\'))}}"\n\t\t\t\t onmouseleave="{{unhover()}}"\n\t\t\t>\n\t\t\t\t<i class="{{csscommon}}-icon-ccw"></i>\n\t\t\t</div>\n\t\t</div>\n\n        <div class="{{css}}-centerbutton-container" ba-show="{{skipvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{skip()}}"  onmouseout="this.blur()"\n\t\t\t\t data-selector="skip-primary-button" class="{{css}}-button-primary"\n                 onclick="{{skip()}}"\n                 onmouseenter="{{hover(string(\'skip-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'skip\')}}\n        \t</div>\n        </div>\n\t</div>\n</div>\n',attrs:{css:"ba-videorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",hovermessage:"",videoselectnotification:null,ismobile:!1,recordingindication:!0,covershot_accept_string:"image/*,image/png,image/jpg,image/jpeg"},events:{"change:settingsopen":function(e){var t;e?(t=this.get("cameras").count(),this.get("cameras").count()<1?this.set("videoselectnotification",this.string("no-video-source")):1<t&&this.get("addstreamdeviceid")?this.set("videoselectnotification",this.string("stream-already-selected")):this.get("cameras").iterate(function(e){1===t&&this.get("addstreamdeviceid")===e.data().id&&this.set("videoselectnotification",this.string("stream-already-selected"))},this)):this.set("videoselectnotification",null)}},create:function(){this.set("ismobile",s.isMobile()),this.auto_destroy(new i({context:this,fire:function(){this.set("recordingindication",!this.get("recordingindication")&&!this.__parent.__paused)},delay:500}))},functions:{selectCamera:function(e){this.trigger("select-camera",e)},selectMicrophone:function(e){this.trigger("select-microphone",e)},toggleFaceMode:function(){this.trigger("toggle-face-mode")},addNewStream:function(e){this.set("settingsopen",!1),this.set("hovermessage",""),this.trigger("add-new-stream",e)},hover:function(e){this.set("hovermessage",e)},unhover:function(){this.set("hovermessage","")},record:function(){this.trigger("invoke-record")},rerecord:function(){this.trigger("invoke-rerecord")},stop:function(){this.trigger("invoke-stop")},pause:function(){this.trigger("invoke-pause")},resume:function(){this.trigger("invoke-resume")},skip:function(){this.trigger("invoke-skip")},cancel:function(){this.trigger("invoke-cancel")},uploadCovershot:function(e){this.trigger("upload-covershot",e[0].target)}}}}).register("ba-videorecorder-controlbar").registerFunctions({css:function(e){return e.css},"settingsvisible && settingsopen":function(e){return e.settingsvisible&&e.settingsopen},videoselectnotification:function(e){return e.videoselectnotification},"string('add-stream')":function(e){return e.string("add-stream")},csscommon:function(e){return e.csscommon},"showaddstreambutton && firefox && allowscreen":function(e){return e.showaddstreambutton&&e.firefox&&e.allowscreen},"addNewStream()":function(e){return e.addNewStream()},"hover(string('add-stream'))":function(e){return e.hover(e.string("add-stream"))},"showaddstreambutton && !firefox && !videoselectnotification":function(e){return e.showaddstreambutton&&!e.firefox&&!e.videoselectnotification},cameras:function(e){return e.cameras},"(camera.id !== selectedcamera) || allowscreen":function(e){return e.camera.id!==e.selectedcamera||e.allowscreen},"addNewStream(camera.id)":function(e){return e.addNewStream(e.camera.id)},"camera.label":function(e){return e.camera.label},"(showaddstreambutton && !firefox) || (firefox && allowscreen)":function(e){return e.showaddstreambutton&&!e.firefox||e.firefox&&e.allowscreen},"!novideo && !allowscreen && !ismobile":function(e){return!e.novideo&&!e.allowscreen&&!e.ismobile},"hover(string('select-camera'))":function(e){return e.hover(e.string("select-camera"))},"selectCamera(camera.id)":function(e){return e.selectCamera(e.camera.id)},"selectedcamera == camera.id":function(e){return e.selectedcamera==e.camera.id},"(!noaudio && !novideo) || !allowscreen":function(e){return!e.noaudio&&!e.novideo||!e.allowscreen},microphones:function(e){return e.microphones},"!noaudio && !allowscreen":function(e){return!e.noaudio&&!e.allowscreen},"selectMicrophone(microphone.id)":function(e){return e.selectMicrophone(e.microphone.id)},"hover(string('select-audio-input'))":function(e){return e.hover(e.string("select-audio-input"))},"selectedmicrophone == microphone.id":function(e){return e.selectedmicrophone==e.microphone.id},"microphone.label":function(e){return e.microphone.label},"settingsvisible && ismobile":function(e){return e.settingsvisible&&e.ismobile},"toggleFaceMode()":function(e){return e.toggleFaceMode()},"hover(string('switch-camera'))":function(e){return e.hover(e.string("switch-camera"))},settingsvisible:function(e){return e.settingsvisible},"settingsopen=!settingsopen":function(e){return e.settingsopen=!e.settingsopen},"settingsopen ? 'selected' : 'unselected'":function(e){return e.settingsopen?"selected":"unselected"},"hover(string('settings'))":function(e){return e.hover(e.string("settings"))},"unhover()":function(e){return e.unhover()},"settingsvisible && !novideo && !allowscreen":function(e){return e.settingsvisible&&!e.novideo&&!e.allowscreen},"hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))":function(e){return e.hover(e.string(e.camerahealthy?"camerahealthy":"cameraunhealthy"))},"camerahealthy ? 'good' : 'bad'":function(e){return e.camerahealthy?"good":"bad"},"settingsvisible && !noaudio && !allowscreen":function(e){return e.settingsvisible&&!e.noaudio&&!e.allowscreen},"hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))":function(e){return e.hover(e.string(e.microphonehealthy?"microphonehealthy":"microphoneunhealthy"))},"microphonehealthy ? 'good' : 'bad'":function(e){return e.microphonehealthy?"good":"bad"},"stopvisible && recordingindication":function(e){return e.stopvisible&&e.recordingindication},controlbarlabel:function(e){return e.controlbarlabel},recordvisible:function(e){return e.recordvisible},"record()":function(e){return e.record()},"hover(string('record-tooltip'))":function(e){return e.hover(e.string("record-tooltip"))},"string('record')":function(e){return e.string("record")},uploadcovershotvisible:function(e){return e.uploadcovershotvisible},"hover(string('upload-covershot-tooltip'))":function(e){return e.hover(e.string("upload-covershot-tooltip"))},"uploadCovershot(domEvent)":function(e){return e.uploadCovershot(e.domEvent)},covershot_accept_string:function(e){return e.covershot_accept_string},"string('upload-covershot')":function(e){return e.string("upload-covershot")},rerecordvisible:function(e){return e.rerecordvisible},"rerecord()":function(e){return e.rerecord()},"hover(string('rerecord-tooltip'))":function(e){return e.hover(e.string("rerecord-tooltip"))},"string('rerecord')":function(e){return e.string("rerecord")},cancelvisible:function(e){return e.cancelvisible},"cancel()":function(e){return e.cancel()},"hover(string('cancel-tooltip'))":function(e){return e.hover(e.string("cancel-tooltip"))},"string('cancel')":function(e){return e.string("cancel")},stopvisible:function(e){return e.stopvisible},"stop()":function(e){return e.stop()},"mintimeindicator ? css + '-disabled': ''":function(e){return e.mintimeindicator?e.css+"-disabled":""},"mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')":function(e){return e.mintimeindicator?e.string("stop-available-after").replace("%d",e.timeminlimit):e.string("stop-tooltip")},"hover( mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))":function(e){return e.hover(e.mintimeindicator?e.string("stop-available-after").replace("%d",e.timeminlimit):e.string("stop-tooltip"))},"string('stop')":function(e){return e.string("stop")},"pausable && !resumevisible && stopvisible":function(e){return e.pausable&&!e.resumevisible&&e.stopvisible},"pause()":function(e){return e.pause()},"string('pause-recorder')":function(e){return e.string("pause-recorder")},"hover(string('pause-recorder'))":function(e){return e.hover(e.string("pause-recorder"))},"pausable && resumevisible":function(e){return e.pausable&&e.resumevisible},"resume()":function(e){return e.resume()},"string('resume-recorder')":function(e){return e.string("resume-recorder")},"hover(string('resume-recorder'))":function(e){return e.hover(e.string("resume-recorder"))},skipvisible:function(e){return e.skipvisible},"skip()":function(e){return e.skip()},"hover(string('skip-tooltip'))":function(e){return e.hover(e.string("skip-tooltip"))},"string('skip')":function(e){return e.string("skip")}}).attachStringTable(t.strings).addStrings({settings:"Settings",camerahealthy:"Lighting is good",cameraunhealthy:"Lighting is not optimal",microphonehealthy:"Sound is good",microphoneunhealthy:"Cannot pick up any sound",record:"Record","record-tooltip":"Click here to record.",rerecord:"Redo","rerecord-tooltip":"Click here to redo.","upload-covershot":"Upload Cover","upload-covershot-tooltip":"Click here to upload custom cover shot",stop:"Stop","stop-tooltip":"Click here to stop.",skip:"Skip","skip-tooltip":"Click here to skip.","stop-available-after":"Minimum recording time is %d seconds",cancel:"Cancel","cancel-tooltip":"Click here to cancel.","add-stream":"Add Stream","pause-recorder":"Pause Recorder","resume-recorder":"Resume Recorder","no-video-source":"Missing additional video input source","stream-already-selected":"Additional stream has been already selected"})}),e.define("module:VideoRecorder.Dynamics.Faceoutline",["dynamics:Dynamic"],function(e,t){return e.extend({scoped:t},function(e){return{template:'<svg viewBox="0 0 301 171" style="width:100%; height:100%; position: absolute; top: 0; left: 0">\n    <g>\n        <path fill="none" stroke="white" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="3.0228,3.0228" d="M198.5,79.831c0,40.542-22.752,78.579-47.5,78.579c-24.749,0-47.5-38.036-47.5-78.579c0-40.543,17.028-68.24,47.5-68.24C185.057,11.591,198.5,39.288,198.5,79.831z"></path>\n    </g>\n</svg>'}}).registerFunctions({}).register("ba-videorecorder-faceoutline")}),e.define("module:VideoRecorder.Dynamics.Imagegallery",["dynamics:Dynamic","media:Recorder.Support","base:Collections.Collection","base:Properties.Properties","base:Timers.Timer","browser:Dom","browser:Info","module:Assets"],["dynamics:Partials.StylesPartial"],function(e,c,i,s,n,r,o,t,a){return e.extend({scoped:a},function(t){return{template:'<div ba-if="{{showslidercontainer}}">\n\t<div data-selector="slider-left-button" class="{{css}}-imagegallery-leftbutton">\n\t\t<div tabindex="0" data-selector="slider-left-inner-button"\n\t\t\t ba-hotkey:space^enter^left="{{left()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-imagegallery-button-inner" onclick="{{left()}}"\n\t\t>\n\t\t\t<i class="{{csscommon}}-icon-left-open"></i>\n\t\t</div>\n\t</div>\n\n\t<div data-selector="images-imagegallery-container" ba-repeat="{{image::images}}"\n\t\t class="{{css}}-imagegallery-container" data-gallery-container>\n\t\t<div tabindex="0" class="{{css}}-imagegallery-image"\n\t\t\t ba-hotkey:space^enter="{{select(image)}}" onmouseout="this.blur()"\n\t\t\t ba-styles="{{{left: image.left + \'px\', top: image.top + \'px\', width: image.width + \'px\', height: image.height + \'px\'}}}"\n\t\t\t onclick="{{select(image)}}"\n\t\t>\n\t\t\t<div class="{{css}}-imagegallery-image-compat" ba-show="{{ie10below}}"></div>\n\t\t</div>\n\t</div>\n\n\t<div data-selector="slider-right-button" class="{{css}}-imagegallery-rightbutton">\n\t\t<div tabindex="0" data-selector="slider-right-inner-button"\n\t\t\t ba-hotkey:space^enter^right="{{right()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-imagegallery-button-inner" onclick="{{right()}}"\n\t\t>\n\t\t\t<i class="{{csscommon}}-icon-right-open"></i>\n\t\t</div>\n\t</div>\n</div>\n\n<div ba-if="{{!showslidercontainer}}" class="{{css}}-chooser-container">\n\t<div data-selector="covershot-primary-button" class="{{css}}-chooser-button-container">\n\t\t<div class="{{css}}-chooser-button-0">\n\t\t\t<input type="file"\n\t\t\t\t   tabindex="0"\n\t\t\t\t   class="{{css}}-chooser-file"\n\t\t\t\t   accept="{{covershot_accept_string}}"\n\t\t\t\t   onchange="{{uploadCovershot(domEvent)}}"\n\t\t\t/>\n\t\t\t<i class="{{csscommon}}-icon-picture"></i>\n\t\t\t<span>\n\t\t\t{{string(\'upload-covershot\')}}\n\t\t</span>\n\t\t</div>\n\t</div>\n</div>\n',attrs:{css:"ba-videorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",imagecount:3,imagenativewidth:0,imagenativeheight:0,containerwidth:0,containerheight:0,containeroffset:0,images:{},deltafrac:1/8,showslidercontainer:!0,snapshots:[],covershot_accept_string:"image/*,image/png,image/jpg,image/jpeg"},computed:{"showslidercontainer:snapshots":function(){return 0<this.get("snapshots").length},"imagewidth:imagecount,containerwidth,deltafrac":function(){return this.get("imagecount")<=0?0:this.get("containerwidth")*(1-this.get("deltafrac"))/this.get("imagecount")},"imagedelta:imagecount,containerwidth,deltafrac":function(){return this.get("imagecount")<=1?0:this.get("containerwidth")*this.get("deltafrac")/(this.get("imagecount")-1)},"imageheight:imagewidth,imagenativewidth,imagenativeheight":function(){return this.get("imagenativeheight")*this.get("imagewidth")/this.get("imagenativewidth")}},create:function(){this.set("ie10below",o.isInternetExplorer()&&o.internetExplorerVersion()<=10);var e=this.auto_destroy(new i);this.set("images",e),this.snapshotindex=0,this._updateImageCount(),this.on("change:imagecount",this._updateImageCount,this),this.on("change:imagewidth change:imageheight change:imagedelta",this._recomputeImageBoxes,this),this.auto_destroy(new n({context:this,delay:1e3,fire:function(){this.updateContainerSize()}}))},destroy:function(){0<this.get("images").length&&this.get("images").iterate(function(e){e.snapshotDisplay&&this.parent().recorder&&this.parent().recorder.removeSnapshotDisplay(e.snapshotDisplay)},this),t.destroy.call(this)},_updateImageCount:function(){for(var e=this.get("images"),t=this.get("imagecount");e.count()<t;){var i=new s({index:e.count()});this._recomputeImageBox(i),e.add(i)}for(;e.count()>t;)e.remove(e.getByIndex(e.count()-1))},_recomputeImageBoxes:function(){this.get("images").iterate(function(e){this._recomputeImageBox(e)},this)},_recomputeImageBox:function(e){var t,i,s,n,r,o,a;!this.parent().recorder&&this.get("snapshots").length<1||(n=!1,(t=this.parent().get("videometadata").ratio)||"undefined"==typeof this.parent().recorder._recorder||"undefined"!=typeof this.parent().recorder._recorder._videoTrackSettings&&("undefined"!=typeof(i=this.parent().recorder._recorder._videoTrackSettings).aspectRatio?t=i.aspectRatio:"undefined"!=typeof i.width&&"undefined"!=typeof i.height&&(t=Math.round(i.width/i.height*100)/100)),t&&(s=Math.floor(this.get("imagewidth")/t),this.get("containerheight")<s)&&0<s&&(n=!0,s=Math.floor(.75*this.get("containerheight"))),i=e.get("index"),s=s||this.get("imageheight"),n=n?.75*this.get("imagewidth"):this.get("imagewidth"),r=this.get("imagedelta"),o=this.get("containerheight"),a=this.get("containerwidth"),1<s&&(1===this.get("images").count()&&(1<t?(n*=.45,s*=.45):n*=.45),2===this.get("images").count()&&t<1&&(n*=.7),e.set("left",1===this.get("images").count()?1+Math.round((a-n)/2):1+Math.round(i*(n+r))),e.set("top",1+Math.round((o-s)/2)),e.set("width",1+Math.round(n)),e.set("height",1+Math.round(s)),e.snapshot)&&e.snapshotDisplay&&(this.parent().recorder?this.parent().recorder:c).updateSnapshotDisplay(e.snapshot,e.snapshotDisplay,e.get("left")+this.get("containeroffset"),e.get("top"),e.get("width"),e.get("height")))},updateContainerSize:function(){var e=this.activeElement().querySelector("[data-gallery-container]"),t=r.elementOffset(e),i=t,s=(this.parent().recorder?i=r.elementOffset(this.parent().recorder._element):(s=this.parent().activeElement().querySelector("video"))&&(i=r.elementOffset(s)),t.left-i.left),t=r.elementDimensions(e);this.set("containeroffset",s),this.set("containerheight",t.height),this.set("containerwidth",t.width)},_afterActivate:function(e){t._afterActivate.apply(this,arguments),this.updateContainerSize()},loadImageSnapshot:function(e,t){e.snapshotDisplay&&((this.parent().recorder?this.parent().recorder:c).removeSnapshotDisplay(e.snapshotDisplay),e.snapshotDisplay=null);var i=this.get("snapshots");e.snapshot=i[(t%i.length+i.length)%i.length],e.snapshotDisplay=(this.parent().recorder?this.parent().recorder:c).createSnapshotDisplay(this.activeElement(),e.snapshot,e.get("left")+this.get("containeroffset"),e.get("top"),e.get("width"),e.get("height"))},loadSnapshots:function(){this.get("images").iterate(function(e){this.loadImageSnapshot(e,this.snapshotindex+e.get("index"))},this)},nextSnapshots:function(){this.snapshotindex+=this.get("imagecount"),this.loadSnapshots()},prevSnapshots:function(){this.snapshotindex-=this.get("imagecount"),this.loadSnapshots()},functions:{left:function(){this.prevSnapshots()},right:function(){this.nextSnapshots()},select:function(e){this.trigger("image-selected",e.snapshot)},uploadCovershot:function(e){this.trigger("upload-covershot",e[0].target)}}}}).registerFunctions({showslidercontainer:function(e){return e.showslidercontainer},css:function(e){return e.css},"left()":function(e){return e.left()},csscommon:function(e){return e.csscommon},images:function(e){return e.images},"select(image)":function(e){return e.select(e.image)},"{left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px'}":function(e){return{left:e.image.left+"px",top:e.image.top+"px",width:e.image.width+"px",height:e.image.height+"px"}},ie10below:function(e){return e.ie10below},"right()":function(e){return e.right()},"!showslidercontainer":function(e){return!e.showslidercontainer},covershot_accept_string:function(e){return e.covershot_accept_string},"uploadCovershot(domEvent)":function(e){return e.uploadCovershot(e.domEvent)},"string('upload-covershot')":function(e){return e.string("upload-covershot")}}).register("ba-videorecorder-imagegallery").attachStringTable(t.strings).addStrings({"upload-covershot":"Upload Cover"})}),e.define("module:VideoRecorder.Dynamics.Loader",["dynamics:Dynamic","module:Assets"],["dynamics:Partials.ShowPartial"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'\n<div class="{{cssrecorder}}-loader-container">\n    <div data-selector="recorder-loader-block" class="{{cssrecorder}}-loader-loader" title="{{tooltip || \'\'}}">\n    </div>\n</div>\n<div data-selector="recorder-loader-label-container" class="{{cssrecorder}}-loader-label" ba-show="{{label}}">\n\t{{label}}\n</div>\n',attrs:{css:"ba-videorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",tooltip:"",label:"",message:"",hovermessage:""}}}).registerFunctions({cssrecorder:function(e){return e.cssrecorder},"tooltip || ''":function(e){return e.tooltip||""},label:function(e){return e.label}}).register("ba-videorecorder-loader").attachStringTable(t.strings).addStrings({})}),e.define("module:VideoRecorder.Dynamics.Message",["dynamics:Dynamic"],["dynamics:Partials.ClickPartial"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'\n<div data-selector="recorder-message-container" class="{{css}}-message-container" ba-click="{{click()}}">\n    <div data-selector="recorder-message-block" class=\'{{css}}-message-message\'>\n        <p>\n            {{message || ""}}\n        </p>\n        <ul ba-if="{{links && links.length > 0}}" ba-repeat="{{link :: links}}">\n            <li>\n                <a href="javascript:;" ba-click="{{linkClick(link)}}">\n                    {{link.title}}\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>\n',attrs:{css:"ba-videorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",message:"",links:null},functions:{click:function(){this.trigger("click")},linkClick:function(e){this.trigger("link",e)}}}}).registerFunctions({css:function(e){return e.css},"click()":function(e){return e.click()},'message || ""':function(e){return e.message||""},"links && links.length > 0":function(e){return e.links&&0<e.links.length},links:function(e){return e.links},"linkClick(link)":function(e){return e.linkClick(e.link)},"link.title":function(e){return e.link.title}}).register("ba-videorecorder-message")}),e.define("module:VideoRecorder.Dynamics.Recorder",["dynamics:Dynamic","module:Assets","module:StylesMixin","browser:Info","browser:Dom","browser:Events","browser:Upload.MultiUploader","browser:Upload.FileUploader","media:Recorder.VideoRecorderWrapper","media:Recorder.Support","media:WebRTC.Support","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:States.Host","base:Classes.ClassRegistry","base:Collections.Collection","base:Promise","module:VideoRecorder.Dynamics.RecorderStates.Initial","module:VideoRecorder.Dynamics.RecorderStates"],["module:VideoRecorder.Dynamics.Imagegallery","module:VideoRecorder.Dynamics.Loader","module:VideoRecorder.Dynamics.Controlbar","module:VideoRecorder.Dynamics.Message","module:VideoRecorder.Dynamics.Topmessage","module:VideoRecorder.Dynamics.Chooser","module:VideoRecorder.Dynamics.Faceoutline","module:Common.Dynamics.Helperframe","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.DataPartial","dynamics:Partials.AttrsPartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"],function(e,i,t,a,c,s,n,r,o,l,d,u,h,m,g,p,f,y,b,v,x,_,A){return e.extend({scoped:A},[t,function(t){return{template:'\n<div data-selector="video-recorder-container" ba-show="{{!player_active}}"\n     class="{{css}}-container {{csstheme}} {{css}}-size-{{csssize}}\n     {{iecss}}-{{ie8 ? \'ie8\' : \'noie8\'}} {{css}}-{{ fullscreened ? \'fullscreen\' : \'normal\' }}-view\n     {{cssrecorder}}-{{ firefox ? \'firefox\' : \'common\'}}-browser\n     {{cssrecorder}}-{{themecolor}}-color\n\t {{csscommon}}-full-width"\n\t ba-styles="{{containerSizingStyles}}"\n>\n\n    <video tabindex="-1"\n\t\t   data-selector="recorder-status" class="{{css}}-video {{css}}-{{hasrecorder ? \'hasrecorder\' : \'norecorder\'}}"\n\t\t   data-video="video" playsinline disablePictureInPicture\n\t></video>\n\t<ba-videorecorder-faceoutline class="{{css}}-overlay" ba-if="{{faceoutline && hasrecorder && isrecorderready}}"></ba-videorecorder-faceoutline>\n    <div data-selector="recorder-overlay" style="{{placeholderstyle}}"\n\t\t class="{{cssrecorder}}-overlay {{hasplaceholderstyle ? (css + \'-overlay-with-placeholder\') : \'\'}}"\n\t\t ba-show="{{!hideoverlay}}"\n\t\t data-overlay="overlay"\n\t>\n\t\t<ba-{{dynloader}}\n\t\t\tba-css="{{cssloader || css}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-template="{{tmplloader}}"\n\t\t\tba-show="{{loader_active}}"\n\t\t\tba-tooltip="{{loadertooltip}}"\n\t\t\tba-hovermessage="{{=hovermessage}}"\n\t\t\tba-label="{{loaderlabel}}"\n\t\t></ba-{{dynloader}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t\tba-css="{{cssmessage || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t\tba-template="{{tmplmessage}}"\n\t\t\tba-show="{{message_active}}"\n\t\t\tba-message="{{message}}"\n\t\t\tba-links="{{message_links}}"\n\t\t\tba-event:click="message_click"\n\t\t\tba-event:link="message_link_click"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<ba-{{dyntopmessage}}\n\t\t\tba-css="{{csstopmessage || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t\tba-template="{{tmpltopmessage}}"\n\t\t\tba-show="{{topmessage_active && (topmessage || hovermessage)}}"\n\t\t\tba-topmessage="{{hovermessage || topmessage}}"\n\t\t></ba-{{dyntopmessage}}>\n\n\t\t<ba-{{dynchooser}}\n\t\t\tba-if="{{chooser_active && !is_initial_state}}"\n\t\t\tba-onlyaudio="{{onlyaudio}}"\n\t\t\tba-facecamera="{{facecamera}}"\n\t\t\tba-recordviafilecapture="{{recordviafilecapture}}"\n\t\t\tba-css="{{csschooser || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t\tba-template="{{tmplchooser}}"\n\t\t\tba-allowscreen="{{allowscreen}}"\n\t\t\tba-allowmultistreams="{{allowmultistreams}}"\n\t\t\tba-parentpopup="{{popup}}"\n\t\t\tba-allowrecord="{{allowrecord}}"\n\t\t\tba-allowupload="{{allowupload}}"\n\t\t\tba-allowcustomupload="{{allowcustomupload}}"\n\t\t\tba-allowedextensions="{{allowedextensions}}"\n\t\t\tba-primaryrecord="{{primaryrecord}}"\n\t\t\tba-initialmessages="{{initialmessages}}"\n\t\t\tba-timelimit="{{timelimit}}"\n\t\t\tba-event:record="record_video"\n\t\t\tba-event:record-screen="record_screen"\n\t\t\tba-event:upload="video_file_selected"\n\t\t></ba-{{dynchooser}}>\n\n\t\t<ba-{{dynimagegallery}}\n\t\t\tba-if="{{imagegallery_active}}"\n\t\t\tba-css="{{cssimagegallery || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t\tba-template="{{tmplimagegallery}}"\n\t\t\tba-imagecount="{{gallerysnapshots}}"\n\t\t\tba-snapshots="{{=snapshots}}"\n\t\t\tba-imagenativewidth="{{nativeRecordingWidth}}"\n\t\t\tba-imagenativeheight="{{nativeRecordingHeight}}"\n\t\t\tba-event:image-selected="select_image"\n\t\t\tba-event:upload-covershot="upload_covershot"\n\t\t></ba-{{dynimagegallery}}>\n\n\t\t<ba-{{dyncontrolbar}}\n\t\t\tba-css="{{csscontrolbar || css}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t\tba-csstheme="{{csstheme || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-template="{{tmplcontrolbar}}"\n\t\t\tba-show="{{controlbar_active}}"\n\t\t\tba-cameras="{{cameras}}"\n\t\t\tba-microphones="{{microphones}}"\n\t\t\tba-noaudio="{{noaudio}}"\n\t\t\tba-novideo="{{onlyaudio}}"\n\t\t\tba-allowscreen="{{record_media===\'screen\' || record_media===\'multistream\'}}"\n\t\t\tba-selectedcamera="{{selectedcamera || 0}}"\n\t\t\tba-selectedmicrophone="{{selectedmicrophone || 0}}"\n\t\t\tba-addstreamdeviceid="{{addstreamdeviceid || null}}"\n\t\t\tba-showaddstreambutton="{{showaddstreambutton}}"\n\t\t\tba-camerahealthy="{{camerahealthy}}"\n\t\t\tba-microphonehealthy="{{microphonehealthy}}"\n\t\t\tba-hovermessage="{{=hovermessage}}"\n\t\t\tba-settingsvisible="{{settingsvisible}}"\n\t\t\tba-recordvisible="{{recordvisible}}"\n\t\t\tba-cancelvisible="{{allowcancel && cancancel}}"\n\t\t\tba-uploadcovershotvisible="{{uploadcovershotvisible}}"\n\t\t\tba-rerecordvisible="{{rerecordvisible}}"\n\t\t\tba-stopvisible="{{stopvisible}}"\n\t\t\tba-skipvisible="{{skipvisible}}"\n\t\t\tba-controlbarlabel="{{controlbarlabel}}"\n\t\t\tba-mintimeindicator="{{mintimeindicator}}"\n\t\t\tba-timeminlimit="{{timeminlimit}}"\n\t\t\tba-resumevisible="{{resumevisible}}"\n\t\t\tba-pausable="{{pausable}}"\n\t\t\tba-firefox="{{firefox}}"\n\t\t\tba-event:select-camera="select_camera"\n\t\t\tba-event:select-microphone="select_microphone"\n\t\t\tba-event:invoke-record="record"\n\t\t\tba-event:invoke-rerecord="rerecord"\n\t\t\tba-event:invoke-stop="stop"\n\t\t\tba-event:invoke-skip="invoke_skip"\n\t\t\tba-event:invoke-pause="pause_recorder"\n\t\t\tba-event:invoke-resume="resume"\n\t\t\tba-event:invoke-cancel="cancel"\n\t\t\tba-event:upload-covershot="upload_covershot"\n\t\t\tba-event:toggle-face-mode="toggle_face_mode"\n\t\t\tba-event:add-new-stream="add_new_stream"\n\t\t></ba-{{dyncontrolbar}}>\n\n\t\t<ba-{{dynhelperframe}}\n\t\t\tba-if="{{helperframe_active || framevisible}}"\n\t\t\tba-template="{{tmphelperframe}}"\n\t\t\tba-framereversable= "{{multistreamreversable}}"\n\t\t\tba-framedragable="{{multistreamdraggable}}"\n\t\t\tba-frameresizeable="{{multistreamresizeable}}"\n\t\t\tba-framepositionx="{{addstreampositionx}}"\n\t\t\tba-framepositiony="{{addstreampositiony}}"\n\t\t\tba-frameproportional="{{addstreamproportional}}"\n\t\t\tba-flipframe="{{flip-camera}}"\n\t\t></ba-{{dynhelperframe}}>\n\t</div>\n</div>\n\n\n<div data-selector="recorder-player" ba-if="{{player_active}}" ba-styles="{{containerSizingStyles}}">\n\t<span ba-show="{{ie8}}">&nbsp;</span>\n\t<ba-{{dynvideoplayer}}\n\t\tba-theme="{{theme || \'default\'}}"\n\t\tba-themecolor="{{themecolor}}"\n\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\tba-source="{{localplayback ? playbacksource : \'\'}}"\n\t\tba-poster="{{localplayback ? playbackposter : \'\'}}"\n\t\tba-localplayback="{{localplayback}}"\n\t\tba-hideoninactivity="{{false}}"\n\t\tba-showsettingsmenu="{{showplayersettingsmenu}}"\n\t\tba-onlyaudio="{{onlyaudio}}"\n\t\tba-attrs="{{playerattrs}}"\n\t\tba-data:id="player"\n\t\tba-width="100%"\n\t\tba-height="100%"\n\t\tba-totalduration="{{duration}}"\n\t\tba-rerecordable="{{rerecordable && (recordings === null || recordings > 0)}}"\n\t\tba-submittable="{{manualsubmit && verified}}"\n\t\tba-reloadonplay="{{true}}"\n\t\tba-autoplay="{{autoplay}}"\n\t\tba-nofullscreen="{{nofullscreen}}"\n\t\tba-topmessage="{{playertopmessage}}"\n\t\tba-allowtexttrackupload="{{allowtexttrackupload}}"\n\t\tba-uploadtexttracksvisible="{{uploadtexttracksvisible}}"\n\t\tba-snapshottype="{{snapshottype}}"\n\t\tba-tracktags="{{tracktags}}"\n\t\tba-tracktagsstyled="{{tracktagsstyled}}"\n\t\tba-trackcuetext="{{trackcuetext}}"\n\t\tba-acceptedtracktexts="{{acceptedtracktexts}}"\n\t\tba-sharevideo="{{sharevideo}}"\n\t\tba-videofitstrategy="{{videofitstrategy}}"\n\t\tba-posterfitstrategy="{{posterfitstrategy}}"\n\t\tba-placeholderstyle="{{placeholderstyle}}"\n\t\tba-event:loaded="ready_to_play"\n\t\tba-event:rerecord="rerecord"\n\t\tba-event:playing="playing"\n\t\tba-event:paused="paused"\n\t\tba-event:ended="ended"\n\t\tba-event:submit="manual_submit"\n\t\tba-event:upload-text-tracks="upload_text_tracks"\n\t\tba-tracksshowselection="{{tracksshowselection}}"\n\t\tba-trackselectorhovered="{{trackselectorhovered}}"\n\t\tba-uploadlocales="{{uploadlocales}}"\n\t\tba-frameselectionmode="{{frameselectionmode}}"\n\t\tba-timeminlimit="{{timeminlimit}}"\n\t\tba-event:selected_label_value="selected_label_value"\n\t\tba-event:move_to_option="move_to_option"\n\t>\n\t</ba-{{dynvideoplayer}}>\n</div>\n',attrs:{css:"ba-videorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",iecss:"ba-videorecorder",cssimagegallery:"",cssloader:"",csscontrolbar:"",cssmessage:"",csstopmessage:"",csschooser:"",csshelperframe:"",gallerysnapshots:3,"popup-width":"","popup-height":"",theme:"",csstheme:"",themecolor:"",dynimagegallery:"videorecorder-imagegallery",dynloader:"videorecorder-loader",dyncontrolbar:"videorecorder-controlbar",dynmessage:"videorecorder-message",dyntopmessage:"videorecorder-topmessage",dynchooser:"videorecorder-chooser",dynvideoplayer:"videoplayer",dynhelperframe:"helperframe",tmplimagegallery:"",tmplloader:"",tmplcontrolbar:"",tmplmessage:"",tmpltopmessage:"",tmplchooser:"",tmplhelperframe:"",autorecord:!1,autoplay:!1,allowrecord:!0,allowupload:!0,allowcustomupload:!0,"manual-upload":!1,camerafacefront:!1,fittodimensions:!1,resizemode:null,createthumbnails:!1,primaryrecord:!0,allowscreen:!1,initialmessages:[],screenrecordmandatory:!1,nofullscreen:!1,recordingwidth:undefined,recordingheight:undefined,minuploadingwidth:undefined,maxuploadingwidth:undefined,minuploadingheight:undefined,maxuploadingheight:undefined,countdown:3,snapshotmax:15,"framerate-warning":null,framerate:null,audiobitrate:null,videobitrate:null,snapshottype:"jpg",picksnapshots:!0,playbacksource:"",screen:{},playbackposter:"",recordermode:!0,skipinitial:!1,skipinitialonrerecord:!1,timelimit:null,timeminlimit:null,webrtcstreaming:!1,webrtconmobile:!1,webrtcstreamingifnecessary:!0,"microphone-volume":1,"flip-camera":!1,flipscreen:!1,"early-rerecord":!1,"custom-covershots":!1,selectfirstcovershotonskip:!1,picksnapshotmandatory:!1,"media-orientation":null,manualsubmit:!1,allowedextensions:null,filesizelimit:null,faceoutline:!1,"display-timer":!0,pausable:!1,sharevideo:[],videofitstrategy:"pad",posterfitstrategy:"crop",placeholderstyle:"",hasplaceholderstyle:!1,"outsource-selectors":null,simulate:!1,onlyaudio:!1,noaudio:!1,"enforce-duration":null,localplayback:!1,uploadoptions:{},playerattrs:{},shortMessage:!0,"cpu-friendly":!1,rerecordable:!0,allowcancel:!1,recordings:null,ready:!0,orientation:!1,popup:!1,"audio-test-mandatory":!1,snapshotfromuploader:!1,snapshotfrommobilecapture:!1,allowmultistreams:!1,showaddstreambutton:!1,multistreamreversable:!0,multistreamdraggable:!0,multistreamresizeable:!1,addstreamproportional:!0,addstreampositionx:5,addstreampositiony:5,addstreampositionwidth:120,addstreampositionheight:null,addstreamminwidth:120,addstreamminheight:null,addstreamdeviceid:null,showsettingsmenu:!0,showplayersettingsmenu:!0,allowtexttrackupload:!1,framevisible:!1,uploadlocales:[{lang:"en",label:"English"}],tracktags:[],outsourceSelectors:[],hassubtitles:!1,videometadata:{},optionsinitialstate:{},playerfallbackwidth:320,playerfallbackheight:240,pickcovershotframe:!1,allowtrim:!1,trimoverlay:!0},computed:{"nativeRecordingWidth:recordingwidth,record_media":function(){return this.get("recordingwidth")||("screen"!==this.get("record_media")&&"multistream"!==this.get("record_media")?640:window.innerWidth||document.body.clientWidth)},"nativeRecordingHeight:recordingheight,record_media":function(){return this.get("recordingheight")||("screen"!==this.get("record_media")&&"multistream"!==this.get("record_media")?480:window.innerHeight||document.body.clientHeight)},"containerSizingStyles:aspectratio,nativeRecordingWidth,nativeRecordingHeight,activated, height, width":function(t,i,s,e,n,r){var o={aspectRatio:t||i+"/"+s};return n&&(o.height="string"==typeof n&&"%"===n[n.length-1]?n:n+"px"),r&&(o.width="string"==typeof r&&"%"===r[r.length-1]?r:r+"px"),e&&(a.isInternetExplorer()||a.isSafari()&&a.safariVersion()<15)&&(new ResizeObserver(function(e){this.set("height",Math.floor(e[0].target.offsetWidth/(t||i/s)))}.bind(this)).observe(this.activeElement().parentElement),o.height=Math.floor(this.activeElement().parentElement.offsetWidth/(t||i/s))+"px"),this.activeElement()&&this._applyStyles(this.activeElement(),o,this.__lastContainerSizingStyles),this.__lastContainerSizingStyles=o},"canswitchcamera:recordviafilecapture":function(){return!this.get("recordviafilecapture")&&a.isMobile()}},scopes:{player:">[id='player']"},types:{allowscreen:"boolean",rerecordable:"boolean",ready:"boolean",fittodimensions:"boolean",autorecord:"boolean",autoplay:"boolean",allowrecord:"boolean",allowupload:"boolean",allowcustomupload:"boolean",primaryrecord:"boolean",recordermode:"boolean",nofullscreen:"boolean",skipinitialonrerecord:"boolean",picksnapshots:"boolean",localplayback:"boolean",camerafacefront:"boolean",noaudio:"boolean",skipinitial:"boolean",popup:"boolean","popup-width":"int","popup-height":"int","enforce-duration":"bool",webrtcstreaming:"boolean",themecolor:"string",webrtconmobile:"boolean","manual-upload":"boolean",webrtcstreamingifnecessary:"boolean","microphone-volume":"float",audiobitrate:"int",videobitrate:"int",minuploadingwidth:"int",maxuploadingwidth:"int",minuploadingheight:"int",maxuploadingheight:"int","framerate-warning":"int",snapshotfromuploader:"boolean",snapshotfrommobilecapture:"boolean","flip-camera":"boolean",flipscreen:"boolean",faceoutline:"boolean","early-rerecord":"boolean","custom-covershots":"boolean",picksnapshotmandatory:"boolean",selectfirstcovershotonskip:"boolean",manualsubmit:"boolean",simulate:"boolean",allowedextensions:"array",onlyaudio:"boolean","cpu-friendly":"boolean",allowcancel:"boolean","display-timer":"boolean","audio-test-mandatory":"boolean",allowtexttrackupload:"boolean",uploadlocales:"array",allowmultistreams:"boolean",pausable:"boolean",sharevideo:"array",multistreamreversable:"boolean",multistreamdraggable:"boolean",multistreamresizeable:"boolean",addstreamproportional:"boolean",addstreampositionx:"int",addstreampositiony:"int",addstreampositionwidth:"int",addstreampositionheight:"int",addstreamminwidth:"int",addstreamminheight:"int",showsettingsmenu:"boolean",showplayersettingsmenu:"boolean",initialmessages:"array",screenrecordmandatory:"boolean","media-orientation":"string",mandatoryresolutions:"array",pickcovershotframe:"boolean",allowtrim:"boolean",trimoverlay:"boolean",outsourceSelectors:[]},extendables:["states"],remove_on_destroy:!0,events:{"change:camerahealthy":function(e){this.trigger("camerahealth",e)},"change:microphonehealthy":function(e){this.trigger("microphonehealth",e)},"change:webrtconmobile":function(){this.set("recordviafilecapture",a.isMobile()&&(!this.get("webrtconmobile")||!o.anySupport(this._videoRecorderWrapperOptions())))},"change:recordviafilecapture":function(){this.get("recordviafilecapture")&&(this.set("skipinitial",!1),this.set("skipinitialonrerecord",!1),this.set("autorecord",!1),this._screenRecorderVerifier(!1))},"change:placeholderstyle":function(e){this.set("hasplaceholderstyle",10<e.length)}},create:function(){var e;this._validateParameters(),d.globals(),this.set("optionsinitialstate",{autorecord:this.get("autorecord"),skipinitial:this.get("skipinitial")}),this.get("theme")&&this.set("theme",this.get("theme").toLowerCase()),this.get("theme")in i.recorderthemes&&h.iter(i.recorderthemes[this.get("theme")],function(e,t){this.isArgumentAttr(t)||this.set(t,e)},this),this.get("themecolor")||this.set("themecolor","default"),this.get("pausable")&&this.set("resumevisible",!1),this.set("ie8",a.isInternetExplorer()&&a.internetExplorerVersion()<9),this.set("hideoverlay",!1),this.set("firefox",a.isFirefox()),this.set("canswitchcamera",!1),this.set("recordviafilecapture",a.isMobile()&&(!this.get("webrtconmobile")||!o.anySupport(this._videoRecorderWrapperOptions()))),this.get("outsource-selectors")&&(e=h.map(this.get("outsource-selectors").split(/;/),function(e){var t={options:{type:"select",disabled:!0,showCapabilities:!0}},i="",e=e.split("["),s=e[0];if(/^cam\-[A-Za-z\d\-\_]*/i.test(s)&&(t.isCamera=!0,t.selector=s),/^mic\-[A-Za-z\d\-\_]*/i.test(s)&&(t.isCamera=!1,t.selector=s),5<(i=e[1]?e[1].replace(/\]$/,"").replace(/\=/g,":").replace(/\'/g,'"').replace(/(\w+:)|(\w+ :)/g,function(e){return'"'+e.substring(0,e.length-1)+'":'}):i).length)try{var n=JSON.parse("{"+i+"}");t.options=h.tree_extend(t.options,n)}catch(r){console.warn("Wrong settins for 'outsource-selectors' was provided")}if(!u.is_undefined(t.isCamera))return t},this),this.set("outsourceSelectors",e)),this.get("recordviafilecapture")&&(this.set("skipinitial",!1),this.set("skipinitialonrerecord",!1),this.set("autorecord",!1),this._screenRecorderVerifier(!1)),this.__attachRequested=!1,this.__activated=!1,this._bound=!1,this.__recording=!1,this.__error=null,this.host=new f({stateRegistry:new y(this.cls.recorderStates())}),(this.host.dynamic=this).host.initialize(this._initialState),this._timer=new p.Timer({context:this,fire:this._timerFire,delay:250,start:!0}),this.activeElement().style.setProperty("display","inline-block"),this._applyStyles(this.activeElement(),this.get("containerSizingStyles")),this.__cameraResponsive=!0,this.__cameraSignal=!0,this._initSettings(),this.get("onlyaudio")&&(this.set("allowupload",!1),this.set("orientation",!1),this.set("picksnapshots",this.get("custom-covershots"))),a.isMobile()||this.set("orientation",!1),this.set("currentorientation",window.innerHeight>window.innerWidth?"portrait":"landscape"),this._screenRecorderVerifier()},getMediaType:function(){return"video"},getCovershotFile:function(){return this.__lastCovershotUpload},getVideoFile:function(){return this._videoFile||this.recorder&&this.recorder.localPlaybackSource()||null},_initialState:x,state:function(){return this.host.state()},recorderAttached:function(){return!!this.recorder},videoError:function(){return this.__error},_error:function(e,t){this.__error={error_type:e,error_code:t},this.trigger("error:"+e,t),this.trigger("error",e,t)},_clearError:function(){this.__error=null},_detachRecorder:function(){this.recorder&&this.recorder.weakDestroy(),this.recorder=null,this.set("hasrecorder",!1),this.set("autorecord",this.get("optionsinitialstate").autorecord)},_validateParameters:function(){var e=["crop","pad","original"];e.includes(this.get("videofitstrategy"))||console.warn("Invalid value for videofitstrategy: "+this.get("videofitstrategy")+"\nPossible values are: "+e.slice(0,-1).join(", ")+" or "+e.slice(-1)),e.includes(this.get("posterfitstrategy"))||console.warn("Invalid value for posterfitstrategy: "+this.get("posterfitstrategy")+"\nPossible values are: "+e.slice(0,-1).join(", ")+" or "+e.slice(-1)),(this.get("stretch")||this.get("stretchwidth")||this.get("stretchheight"))&&console.warn("Stretch parameters were deprecated, your player will stretch to the full container width by default.");["minheight","minwidth","minheight","minwidth"].forEach(function(e){this.get(e)&&console.warn(e+" parameter was deprecated, please use CSS instead.")}.bind(this))},_videoRecorderWrapperOptions:function(){var e=null,t=this.get("resizemode");return(this.get("allowscreen")&&"screen"===this.get("record_media")||this.get("allowmultistreams")&&"multistream"===this.get("record_media"))&&(e=this.get("screen"),t=t||"none"),this.get("allowrecord")||!this.get("autorecord")&&!this.get("skipinitial")||(this.get("allowscreen")||this.get("allowmultistreams"))&&(this.set("record_media",this.get("allowscreen")?"screen":"multistream"),e={}),{simulate:this.get("simulate"),recordVideo:!this.get("onlyaudio"),screenResizeMode:this.get("screenresizemode"),recordAudio:!this.get("noaudio"),recordingWidth:this.get("nativeRecordingWidth"),recordingHeight:this.get("nativeRecordingHeight"),audioBitrate:"number"==typeof this.get("audiobitrate")?this.get("audiobitrate"):undefined,videoBitrate:"number"==typeof this.get("videobitrate")?this.get("videobitrate"):undefined,webrtcStreaming:!!this.get("webrtcstreaming"),webrtcStreamingIfNecessary:!!this.get("webrtcstreamingifnecessary"),localPlaybackRequested:this.get("localplayback"),screen:e,resizeMode:t,framerate:this.get("framerate"),flip:this.get("flip-camera"),flipscreen:this.get("flipscreen"),fittodimensions:this.get("fittodimensions"),cpuFriendly:this.get("cpu-friendly")}},_attachRecorder:function(){var e;this.recorderAttached()||(this.__activated?("screen"===this.get("record_media")&&"undefined"!=typeof navigator.mediaDevices&&"undefined"==typeof navigator.mediaDevices.getDisplayMedia&&this.set("webrtcstreaming",!0),this.set("hasrecorder",!0),this.__attachRequested=!1,e=this.activeElement().querySelector("[data-video='video']"),this._clearError(),this.recorder=o.create(h.extend({element:e},this._videoRecorderWrapperOptions())),this.recorder?(this.trigger("attached"),this.set("pausable",this.get("pausable")&&this.recorder.canPause())):this._error("attach")):this.__attachRequested=!0)},_softwareDependencies:function(){return this.recorderAttached()&&this.recorder?this.recorder.softwareDependencies():v.error("No recorder attached.")},_bindMedia:function(){!this._bound&&this.recorderAttached()&&this.recorder&&this.recorder.ready.success(function(){this.recorder&&(this.recorder.on("require_display",function(){this.set("hideoverlay",!0)},this),this.recorder.bindMedia().error(function(e){this.trigger("access_forbidden",e),this.set("hideoverlay",!1),this.off("require_display",null,this),this._error("bind",e)},this).success(function(){if(this.recorder){for(this.trigger("access_granted"),this.recorder.setVolumeGain(this.get("microphone-volume")),this.set("hideoverlay",!1),this.off("require_display",null,this),this.recorder.once("mainvideostreamended",function(){this.trigger("mainvideostreamended")},this),this.recorder.enumerateDevices().success(function(e){this.recorder&&(this.recorder.once("currentdevicesdetected",function(e){this.set("selectedcamera",e.video),this.set("selectedmicrophone",e.audio),0<this.get("outsourceSelectors").length&&this.setOutsourceSelectors(e)},this),this.set("cameras",new b(h.values(e.video))),this.set("microphones",new b(h.values(e.audio))),this.trigger(u.is_empty(e.video)?"no_camera":"has_camera"),this.trigger(u.is_empty(e.audio)?"no_microphone":"has_microphone"),this.set("showaddstreambutton",this._showAddStreamButton()))},this),this.get("noaudio")||this.recorder.testSoundLevel(!0),this.set("devicetesting",!0);0<this.get("snapshots").length;){var e=this.get("snapshots").unshift();this.recorder.removeSnapshot(e)}this._bound=!0,this.trigger("bound")}},this))},this)},isWebrtcStreaming:function(){return this.recorder&&this.recorder.isWebrtcStreaming()},_showAddStreamButton:function(){return this.get("allowmultistreams")&&(1<this.get("cameras").count()||1<=this.get("cameras").count()&&("screen"!==this.get("record_media")||"multistream"!==this.get("record_media")))},_initSettings:function(){this.set("snapshots",[]),this.thumbnails=[],this.__lastCovershotUpload=undefined,this.__pauseDelta=0,this.set("starttime",undefined),this.set("endtime",undefined),this.set("duration",0),this.set("videometadata",{height:null,width:null,ratio:null,thumbnails:{mainimage:null,images:[]},placeholderSnapshot:null})},_initializeUploader:function(){this._videoUploader&&this._videoUploader.weakDestroy(),this._dataUploader&&this._dataUploader.weakDestroy(),this._dataUploader=new n},_unbindMedia:function(){this._bound&&(this.recorder.unbindMedia(),this._bound=!1)},_uploadCovershot:function(e){this.get("simulate")||(this.__lastCovershotUpload=e,(e=(this.recorder||l).createSnapshotUploader(e,this.get("snapshottype"),this.get("uploadoptions").image)).upload(),this._dataUploader.addUploader(e))},_uploadCovershotFile:function(e){this.get("simulate")||(this.__lastCovershotUpload=e,(e=r.create(h.extend({source:e},this.get("uploadoptions").image))).upload(),this._dataUploader.addUploader(e))},_uploadThumbnails:function(e){this.get("simulate")||(this.set("videometadata",h.tree_merge(this.get("videometadata"),{thumbnails:{mainimage:e}})),(e=r.create(h.extend({source:e},this.get("uploadoptions").thumbnail))).upload(),this._dataUploader.addUploader(e))},_uploadThumbnailTracks:function(e){this.get("simulate")||(e=r.create(h.extend({source:e},this.get("uploadoptions").tracks)),this.get("uploadoptions").tracks.url&&this.get("tracktags").push({kind:"thumbnails",src:this.get("uploadoptions").tracks.url}),e.upload(),this._dataUploader.addUploader(e))},_uploadVideoFile:function(e){this.get("simulate")||((e=r.create(h.extend({source:e},this.get("uploadoptions").video))).upload(),this._videoUploader=e,this._dataUploader.addUploader(e))},_prepareRecording:function(){return v.create(!0)},_startRecording:function(){return this.__recording?v.error(!0):(this.get("noaudio")||this.recorder.testSoundLevel(!1),this.set("devicetesting",!1),this.recorder.startRecord({video:this.get("uploadoptions").video,audio:this.get("uploadoptions").audio,webrtcStreaming:this.get("uploadoptions").webrtcStreaming}).success(function(){this.__recording=!0,this.__recording_start_time=g.now()},this))},_stopRecording:function(){return this.__recording?this.recorder.stopRecord({video:this.get("uploadoptions").video,audio:this.get("uploadoptions").audio,webrtcStreaming:this.get("uploadoptions").webrtcStreaming,noUploading:this.get("uploadoptions").noUploading}).success(function(e){this.__recording=!1,e.upload(),this._dataUploader.addUploader(e)},this):v.error(!0)},isRecording:function(){return this.__recording},isFormatSupported:function(){return this.recorder&&this.recorder.supportsLocalPlayback()||this._videoFilePlaybackable},_verifyRecording:function(){return v.create(!0)},_afterActivate:function(e){t._afterActivate.call(this,e),this.set("activated",!0),this.__activated=!0,this.__attachRequested&&this._attachRecorder(),this.persistentTrigger("loaded"),this.activeElement().classList.add(this.get("csscommon")+"-full-width")},_showBackgroundSnapshot:function(){var e,t,i,s,n,r,o;this.get("onlyaudio")||(this._hideBackgroundSnapshot(),this.get("snapshots")&&this.get("selectfirstcovershotonskip")&&this.get("snapshots")[0]&&(this.__backgroundSnapshot=this.get("snapshots")[0]),!this.__backgroundSnapshot&&this.recorder&&(this.__backgroundSnapshot=this.recorder.createSnapshot(this.get("snapshottype"))),e=this.activeElement().querySelector("[data-video]"),t=c.elementDimensions(e),this.__backgroundSnapshot&&(n=s=0,r=t.width,o=t.height,this.recorder._recorder._videoTrackSettings&&"undefined"!=typeof this.recorder._recorder._videoTrackSettings.videoInnerFrame&&(r=(i=this.recorder._recorder._videoTrackSettings.videoInnerFrame).width||r,o=i.height||o,n=(t.width-r)/2,s=(t.height-o)/2),this.__backgroundSnapshotDisplay=this.recorder.createSnapshotDisplay(e,this.__backgroundSnapshot,n,s,r,o)))},_hideBackgroundSnapshot:function(){this.get("onlyaudio")||(this.__backgroundSnapshotDisplay&&this.recorder.removeSnapshotDisplay(this.__backgroundSnapshotDisplay),delete this.__backgroundSnapshotDisplay,this.__backgroundSnapshot&&this.recorder.removeSnapshot(this.__backgroundSnapshot),delete this.__backgroundSnapshot)},_getFirstFrameSnapshot:function(){var t,i;return this.__firstFrameSnapshot?v.value(this.__firstFrameSnapshot):this._videoFile||this.recorder&&this.recorder.localPlaybackSource().src?(t=v.create(),i=this._videoFile||this.recorder.localPlaybackSource().src,l.createSnapshotFromSource(URL.createObjectURL(i),this.get("snapshottype"),0).success(function(e){this.__firstFrameSnapshot=e,t.asyncSuccess(e),URL.revokeObjectURL(i)},this).error(function(e){t.asyncError(e),URL.revokeObjectURL(i)},this),t):v.error("No source to get the snapshot from")},toggleFaceOutline:function(e){void 0===e?this.set("faceoutline",!this.get("faceoutline")):this.set("faceoutline",e)},isMobile:function(){return a.isMobile()},object_functions:["record","rerecord","record_screen","stop","play","pause","reset","cancel","pause_recorder","resume","upload_video","upload_covershot","select_camera","select_microphone","add_new_stream","trim","toggle_face_mode"],functions:{cancel:function(){confirm(this.stringUnicode("cancel-confirm"))&&this.execute("reset")},record:function(){this._delegatedRecorder?this._delegatedRecorder.execute("record"):this.host.state().record()},record_video:function(){this.host.state().selectRecord()},record_screen:function(e){this._delegatedRecorder?this._delegatedRecorder.execute("record_screen"):this.host.state().selectRecordScreen(e)},pause_recorder:function(){this._delegatedRecorder?this._delegatedRecorder.execute("pause_recorder"):"undefined"!=typeof this.recorder&&(this.__paused=!0,this.__pauseStart=g.now(),this.__recording=!1,this.recorder.pauseRecord(),this.recorder._recorder.once("paused",function(e){this.set("resumevisible",!0)},this))},resume:function(){this._delegatedRecorder?this._delegatedRecorder.execute("resume"):"undefined"!=typeof this.recorder&&this._resume()},video_file_selected:function(e){this.__selected_video_file=e,this.get("manual-upload")||this.execute("upload_video")},upload_video:function(e){this.host.state().selectUpload(e||this.__selected_video_file)},upload_covershot:function(e){this.host.state().uploadCovershot(e)},select_camera:function(e){this.recorder&&(this.recorder.setCurrentDevices({video:e}),this.set("showaddstreambutton",this._showAddStreamButton()),this.set("selectedcamera",e))},select_microphone:function(e){this.recorder&&(this.recorder.setCurrentDevices({audio:e}),this.recorder.testSoundLevel(!0),this.set("selectedmicrophone",e)),this.set("microphonehealthy",!1)},toggle_face_mode:function(){this._delegatedRecorder?this._delegatedRecorder.execute("toggle_face_mode"):this.toggleFaceMode()},add_new_stream:function(e){this._add_new_stream(e)},invoke_skip:function(){this.trigger("invoke-skip")},select_image:function(e){this.trigger("select-image",e)},rerecord:function(){this._delegatedRecorder?this._delegatedRecorder.execute("rerecord"):confirm(this.stringUnicode("rerecord-confirm"))&&(this.host.state().rerecord(),this._initSettings())},stop:function(){this._delegatedRecorder?this._delegatedRecorder.execute("stop"):(this.__paused&&this._resume(),this.host.state().stop())},play:function(){this._delegatedRecorder?this._delegatedRecorder.execute("play"):this.host.state().play()},pause:function(){this._delegatedRecorder?this._delegatedRecorder.execute("pause"):this.host.state().pause()},message_click:function(){this.trigger("message-click")},message_link_click:function(e){this.trigger("message-link-click",e)},playing:function(){this.trigger("playing")},paused:function(){this.trigger("paused")},ended:function(){this.trigger("ended")},reset:function(){this._delegatedRecorder?this._delegatedRecorder.execute("reset"):this._stopRecording().callback(function(){this._unbindMedia(),this._hideBackgroundSnapshot(),this._detachRecorder(),this._initSettings(),this.host.state().next("Initial")},this)},trim:function(e,t){"Trimming"===this.host.state().state_name()&&this.trigger("manual-trim",e,t)},manual_submit:function(){this.set("rerecordable",!1),this.set("manualsubmit",!1),this.trigger("manually_submitted")},ready_to_play:function(){this.trigger("ready_to_play")}},_resume:function(){this.__paused=!1,this.__pauseDelta+=g.now()-this.__pauseStart,this.__recording=!0,this.recorder.resumeRecord(),this.recorder._recorder.once("resumed",function(){this.set("resumevisible",!1)},this)},destroy:function(){this._timer.destroy(),this.host.destroy(),this._detachRecorder(),t.destroy.call(this)},deltaCoefficient:function(){return this.recorderAttached()?this.recorder.deltaCoefficient():null},blankLevel:function(){return this.recorderAttached()?this.recorder.blankLevel():null},lightLevel:function(){return this.recorderAttached()?this.recorder.lightLevel():null},soundLevel:function(){return this.recorderAttached()?this.recorder.soundLevel():null},toggleFaceMode:function(){this.recorder&&(this.recorder.setCameraFace(this.get("camerafacefront")),this.set("camerafacefront",!this.get("camerafacefront")))},_timerFire:function(){if(!this.destroyed()){this.set("currentorientation",window.innerHeight>window.innerWidth?"portrait":"landscape");try{this.recorderAttached()&&this.get("devicetesting")&&(this.get("onlyaudio")||(e=this.lightLevel(),this.set("camerahealthy",100<=e&&e<=200)),!this.get("noaudio"))&&!this.get("microphonehealthy")&&1.01<=this.soundLevel()&&(this.set("microphonehealthy",!0),this.recorder.testSoundLevel(!1))}catch(o){}var e,t,i,s,n,r;!this.get("onlyaudio")&&this.__recording&&(this.get("picksnapshots")?this.__recording_start_time+500<g.now()&&(e=this.get("snapshots").length<this.get("snapshotmax")?.25:.05,Math.random()<=e)&&(e=this.recorder.createSnapshot(this.get("snapshottype")))&&(!this.get("videometadata").height&&"undefined"!=typeof Image&&this.get("createthumbnails")&&l.snapshotMetaData(e).success(function(e){var t="landscape"===e.orientation?80:35;this.set("videometadata",h.tree_merge(this.get("videometadata"),e)),this.set("videometadata",h.tree_merge(this.get("videometadata"),{thumbnails:{width:t,height:Math.floor(t/e.width*e.height)}}))},this),this.get("snapshots").length<this.get("snapshotmax")?this.get("snapshots").push(e):(t=Math.floor(Math.random()*this.get("snapshotmax")),this.recorder.removeSnapshot(this.get("snapshots")[t]),this.get("snapshots")[t]=e),this.get("createthumbnails"))&&(t=Math.floor((g.now()-this.__recording_start_time)/1e3),i=1<this.get("videometadata").thumbnails.images.length?this.get("videometadata").thumbnails.images.length-1:0,void 0===(i=this.get("videometadata").thumbnails.images[i])||t>i.time+1)&&this.get("videometadata").thumbnails.images.push({time:t,snap:e}):this.get("videometadata").processingPlaceholder||(this.get("videometadata").processingPlaceholder=this.recorder.createSnapshot(this.get("snapshottype"))));try{this.recorderAttached()&&this._timer.fire_count()%20==0&&this._accessing_camera&&(s=.01<=this.blankLevel())!==this.__cameraSignal&&(this.__cameraSignal=s,this.trigger(s?"camera_signal":"camera_nosignal")),this.recorderAttached()&&this._timer.fire_count()%20==10&&this._accessing_camera&&(r=null===(n=this.recorder.deltaCoefficient())||.5<=n)!==this.__cameraResponsive&&(this.__cameraResponsive=r,this.trigger(r?"camera_responsive":"camera_unresponsive"))}catch(o){}this._updateCSSSize()}},domDimensions:function(){return c.elementDimensions(this.activeElement().childNodes[0])},_updateCSSSize:function(){var e=this.domDimensions().width;this.set("csssize",400<e?"normal":300<e?"medium":"small")},videoHeight:function(){var e,t=window.innerHeight||document.body.clientHeight;return!this.recorderAttached()||t<(e=this.recorder.cameraHeight())?t:e},videoWidth:function(){var e,t=window.innerWidth||document.body.clientWidth;return!this.recorderAttached()||t<(e=this.recorder.cameraWidth())?t:e},aspectRatio:function(){return this.videoWidth()/this.videoHeight()},isPortrait:function(){return"undefined"!=typeof this.recorder&&"undefined"!=typeof this.recorder._recorder._videoTrackSettings?this.recorder._recorder._videoTrackSettings.aspectRatio<1:this.aspectRatio()<1},isLandscape:function(){return!this.isPortrait()},parentWidth:function(){return this.get("width")||c.elementDimensions(this.activeElement()).width},parentHeight:function(){return this.get("height")||c.elementDimensions(this.activeElement()).height},parentAspectRatio:function(){return this.parentWidth()/this.parentHeight()},averageFrameRate:function(){return this.recorderAttached()?this.recorder.averageFrameRate():null},cloneAttrs:function(){return h.map(this.attrs,function(e,t){return this.get(t)},this)},popupAttrs:function(){return{popup:!1,width:this.get("popup-width"),height:this.get("popup-height")}},imageUploaded:function(){return!!this.__lastCovershotUpload},audioUploaded:function(){return this.recorder&&this.recorder.localPlaybackSource()&&!!this.recorder.localPlaybackSource().audiosrc},_screenRecorderVerifier:function(e){e&&(this.set("allowscreen",!1),this.set("allowmultistreams",!1)),(this.get("allowscreen")||this.get("allowmultistreams"))&&this.get("screenrecordmandatory")&&!a.isScreenRecorderSupported()&&this.get("initialmessages").push({id:"undefined"!=typeof Date.now?+Date.now():1498744,message:this.string("screen-recorder-is-not-supported"),type:"warning"})},_add_new_stream:function(i){var s,t=this.recorder._recorder.stream().getTracks();this.get("cameras").iterate(function(e){e=e.data();i=i||e.id,s||i!==e.id||(this.set("loadlabel",this.string("adding-new-stream")),this.set("loader_active",!0),this.recorder.addMultiStream(e,{positionX:this.get("addstreampositionx"),positionY:this.get("addstreampositiony"),width:this.get("addstreampositionwidth"),height:this.get("addstreampositionheight")},t).success(function(e){var t;s=!0,this.set("addstreamdeviceid",i),this.get("addstreampositionheight")||(t=1.333,"undefined"!=typeof e.getTracks()[0]&&((e=e.getTracks()[0].getSettings()).aspectRatio?t=e.aspectRatio:0<e.height&&0<e.width&&(t=Math.round(e.width/e.height*100)/100)),e=t?this.get("addstreampositionwidth")/t:Math.round(this.get("addstreampositionwidth")/1.33),this.set("addstreampositionheight",e)),this.set("loadlabel",""),this.set("loader_active",!1),this.set("showaddstreambutton",!1),this.get("allowmultistreams")&&(this.get("multistreamreversable")||this.get("multistreamdraggable")||this.get("multistreamresizeable"))&&(this.set("helperframe_active",!0),this.set("framevisible",!0))},this).error(function(e){console.warn(e),this.set("loadlabel",e),this.set("loader_active",!1)},this))},this)},setOutsourceSelectors:function(a){h.map(this.get("outsourceSelectors"),function(e){var t,i,s,n,r=e.options,o=document.getElementById(e.selector);o?(t=e.isCamera,i=a[t?"video":"audio"],"select"===r.type&&"SELECT"!==o.tagName||"select"!==r.type&&"SELECT"===o.tagName?(r="You sould provide correct element selector, option element could be only select element child",n=document.createTextNode(r),"SELECT"===o.tagName&&(s=n,(n=document.createElement("option")).appendChild(s)),o.appendChild(n),console.warn(r)):this.__buildOutsourceElement(o,e.options,t,i)):console.warn("There are no element with id: "+e.selector+" to implement 'outsource-selectors'")},this)},__buildOutsourceElement:function(r,o,a,c){var l=this,e=a?this.get("cameras"):this.get("microphones"),d=[],n="";if(r.disabled=e.count()<=1&&o.disabled,0<e.count()){if("select"===o.type&&r.options)for(u.is_defined(r.options[0])&&(n=r.options[0].innerText);0<r.options.length;)r.remove(0);e.iterate(function(e){var t,i,s="",n=(o.showCapabilities&&a&&(n=e.get("capabilities"))&&"undefined"!=typeof n.width&&"undefined"!=typeof n.height&&(s="("+n.width.max+"x"+n.height.max+")"),e.get("id")),e=e.get("label");"select"===o.type&&"SELECT"===r.tagName&&((t=document.createElement("option")).value=n,t.innerText=e+s,t.selected=n===c,o.className&&(t.className+=o.className),r.appendChild(t)),"radio"===o.type&&(t=document.createElement("input"),i=document.createElement("label"),t.name=l.get("css")+(a?"-cam":"-mic")+"-radio-input",t.type="radio",o.className&&(i.className+=o.className),i.setAttribute("for",this.get("css")+n),t.value=n,t.checked=n===c,n=document.createTextNode(e+s),i.appendChild(t),i.appendChild(n),r.appendChild(i),t.addEventListener("change",function(e){var e=e.target,t=e.value;e.checked&&t&&(a?l.select_camera(t):l.select_microphone(t))}),d.push({type:"change",element:t,container:i}))},this),"select"===o.type&&(d.push({type:"change",element:r}),r.addEventListener("change",function(e){Array.from(e.target.options).forEach(function(e){var t=e.value;e.selected&&t&&(a?l.select_camera(t):l.select_microphone(t))})})),l.on("recording",function(){0<d.length&&h.map(d,function(e){var t=e.type,i=e.element,s=e.container||i;if(removeEventListener(t,i),u.is_undefined(s.options))s.parentNode.removeChild(s);else{for(;0<s.options.length;)s.remove(0);e=document.createElement("option"),t=document.createTextNode(n);e.appendChild(t),s.appendChild(e)}})})}}}}],{recorderStates:function(){return[_]}}).register("ba-videorecorder").registerFunctions({"!player_active":function(e){return!e.player_active},css:function(e){return e.css},csstheme:function(e){return e.csstheme},csssize:function(e){return e.csssize},iecss:function(e){return e.iecss},"ie8 ? 'ie8' : 'noie8'":function(e){return e.ie8?"ie8":"noie8"},"fullscreened ? 'fullscreen' : 'normal'":function(e){return e.fullscreened?"fullscreen":"normal"},cssrecorder:function(e){return e.cssrecorder},"firefox ? 'firefox' : 'common'":function(e){return e.firefox?"firefox":"common"},themecolor:function(e){return e.themecolor},csscommon:function(e){return e.csscommon},containerSizingStyles:function(e){return e.containerSizingStyles},"hasrecorder ? 'hasrecorder' : 'norecorder'":function(e){return e.hasrecorder?"hasrecorder":"norecorder"},"faceoutline && hasrecorder && isrecorderready":function(e){return e.faceoutline&&e.hasrecorder&&e.isrecorderready},placeholderstyle:function(e){return e.placeholderstyle},"hasplaceholderstyle ? (css + '-overlay-with-placeholder') : ''":function(e){return e.hasplaceholderstyle?e.css+"-overlay-with-placeholder":""},"!hideoverlay":function(e){return!e.hideoverlay},dynloader:function(e){return e.dynloader},"cssloader || css":function(e){return e.cssloader||e.css},"cssrecorder || css":function(e){return e.cssrecorder||e.css},tmplloader:function(e){return e.tmplloader},loader_active:function(e){return e.loader_active},loadertooltip:function(e){return e.loadertooltip},hovermessage:function(e){return e.hovermessage},loaderlabel:function(e){return e.loaderlabel},dynmessage:function(e){return e.dynmessage},"cssmessage || css":function(e){return e.cssmessage||e.css},tmplmessage:function(e){return e.tmplmessage},message_active:function(e){return e.message_active},message:function(e){return e.message},message_links:function(e){return e.message_links},dyntopmessage:function(e){return e.dyntopmessage},"csstopmessage || css":function(e){return e.csstopmessage||e.css},tmpltopmessage:function(e){return e.tmpltopmessage},"topmessage_active && (topmessage || hovermessage)":function(e){return e.topmessage_active&&(e.topmessage||e.hovermessage)},"hovermessage || topmessage":function(e){return e.hovermessage||e.topmessage},dynchooser:function(e){return e.dynchooser},"chooser_active && !is_initial_state":function(e){return e.chooser_active&&!e.is_initial_state},onlyaudio:function(e){return e.onlyaudio},facecamera:function(e){return e.facecamera},recordviafilecapture:function(e){return e.recordviafilecapture},"csschooser || css":function(e){return e.csschooser||e.css},tmplchooser:function(e){return e.tmplchooser},allowscreen:function(e){return e.allowscreen},allowmultistreams:function(e){return e.allowmultistreams},popup:function(e){return e.popup},allowrecord:function(e){return e.allowrecord},allowupload:function(e){return e.allowupload},allowcustomupload:function(e){return e.allowcustomupload},allowedextensions:function(e){return e.allowedextensions},primaryrecord:function(e){return e.primaryrecord},initialmessages:function(e){return e.initialmessages},timelimit:function(e){return e.timelimit},dynimagegallery:function(e){return e.dynimagegallery},imagegallery_active:function(e){return e.imagegallery_active},"cssimagegallery || css":function(e){return e.cssimagegallery||e.css},tmplimagegallery:function(e){return e.tmplimagegallery},gallerysnapshots:function(e){return e.gallerysnapshots},snapshots:function(e){return e.snapshots},nativeRecordingWidth:function(e){return e.nativeRecordingWidth},nativeRecordingHeight:function(e){return e.nativeRecordingHeight},dyncontrolbar:function(e){return e.dyncontrolbar},"csscontrolbar || css":function(e){return e.csscontrolbar||e.css},"csstheme || css":function(e){return e.csstheme||e.css},tmplcontrolbar:function(e){return e.tmplcontrolbar},controlbar_active:function(e){return e.controlbar_active},cameras:function(e){return e.cameras},microphones:function(e){return e.microphones},noaudio:function(e){return e.noaudio},"record_media==='screen' || record_media==='multistream'":function(e){return"screen"===e.record_media||"multistream"===e.record_media},"selectedcamera || 0":function(e){return e.selectedcamera||0},"selectedmicrophone || 0":function(e){return e.selectedmicrophone||0},"addstreamdeviceid || null":function(e){return e.addstreamdeviceid||null},showaddstreambutton:function(e){return e.showaddstreambutton},camerahealthy:function(e){return e.camerahealthy},microphonehealthy:function(e){return e.microphonehealthy},settingsvisible:function(e){return e.settingsvisible},recordvisible:function(e){return e.recordvisible},"allowcancel && cancancel":function(e){return e.allowcancel&&e.cancancel},uploadcovershotvisible:function(e){return e.uploadcovershotvisible},rerecordvisible:function(e){return e.rerecordvisible},stopvisible:function(e){return e.stopvisible},skipvisible:function(e){return e.skipvisible},controlbarlabel:function(e){return e.controlbarlabel},mintimeindicator:function(e){return e.mintimeindicator},timeminlimit:function(e){return e.timeminlimit},resumevisible:function(e){return e.resumevisible},pausable:function(e){return e.pausable},firefox:function(e){return e.firefox},dynhelperframe:function(e){return e.dynhelperframe},"helperframe_active || framevisible":function(e){return e.helperframe_active||e.framevisible},tmphelperframe:function(e){return e.tmphelperframe},multistreamreversable:function(e){return e.multistreamreversable},multistreamdraggable:function(e){return e.multistreamdraggable},multistreamresizeable:function(e){return e.multistreamresizeable},addstreampositionx:function(e){return e.addstreampositionx},addstreampositiony:function(e){return e.addstreampositiony},addstreamproportional:function(e){return e.addstreamproportional},"flip-camera":function(e){return e.flip-e.camera},player_active:function(e){return e.player_active},ie8:function(e){return e.ie8},dynvideoplayer:function(e){return e.dynvideoplayer},"theme || 'default'":function(e){return e.theme||"default"},"localplayback ? playbacksource : ''":function(e){return e.localplayback?e.playbacksource:""},"localplayback ? playbackposter : ''":function(e){return e.localplayback?e.playbackposter:""},localplayback:function(e){return e.localplayback},"false":function(e){return!1},showplayersettingsmenu:function(e){return e.showplayersettingsmenu},playerattrs:function(e){return e.playerattrs},duration:function(e){return e.duration},"rerecordable && (recordings === null || recordings > 0)":function(e){return e.rerecordable&&(null===e.recordings||0<e.recordings)},"manualsubmit && verified":function(e){return e.manualsubmit&&e.verified},"true":function(e){return!0},autoplay:function(e){return e.autoplay},nofullscreen:function(e){return e.nofullscreen},playertopmessage:function(e){return e.playertopmessage},allowtexttrackupload:function(e){return e.allowtexttrackupload},uploadtexttracksvisible:function(e){return e.uploadtexttracksvisible},snapshottype:function(e){return e.snapshottype},tracktags:function(e){return e.tracktags},tracktagsstyled:function(e){return e.tracktagsstyled},trackcuetext:function(e){return e.trackcuetext},acceptedtracktexts:function(e){return e.acceptedtracktexts},sharevideo:function(e){return e.sharevideo},videofitstrategy:function(e){return e.videofitstrategy},posterfitstrategy:function(e){return e.posterfitstrategy},tracksshowselection:function(e){return e.tracksshowselection},trackselectorhovered:function(e){return e.trackselectorhovered},uploadlocales:function(e){return e.uploadlocales},frameselectionmode:function(e){return e.frameselectionmode}}).attachStringTable(i.strings).addStrings({"recorder-error":"An error occurred, please try again later. Click to retry.","attach-error":"We could not access the media interface. Depending on the device and browser, you might need to access the page via SSL.","software-required":"Please click below to install / activate the following requirements in order to proceed.","software-waiting":"Waiting for the requirements to be installed / activated. You might need to refresh the page after completion.","access-forbidden":"Access to the media was forbidden. Click to retry.","pick-covershot":"Pick a covershot.","pick-covershot-frame":"Select a frame to use as covershot.","framerate-warning":"The video frame rate is very low. We recommend closing all other programs and browser tabs or to use a faster computer.",uploading:"Uploading","uploading-src-error":"Unable to play back video now, uploading is still in progress","uploading-failed":"Uploading failed - click here to retry.","upload-error-duration":"Length of the uploaded video does not meet the requirements - click here to retry.","resolution-constraint-error":"The file you've selected does not match the required resolution - click here to retry.",verifying:"Verifying","verifying-failed":"Verifying failed - click here to retry.","rerecord-confirm":"Do you really want to redo your video?","cancel-confirm":"Do you really want to cancel your video upload?",video_file_too_large:"Your video file is too large (%s) - click here to try again with a smaller video file.",unsupported_video_type:"Please upload: %s - click here to retry.","orientation-portrait-required":"Please rotate your device to record in portrait mode.","orientation-landscape-required":"Please rotate your device to record in landscape mode.","switch-camera":"Switch camera","prepare-covershot":"Preparing covershots","prepare-thumbnails":"Preparing seeking thumbnails","adding-new-stream":"Adding New Stream","missing-track":"Required audio or video track is missing","device-already-in-use":"At least one of your input devices are already in use","browser-permission-denied":"Permission denied by browser, please grant access and reload page","screen-recorder-is-not-supported":"Screen recorder is not supported on this device","trim-prompt":"Do you want to trim your video?","trim-video":"Move the start and end markers to trim your video","wait-for-trim":"Waiting for trim command...","supported-mode":"Media resolution should be in '%s' mode.","re-choose-action":"Please click to choose another input device or retry action."})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.State",["base:States.State","base:Events.ListenMixin","base:Objs"],function(e,t,i,s){return e.extend({scoped:s},[t,{dynamics:[],_start:function(){this.dyn=this.host.dynamic,i.iter(i.extend({message:!1,chooser:!1,topmessage:!1,controlbar:!1,loader:!1,imagegallery:!1,helperframe:!1},i.objectify(this.dynamics)),function(e,t){this.dyn.set(t+"_active",e)},this),this.dyn.set("placeholderStyle",""),this.dyn.set("playertopmessage",""),this.dyn.set("message_links",null),this.dyn._accessing_camera=!1,this._started()},_started:function(){},record:function(){this.dyn.set("autorecord",!0)},stop:function(){this.dyn.scopes.player.execute("stop")},play:function(){this.dyn.scopes.player.execute("play")},pause:function(){this.dyn.scopes.player.execute("pause")},rerecord:function(){},selectRecord:function(){},selectRecordScreen:function(e){},selectUpload:function(e){},uploadCovershot:function(e){},checkOrientation:function(e,t){if((t=t||"FatalError",this.dyn.get("media-orientation"))&&("portrait"===this.dyn.get("media-orientation")&&!e||"landscape"===this.dyn.get("media-orientation")&&e))return this.dyn.set("recordvisible",!1),e=this.dyn.string("supported-mode").replace("%s",e?"landscape":"portrait"),e+=" "+this.dyn.string("re-choose-action"),this.next(t,{message:e,retry:"Chooser"}),!1;return!0}}])}),e.define("module:VideoRecorder.Dynamics.RecorderStates.FatalError",["module:VideoRecorder.Dynamics.RecorderStates.State","browser:Info","base:Timers.Timer"],function(e,t,i,s){return e.extend({scoped:s},{dynamics:["message"],_locals:["message","retry"],_started:function(){this.dyn.set("message",this._message||this.dyn.string("recorder-error")),this.dyn.set("shortMessage",this.dyn.get("message").length<30),this.listenOn(this.dyn,"message-click",function(){this.dyn.set("placeholderstyle",""),this._retry&&this.next(this._retry)})}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.ChooseAlternativeDevice",["module:VideoRecorder.Dynamics.RecorderStates.State","browser:Info"],function(e,t,i){return e.extend({scoped:i},{dynamics:["message"],_locals:["message","retry"],_started:function(){this.dyn.set("controlbar_active",!0),this.dyn.set("message",this._message||this.dyn.string("recorder-error")),this.dyn.set("shortMessage",this.dyn.get("message").length<30),this.listenOn(this.dyn,"message-click",function(){this.next("Chooser")},this),"undefined"!=typeof this.dyn.recorder._recorder&&this.listenOn(this.dyn.recorder._recorder,"rebound",function(){t.isChromiumBased()&&this.next("CameraHasAccess")},this)}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.Initial",["module:VideoRecorder.Dynamics.RecorderStates.State","browser:Dom"],function(e,t,i){return e.extend({scoped:i},{_started:function(){this.dyn.set("is_initial_state",!0),this.dyn.set("verified",!1),this.dyn.set("playbacksource",null),this.dyn.set("playbackposter",null),this.dyn.set("player_active",!1),this.dyn.set("placeholderstyle",""),this.dyn._videoFileName=null,this.dyn._videoFile=null,this.dyn._videoFilePlaybackable=!1,this.dyn.__firstFrameSnapshot=null,this.dyn._initializeUploader(),this.dyn.get("recordermode")?this.dyn.get("autorecord")||this.dyn.get("skipinitial")?this.dyn.get("onlyaudio")?t.userInteraction(function(){this.eventualNext("RequiredSoftwareCheck")},this):this.eventualNext("RequiredSoftwareCheck"):this.next("Chooser"):this.dyn.get("video")?this.next("Player"):(console.warn("recordermode:false requires an existing video to be present and provided."),this.dyn.set("recordermode",!0))},_end:function(){this.dyn.set("is_initial_state",!1)}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.Player",["module:VideoRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{rerecord:function(){this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")},_started:function(){this.dyn.set("player_active",!0),this.dyn.get("allowtexttrackupload")&&this.dyn.set("uploadtexttracksvisible",!0)},_end:function(){this.dyn.set("player_active",!1),this.dyn.set("uploadtexttracksvisible",!1)}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.Chooser",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Strings","base:Objs","browser:Info","module:PopupHelper","media:Player.Support"],function(e,a,i,c,s,l,t){return e.extend({scoped:t},{dynamics:["chooser"],_started:function(){this.listenOn(this.dyn,"change:orientation change:currentorientation",function(){var e=this.dyn.get("orientation"),t=this.dyn.get("currentorientation"),t=e&&e!==t;t&&this.dyn.set("message",this.dyn.string("orientation-"+e+"-required")),this.dyn.set("message_active",t),this.dyn.set("chooser_active",!t)},this,{initcall:!0})},_popup:function(){var e=this.auto_destroy(new s),t=this.auto_destroy(new this.dyn.cls({element:e.containerInner,attrs:i.extend(this.dyn.cloneAttrs(),this.dyn.popupAttrs())}));this._delegatedRecorder=t,this.dyn.delegateEvents(null,t),e.on("hide",function(){this._delegatedRecorder=null,t.destroy(),e.destroy()},this),e.show(),t.activate()},record:function(){this.dyn.get("popup")?this._popup():(this.dyn.set("autorecord",!0),this.selectRecord())},selectRecordScreen:function(e){this.dyn.get("popup")?this._popup():(this.dyn.set("record_media",e?"multistream":"screen"),this.next("RequiredSoftwareCheck"))},selectRecord:function(){this.dyn.get("popup")?this._popup():(this.dyn.set("record_media","camera"),this.next("RequiredSoftwareCheck"))},selectUpload:function(t){if(this.dyn.get("popup"))this._popup();else{if(!(c.isMobile()&&c.isAndroid()&&c.isCordova())){if(this.dyn.get("allowedextensions")){var i=(t.files[0].name||"").toLowerCase(),s=!1;if(this.dyn.get("allowedextensions").forEach(function(e){a.ends_with(i,"."+e.toLowerCase())&&(s=!0)},this),!s)return e=this.dyn.string("unsupported_video_type").replace("%s",this.dyn.get("allowedextensions").join(" / ")),this.dyn.trigger("error",{error_type:"upload",error_code:e}),void this.next("FatalError",{message:e,retry:"Chooser"})}var e,n,r;if(this.dyn.get("filesizelimit")&&t.files&&0<t.files.length&&t.files[0].size&&t.files[0].size>this.dyn.get("filesizelimit"))return e="KB",n=Math.round(t.files[0].size/1e3),r=Math.round(this.dyn.get("filesizelimit")/1e3),999<n&&(e="MB",n=Math.round(n/1e3),r=Math.round(r/1e3)),void this.next("FatalError",{message:this.dyn.string("video_file_too_large").replace("%s",n+e+" / "+r+e),retry:"Chooser"})}try{l.videoFileInfo(t.files[0]).success(function(e){"undefined"!=typeof e.width&&"undefined"!=typeof e.height&&!this.checkOrientation(1<e.width/e.height)||(e.duration&&this.dyn.get("enforce-duration")&&(this.dyn.get("timeminlimit")&&e.duration<this.dyn.get("timeminlimit")||this.dyn.get("timelimit")&&e.duration>this.dyn.get("timelimit"))?this.next("FatalError",{message:this.dyn.string("upload-error-duration"),retry:"Chooser"}):e.width&&this.dyn.get("minuploadingwidth")&&this.dyn.get("minuploadingwidth")>e.width||e.width&&this.dyn.get("maxuploadingwidth")&&this.dyn.get("maxuploadingwidth")<e.width||e.height&&this.dyn.get("minuploadingheight")&&this.dyn.get("minuploadingheight")>e.height||e.height&&this.dyn.get("maxuploadingheight")&&this.dyn.get("maxuploadingheight")<e.height?this.next("FatalError",{message:this.dyn.string("resolution-constraint-error"),retry:"Chooser"}):(this.dyn._videoFilePlaybackable=!0,this.dyn.set("duration",e.duration),(e.width<=0||e.height<=0)&&(this.dyn._videoFilePlaybackable=!1,this.dyn.set("media_src_not_supported",!0),this._disablePlaybackOnRecorder()),this._uploadFile(t)))},this).error(function(e){e.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED&&(this.dyn.set("media_src_not_supported",!0),this._disablePlaybackOnRecorder()),this._uploadFile(t)},this)}catch(o){this._uploadFile(t)}}},_uploadFile:function(t){if(!this.__blocked){this.__blocked=!0,this.dyn.set("creation-type",c.isMobile()?"mobile":"upload");try{this.dyn._videoFileName=t.files[0].name,this.dyn._videoFile=t.files[0]}catch(e){}this.dyn._prepareRecording().success(function(){this.dyn.trigger("upload_selected",t),this.dyn._uploadVideoFile(t),this._setValueToEmpty(t),this.__blocked=!1,this.next("CovershotSelection")},this).error(function(e){this._setValueToEmpty(t),this.__blocked=!1,this.next("FatalError",{message:e,retry:"Chooser"})},this)}},_setValueToEmpty:function(e){try{e.value=""}catch(t){}},_disablePlaybackOnRecorder:function(){!0===this.dyn.get("allowtrim")&&(this.dyn.set("allowtrim",!1),this.dyn.set("was_allowtrim",!0)),!0===this.dyn.get("localplayback")&&(this.dyn.set("localplayback",!1),this.dyn.set("was_localplayback",!0)),!0===this.dyn.get("snapshotfromuploader")&&(this.dyn.set("snapshotfromuploader",!1),this.dyn.set("was_snapshotfromuploader",!0))}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.CreateUploadCovershot",["module:VideoRecorder.Dynamics.RecorderStates.State","media:Recorder.Support","base:Objs","base:Timers.Timer","browser:Dom","browser:Events","browser:Info","base:Async"],function(e,o,a,c,l,d,t,u,i){return e.extend({scoped:i},{dynamics:["loader","message"],_started:function(){this.dyn.set("cancancel",!0),this.dyn.set("loader_active",!0),this.dyn.set("topmessage",this.dyn.string("please-wait")),this.dyn.set("message",this.dyn.string("prepare-covershot")),this.dyn.get("cancancel")&&this.dyn.get("allowcancel")&&this.dyn.set("controlbar_active",!0);try{if(this.dyn.set("player_active",!1),!this.dyn._videoFile)return console.warn("Could not find source file to be able start player"),this.next("Trimming");this.dyn.set("playbacksource",(window.URL||window.webkitURL).createObjectURL(this.dyn._videoFile));var s=document.createElement("video"),i=0,n=0,r=1,e=(s.src=this.dyn.get("playbacksource"),s.setAttribute("preload","metadata"),s.volume=0,s.muted=!0,u.eventually(function(){if(s.readyState<1)return console.warn("Could not be able load video metadata"),this.next("Trimming")},this,5e3),this.auto_destroy(new d));e.on(s,"loadedmetadata",function(e){var t;return(n=s.duration)!==Infinity&&n?(r=this._calculateSeekPeriod(n),0<s.videoWidth&&0<s.videoHeight?(t=s.videoWidth>s.videoHeight?80:35,this.dyn.set("videometadata",a.tree_merge(this.dyn.get("videometadata"),{height:s.videoHeight,width:s.videoWidth,ratio:+(s.videoWidth/s.videoHeight).toFixed(2),thumbnails:{width:t,height:Math.floor(t/s.videoWidth*s.videoHeight)}})),void(this.__videoSeekTimer=new c({context:this,fire:function(){s.volume<.1||s.muted?s.currentTime=i:s.volume=0,i+=r},destroy_on_stop:!0,delay:500,start:!0}))):(console.warn("Could not find video dimensions information to be able create covershot"),this.next("Trimming"))):(console.warn("Could not generate video covershots from uploaded file"),this.next("Trimming"))},this),this.dyn.get("picksnapshots")?e.on(s,"seeked",function(e){var t,i=o.createSnapshot(this.dyn.get("snapshottype"),s,!0);i&&(this.dyn.get("createthumbnails")&&this.dyn.get("videometadata").thumbnails.images.push({time:s.currentTime,snap:i}),this.dyn.get("snapshots").length<this.dyn.get("snapshotmax")?this.dyn.get("snapshots").push(i):(t=Math.floor(Math.random()*this.dyn.get("snapshotmax")),o.removeSnapshot(this.dyn.get("snapshots")[t]),this.dyn.get("snapshots")[t]=i)),s.currentTime+r>=n&&(s.currentTime=s.currentTime+r,s.ended||l.triggerDomEvent(s,"ended"))},this):e.on(s,"canplay",function(e){s.currentTime=0;var t=o.createSnapshot(this.dyn.get("snapshottype"),s,!0);t&&(this.dyn.get("selectfirstcovershotonskip")&&(this.dyn.get("snapshots")[0]=t),this.dyn.get("videometadata").processingPlaceholder=t,l.triggerDomEvent(s,"ended"))},this),e.on(s,"ended",function(e){this.__videoSeekTimer.stop(),"function"==typeof s.remove?s.remove():s.style.display="none",this.next("CovershotSelection")},this)}catch(t){console.warn(t),this.next("Trimming")}},stop:function(){this.dyn.set("loader_active",!1),this.dyn.set("loaderlabel",""),this.dyn.set("topmessage","")},_calculateSeekPeriod:function(e){return e<15?1:e<40?3:e<100?4:Math.floor(e/100)+4}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.RequiredSoftwareCheck",["module:VideoRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("skipvisible",!1),this.dyn.set("uploadcovershotvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.listenOn(this.dyn,"error",function(e){this.next("FatalError",{message:this.dyn.string("attach-error"),retry:"Initial"})},this),this.dyn._attachRecorder(),this.dyn&&(this.dyn.on("message-link-click",function(e){e.execute(),this.next("RequiredSoftwareWait")},this),this.dyn._softwareDependencies().error(function(e){this.dyn.set("message_links",e),this.dyn.set("loader_active",!1),this.dyn.set("message_active",!0),this.dyn.set("message",this.dyn.string("software-required"))},this).success(function(){this.next("CameraAccess")},this))}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.RequiredSoftwareWait",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Promise","browser:Dom"],function(e,t,i,s){return e.extend({scoped:s},{dynamics:["message"],_started:function(){this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("skipvisible",!1),this.dyn.set("uploadcovershotvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.dyn.set("message",this.dyn.string("software-waiting")),t.resilience(function(){return i.isTabHidden()?t.error("Not ready"):this.dyn._softwareDependencies()},this,120,[],1e3).success(function(){this.next("CameraAccess")},this).error(function(){this.next("RequiredSoftwareCheck")},this),this.dyn.on("message-click",function(){this.next("RequiredSoftwareCheck")},this)}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.CameraAccess",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Objs","base:Types","base:Timers.Timer","base:Collections.Collection"],function(e,t,i,s,n,r){return e.extend({scoped:r},{dynamics:["loader"],_started:function(){this.dyn.set("settingsvisible",!0),this.dyn.set("recordvisible",!0),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("skipvisible",!1),this.dyn.set("uploadcovershotvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.listenOn(this.dyn,"bound",function(){var e;this.dyn.set("creation-type","webrtc"),this.dyn.get("onlyaudio")||"screen"===this.dyn.get("record_media")||"multistream"===this.dyn.get("record_media")?(this.dyn.get("allowmultistreams")&&"multistream"===this.dyn.get("record_media")&&this.dyn.recorder.enumerateDevices().success(function(e){this.set("cameras",new n(t.values(e.video))),this.trigger(i.is_empty(e.video)?"no_camera":"has_camera"),this._add_new_stream()},this.dyn),this.next("CameraHasAccess")):e=this.auto_destroy(new s({start:!0,delay:100,context:this,fire:function(){.01<=this.dyn.blankLevel()&&.01<=this.dyn.deltaCoefficient()&&(e.stop(),this.next("CameraHasAccess"))}}))},this),this.listenOn(this.dyn,"error",function(e){this.next("FatalError",{message:this.dyn.string("attach-error"),retry:"Initial"})},this),this.listenOn(this.dyn,"access_forbidden",function(e){var t=this.dyn.string("access-forbidden");"string"==typeof e.name&&"function"==typeof this.dyn.recorder.errorHandler&&"object"==typeof(e=this.dyn.recorder.errorHandler(e.name))&&(e.userLevel?t=this.dyn.string(e.key):console.warn(e.message+". Please inform us!")),this.next("FatalError",{message:t,retry:"Initial"})},this),this.dyn._bindMedia()}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.CameraHasAccess",["module:VideoRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["topmessage","controlbar"],_started:function(){this.checkOrientation(this.dyn.isPortrait(),"ChooseAlternativeDevice")&&(this.dyn.trigger("ready_to_record"),this._preparePromise=null,0<this.dyn.get("countdown")&&this.dyn.recorder&&this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions"))>1e3*this.dyn.get("countdown")&&(this._preparePromise=this.dyn._prepareRecording()),this.dyn.get("pausable")&&this.dyn.set("pausable",this.dyn.recorder.canPause()),this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),this.dyn.set("settingsvisible",!0),this.dyn.set("recordvisible",!0),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("skipvisible",!1),this.dyn.set("uploadcovershotvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("isrecorderready",!0),this.dyn.get("autorecord"))&&this.next("RecordPrepare",{preparePromise:this._preparePromise})},record:function(){this.dyn.get("autorecord")||this.dyn.get("audio-test-mandatory")&&!this.dyn.get("microphonehealthy")&&!this._preparePromise||this.next("RecordPrepare",{preparePromise:this._preparePromise})}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.RecordPrepare",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time"],function(e,t,l,i){return e.extend({scoped:i},{dynamics:["loader"],_locals:["preparePromise"],_started:function(){this.dyn.set("message",""),this.dyn.set("loaderlabel","");var i,s,n,r,o,a=!1,e=(this.dyn._accessing_camera=!0,this._preparePromise=this._preparePromise||this.dyn._prepareRecording(),this.dyn.get("countdown")?1e3*this.dyn.get("countdown"):0),c=this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions"))||0;e?(i=1e3,s=0,n=l.now(),r=n+Math.max(c,e),e<c?(s=Math.min(500,c-e),i=(c-s)/e*1e3):this.dyn.set("loaderlabel",this.dyn.get("countdown")),o=new t({context:this,delay:50,fire:function(){var e=l.now(),t=Math.max(0,r-e);s+n<e&&(this.dyn.set("loaderlabel",""+Math.ceil((t-s)/i)),this.dyn.trigger("countdown",Math.round((t-s)/i*1e3))),r<=e&&(this.dyn.set("loaderlabel",""),o.stop()),t<=c&&!a&&(a=!0,this._startRecording())}}),this.auto_destroy(o)):this._startRecording()},record:function(){this._startRecording()},_startRecording:function(){this._preparePromise.success(function(){this.dyn._startRecording().success(function(){this.next("Recording")},this).error(function(e){this.next("FatalError",{message:e,retry:"RequiredSoftwareCheck"})},this)},this).error(function(e){this.next("FatalError",{message:e,retry:"RequiredSoftwareCheck"})},this)}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.Recording",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time","base:TimeFormat","base:Async","browser:Info"],function(e,t,s,n,i,r,o){return e.extend({scoped:o},{dynamics:["topmessage","controlbar"],_started:function(){this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),this.dyn._accessing_camera=!0,this.dyn.trigger("recording"),this.dyn.set("settingsvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("stopvisible",!0),this.dyn.set("skipvisible",!1),this.dyn.set("uploadcovershotvisible",!1),this._startTime=s.now(),this._stopping=!1,this.__timerDelay=10,this._timer=this.auto_destroy(new t({immediate:!0,delay:this.__timerDelay,context:this,fire:this._timerFire})),this._framerateWarning=!1},_timerFire:function(){var e,t,i=this.dyn.get("timelimit");this.dyn.__paused||(e=s.now()-this.dyn.__pauseDelta,t=Math.max(0,i?this._startTime+1e3*i-e:e-this._startTime),this.dyn.trigger("recording_progress",e-this._startTime,!!this.dyn.__paused),this.dyn.set("controlbarlabel",this.dyn.get("display-timer")?n.format(n.ELAPSED_MINUTES_SECONDS,t):""),this.dyn.get("timeminlimit")&&this.dyn.set("mintimeindicator",(s.now()-this._startTime)/1e3<=this.dyn.get("timeminlimit")),i&&this._startTime+1e3*i<=e&&(this._timer.stop(),this.stop()),this.dyn.get("framerate-warning")&&this.dyn.averageFrameRate()&&(t=this.dyn.averageFrameRate()<this.dyn.get("framerate-warning"))!==this._framerateWarning&&((this._framerateWarning=t)?this.dyn.set("hovermessage",this.dyn.string("framerate-warning")):this.dyn.set("hovermessage","")))},stop:function(){var e=this.dyn.get("timeminlimit");if(e){var t=(s.now()-(this._startTime+this.dyn.__pauseDelta))/1e3;if(t<e){e=this.dyn.get("timelimit");if(!e||t<e)return}}this._stopping||(this.dyn.set("loader_active",!0),this.dyn.set("controlbar_active",!1),this.dyn.set("topmessage_active",!1),this.dyn.set("message_active",!0),this.dyn.set("message",""),this._stopping=!0,i.eventually(function(){this.dyn._stopRecording().success(function(){this._hasStopped(),this.next("CovershotSelection")},this).error(function(e){this.next("FatalError",{message:e,retry:"RequiredSoftwareCheck"})},this)},this))},_hasStopped:function(){this.dyn.set("duration",(s.now()-(this._startTime+this.dyn.__pauseDelta))/1e3),0<this.dyn.get("snapshots").length&&this.dyn._showBackgroundSnapshot(),this.dyn._unbindMedia(),this.dyn.trigger("recording_stopped")}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.Trimming",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Types"],function(e,i,t){return e.extend({scoped:t},{_started:function(){!this.dyn.isFormatSupported()||!this.dyn.get("allowtrim")||this.dyn.get("duration")<this.dyn.get("timeminlimit")?(this.dyn.isFormatSupported()||(this.dyn.set("allowtrim",!1),this.dyn.set("was_allowtrim",!0)),this.next("Uploading")):(this.dyn.get("trimoverlay")?this.dyn._getFirstFrameSnapshot().success(function(e){this.showTrimmingOverlay(e)},this).error(function(){this.showTrimmingOverlay(this.dyn.__backgroundSnapshot)},this):(this.dyn.set("message_active",!0),this.dyn.set("message",this.dyn.string("wait-for-trim")),this.listenOnce(this.dyn,"manual-trim",function(e,t){i.isNumber(e)&&0<e&&this.dyn.set("starttime",e),i.isNumber(t)&&t<=this.get("duration")&&this.dyn.set("endtime",t),this.dyn.trigger("video-trimmed",this.dyn.get("starttime"),this.dyn.get("endtime"),this.dyn.get("duration")),this.next("Uploading")})),this.dyn.trigger("ready-to-trim"))},showTrimmingOverlay:function(e){this._playerAttrs=this.dyn.get("playerattrs"),this.dyn.set("playerattrs",{poster:e,source:this.dyn._videoFile||this.dyn.recorder.localPlaybackSource(),trimmingmode:!0,hidecontrolbar:!0}),this.dyn.set("playertopmessage",this.dyn.string("trim-prompt")),this.dyn.set("player_active",!0),this.listenOnce(this.dyn.scopes.player,"playing",function(){this.dyn.scopes.player.set("skipinitial",!0),this.dyn.set("playertopmessage",this.dyn.string("trim-video"))}),this.listenOnce(this.dyn.scopes.player,"video-trimmed skip",function(e){e&&e.start&&this.dyn.set("starttime",e.start),e&&e.end&&this.dyn.set("endtime",e.end),this.dyn.trigger("video-trimmed",this.dyn.get("starttime"),this.dyn.get("endtime"),this.dyn.get("duration")),this.hideTrimmingOverlay(),this.next("Uploading")},this)},hideTrimmingOverlay:function(){this.dyn.set("trimmingmode",!1),this.dyn.set("playerattrs",this._playerAttrs),this.dyn.set("player_active",!1)}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.CovershotSelection",["module:VideoRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{_started:function(){!this.dyn.get("picksnapshots")&&!this.dyn.get("custom-covershots")||this.dyn.get("onlyaudio")?!this.dyn.get("snapshots")&&this.dyn.get("snapshotfromuploader")||this.dyn.get("snapshotfrommobilecapture")&&this.dyn.get("recordviafilecapture")?(this.dyn.set("snapshotmax",1),this.dyn.set("snapshots",[]),this.next("CreateUploadCovershot")):this._next(!0):this.dyn.get("pickcovershotframe")?this.dyn.recorder&&this.dyn.recorder.supportsLocalPlayback()||this.dyn.get("snapshotfromuploader")&&this.dyn.isFormatSupported()?this.next("CovershotSelectionFromPlayer"):this._next(!0):this.dyn.get("snapshots")&&0<this.dyn.get("snapshots").length?this.next("CovershotSelectionFromGallery"):this.dyn.get("snapshotfromuploader")||this.dyn.get("snapshotfrommobilecapture")&&this.dyn.get("recordviafilecapture")?this.next("CreateUploadCovershot"):this._next(!0)},rerecord:function(){this.dyn._hideBackgroundSnapshot(),this.dyn._detachRecorder(),this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")},_next:function(e){e&&this.dyn.get("selectfirstcovershotonskip")&&this.dyn.get("snapshots")&&this.dyn.get("snapshots")[0]&&this.dyn._uploadCovershot(this.dyn.get("snapshots")[0]),!this.dyn.get("videometadata").processingPlaceholder&&this.dyn.get("snapshots")[0]&&(this.dyn.get("videometadata").processingPlaceholder=this.dyn.get("snapshots")[0]),3<this.dyn.get("videometadata").thumbnails.images.length&&this.dyn.get("createthumbnails")?this.next("UploadThumbnails"):this.next("Trimming")}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.CovershotSelectionFromGallery",["module:VideoRecorder.Dynamics.RecorderStates.CovershotSelection"],function(e,t){return e.extend({scoped:t},{dynamics:["imagegallery","topmessage","controlbar"],_started:function(){var e;this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("skipvisible",!this.dyn.get("picksnapshotmandatory")),this.dyn.set("controlbarlabel",""),this.dyn.set("rerecordvisible",this.dyn.get("early-rerecord")),this.dyn.set("uploadcovershotvisible",this.dyn.get("custom-covershots")),this.dyn.set("hovermessage",""),this.dyn.set("topmessage",this.dyn.string("pick-covershot")),this.dyn.set("isrecorderready",!1),0<this.dyn.get("snapshots").length&&((e=this.dyn.scope(">[tagname='ba-videorecorder-imagegallery']").materialize(!0)).loadSnapshots(),e.updateContainerSize()),this.listenOn(this.dyn,"invoke-skip",function(){this._next(!0)},this),this.listenOn(this.dyn,"select-image",function(e){this.dyn._uploadCovershot(e),this.dyn.get("videometadata").processingPlaceholder=e,this._next(!1)},this)},uploadCovershot:function(e){"undefined"!=typeof e.files&&e.files[0]&&(e=e.files[0]),this.dyn._uploadCovershotFile(e),this._next(!1)}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.CovershotSelectionFromPlayer",["module:VideoRecorder.Dynamics.RecorderStates.CovershotSelection"],function(e,t){return e.extend({scoped:t},{_started:function(){this.dyn._getFirstFrameSnapshot().success(function(e){this.startFrameSelection(e)},this).error(function(){this.startFrameSelection(this.dyn.__backgroundSnapshot)},this)},startFrameSelection:function(e){this._playerattrs=this.dyn.get("playerattrs"),this.dyn.set("playerattrs",{poster:e,source:this.dyn._videoFile||this.dyn.recorder.localPlaybackSource(),skipinitial:!0}),this.dyn.set("frameselectionmode",!0),this.dyn.set("playertopmessage",this.dyn.string("pick-covershot-frame")),this.dyn.set("player_active",!0),this.listenOn(this.dyn.scopes.player,"image-selected",function(e){this.dyn._uploadCovershot(e),this._next(!1)},this)},endFrameSelection:function(){this.dyn.set("frameselectionmode",!1),this.dyn.set("playerattrs",this._playerattrs)},_end:function(){this.endFrameSelection()}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.UploadThumbnails",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Objs","base:Promise","base:Time","base:TimeFormat","media:WebRTC.Support","browser:Events"],function(e,t,d,i,m,s,u,n){return e.extend({scoped:n},{dynamics:["loader"],_started:function(){this.dyn.set("loader_active",!0),this.dyn.set("loadlabel","Thumbnails"),this.dyn.set("message",this.dyn.string("prepare-thumbnails")),this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),this._drawIntoCanvas(this.dyn.get("videometadata").thumbnails).success(function(e){this.dyn._uploadThumbnails(s.dataURItoBlob(e.toDataURL("image/jpg"))),this.dyn._uploadThumbnailTracks(new Blob(this._vttDescripitions,{type:"text/vtt"})),this.next("Trimming")},this).error(function(e){console.warn(e),this.next("Trimming")},this)},_drawIntoCanvas:function(e){var t,i=d.create(),s=e.width,n=e.height,r=e.images.length,o=10<e.images.length?Math.ceil(r/10):1,a=document.createElement("canvas"),c=(a.width=1<o?10*s:s*r,a.height=o*n,this._vttDescripitions=[],this._vttDescripitions.push("WEBVTT \n\n"),a.getContext("2d"));try{"undefined"!=typeof e.images[0]&&(this._imageEvent=this.auto_destroy(new u),(t=t||new Image).width=s,t.height=n,t.src=(window.URL||window.webkitURL).createObjectURL(e.images[0].snap),this._imageEvent.on(t,"load",function(){this._recursivelyDrawImage(a,e,c,s,n,t,0,i)},this),this._imageEvent.on(t,"error",function(e){throw"Error with loading thumbnail image. ".err},this))}catch(l){i.asyncError(l)}return i},_recursivelyDrawImage:function(e,t,i,s,n,r,o,a,c,l){if(c=c||0,l=l||0,o=o||0,i.drawImage(r,c*s,l*n,s,n),0<o&&o%10==0?(l++,c=0):0!==o&&c++,o++,"undefined"!=typeof t.images[o]&&t.images.length>=o){var d,r=o-1,u=o+1,h=Math.round((t.images[o].time-t.images[r].time)/2),r=t.images[r].time+h;t.images[u+1]||(h=0),h=t.images[o].time+h,r=0===r?"00:00:00":m.format("HH:MM:ss",1e3*r),h=0===h?"00:00:00":m.format("HH:MM:ss",1e3*h),"undefined"!=typeof t.images[u]&&this._vttDescripitions.push(r+".000 --\x3e "+h+".000\n"+this.dyn.get("uploadoptions").thumbnail.url+"#xywh="+c*s+","+l*n+","+s+","+n+"\n\n"),(d=new Image).width=s,d.height=n,d.src=(window.URL||window.webkitURL).createObjectURL(t.images[o].snap),this._imageEvent.on(d,"load",function(){this._recursivelyDrawImage(e,t,i,s,n,d,o,a,c,l)},this),this._imageEvent.on(d,"error",function(e){throw"Error with loading thumbnail image. Error: ".err},this)}else{if(!(t.images.length<=o))throw"Could not draw all images";a.asyncSuccess(e)}}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.Uploading",["module:VideoRecorder.Dynamics.RecorderStates.State","base:Time","base:Async","base:Objs"],function(e,n,r,t,i){return e.extend({scoped:i},{dynamics:["loader","message"],_started:function(){this.dyn.set("cancancel",!0),this.dyn.set("skipinitial",this.dyn.get("skipinitial")||this.dyn.get("skipinitialonrerecord")),this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("loadlabel",""),this.dyn.set("controlbarlabel",""),this.dyn.set("isrecorderready",!1),this.dyn.trigger("uploading"),this.dyn.set("rerecordvisible",this.dyn.get("early-rerecord")),(this.dyn.get("early-rerecord")||this.dyn.get("cancancel")&&this.dyn.get("allowcancel"))&&this.dyn.set("controlbar_active",!0),this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),!0!==this.dyn.get("media_src_not_supported")||!0!==this.dyn.get("was_allowtrim")&&!0!==this.dyn.get("was_localplayback")&&!0!==this.dyn.get("was_snapshotfromuploader")?this.dyn.set("uploading-message",this.dyn.string("uploading")):this.dyn.set("uploading-message",this.dyn.string("uploading-src-error")),this.dyn.set("message",this.dyn.get("uploading-message")),this.dyn.set("playertopmessage",this.dyn.get("message"));var t,e,i,s=this.dyn._dataUploader;this.listenOn(s,"success",function(){r.eventually(function(){this.destroyed()||(this._finished(),this.next("Verifying"))},this)}),this.listenOn(s,"error",function(e){var i=this.dyn.string("uploading-failed");try{e.forEach(function(e){for(var t in e)this.dyn.string("upload-error-"+t)&&(i=this.dyn.string("upload-error-"+t))},this)}catch(t){}this.dyn.set("player_active",!1),this.next("FatalError",{message:i,retry:this.dyn.recorderAttached()?"Uploading":"Initial"})}),this.listenOn(s,"progress",function(e,t){this.dyn.trigger("upload_progress",e,t),0!==t&&0<t&&0<=e&&(e=Math.min(100,Math.round(e/t*100)),isNaN(e)||(this.dyn.set("message",this.dyn.get("uploading-message")+": "+e+"%"),this.dyn.set("playertopmessage",this.dyn.get("message"))))}),this.dyn.get("localplayback")&&this.dyn.isFormatSupported()?(this.dyn.recorder&&this.dyn.recorder.supportsLocalPlayback()?this.dyn.set("playbacksource",this.dyn.recorder.localPlaybackSource()):this.dyn.set("playbacksource",(window.URL||window.webkitURL).createObjectURL(this.dyn._videoFile)),this.dyn.__lastCovershotUpload&&this.dyn.recorder&&this.dyn.set("playbackposter",this.dyn.recorder.snapshotToLocalPoster(this.dyn.__lastCovershotUpload)),this.dyn.set("loader_active",!1),this.dyn.set("message_active",!1),this.dyn._hideBackgroundSnapshot(),this.dyn.set("player_active",!0)):this.dyn.get("videometadata").processingPlaceholder&&"undefined"!=typeof window.URL&&(t=this.dyn,e=URL.createObjectURL(this.dyn.get("videometadata").processingPlaceholder),(i=new XMLHttpRequest).open("GET",e),i.onload=function(){var e=new FileReader;e.onloadend=function(){t.set("placeholderstyle","background: url('"+e.result+"') center/contain no-repeat")},e.readAsDataURL(i.response)},i.responseType="blob",i.send()),this.dyn.set("start-upload-time",n.now()),s.reset(),s.upload()},rerecord:function(){this.dyn._hideBackgroundSnapshot(),this.dyn._detachRecorder(),this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.dyn.set("placeholderstyle",""),this.next("Initial")},_finished:function(){this.dyn.set("cancancel",!1),this.dyn.trigger("uploaded"),this.dyn.set("end-upload-time",n.now())}})}),e.define("module:VideoRecorder.Dynamics.RecorderStates.Verifying",["module:VideoRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader","message"],_started:function(){this.dyn.set("loadlabel",""),this.dyn.trigger("verifying"),this.dyn.set("message",this.dyn.string("verifying")+"..."),this.dyn.set("playertopmessage",this.dyn.get("message")),this.dyn.get("localplayback")&&this.dyn.isFormatSupported()?(this.dyn.set("loader_active",!1),this.dyn.set("message_active",!1)):(this.dyn.set("rerecordvisible",this.dyn.get("early-rerecord")),this.dyn.get("early-rerecord")&&this.dyn.set("controlbar_active",!0)),this.dyn._verifyRecording().success(function(){this.dyn.trigger("verified"),this.dyn._hideBackgroundSnapshot(),this.dyn._detachRecorder(),this.dyn.get("recordings")&&this.dyn.set("recordings",this.dyn.get("recordings")-1),this.dyn.set("message",""),this.dyn.set("playertopmessage",""),this.dyn.set("verified",!0),this.next("Player")},this).error(function(){this.dyn.set("player_active",!1),this.dyn.set("placeholderstyle",""),this.next("FatalError",{message:this.dyn.string("verifying-failed"),retry:this.dyn.recorderAttached()?"Verifying":"Initial"})},this)},rerecord:function(){this.dyn._hideBackgroundSnapshot(),this.dyn._detachRecorder(),this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")}})}),e.define("module:VideoRecorder.Dynamics.Topmessage",["dynamics:Dynamic"],function(e,t){return e.extend({scoped:t},function(e){return{template:"\n<div class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-background'>\n    </div>\n    <div data-selector=\"recorder-topmessage-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",attrs:{css:"ba-videorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",topmessage:""}}}).registerFunctions({css:function(e){return e.css},topmessage:function(e){return e.topmessage}}).register("ba-videorecorder-topmessage")}),e.define("module:VideoRecorder.Dynamics.Trimmer",["dynamics:Dynamic","browser:Events","base:Promise"],function(e,t,s,i){return e.extend({scoped:i},function(e){return{template:'<div class="{{csstrimmer}}-container {{csscommon}}-accent-color-bg">\n    \n    <button ba-click="{{togglePlay()}}" class="{{csstrimmer}}-button-play" aria-label="{{playing || wasPlaying ? \'Pause\' : \'Play\'}}">\n        <i class="{{csscommon + \'-icon-\' + (playing || wasPlaying ? \'pause\' : \'play\')}} {{csscommon}}-accent-color"></i>\n    </button>\n    \n    <div\n        class="{{csstrimmer}}-progress-bar"\n        ontouchstart="{{handleProgressBarClick(domEvent)}}"\n        onmousedown="{{handleProgressBarClick(domEvent)}}"\n        data-selector="progressbar"\n    >\n        \n        <div\n            class="{{csstrimmer}}-snapshots"\n            data-selector="snapshots"\n        ></div>\n        \n        <div\n            class="{{csstrimmer}}-playhead"\n            style="left: calc({{duration ? position / duration * 100 : 0}}% - 1px)"\n        ></div>\n        \n        <div\n            class="{{csstrimmer}}-selection {{csscommon}}-accent-color-border"\n            ontouchstart="{{handleSelectionClick(domEvent)}}"\n            onmousedown="{{handleSelectionClick(domEvent)}}"\n            data-selector="selection"\n            style="\n                left: calc({{duration && startposition ? startposition / duration * 100 : 0}}% - 4px);\n                right: calc({{100 - (duration && endposition ? endposition / duration * 100 : 100)}}% - 4px);\n            "\n        ></div>\n    </div>\n    \n    <div class="{{csstrimmer}}-right-button-container">\n        \n        <button\n            class="{{csscommon}}-{{trimButtonEnabled ? \'accent-color-bg\' : \'disabled\'}} {{csstrimmer}}-button-trim"\n            ba-click="{{trim()}}"\n        >Trim</button>\n        \n        <button\n            class="{{csstrimmer}}-button-skip"\n            ba-click="{{skip()}}"\n        >Skip</button>\n    </div>\n</div>',attrs:{csscommon:"ba-commoncss",csstrimmer:"ba-videorecorder-trimmer"},computed:{"trimButtonEnabled:startposition,endposition,duration":function(e,t,i){return 0!==e&&null!==e||t!==i&&null!==t}},events:{"change:progress-bar-width":function(){this.call("updateThumbnails")}},destroy:function(){this._progressBarResizeObserver&&this._progressBarResizeObserver.disconnect(),e.destroy.call(this)},functions:{skip:function(){this.chainedTrigger("skip")},trim:function(){this.chainedTrigger("video-trimmed",{start:this.get("startposition"),end:this.get("endposition")})},togglePlay:function(){this.trigger(this.get("playing")?"pause":"play")},handleSelectionClick:function(e){var t,i,s,n,e=e[0];e.preventDefault(),("mousedown"!==e.type||0===e.button)&&(t=this.call("getClientX",e),i=e.target.getBoundingClientRect(),n=e.target.clientLeft,s=t>=i.left&&t<=i.left+n,n=t>=i.right-n&&t<=i.right,s||n)&&(e.stopPropagation(),s?this.call("attachUpdatePositionEventListeners",t,"startposition"):this.call("attachUpdatePositionEventListeners",t,"endposition"))},handleProgressBarClick:function(e){var t,i,e=e[0];e.preventDefault(),"mousedown"===e.type&&0!==e.button||(t=(e=this.call("getClientX",e))<=(i=this._selectionElement.getBoundingClientRect()).left,i=e>=i.right,t?this.call("attachUpdatePositionEventListeners",e,"startposition"):i?this.call("attachUpdatePositionEventListeners",e,"endposition"):(this.get("playing")&&(this.set("wasPlaying",!0),this.trigger("pause")),this.call("attachUpdatePositionEventListeners",e,"position")))},attachUpdatePositionEventListeners:function(e,t){this.call("updatePosition",e,t);var i=this._events;i.on(document,"mousemove touchmove",function(e){e.preventDefault(),this.call("updatePosition",this.call("getClientX",e),t)},this),i.on(document,"mouseup touchend",function(e){e.preventDefault(),this.get("wasPlaying")&&(this.trigger("play"),setTimeout(function(){this.set("wasPlaying",!1)}.bind(this),100)),i.off(document,"mouseup touchend mousemove touchmove")},this)},updatePosition:function(e,t){var i=this.call("getCurrentPosition",e),s=this.get("minduration")||1;switch(t){case"position":this.trigger("seek",i);break;case"startposition":var n=this.get("endposition")||this.get("duration");n-s<i?this.set(t,n-s):this.set(t,i);break;case"endposition":n=this.get("startposition")||0;i<n+s?this.set(t,n+s):this.set(t,i)}},getClientX:function(e){return 0===e.clientX?0:e.clientX||e.targetTouches[0].clientX},getCurrentPosition:function(e){var t=this._progressBarElement.getBoundingClientRect(),e=e<t.left?0:e>t.left+t.width?1:(e-t.left)/(t.width||1);return this.get("duration")*e},updateThumbnails:function(){this._internalVideoElement&&0!==this._progressBarElement.clientWidth&&this.call("drawSnapshotRecursive",1)},createNewCanvas:function(){var e=document.createElement("canvas");return e.height=this._canvasHeight,e.width=this._canvasWidth,this._snapshotsElement.appendChild(e),e},drawSnapshot:function(e,t){var i=s.create();return this._internalVideoElement.currentTime=t||0,this._events.on(this._internalVideoElement,"seeked",function(){e.getContext("2d").drawImage(this._internalVideoElement,0,0,e.width,e.height),this._events.off(this._internalVideoElement,"seeked"),i.asyncSuccess()},this),i},drawSnapshotRecursive:function(e){e*this._canvasWidth>this._progressBarElement.clientWidth||(e+1>=this._canvases.length&&this._canvases.push(this.call("createNewCanvas")),this.call("drawSnapshot",this._canvases[e],this.get("duration")*(e*this._canvasWidth/this._progressBarElement.clientWidth)).success(function(){this.call("drawSnapshotRecursive",++e)},this))}},create:function(){this._events=this.auto_destroy(new t),this._progressBarElement=this.activeElement().querySelector("[data-selector='progressbar']"),this._selectionElement=this.activeElement().querySelector("[data-selector='selection']"),this._snapshotsElement=this.activeElement().querySelector("[data-selector='snapshots']"),this._progressBarResizeObserver=new ResizeObserver(function(e){e.forEach(function(e){e.contentRect.width!==this.get("progress-bar-width")&&this.set("progress-bar-width",e.contentRect.width)}.bind(this))}.bind(this)),this._progressBarResizeObserver.observe(this._progressBarElement),this._loadVideo().success(function(){this.call("updateThumbnails")},this)},_loadVideo:function(){var e=s.create(),t=document.createElement("video"),i=this.get("source").src||this.get("source");return t.src="string"==typeof i?i:URL.createObjectURL(i),this._events.on(t,"loadedmetadata",function(){this&&!this.destroyed()&&(this.get("duration")||this.set("duration",t.duration),this._internalVideoElement=t,this._canvasHeight=34,this._canvasWidth=this._canvasHeight*t.videoWidth/t.videoHeight,this._canvases=[],this._canvases.push(this.call("createNewCanvas")),this.call("drawSnapshot",this._canvases[0],0).success(function(){e.asyncSuccess(t)}))},this),e}}}).register("ba-videorecorder-trimmer").registerFunctions({csstrimmer:function(e){return e.csstrimmer},csscommon:function(e){return e.csscommon},"togglePlay()":function(e){return e.togglePlay()},"playing || wasPlaying ? 'Pause' : 'Play'":function(e){return e.playing||e.wasPlaying?"Pause":"Play"},"csscommon + '-icon-' + (playing || wasPlaying ? 'pause' : 'play')":function(e){return e.csscommon+"-icon-"+(e.playing||e.wasPlaying?"pause":"play")},"handleProgressBarClick(domEvent)":function(e){return e.handleProgressBarClick(e.domEvent)},"duration ? position / duration * 100 : 0":function(e){return e.duration?e.position/e.duration*100:0},"handleSelectionClick(domEvent)":function(e){return e.handleSelectionClick(e.domEvent)},"duration && startposition ? startposition / duration * 100 : 0":function(e){return e.duration&&e.startposition?e.startposition/e.duration*100:0},"100 - (duration && endposition ? endposition / duration * 100 : 100)":function(e){return 100-(e.duration&&e.endposition?e.endposition/e.duration*100:100)},"trimButtonEnabled ? 'accent-color-bg' : 'disabled'":function(e){return e.trimButtonEnabled?"accent-color-bg":"disabled"},"trim()":function(e){return e.trim()},"skip()":function(e){return e.skip()}})}),e.define("module:ImageViewer.Dynamics.Controlbar",["dynamics:Dynamic","module:Assets","browser:Info"],["dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.ClickPartial"],function(e,t,i,s){return e.extend({scoped:s},function(e){return{template:'\n<div class="{{css}}-dashboard {{activitydelta > 5000 && hideoninactivity ? (css + \'-dashboard-hidden\') : \'\'}}">\n\t<div class="{{css}}-backbar"></div>\n\n\t<div class="{{css}}-controlbar">\n\n        <div tabindex="0" data-selector="submit-image-button"\n\t\t\t ba-hotkey:space^enter="{{submit()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-leftbutton-container"\n\t\t\t ba-if="{{submittable}}" ba-click="{{submit()}}">\n            <div class="{{css}}-button-inner">\n                {{string(\'submit-image\')}}\n            </div>\n        </div>\n\n        <div tabindex="0" data-selector="button-icon-ccw"\n\t\t\t ba-hotkey:space^enter="{{rerecord()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-leftbutton-container" ba-if="{{rerecordable}}"\n\t\t\t ba-click="{{rerecord()}}" title="{{string(\'rerecord-image\')}}"\n\t\t>\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-ccw"></i>\n            </div>\n        </div>\n\n\t\t<div data-selector="image-title-block" class="{{css}}-image-title-container" ba-if="{{title}}">\n\t\t\t<p class="{{css}}-image-title">\n\t\t\t\t{{title}}\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div tabindex="8" data-selector="button-icon-resize-full"\n\t\t\t ba-hotkey:space^enter="{{toggle_fullscreen()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-rightbutton-container"\n\t\t\t onkeydown="{{tab_index_move(domEvent)}}" ba-if="{{fullscreen}}"\n\t\t\t ba-click="{{toggle_fullscreen()}}" title="{{ fullscreened ? string(\'exit-fullscreen-image\') : string(\'fullscreen-image\') }}">\n\t\t\t<div class="{{css}}-button-inner">\n\t\t\t\t<i class="{{csscommon}}-icon-resize-{{fullscreened ? \'small\' : \'full\'}}"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>\n',attrs:{css:"ba-imageviewer",rerecordable:!1,submittable:!1,fullscreen:!0,fullscreened:!1,activitydelta:0,title:""},functions:{toggle_fullscreen:function(){this.trigger("fullscreen")},rerecord:function(){this.trigger("rerecord")},submit:function(){this.set("submittable",!1),this.set("rerecordable",!1),this.trigger("submit")},tab_index_move:function(e,t,i){this.trigger("tab_index_move",e[0],t,i)}},create:function(){this.set("ismobile",i.isMobile())}}}).register("ba-imageviewer-controlbar").registerFunctions({css:function(e){return e.css},"activitydelta > 5000 && hideoninactivity ? (css + '-dashboard-hidden') : ''":function(e){return 5e3<e.activitydelta&&e.hideoninactivity?e.css+"-dashboard-hidden":""},"submit()":function(e){return e.submit()},submittable:function(e){return e.submittable},"string('submit-image')":function(e){return e.string("submit-image")},"rerecord()":function(e){return e.rerecord()},rerecordable:function(e){return e.rerecordable},"string('rerecord-image')":function(e){return e.string("rerecord-image")},csscommon:function(e){return e.csscommon},title:function(e){return e.title},"toggle_fullscreen()":function(e){return e.toggle_fullscreen()},"tab_index_move(domEvent)":function(e){return e.tab_index_move(e.domEvent)},fullscreen:function(e){return e.fullscreen},"fullscreened ? string('exit-fullscreen-image') : string('fullscreen-image')":function(e){return e.fullscreened?e.string("exit-fullscreen-image"):e.string("fullscreen-image")},"fullscreened ? 'small' : 'full'":function(e){return e.fullscreened?"small":"full"}}).attachStringTable(t.strings).addStrings({"rerecord-image":"Redo?","submit-image":"Confirm","fullscreen-image":"Enter fullscreen","exit-fullscreen-image":"Exit fullscreen"})}),e.define("module:ImageViewer.Dynamics.Message",["dynamics:Dynamic"],["dynamics:Partials.ClickPartial"],function(e,t){return e.extend({scoped:t},function(e){return{template:'\n<div class="{{css}}-message-container" ba-click="{{click()}}">\n    <div data-selector="message-block" class=\'{{css}}-message-message\'>\n        {{message}}\n    </div>\n</div>\n',attrs:{css:"ba-imageviewer",message:""},functions:{click:function(){this.trigger("click")}}}}).registerFunctions({css:function(e){return e.css},"click()":function(e){return e.click()},message:function(e){return e.message}}).register("ba-imageviewer-message")}),e.define("module:ImageViewer.Dynamics.Topmessage",["dynamics:Dynamic"],function(e,t){return e.extend({scoped:t},function(e){return{template:"\n<div class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-background'>\n    </div>\n    <div data-selector=\"topmessage-message-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",attrs:{css:"ba-imageviewer",topmessage:""}}}).registerFunctions({css:function(e){return e.css},topmessage:function(e){return e.topmessage}}).register("ba-imageviewer-topmessage")}),e.define("module:ImageViewer.Dynamics.ImageViewer",["dynamics:Dynamic","module:Assets","browser:Info","browser:Dom","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:Classes.ClassRegistry","base:Async","browser:Events"],["module:ImageViewer.Dynamics.Message","module:ImageViewer.Dynamics.Controlbar","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"],function(e,i,s,n,t,r,o,a,c,l,d,u,h){return e.extend({scoped:h},function(t){return{template:'<div itemscope itemtype="http://schema.org/ImageObject"\n    class="{{css}}-container {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? \'ie8\' : \'noie8\'}}\n    {{csstheme}} {{css}}-{{ fullscreened ? \'fullscreen\' : \'normal\' }}-view {{css}}-{{ firefox ? \'firefox\' : \'common\'}}-browser\n    {{css}}-{{themecolor}}-color"\n    ba-on:mousemove="{{user_activity()}}"\n    ba-on:mousedown="{{user_activity(true)}}"\n    ba-on:touchstart="{{user_activity(true)}}"\n\tba-styles="{{widthHeightStyles}}"\n>\n    <img tabindex="-1" class="{{css}}-image" data-image="image" />\n    <div class="{{css}}-overlay">\n\t    <ba-{{dyncontrolbar}}\n\t\t    ba-css="{{csscontrolbar || css}}"\n\t\t\tba-csscommon="{{csscommon || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t    ba-template="{{tmplcontrolbar}}"\n\t\t    ba-show="{{controlbar_active}}"\n\t\t    ba-event:rerecord="rerecord"\n\t\t    ba-event:submit="submit"\n\t\t    ba-event:fullscreen="toggle_fullscreen"\n\t\t\tba-event:tab_index_move="tab_index_move"\n\t\t\tba-tabindex="{{tabindex}}"\n\t\t    ba-title="{{title}}"\n\t\t    ba-activitydelta="{{activity_delta}}"\n\t\t    ba-hideoninactivity="{{hideoninactivity}}"\n\t\t    ba-rerecordable="{{rerecordable}}"\n\t\t    ba-submittable="{{submittable}}"\n\t\t    ba-fullscreen="{{fullscreensupport && !nofullscreen}}"\n            ba-fullscreened="{{fullscreened}}"\n            ba-source="{{source}}"\n\t\t></ba-{{dyncontrolbar}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t    ba-css="{{cssmessage || css}}"\n\t\t\tba-csscommon="{{csscommon || css}}"\n\t\t\tba-theme-color="{{themecolor}}"\n\t\t    ba-template="{{tmplmessage}}"\n\t\t    ba-show="{{message_active}}"\n\t\t    ba-message="{{message}}"\n\t\t    ba-event:click="message_click"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<ba-{{dyntopmessage}}\n\t\t    ba-css="{{csstopmessage || css}}"\n\t\t\tba-csscommon="{{csscommon || css}}"\n\t\t\tba-theme-color="{{themecolor}}"\n\t\t    ba-template="{{tmpltopmessage}}"\n\t\t    ba-show="{{topmessage}}"\n\t\t    ba-topmessage="{{topmessage}}"\n\t\t></ba-{{dyntopmessage}}>\n\t\t\n\t\t<meta itemprop="caption" content="{{title}}" />\n\t\t<meta itemprop="thumbnailUrl" content="{{poster}}"/>\n\t\t<meta itemprop="contentUrl" content="{{source}}"/>\n    </div>\n</div>\n',attrs:{css:"ba-imageviewer",csscommon:"ba-commoncss",iecss:"ba-imageviewer",cssmessage:"",csstopmessage:"",csscontrolbar:"",width:"",height:"","popup-width":"","popup-height":"",theme:"",csstheme:"",themecolor:"",dynmessage:"imageviewer-message",dyntopmessage:"imageviewer-topmessage",dyncontrolbar:"imageviewer-controlbar",tmplmessage:"",tmpltopmessage:"",tmplcontrolbar:"",source:"",title:"",fullscreened:!1,visibilityfraction:.8,rerecordable:!1,submittable:!1,popup:!1,nofullscreen:!1,ready:!0,stretch:!1,"popup-stretch":!1,hideoninactivity:!0,topmessage:"",closebuttonvisible:!1,customcaptionvisible:!1,initialoptions:{hideoninactivity:null}},types:{rerecordable:"boolean",ready:"boolean",nofullscreen:"boolean",stretch:"boolean",hideoninactivity:"boolean",popup:"boolean","popup-stretch":"boolean","popup-width":"int","popup-height":"int",fullscreened:"boolean",themecolor:"string",closebuttonvisible:"boolean",customcaptionvisible:"boolean"},computed:{"widthHeightStyles:width,height":function(){var e={},t=this.get("width"),i=this.get("height");return t&&(e.width=t+((t+"").match(/^\d+$/g)?"px":"")),i&&(e.height=i+((i+"").match(/^\d+$/g)?"px":"")),e}},events:{"change:source":function(){var e=this.image();e&&(e.src=this.get("source"))}},remove_on_destroy:!0,create:function(){this.get("theme")&&this.set("theme",this.get("theme").toLowerCase()),this.get("theme")in i.imageviewerthemes&&r.iter(i.imageviewerthemes[this.get("theme")],function(e,t){this.isArgumentAttr(t)||this.set(t,e)},this),this.get("themecolor")||this.set("themecolor","default"),this.set("ie8",s.isInternetExplorer()&&s.internetExplorerVersion()<9),this.set("firefox",s.isFirefox()),this.set("message",""),this.set("fullscreensupport",n.elementSupportsFullscreen(this.activeElement())),this.set("csssize","normal"),this.set("controlbar_active",this.get("fullscreensupport")||this.get("submittable")||this.get("rerecordable")),this.set("message_active",!1),this.set("last_activity",a.now()),this.set("activity_delta",0),this.__currentStretch=null,this.__imageViewer={},this.set("initialoptions",{hideoninactivity:this.get("hideoninactivity")}),this.activeElement().onkeydown=this._keyDownActivity.bind(this,this.activeElement()),this.on("change:stretch",function(){this._updateStretch()},this),this._timer=new c.Timer({context:this,fire:this._timerFire,delay:100,start:!0})},getMediaType:function(){return"image"},_keyDownActivity:function(e,t){var i=t.which||t.keyCode;32!==i&&37!==i&&38!==i&&39!==i&&40!==i||t.preventDefault(),32!==i&&13!==i&&9!==i||(this._resetActivity(),this.get("fullscreened")&&this.get("hideoninactivity")&&this.set("hideoninactivity",!1)),9===i&&t.shiftKey?(this._resetActivity(),this._findNextTabStop(e,t,function(e,t){e.focus()},-1)):9===i&&(this._resetActivity(),this._findNextTabStop(e,t,function(e,t){e.focus()}))},_findNextTabStop:function(e,t,i,s){var n,r,o,a,c=n=0,l=s||1,d=t.target.tabIndex,u=e.querySelectorAll("[tabindex]");if(u=Array.prototype.slice.call(u,0).filter(function(e){return(0<e.clientWidth||0<e.clientHeight)&&-1!==e.tabIndex&&(c<=e.tabIndex&&(c=e.tabIndex),n>=e.tabIndex&&(n=e.tabIndex),!0)}),1===l&&d===c||-1===s&&d===n||0===c)1<document.querySelectorAll("ba-imageviewer").length&&(e.tabIndex=-1,e.blur());else{for(var h=0;h<u.length;h++)u[h]&&(a=(o=u[h].tabIndex)-d,o<n||c<o||Math.sign(a)!==l||(!r||Math.abs(a)<Math.abs(r.tabIndex-d))&&(r=u[h]));r&&(t.preventDefault(),i(r,r.tabIndex))}},_afterActivate:function(e){t._afterActivate.call(this,e),this.image().src=this.get("source")},_resetActivity:function(){this.set("last_activity",a.now()),this.set("activity_delta",0)},object_functions:["rerecord"],functions:{user_activity:function(e){this.set("last_activity",a.now()),this.set("activity_delta",0)},message_click:function(){this.trigger("message:click")},rerecord:function(){this.get("rerecordable")&&this.trigger("rerecord")},toggle_fullscreen:function(){this.get("fullscreened")&&this.__imageViewer.imageWrapper?this._close_image():this._open_image()},submit:function(){this.get("submittable")&&(this.trigger("submit"),this.set("submittable",!1),this.set("rerecordable",!1))},tab_index_move:function(e,t,i){var s,e=e.which||e.keyCode,n=this.activeElement();13===e||32===e?i?(s=n.querySelector("[data-selector='"+i+"']"))&&d.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!1})},this,100):(s=n.querySelector('[data-image="image"]'),d.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!0})},this,100)):9===e&&t&&(s=n.querySelector("[data-selector='"+t+"']"))&&d.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!1})},this,100)}},destroy:function(){this._timer.destroy(),this.host.destroy(),t.destroy.call(this)},_open_image:function(e){this.__imageViewer.counter=0,this.__imageViewer.imageViewer=document.createElement("div"),this.__imageViewer.imageWrapper=document.createElement("div"),this.__imageViewer.imageWrapper.className=this.get("css")+"-image-viewer-wrapper",this.__imageViewer.overlayElement=document.createElement("div"),this.__imageViewer.overlayElement.className=this.get("css")+"-image-viewer-overlay",this.__imageViewer.image=document.createElement("img"),this.__imageViewer.image.className=this.get("css")+"-image-viewer-expanded",this.__imageViewer.image.src=e||this.get("source"),this.get("customcaptionvisible")&&(this.__imageViewer.title=document.createElement("div"),this.__imageViewer.title.className=this.get("css")+"-image-viewer-title",e=document.createTextNode(this.get("title")),this.__imageViewer.title.appendChild(e)),this.get("closebuttonvisible")&&(this.__imageViewer.closeButton=document.createElement("div"),this.__imageViewer.closeButton.className=this.get("css")+"-close-button",this.__imageViewer.closeButton.tabIndex=0,this.__imageViewer.clickEvent=this.auto_destroy(new u),this.__imageViewer.clickEvent.on(this.__imageViewer.closeButton,"click",function(){this._close_image()},this),this.__imageViewer.clickEvent.on(this.__imageViewer.closeButton,"keydown",function(){this._close_image()},this)),this.__imageViewer.bodyOverlay=document.querySelector("ba-imageviewer"),this.__imageViewer.imageViewer.appendChild(this.__imageViewer.overlayElement),this.__imageViewer.imageViewer.appendChild(this.__imageViewer.image),this.get("customcaptionvisible")&&this.__imageViewer.imageViewer.appendChild(this.__imageViewer.title),this.get("closebuttonvisible")&&this.__imageViewer.imageViewer.appendChild(this.__imageViewer.closeButton),this.__imageViewer.bodyOverlay.parentNode.insertBefore(this.__imageViewer.imageWrapper,this.__imageViewer.bodyOverlay),this.__imageViewer.imageViewer.style.opacity=0,this.__imageViewer.imageWrapper.appendChild(this.__imageViewer.imageViewer),this.__imageViewer.fadeInCounter=new c.Timer({context:this,fire:this.__fadeIn,delay:40,start:!0}),this.set("hideoninactivity",!1),this.set("fullscreened",!0)},_close_image:function(){this.set("fullscreened",!1),this.set("hideoninactivity",this.get("initialoptions").hideoninactivity),this.__imageViewer.fadeInCounter=new c.Timer({context:this,fire:this.__fadeOut,delay:20,start:!0})},__fadeIn:function(){!this.__imageViewer.fadeInCounter||this.__imageViewer.fadeInCounter.destroyed()||(this.__imageViewer.counter<1.05?(this.__imageViewer.imageViewer.style.opacity=this.__imageViewer.counter,this.__imageViewer.counter+=.05):(this.__imageViewer.imageViewer.opacity=1,this.__imageViewer.fadeInCounter.stop()))},__fadeOut:function(){!this.__imageViewer.fadeInCounter||this.__imageViewer.fadeInCounter.destroyed()||(0<this.__imageViewer.counter?(this.__imageViewer.imageViewer.style.opacity=this.__imageViewer.counter,this.__imageViewer.counter-=.05):(this.__imageViewer.fadeInCounter.stop(),this.__imageViewer.bodyOverlay.parentNode.removeChild(this.__imageViewer.imageWrapper)))},_timerFire:function(){if(!this.destroyed()){try{this.set("activity_delta",a.now()-this.get("last_activity"))}catch(e){}try{this._updateStretch()}catch(e){}try{this._updateCSSSize()}catch(e){}}},_updateCSSSize:function(){var e=n.elementDimensions(this.activeElement()).width;this.set("csssize",400<e?"normal":300<e?"medium":"small")},image:function(){return this.activeElement().querySelector("img")},imageHeight:function(){var e=this.image().height,t=window.innerHeight||document.body.clientHeight;return!this._image()||t<e?t:e},imageWidth:function(){var e=window.innerWidth||document.body.clientWidth,t=this.image().width;return!this._image()||e<t?e:t},aspectRatio:function(){var e=this.imageHeight();return this.imageWidth()/e},parentWidth:function(){return n.elementDimensions(this.activeElement().parentElement).width},parentHeight:function(){return n.elementDimensions(this.activeElement().parentElement).height},parentAspectRatio:function(){return this.parentWidth()/this.parentHeight()},_updateStretch:function(){var e,t,i=null;this.get("stretch")&&(e=this.aspectRatio(),isFinite(e))&&(t=this.parentAspectRatio(),isFinite(t)?(e<t&&(i="height"),t<e&&(i="width")):t===Infinity&&(i="height")),this.__currentStretch!==i&&(this.__currentStretch&&n.elementRemoveClass(this.activeElement(),this.get("css")+"-stretch-"+this.__currentStretch),i)&&n.elementAddClass(this.activeElement(),this.get("css")+"-stretch-"+i),this.__currentStretch=i},cloneAttrs:function(){return r.map(this.attrs,function(e,t){return this.get(t)},this)},popupAttrs:function(){return{popup:!1,width:this.get("popup-width"),height:this.get("popup-height"),stretch:this.get("popup-stretch")}}}},{}).register("ba-imageviewer").registerFunctions({css:function(e){return e.css},csssize:function(e){return e.csssize},iecss:function(e){return e.iecss},"ie8 ? 'ie8' : 'noie8'":function(e){return e.ie8?"ie8":"noie8"},csstheme:function(e){return e.csstheme},"fullscreened ? 'fullscreen' : 'normal'":function(e){return e.fullscreened?"fullscreen":"normal"},"firefox ? 'firefox' : 'common'":function(e){return e.firefox?"firefox":"common"},themecolor:function(e){return e.themecolor},"user_activity()":function(e){return e.user_activity()},"user_activity(true)":function(e){return e.user_activity(!0)},widthHeightStyles:function(e){return e.widthHeightStyles},dyncontrolbar:function(e){return e.dyncontrolbar},"csscontrolbar || css":function(e){return e.csscontrolbar||e.css},"csscommon || css":function(e){return e.csscommon||e.css},tmplcontrolbar:function(e){return e.tmplcontrolbar},controlbar_active:function(e){return e.controlbar_active},tabindex:function(e){return e.tabindex},title:function(e){return e.title},activity_delta:function(e){return e.activity_delta},hideoninactivity:function(e){return e.hideoninactivity},rerecordable:function(e){return e.rerecordable},submittable:function(e){return e.submittable},"fullscreensupport && !nofullscreen":function(e){return e.fullscreensupport&&!e.nofullscreen},fullscreened:function(e){return e.fullscreened},source:function(e){return e.source},dynmessage:function(e){return e.dynmessage},"cssmessage || css":function(e){return e.cssmessage||e.css},tmplmessage:function(e){return e.tmplmessage},message_active:function(e){return e.message_active},message:function(e){return e.message},dyntopmessage:function(e){return e.dyntopmessage},"csstopmessage || css":function(e){return e.csstopmessage||e.css},tmpltopmessage:function(e){return e.tmpltopmessage},topmessage:function(e){return e.topmessage},poster:function(e){return e.poster}}).attachStringTable(i.strings).addStrings({"image-error":"An error occurred, please try again later. Click to retry."})}),e.define("module:ImageCapture.Dynamics.Recorder",["dynamics:Dynamic","module:Assets","browser:Info","browser:Dom","browser:Upload.MultiUploader","browser:Upload.FileUploader","media:ImageRecorder.ImageRecorderWrapper","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:States.Host","base:Classes.ClassRegistry","base:Collections.Collection","base:Promise","module:ImageCapture.Dynamics.RecorderStates.Initial","module:ImageCapture.Dynamics.RecorderStates"],["module:ImageCapture.Dynamics.Loader","module:ImageCapture.Dynamics.Controlbar","module:ImageCapture.Dynamics.Message","module:ImageCapture.Dynamics.Topmessage","module:ImageCapture.Dynamics.Chooser","module:ImageCapture.Dynamics.Faceoutline","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.DataPartial","dynamics:Partials.AttrsPartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"],function(e,i,s,n,r,o,a,t,c,l,d,u,h,m,g,p,f,y,b){return e.extend({scoped:b},function(t){return{template:'\n<div data-selector="capture-container" ba-show="{{!player_active}}"\n     class="{{css}}-container {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? \'ie8\' : \'noie8\'}} {{csstheme}}\n     \t{{css}}-{{ fullscreened ? \'fullscreen\' : \'normal\' }}-view {{css}}-{{ firefox ? \'firefox\' : \'common\'}}-browser\n    \t{{css}}-{{themecolor}}-color"\n     ba-styles="{{widthHeightStyles}}"\n>\n\n    <img tabindex="-1" data-selector="recorder-status" class="{{css}}-video {{css}}-{{hasrecorder ? \'hasrecorder\' : \'norecorder\'}}" data-image="image" />\n\t<ba-imagecapture-faceoutline class="{{css}}-overlay" ba-if="{{faceoutline && hasrecorder}}">\n\t</ba-imagecapture-faceoutline>\n    <div data-selector="recorder-overlay" class=\'{{css}}-overlay\' ba-show="{{!hideoverlay}}" data-overlay="overlay">\n\t\t<ba-{{dynloader}}\n\t\t    ba-css="{{cssloader || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t    ba-template="{{tmplloader}}"\n\t\t    ba-show="{{loader_active}}"\n\t\t    ba-tooltip="{{loadertooltip}}"\n\t\t\tba-hovermessage="{{=hovermessage}}"\n\t\t    ba-label="{{loaderlabel}}"\n\t\t></ba-{{dynloader}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t    ba-css="{{cssmessage || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t    ba-template="{{tmplmessage}}"\n\t\t    ba-show="{{message_active}}"\n\t\t    ba-message="{{message}}"\n\t\t\tba-links="{{message_links}}"\n\t\t    ba-event:click="message_click"\n\t\t\tba-event:link="message_link_click"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<ba-{{dyntopmessage}}\n\t\t    ba-css="{{csstopmessage || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t    ba-template="{{tmpltopmessage}}"\n\t\t    ba-show="{{topmessage_active && (topmessage || hovermessage)}}"\n\t\t    ba-topmessage="{{hovermessage || topmessage}}"\n\t\t></ba-{{dyntopmessage}}>\n\n\t\t<ba-{{dynchooser}}\n\t\t\tba-recordviafilecapture="{{recordviafilecapture}}"\n\t\t    ba-css="{{csschooser || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t    ba-template="{{tmplchooser}}"\n\t\t    ba-if="{{chooser_active && !is_initial_state}}"\n\t\t    ba-allowrecord="{{allowrecord}}"\n\t\t    ba-allowupload="{{allowupload}}"\n\t\t    ba-allowcustomupload="{{allowcustomupload}}"\n\t\t    ba-allowedextensions="{{allowedextensions}}"\n\t\t    ba-primaryrecord="{{primaryrecord}}"\n\t\t    ba-event:record="capture_image"\n\t\t    ba-event:upload="upload_image"\n\t\t></ba-{{dynchooser}}>\n\n\t\t<ba-{{dyncontrolbar}}\n\t\t    ba-css="{{csscontrolbar || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t    ba-template="{{tmplcontrolbar}}"\n\t\t    ba-show="{{controlbar_active}}"\n\t\t    ba-cameras="{{cameras}}"\n\t\t    ba-selectedcamera="{{selectedcamera || 0}}"\n\t\t    ba-camerahealthy="{{camerahealthy}}"\n\t\t    ba-hovermessage="{{=hovermessage}}"\n\t\t    ba-settingsvisible="{{settingsvisible}}"\n\t\t    ba-recordvisible="{{recordvisible}}"\n\t\t\tba-cancelvisible="{{allowcancel && cancancel}}"\n\t\t    ba-rerecordvisible="{{rerecordvisible}}"\n\t\t    ba-controlbarlabel="{{controlbarlabel}}"\n\t\t    ba-event:select-camera="select_camera"\n\t\t    ba-event:invoke-record="record"\n\t\t    ba-event:invoke-rerecord="rerecord"\n\t\t></ba-{{dyncontrolbar}}>\n    </div>\n</div>\n\n<div data-selector="recorder-player" ba-if="{{player_active}}" ba-styles="{{widthHeightStyles}}">\n\t<span ba-show="{{ie8}}">&nbsp;</span>\n\t<ba-{{dynimageviewer}}\n\t    ba-theme="{{theme || \'default\'}}"\n        ba-themecolor="{{themecolor}}"\n        ba-source="{{playbacksource}}"\n        ba-hideoninactivity="{{false}}"\n        ba-stretch="{{stretch}}"\n        ba-attrs="{{playerattrs}}"\n        ba-data:id="player"\n        ba-width="{{width}}"\n        ba-height="{{height}}"\n        ba-rerecordable="{{rerecordable && (recordings === null || recordings > 0)}}"\n        ba-submittable="{{manualsubmit && verified}}"\n        ba-nofullscreen="{{nofullscreen}}"\n        ba-event:rerecord="rerecord"\n        ba-event:submit="manual_submit"\n\t>\n\t</ba-{{dynimageviewer}}>\n</div>\n',attrs:{css:"ba-imagecapture",csscommon:"ba-commoncss",iecss:"ba-imagecapture",cssimagegallery:"",cssloader:"",csscontrolbar:"",cssmessage:"",csstopmessage:"",csschooser:"",width:"",height:"",gallerysnapshots:3,theme:"",csstheme:"",dynloader:"imagecapture-loader",dyncontrolbar:"imagecapture-controlbar",dynmessage:"imagecapture-message",dyntopmessage:"imagecapture-topmessage",dynchooser:"imagecapture-chooser",dynimageviewer:"imageviewer",tmplloader:"",tmplcontrolbar:"",tmplmessage:"",tmpltopmessage:"",tmplchooser:"",autorecord:!1,allowrecord:!0,allowupload:!0,allowcustomupload:!0,camerafacefront:!1,primaryrecord:!0,nofullscreen:!1,recordingwidth:undefined,recordingheight:undefined,minuploadingwidth:undefined,maxuploadingwidth:undefined,minuploadingheight:undefined,maxuploadingheight:undefined,countdown:3,webrtconmobile:"boolean",snapshottype:"jpg",playbacksource:"",recordermode:!0,skipinitial:!1,skipinitialonrerecord:!1,"flip-camera":!1,"early-rerecord":!1,manualsubmit:!1,allowedextensions:null,filesizelimit:null,faceoutline:!1,simulate:!1,localplayback:!1,uploadoptions:{},playerattrs:{},shortMessage:!0,rerecordable:!0,recordings:null,ready:!0,orientation:!1,stretch:!1},computed:{"nativeRecordingWidth:recordingwidth,record_media":function(){return this.get("recordingwidth")||("screen"!==this.get("record_media")?640:window.innerWidth||document.body.clientWidth)},"nativeRecordingHeight:recordingheight,record_media":function(){return this.get("recordingheight")||("screen"!==this.get("record_media")?480:window.innerHeight||document.body.clientHeight)},"widthHeightStyles:width,height":function(){var e={},t=this.get("width"),i=this.get("height");return t&&(e.width=t+((t+"").match(/^\d+$/g)?"px":"")),i&&(e.height=i+((i+"").match(/^\d+$/g)?"px":"")),e},"canswitchcamera:recordviafilecapture":function(){return!this.get("recordviafilecapture")&&s.isMobile()}},scopes:{player:">[id='player']"},types:{rerecordable:"boolean",ready:"boolean",stretch:"boolean",autorecord:"boolean",allowrecord:"boolean",allowupload:"boolean",allowcustomupload:"boolean",primaryrecord:"boolean",recordermode:"boolean",nofullscreen:"boolean",skipinitialonrerecord:"boolean",localplayback:"boolean",camerafacefront:"boolean",skipinitial:"boolean",minuploadingwidth:"int",maxuploadingwidth:"int",minuploadingheight:"int",maxuploadingheight:"int",webrtconmobile:"boolean","flip-camera":"boolean",faceoutline:"boolean","early-rerecord":"boolean",manualsubmit:"boolean",simulate:"boolean",allowedextensions:"array"},extendables:["states"],remove_on_destroy:!0,events:{"change:camerahealthy":function(e){this.trigger("camerahealth",e)},"change:webrtconmobile":function(){this.set("recordviafilecapture",s.isMobile()&&(!this.get("webrtconmobile")||!a.anySupport(this._imageCaptureWrapperOptions())))},"change:recordviafilecapture":function(){this.get("recordviafilecapture")&&(this.set("skipinitial",!1),this.set("skipinitialonrerecord",!1),this.set("allowscreen",!1),this.set("autorecord",!1))}},create:function(){this.get("theme")&&this.set("theme",this.get("theme").toLowerCase()),this.get("theme")in i.recorderthemes&&c.iter(i.recorderthemes[this.get("theme")],function(e,t){this.isArgumentAttr(t)||this.set(t,e)},this),this.set("ie8",s.isInternetExplorer()&&s.internetExplorerVersion()<9),this.set("hideoverlay",!1),this.set("canswitchcamera",!1),this.set("recordviafilecapture",s.isMobile()&&(!this.get("webrtconmobile")||!a.anySupport(this._imageCaptureWrapperOptions()))),this.get("recordviafilecapture")&&(this.set("skipinitial",!1),this.set("skipinitialonrerecord",!1),this.set("autorecord",!1)),this.__attachRequested=!1,this.__activated=!1,this._bound=!1,this.__recording=!1,this.__error=null,this.__currentStretch=null,this.on("change:stretch",function(){this._updateStretch()},this),this.host=new h({stateRegistry:new m(this.cls.recorderStates())}),(this.host.dynamic=this).host.initialize(this._initialState),this._timer=new u.Timer({context:this,fire:this._timerFire,delay:250,start:!0}),this.__cameraResponsive=!0,this.__cameraSignal=!0,s.isMobile()||this.set("orientation",!1),this.set("currentorientation",window.innerHeight>window.innerWidth?"portrait":"landscape")},getMediaType:function(){return"image"},getImageFile:function(){return this._imageFile||this.recorder&&this.recorder.localPlaybackSource()||null},_initialState:f,state:function(){return this.host.state()},recorderAttached:function(){return!!this.recorder},imageError:function(){return this.__error},isFormatSupported:function(){return this.dyn.recorder&&this.dyn.recorder.supportsLocalPlayback()||this.dyn._imageFilePlaybackable},_error:function(e,t){this.__error={error_type:e,error_code:t},this.trigger("error:"+e,t),this.trigger("error",e,t)},_clearError:function(){this.__error=null},_detachRecorder:function(){this.recorder&&this.recorder.weakDestroy(),this.recorder=null,this.set("hasrecorder",!1)},_imageCaptureWrapperOptions:function(){return{simulate:this.get("simulate"),localPlaybackRequested:this.get("localplayback"),flip:this.get("flip-camera")}},_attachRecorder:function(){var e;this.recorderAttached()||(this.__activated?(this.set("hasrecorder",!0),this.__attachRequested=!1,e=this.activeElement().querySelector("[data-image='image']"),this._clearError(),this.recorder=a.create(c.extend({element:e},this._imageCaptureWrapperOptions())),this.recorder?this.trigger("attached"):this._error("attach")):this.__attachRequested=!0)},_softwareDependencies:function(){return this.recorderAttached()&&this.recorder?this.recorder.softwareDependencies():p.error("No recorder attached.")},_bindMedia:function(){!this._bound&&this.recorderAttached()&&this.recorder&&this.recorder.ready.success(function(){this.recorder.on("require_display",function(){this.set("hideoverlay",!0)},this),this.recorder.bindMedia().error(function(e){this.trigger("access_forbidden",e),this.set("hideoverlay",!1),this.off("require_display",null,this),this._error("bind",e)},this).success(function(){this.trigger("access_granted"),this.set("hideoverlay",!1),this.off("require_display",null,this),this.recorder.enumerateDevices().success(function(e){var t=this.recorder.currentDevices();this.set("selectedcamera",t.video),this.set("cameras",new g(c.values(e.video)))},this),this.set("devicetesting",!0),this._updateStretch(),this._bound=!0,this.trigger("bound")},this)},this)},_initializeUploader:function(){this._dataUploader&&this._dataUploader.weakDestroy(),this._dataUploader=new r},_unbindMedia:function(){this._bound&&(this.recorder.unbindMedia(),this._bound=!1)},_uploadImageFile:function(e){this.get("simulate")||((e=o.create(c.extend({source:e},this.get("uploadoptions").image))).upload(),this._dataUploader.addUploader(e))},_prepareRecording:function(){return p.create(!0)},_captureImage:function(){this._snapshot=this.recorder.createSnapshot(this.get("snapshottype"))},_uploadCapture:function(){var e;this.get("simulate")||((e=this.recorder.createSnapshotUploader(this._snapshot,this.get("snapshottype"),this.get("uploadoptions").image)).upload(),this._dataUploader.addUploader(e))},_verifyRecording:function(){return p.create(!0)},_afterActivate:function(e){t._afterActivate.call(this,e),this.__activated=!0,this.__attachRequested&&this._attachRecorder(),this.persistentTrigger("loaded")},object_functions:["record","rerecord","reset"],functions:{record:function(){this.host.state().record()},record_image:function(){this.host.state().selectRecord()},upload_image:function(e){this.host.state().selectUpload(e)},select_camera:function(e){this.recorder&&(this.recorder.setCurrentDevices({video:e}),this.set("selectedcamera",e))},select_camera_face:function(e){this.recorder&&(this.recorder.setCameraFace(e),this.set("camerafacefront",e))},rerecord:function(){confirm(this.stringUnicode("rerecord-confirm"))&&this.host.state().rerecord()},message_click:function(){this.trigger("message-click")},message_link_click:function(e){this.trigger("message-link-click",e)},reset:function(){this._stopRecording().callback(function(){this._unbindMedia(),this._detachRecorder(),this.host.state().next("Initial")},this)},manual_submit:function(){this.set("rerecordable",!1),this.set("manualsubmit",!1),this.trigger("manually_submitted")},ready_to_play:function(){this.trigger("ready_to_play")}},destroy:function(){this._timer.destroy(),this.host.destroy(),this._detachRecorder(),t.destroy.call(this)},deltaCoefficient:function(){return this.recorderAttached()?this.recorder.deltaCoefficient():null},blankLevel:function(){return this.recorderAttached()?this.recorder.blankLevel():null},lightLevel:function(){return this.recorderAttached()?this.recorder.lightLevel():null},_timerFire:function(){if(!this.destroyed()){this.set("currentorientation",window.innerHeight>window.innerWidth?"portrait":"landscape");try{var e;this.recorderAttached()&&this.get("devicetesting")&&(e=this.lightLevel(),this.set("camerahealthy",100<=e&&e<=200))}catch(n){}try{var t,i,s;this.recorderAttached()&&this._timer.fire_count()%20==0&&this._accessing_camera&&(t=.01<=this.blankLevel())!==this.__cameraSignal&&(this.__cameraSignal=t,this.trigger(t?"camera_signal":"camera_nosignal")),this.recorderAttached()&&this._timer.fire_count()%20==10&&this._accessing_camera&&(s=null===(i=this.recorder.deltaCoefficient())||.5<=i)!==this.__cameraResponsive&&(this.__cameraResponsive=s,this.trigger(s?"camera_responsive":"camera_unresponsive"))}catch(n){}this._updateStretch(),this._updateCSSSize()}},_updateCSSSize:function(){var e=n.elementDimensions(this.activeElement()).width;this.set("csssize",400<e?"normal":300<e?"medium":"small")},imageHeight:function(){return this.recorderAttached()?this.recorder.cameraHeight():NaN},imageWidth:function(){return this.recorderAttached()?this.recorder.cameraWidth():NaN},aspectRatio:function(){return this.imageWidth()/this.imageHeight()},parentWidth:function(){return this.get("width")||n.elementDimensions(this.activeElement()).width},parentHeight:function(){return this.get("height")||n.elementDimensions(this.activeElement()).height},parentAspectRatio:function(){return this.parentWidth()/this.parentHeight()},_updateStretch:function(){var e,t,i=null;this.get("stretch")&&(e=this.aspectRatio(),isFinite(e))&&(t=this.parentAspectRatio(),isFinite(t)?(e<t&&(i="height"),t<e&&(i="width")):t===Infinity&&(i="height")),this.__currentStretch!==i&&(this.__currentStretch&&n.elementRemoveClass(this.activeElement(),this.get("css")+"-stretch-"+this.__currentStretch),i)&&n.elementAddClass(this.activeElement(),this.get("css")+"-stretch-"+i),this.__currentStretch=i}}},{recorderStates:function(){return[y]}}).register("ba-imagecapture").registerFunctions({"!player_active":function(e){return!e.player_active},css:function(e){return e.css},csssize:function(e){return e.csssize},iecss:function(e){return e.iecss},"ie8 ? 'ie8' : 'noie8'":function(e){return e.ie8?"ie8":"noie8"},csstheme:function(e){return e.csstheme},"fullscreened ? 'fullscreen' : 'normal'":function(e){return e.fullscreened?"fullscreen":"normal"},"firefox ? 'firefox' : 'common'":function(e){return e.firefox?"firefox":"common"},themecolor:function(e){return e.themecolor},widthHeightStyles:function(e){return e.widthHeightStyles},"hasrecorder ? 'hasrecorder' : 'norecorder'":function(e){return e.hasrecorder?"hasrecorder":"norecorder"},"faceoutline && hasrecorder":function(e){return e.faceoutline&&e.hasrecorder},"!hideoverlay":function(e){return!e.hideoverlay},dynloader:function(e){return e.dynloader},"cssloader || css":function(e){return e.cssloader||e.css},tmplloader:function(e){return e.tmplloader},loader_active:function(e){return e.loader_active},loadertooltip:function(e){return e.loadertooltip},hovermessage:function(e){return e.hovermessage},loaderlabel:function(e){return e.loaderlabel},dynmessage:function(e){return e.dynmessage},"cssmessage || css":function(e){return e.cssmessage||e.css},tmplmessage:function(e){return e.tmplmessage},message_active:function(e){return e.message_active},message:function(e){return e.message},message_links:function(e){return e.message_links},dyntopmessage:function(e){return e.dyntopmessage},"csstopmessage || css":function(e){return e.csstopmessage||e.css},tmpltopmessage:function(e){return e.tmpltopmessage},"topmessage_active && (topmessage || hovermessage)":function(e){return e.topmessage_active&&(e.topmessage||e.hovermessage)},"hovermessage || topmessage":function(e){return e.hovermessage||e.topmessage},dynchooser:function(e){return e.dynchooser},recordviafilecapture:function(e){return e.recordviafilecapture},"csschooser || css":function(e){return e.csschooser||e.css},tmplchooser:function(e){return e.tmplchooser},"chooser_active && !is_initial_state":function(e){return e.chooser_active&&!e.is_initial_state},allowrecord:function(e){return e.allowrecord},allowupload:function(e){return e.allowupload},allowcustomupload:function(e){return e.allowcustomupload},allowedextensions:function(e){return e.allowedextensions},primaryrecord:function(e){return e.primaryrecord},dyncontrolbar:function(e){return e.dyncontrolbar},"csscontrolbar || css":function(e){return e.csscontrolbar||e.css},tmplcontrolbar:function(e){return e.tmplcontrolbar},controlbar_active:function(e){return e.controlbar_active},cameras:function(e){return e.cameras},"selectedcamera || 0":function(e){return e.selectedcamera||0},camerahealthy:function(e){return e.camerahealthy},settingsvisible:function(e){return e.settingsvisible},recordvisible:function(e){return e.recordvisible},"allowcancel && cancancel":function(e){return e.allowcancel&&e.cancancel},rerecordvisible:function(e){return e.rerecordvisible},controlbarlabel:function(e){return e.controlbarlabel},player_active:function(e){return e.player_active},ie8:function(e){return e.ie8},dynimageviewer:function(e){return e.dynimageviewer},"theme || 'default'":function(e){return e.theme||"default"},playbacksource:function(e){return e.playbacksource},"false":function(e){return!1},stretch:function(e){return e.stretch},playerattrs:function(e){return e.playerattrs},width:function(e){return e.width},height:function(e){return e.height},"rerecordable && (recordings === null || recordings > 0)":function(e){return e.rerecordable&&(null===e.recordings||0<e.recordings)},"manualsubmit && verified":function(e){return e.manualsubmit&&e.verified},nofullscreen:function(e){return e.nofullscreen}}).attachStringTable(i.strings).addStrings({"recorder-error":"An error occurred, please try again later. Click to retry.","attach-error":"We could not access the media interface. Depending on the device and browser, you might need to access the page via SSL.","software-required":"Please click below to install / activate the following requirements in order to proceed.","software-waiting":"Waiting for the requirements to be installed / activated. You might need to refresh the page after completion.","access-forbidden":"Access to the media was forbidden. Click to retry.",uploading:"Uploading","uploading-failed":"Uploading failed - click here to retry.","upload-error-duration":"Length of the uploaded image does not meet the requirements - click here to retry.","resolution-constraint-error":"The file you've selected does not match the required resolution - click here to retry.",verifying:"Verifying","verifying-failed":"Verifying failed - click here to retry.","rerecord-confirm":"Do you really want to retake your image?",image_file_too_large:"Your image file is too large (%s) - click here to try again with a smaller image file.",unsupported_image_type:"Please upload: %s - click here to retry.","orientation-portrait-required":"Please rotate your device to record in portrait mode.","orientation-landscape-required":"Please rotate your device to record in landscape mode."})}),e.define("module:ImageCapture.Dynamics.RecorderStates.State",["base:States.State","base:Events.ListenMixin","base:Objs"],function(e,t,i,s){return e.extend({scoped:s},[t,{dynamics:[],_start:function(){this.dyn=this.host.dynamic,i.iter(i.extend({message:!1,chooser:!1,topmessage:!1,controlbar:!1,loader:!1},i.objectify(this.dynamics)),function(e,t){this.dyn.set(t+"_active",e)},this),this.dyn.set("playertopmessage",""),this.dyn.set("message_links",null),this.dyn._accessing_camera=!1,this._started()},_started:function(){},record:function(){this.dyn.set("autorecord",!0)},rerecord:function(){},selectRecord:function(){},selectUpload:function(e){}}])}),e.define("module:ImageCapture.Dynamics.RecorderStates.FatalError",["module:ImageCapture.Dynamics.RecorderStates.State","browser:Info","base:Timers.Timer"],function(e,t,i,s){return e.extend({scoped:s},{dynamics:["message"],_locals:["message","retry"],_started:function(){this.dyn.set("message",this._message||this.dyn.string("recorder-error")),this.dyn.set("shortMessage",this.dyn.get("message").length<30),this.listenOn(this.dyn,"message-click",function(){this._retry&&this.next(this._retry)})}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.Initial",["module:ImageCapture.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{_started:function(){this.dyn.set("is_initial_state",!0),this.dyn.set("verified",!1),this.dyn.set("playbacksource",null),this.dyn.set("player_active",!1),this.dyn._imageFileName=null,this.dyn._imageFile=null,this.dyn._imageFilePlaybackable=!1,this.dyn._initializeUploader(),this.dyn.get("recordermode")?this.dyn.get("autorecord")||this.dyn.get("skipinitial")?this.eventualNext("RequiredSoftwareCheck"):this.next("Chooser"):this.dyn.get("image")?this.next("Player"):(console.warn("recordermode:false requires an existing video to be present and provided."),this.dyn.set("recordermode",!0))},_end:function(){this.dyn.set("is_initial_state",!1)}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.Player",["module:ImageCapture.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{rerecord:function(){this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")},_started:function(){this.dyn.set("player_active",!0)},_end:function(){this.dyn.set("player_active",!1)}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.Chooser",["module:ImageCapture.Dynamics.RecorderStates.State","base:Strings","browser:Info","media:Player.Support"],function(e,a,c,l,t){return e.extend({scoped:t},{dynamics:["chooser"],_started:function(){this.listenOn(this.dyn,"change:orientation change:currentorientation",function(){var e=this.dyn.get("orientation"),t=this.dyn.get("currentorientation"),t=e&&e!==t;t&&this.dyn.set("message",this.dyn.string("orientation-"+e+"-required")),this.dyn.set("message_active",t),this.dyn.set("chooser_active",!t)},this,{initcall:!0})},record:function(){this.dyn.set("autorecord",!0),this.selectRecord()},selectRecord:function(){this.dyn.set("record_media","camera"),this.next("RequiredSoftwareCheck")},selectUpload:function(t){if(!(c.isMobile()&&c.isAndroid()&&c.isCordova())){if(this.dyn.get("allowedextensions")){var i=(t.files[0].name||"").toLowerCase(),s=!1;if(this.dyn.get("allowedextensions").forEach(function(e){a.ends_with(i,"."+e.toLowerCase())&&(s=!0)},this),!s)return void this.next("FatalError",{message:this.dyn.string("unsupported_image_type").replace("%s",this.dyn.get("allowedextensions").join(" / ")),retry:"Chooser"})}var e,n,r;if(this.dyn.get("filesizelimit")&&t.files&&0<t.files.length&&t.files[0].size&&t.files[0].size>this.dyn.get("filesizelimit"))return e="KB",n=Math.round(t.files[0].size/1e3),r=Math.round(this.dyn.get("filesizelimit")/1e3),999<n&&(e="MB",n=Math.round(n/1e3),r=Math.round(r/1e3)),void this.next("FatalError",{message:this.dyn.string("image_file_too_large").replace("%s",n+e+" / "+r+e),retry:"Chooser"})}try{l.imageFileInfo(t.files[0]).success(function(e){e.width&&this.dyn.get("minuploadingwidth")&&this.dyn.get("minuploadingwidth")>e.width||e.width&&this.dyn.get("maxuploadingwidth")&&this.dyn.get("maxuploadingwidth")<e.width||e.height&&this.dyn.get("minuploadingheight")&&this.dyn.get("minuploadingheight")>e.height||e.height&&this.dyn.get("maxuploadingheight")&&this.dyn.get("maxuploadingheight")<e.height?this.next("FatalError",{message:this.dyn.string("resolution-constraint-error"),retry:"Chooser"}):(this.dyn._imageFilePlaybackable=!0,this._uploadFile(t))},this).error(function(){this._uploadFile(t)},this)}catch(o){this._uploadFile(t)}},_uploadFile:function(e){this.dyn.set("creation-type",c.isMobile()?"mobile":"upload");try{this.dyn._imageFileName=e.files[0].name,this.dyn._imageFile=e.files[0]}catch(t){}this.dyn._prepareRecording().success(function(){this.dyn.trigger("upload_selected",e),this.dyn._uploadImageFile(e),this.next("Uploading")},this).error(function(e){this.next("FatalError",{message:e,retry:"Chooser"})},this)}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.RequiredSoftwareCheck",["module:ImageCapture.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.listenOn(this.dyn,"error",function(e){this.next("FatalError",{message:this.dyn.string("attach-error"),retry:"Initial"})},this),this.dyn._attachRecorder(),this.dyn&&(this.dyn.on("message-link-click",function(e){e.execute(),this.next("RequiredSoftwareWait")},this),this.dyn._softwareDependencies().error(function(e){this.dyn.set("message_links",e),this.dyn.set("loader_active",!1),this.dyn.set("message_active",!0),this.dyn.set("message",this.dyn.string("software-required"))},this).success(function(){this.next("CameraAccess")},this))}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.RequiredSoftwareWait",["module:ImageCapture.Dynamics.RecorderStates.State","base:Promise","browser:Dom"],function(e,t,i,s){return e.extend({scoped:s},{dynamics:["message"],_started:function(){this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.dyn.set("message",this.dyn.string("software-waiting")),t.resilience(function(){return i.isTabHidden()?t.error("Not ready"):this.dyn._softwareDependencies()},this,120,[],1e3).success(function(){this.next("CameraAccess")},this).error(function(){this.next("RequiredSoftwareCheck")},this),this.dyn.on("message-click",function(){this.next("RequiredSoftwareCheck")},this)}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.CameraAccess",["module:ImageCapture.Dynamics.RecorderStates.State","base:Timers.Timer"],function(e,t,i){return e.extend({scoped:i},{dynamics:["loader"],_started:function(){this.dyn.set("settingsvisible",!0),this.dyn.set("recordvisible",!0),this.dyn.set("rerecordvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.listenOn(this.dyn,"bound",function(){this.dyn.set("creation-type","webrtc");var e=this.auto_destroy(new t({start:!0,delay:100,context:this,fire:function(){.01<=this.dyn.blankLevel()&&.01<=this.dyn.deltaCoefficient()&&(e.stop(),this.next("CameraHasAccess"))}}))},this),this.listenOn(this.dyn,"error",function(e){this.next("FatalError",{message:this.dyn.string("attach-error"),retry:"Initial"})},this),this.listenOn(this.dyn,"access_forbidden",function(){this.next("FatalError",{message:this.dyn.string("access-forbidden"),retry:"Initial"})},this),this.dyn._bindMedia()}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.CameraHasAccess",["module:ImageCapture.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["topmessage","controlbar"],_started:function(){this.dyn.trigger("ready_to_record"),this._preparePromise=null,0<this.dyn.get("countdown")&&this.dyn.recorder&&this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions"))>1e3*this.dyn.get("countdown")&&(this._preparePromise=this.dyn._prepareRecording()),this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),this.dyn.set("settingsvisible",!0),this.dyn.set("recordvisible",!0),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.get("autorecord")&&this.next("RecordPrepare",{preparePromise:this._preparePromise})},record:function(){this.dyn.get("autorecord")||this.next("RecordPrepare",{preparePromise:this._preparePromise})}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.RecordPrepare",["module:ImageCapture.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time"],function(e,t,l,i){return e.extend({scoped:i},{dynamics:["loader"],_locals:["preparePromise"],_started:function(){this.dyn.set("message",""),this.dyn.set("loaderlabel","");var i,s,n,r,o,a=!1,e=(this.dyn._accessing_camera=!0,this._preparePromise=this._preparePromise||this.dyn._prepareRecording(),this.dyn.get("countdown")?1e3*this.dyn.get("countdown"):0),c=this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions"))||0;e?(i=1e3,s=0,n=l.now(),r=n+Math.max(c,e),e<c?(s=Math.min(500,c-e),i=(c-s)/e*1e3):this.dyn.set("loaderlabel",this.dyn.get("countdown")),o=new t({context:this,delay:50,fire:function(){var e=l.now(),t=Math.max(0,r-e);s+n<e&&(this.dyn.set("loaderlabel",""+Math.ceil((t-s)/i)),this.dyn.trigger("countdown",Math.round((t-s)/i*1e3))),r<=e&&(this.dyn.set("loaderlabel",""),o.stop()),t<=c&&!a&&(a=!0,this._startRecording())}}),this.auto_destroy(o)):this._startRecording()},record:function(){this._startRecording()},_startRecording:function(){this.next("Recording")}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.Recording",["module:ImageCapture.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time","base:TimeFormat","base:Async"],function(e,t,i,s,n,r){return e.extend({scoped:r},{dynamics:["topmessage","controlbar"],_started:function(){this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),this.dyn._accessing_camera=!0,this.dyn.trigger("recording"),this.dyn.set("settingsvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("recordvisible",!1),this.dyn._captureImage(),this.dyn._uploadCapture(),this.dyn._unbindMedia(),this.next("Uploading")}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.Uploading",["module:ImageCapture.Dynamics.RecorderStates.State","base:Time","base:Async","base:Objs"],function(e,t,i,s,n){return e.extend({scoped:n},{dynamics:["loader","message"],_started:function(){this.dyn.set("cancancel",!0),this.dyn.set("skipinitial",this.dyn.get("skipinitial")||this.dyn.get("skipinitialonrerecord")),this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("loadlabel",""),this.dyn.set("controlbarlabel",""),this.dyn.trigger("uploading"),this.dyn.set("rerecordvisible",this.dyn.get("early-rerecord")),this.dyn.get("early-rerecord")&&this.dyn.set("controlbar_active",!0),this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),this.dyn.set("message",this.dyn.string("uploading")),this.dyn.set("playertopmessage",this.dyn.get("message"));var e=this.dyn._dataUploader;this.listenOn(e,"success",function(){i.eventually(function(){this.destroyed()||(this._finished(),this.next("Verifying"))},this)}),this.listenOn(e,"error",function(e){var i=this.dyn.string("uploading-failed");try{e.forEach(function(e){for(var t in e)this.dyn.string("upload-error-"+t)&&(i=this.dyn.string("upload-error-"+t))},this)}catch(t){}this.dyn.set("player_active",!1),this.next("FatalError",{message:i,retry:this.dyn.recorderAttached()?"Uploading":"Initial"})}),this.listenOn(e,"progress",function(e,t){this.dyn.trigger("upload_progress",e,t),0!==t&&0<t&&0<=e&&(e=Math.min(100,Math.round(e/t*100)),isNaN(e)||(this.dyn.set("message",this.dyn.string("uploading")+": "+e+"%"),this.dyn.set("playertopmessage",this.dyn.get("message"))))}),this.dyn.get("localplayback")&&this.dyn.isFormatSupported()&&(this.dyn.recorder&&this.dyn.recorder.supportsLocalPlayback()?this.dyn.set("playbacksource",this.dyn.recorder.localPlaybackSource()):this.dyn.set("playbacksource",(window.URL||window.webkitURL).createObjectURL(this.dyn._imageFile)),this.dyn.set("loader_active",!1),this.dyn.set("message_active",!1),this.dyn.set("player_active",!0)),this.dyn.set("start-upload-time",t.now()),e.reset(),e.upload()},rerecord:function(){this.dyn._detachRecorder(),this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")},_finished:function(){this.dyn.set("cancancel",!1),this.dyn.trigger("uploaded"),this.dyn.set("end-upload-time",t.now())}})}),e.define("module:ImageCapture.Dynamics.RecorderStates.Verifying",["module:ImageCapture.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader","message"],_started:function(){this.dyn.set("loadlabel",""),this.dyn.trigger("verifying"),this.dyn.set("message",this.dyn.string("verifying")+"..."),this.dyn.set("playertopmessage",this.dyn.get("message")),this.dyn.get("localplayback")&&this.dyn.isFormatSupported()?(this.dyn.set("loader_active",!1),this.dyn.set("message_active",!1)):(this.dyn.set("rerecordvisible",this.dyn.get("early-rerecord")),this.dyn.get("early-rerecord")&&this.dyn.set("controlbar_active",!0)),this.dyn._verifyRecording().success(function(){this.dyn.trigger("verified"),this.dyn._detachRecorder(),this.dyn.get("recordings")&&this.dyn.set("recordings",this.dyn.get("recordings")-1),this.dyn.set("message",""),this.dyn.set("playertopmessage",""),this.dyn.set("verified",!0),this.next("Player")},this).error(function(){this.dyn.set("player_active",!1),this.next("FatalError",{message:this.dyn.string("verifying-failed"),retry:this.dyn.recorderAttached()?"Verifying":"Initial"})},this)},rerecord:function(){this.dyn._detachRecorder(),this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")}})}),e.define("module:ImageCapture.Dynamics.Chooser",["dynamics:Dynamic","module:Assets","browser:Info"],["dynamics:Partials.ClickPartial","dynamics:Partials.IfPartial"],function(e,t,n,i){return e.extend({scoped:i},function(e){return{template:'<div class="{{css}}-chooser-container">\n\t<div class="{{css}}-chooser-button-container">\n\t\t<div ba-repeat="{{action :: actions}}">\n\t\t\t<div ba-hotkey:space^enter="{{click_action(action)}}" onmouseout="this.blur()"\n\t\t\t\t tabindex="0" class="{{css}}-chooser-button-{{action.index}}"\n\t\t\t     ba-click="{{click_action(action)}}"\n\t\t\t>\n\t\t\t\t<input ba-if="{{action.select && action.capture}}"\n\t\t\t\t\t   type="file"\n\t\t\t\t\t   class="{{css}}-chooser-file"\n\t\t\t\t\t   onchange="{{select_file_action(action, domEvent)}}"\n\t\t\t\t\t   accept="{{action.accept}}"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if="{{action.select && !action.capture}}"\n\t\t\t\t\t   type="file"\n\t\t\t\t\t   class="{{css}}-chooser-file"\n\t\t\t\t\t   onchange="{{select_file_action(action, domEvent)}}"\n\t\t\t\t\t   accept="{{action.accept}}"\n\t\t\t\t\t   />\n\t\t\t\t<i class="{{csscommon}}-icon-{{action.icon}}"\n\t\t\t\t   ba-if="{{action.icon}}"></i>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n',attrs:{css:"ba-imagecapture",allowrecord:!0,allowupload:!0,primaryrecord:!0,recordviafilecapture:!1,allowcustomupload:!0,allowedextensions:null},types:{allowedextensions:"array",recordviafilecapture:"boolean"},collections:["actions"],create:function(){var i="",e=(this.get("allowedextensions")&&0<this.get("allowedextensions").length?(n.isEdge()||n.isChrome()||n.isOpera()||n.isFirefox()&&42<=n.firefoxVersion()||n.isInternetExplorer()&&10<=n.internetExplorerVersion())&&(i="."+this.get("allowedextensions").join(",.")):this.get("allowcustomupload")||(i="image/*,image/png"),[]),s=(this.get("primaryrecord")?(this.get("allowrecord")&&e.push("record"),this.get("allowupload")&&e.push("upload")):(this.get("allowupload")&&e.push("upload"),this.get("allowrecord")&&e.push("record")),this.get("actions"));e.forEach(function(e,t){switch(e){case"record":s.add({type:"record",index:t,icon:"videocam",label:this.string("capture-image"),select:n.isMobile()&&!(n.isAndroid()&&n.isCordova())&&this.get("recordviafilecapture"),capture:!0,accept:"image/*,image/png;capture=camcorder"});break;case"upload":s.add({type:"upload",index:t,icon:"upload",label:this.string("upload-image"),select:!(n.isiOS()&&n.isCordova()),accept:!n.isMobile()||n.isAndroid()&&n.isCordova()?i:"image/*,image/png"})}},this)},functions:{click_action:function(e){var t;e.get("select")||(n.isMobile()&&n.isCordova()?(t=this,n.isAndroid()?navigator.device.capture.captureImage(function(e){t.trigger("upload",e[0])},function(e){},{limit:1}):n.isiOS()&&navigator.camera.getPicture(function(e){t.trigger("upload",{localURL:e,fullPath:e})},function(e){},{destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,mediaType:Camera.MediaType.IMAGE})):this.trigger("record"))},select_file_action:function(e,t){e.get("select")&&this.trigger("upload",t[0].target)}}}}).registerFunctions({css:function(e){return e.css},actions:function(e){return e.actions},"click_action(action)":function(e){return e.click_action(e.action)},"action.index":function(e){return e.action.index},"action.select && action.capture":function(e){return e.action.select&&e.action.capture},"select_file_action(action, domEvent)":function(e){return e.select_file_action(e.action,e.domEvent)},"action.accept":function(e){return e.action.accept},"action.select && !action.capture":function(e){return e.action.select&&!e.action.capture},csscommon:function(e){return e.csscommon},"action.icon":function(e){return e.action.icon},"action.label":function(e){return e.action.label}}).register("ba-imagecapture-chooser").attachStringTable(t.strings).addStrings({"image-capture":"Capture Image","upload-image":"Upload Image"})}),e.define("module:ImageCapture.Dynamics.Controlbar",["dynamics:Dynamic","module:Assets","base:Timers.Timer"],["dynamics:Partials.ShowPartial","dynamics:Partials.RepeatPartial"],function(e,t,i,s){return e.extend({scoped:s},function(e){return{template:'<div class="{{css}}-dashboard">\n\t<div class="{{css}}-backbar"></div>\n\t<div data-selector="recorder-settings" class="{{css}}-settings" ba-show="{{settingsvisible && settingsopen}}">\n\t\t<div class="{{css}}-settings-backbar"></div>\n\t\t<div data-selector="settings-list-front" class="{{css}}-settings-front">\n\t\t\t<ul data-selector="camera-settings" ba-repeat="{{camera :: cameras}}">\n\t\t\t\t<li>\n\t\t\t\t\t<input tabindex="0"\n\t\t\t\t\t\t   ba-hotkey:space^enter="{{selectCamera(camera.id)}}" onmouseout="this.blur()"\n\t\t\t\t\t\t   type=\'radio\' name=\'camera\' value="{{selectedcamera == camera.id}}" onclick="{{selectCamera(camera.id)}}"\n\t\t\t\t\t/>\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<label tabindex="0"\n\t\t\t\t\t\t   ba-hotkey:space^enter="{{selectCamera(camera.id)}}" onmouseout="this.blur()"\n\t\t\t\t\t\t   onclick="{{selectCamera(camera.id)}}"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{camera.label}}\n\t\t\t\t\t</label>\n\t\t\t\t </li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div data-selector="controlbar" class="{{css}}-controlbar">\n\n        <div class="{{css}}-leftbutton-container" ba-show="{{settingsvisible}}">\n            <div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{settingsopen=!settingsopen}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="record-button-icon-cog" class="{{css}}-button-inner {{css}}-button-{{settingsopen ? \'selected\' : \'unselected\'}}"\n                 onclick="{{settingsopen=!settingsopen}}"\n                 onmouseenter="{{hover(string(\'settings\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n                <i class="{{csscommon}}-icon-cog"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-lefticon-container" ba-show="{{settingsvisible}}">\n            <div data-selector="record-button-icon-videocam" class="{{csscommon}}-icon-inner"\n                 onmouseenter="{{hover(string(camerahealthy ? \'camerahealthy\' : \'cameraunhealthy\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n                <i class="{{csscommon}}-icon-videocam {{csscommon}}-icon-state-{{camerahealthy ? \'good\' : \'bad\' }}"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-label-container" ba-show="{{controlbarlabel}}">\n        \t<div data-selector="record-label-block" class="{{css}}-label-label">\n        \t\t{{controlbarlabel}}\n        \t</div>\n        </div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{recordvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{record()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="record-primary-button" class="{{css}}-button-primary"\n                 onclick="{{record()}}"\n                 onmouseenter="{{hover(string(\'record-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'record\')}}\n        \t</div>\n        </div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{rerecordvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{rerecord()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="rerecord-primary-button" class="{{css}}-button-primary"\n                 onclick="{{rerecord()}}"\n                 onmouseenter="{{hover(string(\'rerecord-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'rerecord\')}}\n        \t</div>\n        </div>\n\n\t\t<div class="{{css}}-rightbutton-container" ba-show="{{cancelvisible}}">\n\t\t\t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{cancel()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="cancel-primary-button" class="{{css}}-button-primary"\n\t\t\t\t onclick="{{cancel()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'cancel-tooltip\'))}}"\n\t\t\t\t onmouseleave="{{unhover()}}"\n\t\t\t>\n\t\t\t\t{{string(\'cancel\')}}\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>\n',attrs:{css:"ba-imagecapture",hovermessage:""},functions:{selectCamera:function(e){this.trigger("select-camera",e)},hover:function(e){this.set("hovermessage",e)},unhover:function(){this.set("hovermessage","")},record:function(){this.trigger("invoke-record")},rerecord:function(){this.trigger("invoke-rerecord")},cancel:function(){this.trigger("invoke-cancel")}}}}).register("ba-imagecapture-controlbar").registerFunctions({css:function(e){return e.css},"settingsvisible && settingsopen":function(e){return e.settingsvisible&&e.settingsopen},cameras:function(e){return e.cameras},"selectCamera(camera.id)":function(e){return e.selectCamera(e.camera.id)},"selectedcamera == camera.id":function(e){return e.selectedcamera==e.camera.id},"camera.label":function(e){return e.camera.label},settingsvisible:function(e){return e.settingsvisible},"settingsopen=!settingsopen":function(e){return e.settingsopen=!e.settingsopen},"settingsopen ? 'selected' : 'unselected'":function(e){return e.settingsopen?"selected":"unselected"},"hover(string('settings'))":function(e){return e.hover(e.string("settings"))},"unhover()":function(e){return e.unhover()},csscommon:function(e){return e.csscommon},"hover(string(camerahealthy ? 'camerahealthy' : 'cameraunhealthy'))":function(e){return e.hover(e.string(e.camerahealthy?"camerahealthy":"cameraunhealthy"))},"camerahealthy ? 'good' : 'bad'":function(e){return e.camerahealthy?"good":"bad"},controlbarlabel:function(e){return e.controlbarlabel},recordvisible:function(e){return e.recordvisible},"record()":function(e){return e.record()},"hover(string('record-tooltip'))":function(e){return e.hover(e.string("record-tooltip"))},"string('record')":function(e){return e.string("record")},rerecordvisible:function(e){return e.rerecordvisible},"rerecord()":function(e){return e.rerecord()},"hover(string('rerecord-tooltip'))":function(e){return e.hover(e.string("rerecord-tooltip"))},"string('rerecord')":function(e){return e.string("rerecord")},cancelvisible:function(e){return e.cancelvisible},"cancel()":function(e){return e.cancel()},"hover(string('cancel-tooltip'))":function(e){return e.hover(e.string("cancel-tooltip"))},"string('cancel')":function(e){return e.string("cancel")}}).attachStringTable(t.strings).addStrings({settings:"Settings",camerahealthy:"Lighting is good",cameraunhealthy:"Lighting is not optimal",record:"Capture","record-tooltip":"Click here to capture.",rerecord:"Redo","rerecord-tooltip":"Click here to redo.",cancel:"Cancel","cancel-tooltip":"Click here to cancel."})}),e.define("module:ImageCapture.Dynamics.Faceoutline",["dynamics:Dynamic"],function(e,t){return e.extend({scoped:t},function(e){return{template:'<svg viewBox="0 0 301 171" style="width:100%; height:100%; position: absolute; top: 0; left: 0">\n    <g>\n        <path fill="none" stroke="white" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="3.0228,3.0228" d="M198.5,79.831c0,40.542-22.752,78.579-47.5,78.579c-24.749,0-47.5-38.036-47.5-78.579c0-40.543,17.028-68.24,47.5-68.24C185.057,11.591,198.5,39.288,198.5,79.831z"></path>\n    </g>\n</svg>'}}).registerFunctions({}).register("ba-imagecapture-faceoutline")}),e.define("module:ImageCapture.Dynamics.Loader",["dynamics:Dynamic","module:Assets"],["dynamics:Partials.ShowPartial"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'\n<div class="{{css}}-loader-container">\n    <div data-selector="recorder-loader-block" class="{{css}}-loader-loader" title="{{tooltip || \'\'}}">\n    </div>\n</div>\n<div data-selector="recorder-loader-label-container" class="{{css}}-loader-label" ba-show="{{label}}">\n\t{{label}}\n</div>\n',attrs:{css:"ba-imagecapture",tooltip:"",label:"",message:"",hovermessage:""}}}).registerFunctions({css:function(e){return e.css},"tooltip || ''":function(e){return e.tooltip||""},label:function(e){return e.label}}).register("ba-imagecapture-loader").attachStringTable(t.strings).addStrings({})}),e.define("module:ImageCapture.Dynamics.Message",["dynamics:Dynamic"],["dynamics:Partials.ClickPartial"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'\n<div data-selector="recorder-message-container" class="{{css}}-message-container" ba-click="{{click()}}">\n    <div data-selector="recorder-message-block" class=\'{{css}}-message-message\'>\n        <p>\n            {{message || ""}}\n        </p>\n        <ul ba-if="{{links && links.length > 0}}" ba-repeat="{{link :: links}}">\n            <li>\n                <a href="javascript:;" ba-click="{{linkClick(link)}}">\n                    {{link.title}}\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>\n',attrs:{css:"ba-imagecapture",message:"",links:null},functions:{click:function(){this.trigger("click")},linkClick:function(e){this.trigger("link",e)}}}}).registerFunctions({css:function(e){return e.css},"click()":function(e){return e.click()},'message || ""':function(e){return e.message||""},"links && links.length > 0":function(e){return e.links&&0<e.links.length},links:function(e){return e.links},"linkClick(link)":function(e){return e.linkClick(e.link)},"link.title":function(e){return e.link.title}}).register("ba-imagecapture-message")}),e.define("module:ImageCapture.Dynamics.Topmessage",["dynamics:Dynamic"],function(e,t){return e.extend({scoped:t},function(e){return{template:"\n<div class=\"{{css}}-topmessage-container\">\n    <div class='{{css}}-topmessage-background'>\n    </div>\n    <div data-selector=\"recorder-topmessage-block\" class='{{css}}-topmessage-message'>\n        {{topmessage}}\n    </div>\n</div>\n",attrs:{css:"ba-imagecapture",topmessage:""}}}).registerFunctions({css:function(e){return e.css},topmessage:function(e){return e.topmessage}}).register("ba-imagecapture-topmessage")}),e.define("module:AudioPlayer.Dynamics.Controlbar",["dynamics:Dynamic","base:TimeFormat","browser:Dom","module:Assets","browser:Info","browser:Events"],["dynamics:Partials.StylesPartial","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.ClickPartial"],function(e,t,s,i,n,r,o){return e.extend({scoped:o},function(e){return{template:'\n<div class="{{css}}-dashboard">\n\t<div tabindex="2" data-selector="progress-bar-inner" class="{{css}}-progressbar {{disableseeking ? cssplayer + \'-disabled\' : \'\'}}"\n\t\t ba-hotkey:right="{{seek(position + skipseconds)}}"\n\t\t ba-hotkey:left="{{seek(position - skipseconds)}}"\n         ba-hotkey:alt+right="{{seek(position + skipseconds * 3)}}"\n         ba-hotkey:alt+left="{{seek(position - skipseconds * 3)}}"\n\t\t onmouseout="this.blur()"\n\t\t ontouchstart="{{startUpdatePosition(domEvent)}}"\n\t\t onmousedown="{{startUpdatePosition(domEvent)}}"\n\t>\n\t\t<div class="{{css}}-progressbar-cache" ba-styles="{{{width: Math.round(duration ? cached / duration * 100 : 0) + \'%\'}}}"></div>\n\t\t<div class="{{css}}-progressbar-position"\n\t\t\t ba-styles="{{{width: Math.round(duration ? position / duration * 100 : 0) + \'%\'}}}"\n\t\t\t title="{{string(\'audio-progress\')}}"\n\t\t>\n\t\t\t<div class="{{css}}-progressbar-button"></div>\n\t\t</div>\n\t</div>\n\n\t<div class="{{css}}-backbar"></div>\n\n\t<div class="{{css}}-controlbar">\n\n        <div tabindex="0" data-selector="submit-audio-button"\n\t\t\t ba-hotkey:space^enter="{{submit()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-leftbutton-container"\n\t\t\t ba-if="{{submittable}}" ba-click="{{submit()}}">\n            <div class="{{css}}-button-inner">\n                {{string(\'submit-audio\')}}\n            </div>\n        </div>\n\n        <div tabindex="0" data-selector="button-icon-ccw"\n\t\t\t ba-hotkey:space^enter="{{rerecord()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-leftbutton-container" ba-if="{{rerecordable}}"\n\t\t\t ba-click="{{rerecord()}}" title="{{string(\'rerecord-audio\')}}"\n\t\t>\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-ccw"></i>\n            </div>\n        </div>\n\n        <div tabindex="0" data-selector="button-icon-play"\n\t\t\t onmouseout="this.blur()"\n\t\t\t class="{{css}}-leftbutton-container" title="{{string(\'play-audio\')}}"\n\t\t\t onkeydown="{{tab_index_move(domEvent, null, \'button-icon-pause\')}}" ba-if="{{!playing}}" ba-click="{{play()}}"\n\t\t>\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-play"></i>\n            </div>\n        </div>\n\n        <div tabindex="0" data-selector="button-icon-pause"\n\t\t\t onmouseout="this.blur()"\n\t\t\t class="{{css}}-leftbutton-container {{disablepause ? cssplayer + \'-disabled\' : \'\'}}"\n\t\t\t onkeydown="{{tab_index_move(domEvent, null, \'button-icon-play\')}}" ba-if="{{playing}}" ba-click="{{pause()}}"\n\t\t\t title="{{disablepause ? string(\'pause-audio-disabled\') : string(\'pause-audio\')}}"\n\t\t>\n            <div class="{{css}}-button-inner">\n                <i class="{{csscommon}}-icon-pause"></i>\n            </div>\n        </div>\n\n\t\t<div class="{{css}}-time-container">\n\t\t\t<div class="{{css}}-time-value" title="{{string(\'elapsed-time\')}}">{{formatTime(position)}}</div>\n\t\t\t<div class="{{css}}-time-sep">/</div>\n\t\t\t<div class="{{css}}-time-value" title="{{string(\'total-time\')}}">{{formatTime(duration || position)}}</div>\n\t\t</div>\n\n\t\t<div data-selector="audio-title-block" class="{{css}}-title-container" ba-if="{{title}}">\n\t\t\t<p class="{{css}}-title">\n\t\t\t\t{{title}}\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div class="{{css}}-volumebar">\n\t\t\t<div tabindex="5" data-selector="button-volume-bar"\n\t\t\t\t ba-hotkey:right="{{set_volume(volume + 0.1)}}" ba-hotkey:left="{{set_volume(volume - 0.1)}}"\n\t\t\t\t ba-hotkey:up="{{set_volume(1)}}" ba-hotkey:down="{{set_volume(0)}}"\n\t\t\t\t onmouseout="this.blur()"\n\t\t\t\t class="{{css}}-volumebar-inner"\n\t\t\t\t ontouchstart="{{startUpdateVolume(domEvent)}}"\n\t\t\t\t ontouchmove="{{progressUpdateVolume(domEvent)}}"\n\t\t\t\t ontouchend="{{stopUpdateVolume(domEvent); this.blur()}};"\n\t\t\t\t onmousedown="{{startUpdateVolume(domEvent)}}"\n                 onmouseup="{{stopUpdateVolume(domEvent)}}"\n                 onmouseleave="{{stopUpdateVolume(domEvent)}}"\n                 onmousemove="{{progressUpdateVolume(domEvent)}}"\n\t\t\t>\n\t\t\t\t<div class="{{css}}-volumebar-position" ba-styles="{{{width: Math.min(100, Math.round(volume * 100)) + \'%\'}}}">\n\t\t\t\t    <div class="{{css}}-volumebar-button" title="{{string(\'volume-button\')}}"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div tabindex="4" data-selector="button-icon-volume"\n\t\t\t ba-hotkey:space^enter="{{toggle_volume()}}" onmouseout="this.blur()"\n\t\t\t class="{{css}}-rightbutton-container"\n\t\t\t ba-click="{{toggle_volume()}}" title="{{string(volume > 0 ? \'volume-mute\' : \'volume-unmute\')}}">\n\t\t\t<div class="{{css}}-button-inner">\n\t\t\t\t<i class="{{csscommon + \'-icon-volume-\' + (volume >= 0.5 ? \'up\' : (volume > 0 ? \'down\' : \'off\')) }}"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n</div>\n',attrs:{css:"ba-audioplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",csstheme:"ba-audiooplayer-default-theme",duration:0,position:0,cached:0,volume:1,manuallypaused:!1,expandedprogress:!0,playing:!1,rerecordable:!1,submittable:!1,title:""},functions:{formatTime:function(e){return e=Math.max(e||0,.1),t.format(t.ELAPSED_MINUTES_SECONDS,1e3*e)},startUpdatePosition:function(e){var t,i;this.get("disableseeking")||(e[0].preventDefault(),this.__parent.get("playing")||!this.__parent.player||this.get("manuallypaused")||this.__parent.player.play(),t=e[0].currentTarget,this.set("dimensions",t.getBoundingClientRect()),this.set("_updatePosition",!0),this.call("progressUpdatePosition",e[0]),(i=this.get("events")).on(document,"mousemove touchmove",function(e){e.preventDefault(),this.call("progressUpdatePosition",e)},this),i.on(document,"mouseup touchend",function(e){e.preventDefault(),this.call("stopUpdatePosition"),i.off(document,"mouseup touchend mousemove touchmove")},this))},progressUpdatePosition:function(e){var t;this.get("dimensions")&&((e=e[0]||e).preventDefault(),e=(e=0===e.clientX?0:e.clientX||e.targetTouches[0].clientX)<(t=this.get("dimensions")).left?0:e>t.left+t.width?1:(e-t.left)/(t.width||1),t=this.get("duration")*e,this.get("_updatePosition"))&&(this.set("position",t),this.trigger("position",this.get("position")))},stopUpdatePosition:function(){this.set("_updatePosition",!1)},startUpdateVolume:function(e){e[0].preventDefault(),this.set("_updateVolume",!0),this.call("progressUpdateVolume",e)},progressUpdateVolume:function(e){var t,i,e=e[0];e.preventDefault(),this.get("_updateVolume")&&(t=e.clientX,e=e.currentTarget,i=s.elementOffset(e),e=s.elementDimensions(e),this.set("volume",(t-i.left)/(e.width||1)),this.trigger("volume",this.get("volume")))},stopUpdateVolume:function(e){e[0].preventDefault(),this.set("_updateVolume",!1)},startVerticallyUpdateVolume:function(e){e[0].preventDefault(),this.set("_updateVolume",!0),this.call("progressVerticallyUpdateVolume",e)},progressVerticallyUpdateVolume:function(e){var t,i,e=e[0];e.preventDefault(),this.get("_updateVolume")&&(t=e.pageY,e=e.currentTarget,i=s.elementOffset(e),e=s.elementDimensions(e),this.set("volume",1-(t-i.top)/e.height),this.trigger("volume",this.get("volume")))},stopVerticallyUpdateVolume:function(e){e[0].preventDefault(),this.set("_updateVolume",!1)},play:function(){this.trigger("play")},pause:function(){this.trigger("pause")},toggle_volume:function(){0<this.get("volume")?(this.__oldVolume=this.get("volume"),this.set("volume",0)):this.set("volume",this.__oldVolume||1),this.trigger("volume",this.get("volume"))},rerecord:function(){this.trigger("rerecord")},seek:function(e){this.trigger("seek",e)},set_volume:function(e){this.trigger("set_volume",e)},submit:function(){this.set("submittable",!1),this.set("rerecordable",!1),this.trigger("submit")},tab_index_move:function(e,t,i){this.trigger("tab_index_move",e[0],t,i)}},create:function(){this.set("ismobile",n.isMobile()),this.set("events",new r)}}}).register("ba-audioplayer-controlbar").registerFunctions({css:function(e){return e.css},"disableseeking ? cssplayer + '-disabled' : ''":function(e){return e.disableseeking?e.cssplayer+"-disabled":""},"seek(position + skipseconds)":function(e){return e.seek(e.position+e.skipseconds)},"seek(position - skipseconds)":function(e){return e.seek(e.position-e.skipseconds)},"seek(position + skipseconds * 3)":function(e){return e.seek(e.position+3*e.skipseconds)},"seek(position - skipseconds * 3)":function(e){return e.seek(e.position-3*e.skipseconds)},"startUpdatePosition(domEvent)":function(e){return e.startUpdatePosition(e.domEvent)},"{width: Math.round(duration ? cached / duration * 100 : 0) + '%'}":function(e){return{width:Math.round(e.duration?e.cached/e.duration*100:0)+"%"}},"{width: Math.round(duration ? position / duration * 100 : 0) + '%'}":function(e){return{width:Math.round(e.duration?e.position/e.duration*100:0)+"%"}},"string('audio-progress')":function(e){return e.string("audio-progress")},"submit()":function(e){return e.submit()},submittable:function(e){return e.submittable},"string('submit-audio')":function(e){return e.string("submit-audio")},"rerecord()":function(e){return e.rerecord()},rerecordable:function(e){return e.rerecordable},"string('rerecord-audio')":function(e){return e.string("rerecord-audio")},csscommon:function(e){return e.csscommon},"string('play-audio')":function(e){return e.string("play-audio")},"tab_index_move(domEvent, null, 'button-icon-pause')":function(e){return e.tab_index_move(e.domEvent,null,"button-icon-pause")},"!playing":function(e){return!e.playing},"play()":function(e){return e.play()},"disablepause ? cssplayer + '-disabled' : ''":function(e){return e.disablepause?e.cssplayer+"-disabled":""},"tab_index_move(domEvent, null, 'button-icon-play')":function(e){return e.tab_index_move(e.domEvent,null,"button-icon-play")},playing:function(e){return e.playing},"pause()":function(e){return e.pause()},"disablepause ? string('pause-audio-disabled') : string('pause-audio')":function(e){return e.disablepause?e.string("pause-audio-disabled"):e.string("pause-audio")},"string('elapsed-time')":function(e){return e.string("elapsed-time")},"formatTime(position)":function(e){return e.formatTime(e.position)},"string('total-time')":function(e){return e.string("total-time")},"formatTime(duration || position)":function(e){return e.formatTime(e.duration||e.position)},title:function(e){return e.title},"set_volume(volume + 0.1)":function(e){return e.set_volume(e.volume+.1)},"set_volume(volume - 0.1)":function(e){return e.set_volume(e.volume-.1)},"set_volume(1)":function(e){return e.set_volume(1)},"set_volume(0)":function(e){return e.set_volume(0)},"startUpdateVolume(domEvent)":function(e){return e.startUpdateVolume(e.domEvent)},"progressUpdateVolume(domEvent)":function(e){return e.progressUpdateVolume(e.domEvent)},"stopUpdateVolume(domEvent); this.blur()":function(e){return e.stopUpdateVolume(e.domEvent)},"stopUpdateVolume(domEvent)":function(e){return e.stopUpdateVolume(e.domEvent)},"{width: Math.min(100, Math.round(volume * 100)) + '%'}":function(e){return{width:Math.min(100,Math.round(100*e.volume))+"%"}},"string('volume-button')":function(e){return e.string("volume-button")},"toggle_volume()":function(e){return e.toggle_volume()},"string(volume > 0 ? 'volume-mute' : 'volume-unmute')":function(e){return e.string(0<e.volume?"volume-mute":"volume-unmute")},"csscommon + '-icon-volume-' + (volume >= 0.5 ? 'up' : (volume > 0 ? 'down' : 'off'))":function(e){return e.csscommon+"-icon-volume-"+(.5<=e.volume?"up":0<e.volume?"down":"off")}}).attachStringTable(i.strings).addStrings({"audio-progress":"Progress","rerecord-audio":"Redo?","submit-audio":"Confirm","play-audio":"Play","pause-audio":"Pause","pause-audio-disabled":"Pause not supported","elapsed-time":"Elapsed time","total-time":"Total length of","volume-button":"Set volume","volume-mute":"Mute sound","volume-unmute":"Unmute sound"})}),e.define("module:AudioPlayer.Dynamics.Loader",["dynamics:Dynamic","module:Assets"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'\n<div class="{{cssplayer}}-loader-container">\n    <div data-selector="loader-block" class="{{cssplayer}}-loader-loader" title="{{string(\'tooltip\')}}">\n    </div>\n</div>\n',attrs:{css:"ba-audioplayer"}}}).register("ba-audioplayer-loader").registerFunctions({cssplayer:function(e){return e.cssplayer},"string('tooltip')":function(e){return e.string("tooltip")}}).attachStringTable(t.strings).addStrings({tooltip:"Loading..."})}),e.define("module:AudioPlayer.Dynamics.Message",["dynamics:Dynamic"],["dynamics:Partials.ClickPartial"],function(e,t){return e.extend({scoped:t},function(e){return{template:'\n<div class="{{css}}-message-container" ba-click="{{click()}}">\n    <div data-selector="message-block" class=\'{{css}}-message-message\'>\n        <p> {{message}} </p>\n    </div>\n</div>\n',attrs:{css:"ba-audioplayer",message:""},functions:{click:function(){this.trigger("click")}}}}).registerFunctions({css:function(e){return e.css},"click()":function(e){return e.click()},message:function(e){return e.message}}).register("ba-audioplayer-message")}),e.define("module:AudioPlayer.Dynamics.Player",["dynamics:Dynamic","module:Assets","module:AudioVisualization","browser:Info","browser:Dom","media:AudioPlayer.AudioPlayerWrapper","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:States.Host","base:Classes.ClassRegistry","base:Async","module:AudioPlayer.Dynamics.PlayerStates.Initial","module:AudioPlayer.Dynamics.PlayerStates","browser:Events"],["module:Common.Dynamics.Settingsmenu","module:AudioPlayer.Dynamics.Message","module:AudioPlayer.Dynamics.Loader","module:AudioPlayer.Dynamics.Controlbar","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.TogglePartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"],function(e,i,s,n,r,o,t,a,c,l,d,u,h,m,g,p,f,y){return e.extend({scoped:y},function(t){return{template:'<div itemscope itemtype="http://schema.org/AudioObject"\n    class="{{css}}-container {{cssplayer}}-size-{{csssize}} {{iecss}}-{{ie8 ? \'ie8\' : \'noie8\'}} {{csstheme}}\n    {{cssplayer}}-normal-view {{cssplayer}}-common-browser {{cssplayer}}-{{themecolor}}-color\n    {{cssplayer}}-{{title ? \'has-title\' : \'no-title\'}} {{visualeffectvisible ? cssplayer + \'-visual-effect-applied\' : \'\'}}"\n\tba-styles="{{widthHeightStyles}}"\n>\n\t<canvas data-selector="audio-canvas" class="{{csstheme}}-audio-canvas" ba-on:click="{{toggle_player()}}"></canvas>\n    <audio crossorigin="anonymous" tabindex="-1" class="{{css}}-audio" data-audio="audio"></audio>\n    <div class="{{css}}-overlay">\n\t\t<div tabindex="-1" class="{{css}}-player-toggle-overlay" data-selector="player-toggle-overlay"\n\t\t\t ba-hotkey:right="{{seek(position + skipseconds)}}" ba-hotkey:left="{{seek(position - skipseconds)}}"\n\t\t\t ba-hotkey:alt+right="{{seek(position + skipseconds * 3)}}" ba-hotkey:alt+left="{{seek(position - skipseconds * 3)}}"\n\t\t\t ba-hotkey:up="{{set_volume(volume + 0.1)}}" ba-hotkey:down="{{set_volume(volume - 0.1)}}"\n\t\t\t ba-hotkey:space^enter="{{toggle_player()}}"\n\t\t\t ba-on:click="{{toggle_player()}}"\n\t\t></div>\n\t    <ba-{{dyncontrolbar}}\n\t\t    ba-css="{{csscontrolbar || css}}"\n\t\t\tba-cssplayer="{{cssplayer || css}}"\n\t\t\tba-csscommon="{{csscommon || css}}"\n\t\t\tba-csstheme="{{csstheme || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t    ba-template="{{tmplcontrolbar}}"\n\t\t    ba-show="{{controlbar_active}}"\n\t\t    ba-playing="{{playing}}"\n\t\t\tba-playwhenvisible="{{playwhenvisible}}"\n\t\t    ba-event:rerecord="rerecord"\n\t\t    ba-event:submit="submit"\n\t\t    ba-event:play="play"\n\t\t    ba-event:pause="pause"\n\t\t    ba-event:position="seek"\n\t\t    ba-event:volume="set_volume"\n\t\t\tba-event:tab_index_move="tab_index_move"\n\t\t\tba-event:seek="seek"\n\t\t\tba-event:set_volume="set_volume"\n\t\t\tba-event:settings_menu="toggle_settings_menu"\n\t\t\tba-tabindex="{{tabindex}}"\n\t\t    ba-volume="{{volume}}"\n\t\t    ba-duration="{{duration}}"\n\t\t    ba-cached="{{buffered}}"\n\t\t    ba-title="{{title}}"\n\t\t    ba-position="{{position}}"\n\t\t    ba-rerecordable="{{rerecordable}}"\n\t\t    ba-submittable="{{submittable}}"\n            ba-source="{{source}}"\n\t\t\tba-disablepause="{{disablepause}}"\n\t\t\tba-disableseeking="{{disableseeking}}"\n\t\t\tba-skipseconds="{{skipseconds}}"\n\t\t\tba-settingsmenubutton="{{showsettingsmenu}}"\n\t\t\tba-settingsmenuactive="{{settingsmenu_active}}"\n\t\t></ba-{{dyncontrolbar}}>\n\n\t\t<ba-{{dynloader}}\n\t\t    ba-css="{{cssloader || css}}"\n\t\t\tba-cssplayer="{{cssplayer || css}}"\n\t\t\tba-csscommon="{{csscommon || css}}"\n\t\t\tba-theme-color="{{themecolor}}"\n\t\t    ba-template="{{tmplloader}}"\n\t\t\tba-playwhenvisible="{{playwhenvisible}}"\n\t\t    ba-show="{{loader_active}}"\n\t\t></ba-{{dynloader}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t    ba-css="{{cssmessage || css}}"\n\t\t\tba-cssplayer="{{cssplayer || css}}"\n\t\t\tba-csscommon="{{csscommon || css}}"\n\t\t\tba-theme-color="{{themecolor}}"\n\t\t    ba-template="{{tmplmessage}}"\n\t\t    ba-show="{{message_active}}"\n\t\t    ba-message="{{message}}"\n\t\t    ba-event:click="message_click"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<ba-{{dynsettingsmenu}}\n\t\t\tba-css="{{css}}"\n\t\t\tba-csstheme="{{csstheme || css}}"\n\t\t\tba-show="{{settingsmenu_active}}"\n\t\t\tba-template="{{tmplsettingsmenu}}"\n\t\t></ba-{{dynsettingsmenu}}>\n\n\t\t<meta itemprop="caption" content="{{title}}" />\n\t\t<meta itemprop="contentUrl" content="{{source}}"/>\n\t</div>\n</div>\n',attrs:{css:"ba-audioplayer",csscommon:"ba-commoncss",cssplayer:"ba-player",iecss:"ba-audioplayer",cssloader:"",cssmessage:"",csscontrolbar:"",width:"",height:"",theme:"",csstheme:"",themecolor:"",dynloader:"audioplayer-loader",dynmessage:"audioplayer-message",dyncontrolbar:"audioplayer-controlbar",dynsettingsmenu:"common-settingsmenu",tmplloader:"",tmplmessage:"",tmplcontrolbar:"",tmplsettingsmenu:"",source:"",sources:[],sourcefilter:{},playlist:null,volume:1,title:"",initialseek:null,visibilityfraction:.8,unmuted:!1,reloadonplay:!1,playonclick:!0,pauseonclick:!0,rerecordable:!1,submittable:!1,autoplay:!1,preload:!1,loop:!1,loopall:!1,ready:!0,totalduration:null,playwhenvisible:!1,playedonce:!1,manuallypaused:!1,disablepause:!1,disableseeking:!1,postervisible:!1,showsettingsmenu:!0,visualeffectvisible:!1,visualeffectsupported:!1,visualeffectheight:null,visualeffectminheight:120,visualeffecttheme:"red-bars",skipseconds:5,initialoptions:{volumelevel:null,playlist:[]},lastplaylistitem:!1,forciblymuted:!1,volumeafterinteraction:!1},types:{rerecordable:"boolean",loop:"boolean",loopall:"boolean",autoplay:"boolean",preload:"boolean",ready:"boolean",volume:"float",initialseek:"float",themecolor:"string",totalduration:"float",playwhenvisible:"boolean",playedonce:"boolean",manuallypaused:"boolean",disablepause:"boolean",disableseeking:"boolean",playonclick:"boolean",pauseonclick:"boolean",showsettings:"boolean",skipseconds:"integer",visualeffectvisible:"boolean",visualeffectmode:"string",visualeffectheight:"integer"},extendables:["states"],scopes:{settingsmenu:">[tagname='ba-common-settingsmenu']"},computed:{"widthHeightStyles:width,height":function(){var e={},t=this.get("width"),i=this.get("height");return t&&(e.width=t+((t+"").match(/^\d+$/g)?"px":"")),i&&(e.height=i+((i+"").match(/^\d+$/g)?"px":"")),e},"buffering:buffered,position,last_position_change_delta,playing":function(){return this.get("playing")&&this.get("buffered")<this.get("position")&&1e3<this.get("last_position_change_delta")}},events:{"change:visualeffectsupported":function(e){!e&&this.audioVisualization&&this.audioVisualization.destroy()}},remove_on_destroy:!0,create:function(){var e;this.get("visualeffectvisible")&&(!this.get("height")||this.get("height")<this.get("visualeffectminheight"))&&this.set("height",this.get("visualeffectminheight")),this.set("initialoptions",a.tree_merge(this.get("initialoptions"),{volumelevel:this.get("volume")})),this.get("theme")&&this.set("theme",this.get("theme").toLowerCase()),this.get("theme")in i.audioplayerthemes&&a.iter(i.audioplayerthemes[this.get("theme")],function(e,t){this.isArgumentAttr(t)||this.set(t,e)},this),this.get("themecolor")||this.set("themecolor","default"),this.get("playlist")&&(e=this.get("playlist")[0],this.set("source",e.source),this.set("sources",e.sources)),this.set("ie8",n.isInternetExplorer()&&n.internetExplorerVersion()<9),this.set("duration",this.get("totalduration")||0),this.set("position",0),this.set("buffered",0),this.set("message",""),this.set("csssize","normal"),this.set("loader_active",!1),this.set("controlbar_active",!1),this.set("message_active",!1),this.set("playing",!1),this.__attachRequested=!1,this.__activated=!1,this.__error=null,this.activeElement().onkeydown=this._keyDownActivity.bind(this,this.activeElement()),this.host=new u({stateRegistry:new h(this.cls.playerStates())}),(this.host.dynamic=this).host.initialize(this._initialState),this._timer=new d.Timer({context:this,fire:this._timerFire,delay:100,start:!0})},getMediaType:function(){return"audio"},_initialState:g,state:function(){return this.host.state()},audioAttached:function(){return!!this.player},audioLoaded:function(){return this.audioAttached()&&this.player.loaded()},audioError:function(){return this.__error},_error:function(e,t){this.__error={error_type:e,error_code:t},this.trigger("error:"+e,t),this.trigger("error",e,t)},_clearError:function(){this.__error=null},_detachAudio:function(){this.set("playing",!1),this.player&&this.player.weakDestroy(),this.player=null,this.__audio=null,this.set("audioelement_active",!1)},_attachAudio:function(){var i;this.audioAttached()||(this.__activated?(this.__attachRequested=!1,this.set("audioelement_active",!0),i=this.activeElement().querySelector("[data-audio='audio']"),this._clearError(),o.create(a.extend(this._getSources(),{element:i,preload:!!this.get("preload"),loop:!!this.get("loop")||this.get("lastplaylistitem")&&this.get("loopall"),reloadonplay:!!this.get("reloadonplay")})).error(function(e){this.destroyed()||this._error("attach",e)},this).success(function(e){if(!this.destroyed()){if(this.player=e,this.__audio=i,this.get("visualeffectvisible")&&s.supported()&&!this.audioVisualization){this.get("height")&&this.get("height")>this.get("visualeffectminheight")?this.set("visualeffectheight",this.get("height")):this.get("visualeffectheight")<this.get("visualeffectminheight")&&this.set("visualeffectheight",this.get("visualeffectminheight")),this.audioVisualization=new s(i,{height:this.get("visualeffectheight"),element:this.activeElement(),theme:this.get("visualeffecttheme")});try{this.audioVisualization.initializeVisualEffect(),this.set("visualeffectsupported",!0)}catch(t){this.set("visualeffectsupported",!1),console.warn(t)}}this.get("visualeffectvisible")&&this.audioVisualization&&(this.player.on("playing",function(){this.audioVisualization.start()},this),this.player.on("paused",function(){this.audioVisualization.pause()},this),this.player.on("ended",function(){this.audioVisualization.stop()},this)),this.get("playwhenvisible")&&this._playWhenVisible(i),n.isChromiumBased()&&this.get("forciblymuted")&&(i.isMuted=!0,r.userInteraction(function(){this.set_volume(this.get("initialoptions").volumelevel),0<this.get("volume")&&(i.isMuted=!1),this.set("forciblymuted",!1)},this)),this.player.on("playing",function(){this.set("playing",!0),this.trigger("playing")},this),this.player.on("error",function(e){this._error("audio",e)},this),this.player.error()&&this.player.trigger("error",this.player.error()),this.player.on("paused",function(){this.set("playing",!1),this.trigger("paused")},this),this.player.on("ended",function(){this.set("playing",!1),this.set("playedonce",!0),this.set("settingsmenu_active",!1),this.trigger("ended")},this),this.trigger("attached",e),this.player.once("loaded",function(){var e=Math.min(1,this.get("volume"));this.player.setVolume(e),this.player.setMuted(e<=0),this.trigger("loaded"),this.trigger("ready_to_play"),(this.get("totalduration")||this.player.duration()<Infinity)&&this.set("duration",this.get("totalduration")||this.player.duration()),this.get("initialseek")&&this.player.setPosition(this.get("initialseek"))},this),this.player.loaded()&&this.player.trigger("loaded")}},this)):this.__attachRequested=!0)},_getSources:function(){var t=this.get("sourcefilter");return{source:this.get("source"),sources:t?a.filter(this.get("sources"),function(e){return a.subset_of(t,e)},this):this.get("sources")}},_afterActivate:function(e){t._afterActivate.call(this,e),this.__activated=!0,this.__attachRequested&&this._attachAudio(),this.__settingsMenu=this.scopes.settingsmenu,this.__settingsMenu.get("settings")&&this.set("hassettings",!0)},_playWhenVisible:function(e){var t=this;r.isElementVisible(e,this.get("visibilityfraction"))&&this.player.play(),this._visiblityScrollEvent=this.auto_destroy(new f),this._visiblityScrollEvent.on(document,"scroll",function(){t.get("playedonce")||t.get("manuallypaused")?t.get("playing")&&!r.isElementVisible(e,t.get("visibilityfraction"))&&t.player.pause():r.isElementVisible(e,t.get("visibilityfraction"))?t.player.play():t.get("playing")&&t.player.pause()})},reattachAudio:function(){this.set("reloadonplay",!0),this._detachAudio(),this._attachAudio()},_keyDownActivity:function(e,t){var i=t.which||t.keyCode;32!==i&&37!==i&&38!==i&&39!==i&&40!==i||t.preventDefault(),9===i&&t.shiftKey?this._findNextTabStop(e,t,function(e,t){e.focus()},-1):9===i&&this._findNextTabStop(e,t,function(e,t){e.focus()})},_findNextTabStop:function(e,t,i,s){var n,r,o,a,c=n=0,l=s||1,d=t.target.tabIndex,u=e.querySelectorAll("[tabindex]");if(u=Array.prototype.slice.call(u,0).filter(function(e){return(0<e.clientWidth||0<e.clientHeight)&&-1!==e.tabIndex&&(c<=e.tabIndex&&(c=e.tabIndex),n>=e.tabIndex&&(n=e.tabIndex),!0)}),1===l&&d===c||-1===s&&d===n||0===c)1<document.querySelectorAll("ba-audioplayer").length&&(this.get("playing")&&this.player.pause(),e.tabIndex=-1,e.blur());else{for(var h=0;h<u.length;h++)u[h]&&(a=(o=u[h].tabIndex)-d,o<n||c<o||Math.sign(a)!==l||(!r||Math.abs(a)<Math.abs(r.tabIndex-d))&&(r=u[h]));r&&(t.preventDefault(),i(r,r.tabIndex))}},object_functions:["play","rerecord","pause","stop","seek","set_volume"],functions:{message_click:function(){this.trigger("message:click")},play:function(){this.host.state().play(),this.set("manuallypaused",!1)},rerecord:function(){this.get("rerecordable")&&this.trigger("rerecord")},submit:function(){this.get("submittable")&&(this.trigger("submit"),this.set("submittable",!1),this.set("rerecordable",!1))},pause:function(){this.get("disablepause")||(this.get("playing")&&this.player.pause(),this.get("playwhenvisible")&&this.set("manuallypaused",!0))},stop:function(){this.audioLoaded()&&(this.get("playing")&&this.player.pause(),this.player.setPosition(0),this.trigger("stopped"))},seek:function(e){this.get("disableseeking")||this.audioLoaded()&&(e>this.player.duration()?this.player.setPosition(this.player.duration()-this.get("skipseconds")):(this.player.setPosition(e),this.trigger("seek",e)))},set_volume:function(e){e=Math.min(1,e),this.set("volume",e=e<=0?0:e),this.audioLoaded()&&(this.player.setVolume(e),this.player.setMuted(e<=0))},tab_index_move:function(e,t,i){var s,e=e.which||e.keyCode,n=this.activeElement();13===e||32===e?i?(s=n.querySelector("[data-selector='"+i+"']"))&&m.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!1})},this,100):(s=n.querySelector('[data-audio="audio"]'),m.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!0})},this,100)):9===e&&t&&(s=n.querySelector("[data-selector='"+t+"']"))&&m.eventually(function(){this.trigger("keyboardusecase",n),s.focus({preventScroll:!1})},this,100)},toggle_settings_menu:function(){this.set("settingsmenu_active",!this.get("settingsmenu_active"))},toggle_player:function(){this.get("playing")&&this.get("pauseonclick")?this.pause():!this.get("playing")&&this.get("playonclick")&&this.play()}},destroy:function(){this._timer.destroy(),this.host.destroy(),this._detachAudio(),t.destroy.call(this)},_timerFire:function(){if(!this.destroyed()){try{var e,t,i;this.audioLoaded()&&(e=l.now(),(t=this.player.position())===this.get("position")&&!this.get("last_position_change")||this.set("last_position_change",e),this.set("last_position_change_delta",e-this.get("last_position_change")),this.set("position",t),this.set("buffered",this.player.buffered()),i=this.player.duration(),this.get("totalduration")?this.set("duration",this.get("totalduration")):0<i&&i<Infinity?this.set("duration",this.player.duration()):this.set("duration",t))}catch(s){}try{this._updateCSSSize()}catch(s){}}},_updateCSSSize:function(){var e=r.elementDimensions(this.activeElement()).width;this.set("csssize",400<e?"normal":300<e?"medium":"small")},cloneAttrs:function(){return a.map(this.attrs,function(e,t){return this.get(t)},this)}}},{playerStates:function(){return[p]}}).register("ba-audioplayer").registerFunctions({css:function(e){return e.css},cssplayer:function(e){return e.cssplayer},csssize:function(e){return e.csssize},iecss:function(e){return e.iecss},"ie8 ? 'ie8' : 'noie8'":function(e){return e.ie8?"ie8":"noie8"},csstheme:function(e){return e.csstheme},themecolor:function(e){return e.themecolor},"title ? 'has-title' : 'no-title'":function(e){return e.title?"has-title":"no-title"},"visualeffectvisible ? cssplayer + '-visual-effect-applied' : ''":function(e){return e.visualeffectvisible?e.cssplayer+"-visual-effect-applied":""},widthHeightStyles:function(e){return e.widthHeightStyles},"toggle_player()":function(e){return e.toggle_player()},"seek(position + skipseconds)":function(e){return e.seek(e.position+e.skipseconds)},"seek(position - skipseconds)":function(e){return e.seek(e.position-e.skipseconds)},"seek(position + skipseconds * 3)":function(e){return e.seek(e.position+3*e.skipseconds)},"seek(position - skipseconds * 3)":function(e){return e.seek(e.position-3*e.skipseconds)},"set_volume(volume + 0.1)":function(e){return e.set_volume(e.volume+.1)},"set_volume(volume - 0.1)":function(e){return e.set_volume(e.volume-.1)},dyncontrolbar:function(e){return e.dyncontrolbar},"csscontrolbar || css":function(e){return e.csscontrolbar||e.css},"cssplayer || css":function(e){return e.cssplayer||e.css},"csscommon || css":function(e){return e.csscommon||e.css},"csstheme || css":function(e){return e.csstheme||e.css},tmplcontrolbar:function(e){return e.tmplcontrolbar},controlbar_active:function(e){return e.controlbar_active},playing:function(e){return e.playing},playwhenvisible:function(e){return e.playwhenvisible},tabindex:function(e){return e.tabindex},volume:function(e){return e.volume},duration:function(e){return e.duration},buffered:function(e){return e.buffered},title:function(e){return e.title},position:function(e){return e.position},rerecordable:function(e){return e.rerecordable},submittable:function(e){return e.submittable},source:function(e){return e.source},disablepause:function(e){return e.disablepause},disableseeking:function(e){return e.disableseeking},skipseconds:function(e){return e.skipseconds},showsettingsmenu:function(e){return e.showsettingsmenu},settingsmenu_active:function(e){return e.settingsmenu_active},dynloader:function(e){return e.dynloader},"cssloader || css":function(e){return e.cssloader||e.css},tmplloader:function(e){return e.tmplloader},loader_active:function(e){return e.loader_active},dynmessage:function(e){return e.dynmessage},"cssmessage || css":function(e){return e.cssmessage||e.css},tmplmessage:function(e){return e.tmplmessage},message_active:function(e){return e.message_active},message:function(e){return e.message},dynsettingsmenu:function(e){return e.dynsettingsmenu},tmplsettingsmenu:function(e){return e.tmplsettingsmenu}}).attachStringTable(i.strings).addStrings({"audio-error":"An error occurred, please try again later. Click to retry.","all-settings":"All settings"})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.State",["base:States.State","base:Events.ListenMixin","base:Objs"],function(e,t,i,s){return e.extend({scoped:s},[t,{dynamics:[],_start:function(){this.dyn=this.host.dynamic,i.iter(i.extend({loader:!1,message:!1,controlbar:!1},i.objectify(this.dynamics)),function(e,t){this.dyn.set(t+"_active",e)},this),this.dyn.parent()&&"undefined"!==this.dyn.parent().record&&"undefined"!==this.dyn.parent().host&&(this.dyn._isRecorder=!0,this.dyn._recorderDyn=this.dyn.parent(),this.dyn._recorderHost=this.dyn._recorderDyn.host),this._started()},_started:function(){},play:function(){this.dyn.set("autoplay",!0)},nextToChooser:function(e){var t=this.dyn;return!!t._isRecorder&&"function"==typeof t._recorderHost.next&&(t._recorderHost.next("FatalError",{message:e,retry:"Chooser"}),!0)}}])}),e.define("module:AudioPlayer.Dynamics.PlayerStates.FatalError",["module:AudioPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["message"],_locals:["message"],_started:function(){this.dyn.set("message",this._message||this.dyn.string("audio-error"))}})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.Initial",["module:AudioPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.set("audioelement_active",!1),this.dyn.get("ready")?this.next("LoadPlayer"):this.listenOn(this.dyn,"change:ready",function(){this.next("LoadPlayer")})}})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.LoadPlayer",["module:AudioPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.listenOn(this.dyn,"error:attach",function(){this.next("LoadError")},this),this.listenOn(this.dyn,"attached",function(){this.next("LoadAudio")},this),this.dyn.reattachAudio()}})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.LoadError",["module:AudioPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["message"],_started:function(){this.dyn.set("message",this.dyn.string("audio-error")),this.listenOn(this.dyn,"message:click",function(){this.next("LoadPlayer")},this)}})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.LoadAudio",["module:AudioPlayer.Dynamics.PlayerStates.State","browser:Info","browser:Dom","base:Timers.Timer"],function(e,t,i,s,n){return e.extend({scoped:n},{dynamics:["loader"],_started:function(){this.dyn.get("audioelement_active")?this.__loadAudio():(this.listenOn(this.dyn,"error:attach",function(){this.next("LoadError")},this),this.listenOn(this.dyn,"attached",function(){this.__loadAudio()},this),this.dyn.reattachAudio())},__loadAudio:function(){var i;this.listenOn(this.dyn,"error:audio",function(){this.next("ErrorAudio")},this),this.listenOn(this.dyn,"playing",function(){this.destroyed()||this.dyn.destroyed()||(this.dyn.get("autoseek")&&this.dyn.execute("seek",this.dyn.get("autoseek")),this.next("PlayAudio"))},this),this.dyn.get("autoplay")?(i=10,this.auto_destroy(new s({context:this,fire:function(){if(!this.destroyed()&&!this.dyn.destroyed()&&this.dyn.player)try{var e=this.dyn.player.play();e&&e.success(function(){this.next("PlayAudio")})}catch(t){}0===--i&&this.next("PlayAudio")},delay:200,immediate:!0}))):this.next("PlayAudio")}})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.ErrorAudio",["module:AudioPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["message"],_started:function(){this.dyn.set("message",this.dyn.string("audio-error")),this.listenOn(this.dyn,"message:click",function(){this.nextToChooser(this.dyn.get("message"))?this.next("Initial"):this.next("LoadAudio")},this)}})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.PlayAudio",["module:AudioPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["controlbar"],_started:function(){this.dyn.trigger("loaded"),this.dyn.set("autoplay",!1),this.listenOn(this.dyn,"ended",function(){this.dyn.set("autoseek",null),this.next("NextAudio")},this),this.listenOn(this.dyn,"change:buffering",function(){this.dyn.set("loader_active",this.dyn.get("buffering"))},this),this.listenOn(this.dyn,"error:audio",function(){this.next("ErrorAudio")},this)},play:function(){this.dyn.get("playing")||this.dyn.player.play()}})}),e.define("module:AudioPlayer.Dynamics.PlayerStates.NextAudio",["module:AudioPlayer.Dynamics.PlayerStates.State"],function(e,t){return e.extend({scoped:t},{_started:function(){if(this.dyn.get("playlist")){var e,t=this.dyn.get("playlist"),i=t.shift();if(this.dyn.get("initialoptions").playlist.push(i),0<t.length)return e=t[0],this.dyn.set("source",e.source),this.dyn.set("sources",e.sources),this._playNext(e);if(i=this.dyn.get("initialoptions").playlist,this.dyn.set("lastplaylistitem",!0),this.dyn.trigger("last-playlist-item"),this.dyn.set("playlist",i),this.dyn.get("initialoptions").playlist=[],e=i[0],this.dyn.set("source",e.source),this.dyn.set("sources",e.sources),this.dyn.get("loopall"))return this._playNext(e);this.dyn.reattachAudio()}else this.dyn.get("loopall")&&(this.dyn.set("loop",!0),this.dyn.set("autoplay",!0),this.dyn.reattachAudio());this.next("LoadAudio")},_playNext:function(e){this.dyn.trigger("playlist-next",e),this.dyn.set("autoplay",!0),this.next("LoadAudio")}})}),e.define("module:AudioRecorder.Dynamics.Chooser",["dynamics:Dynamic","module:Assets","browser:Info"],["dynamics:Partials.ClickPartial","dynamics:Partials.IfPartial"],function(e,t,n,i){return e.extend({scoped:i},function(e){return{template:'<div class="{{css}}-chooser-container">\n\t<div class="{{css}}-chooser-button-container">\n\t\t<div ba-repeat="{{action :: actions}}">\n\t\t\t<div ba-hotkey:space^enter="{{click_action(action)}}" onmouseout="this.blur()"\n\t\t\t\t tabindex="0" class="{{css}}-chooser-button-{{action.index}}"\n\t\t\t     ba-click="{{click_action(action)}}"\n\t\t\t>\n\t\t\t\t<input ba-if="{{action.select && action.capture}}"\n\t\t\t\t\t   type="file"\n\t\t\t\t\t   class="{{css}}-chooser-file"\n\t\t\t\t\t   onchange="{{select_file_action(action, domEvent)}}"\n\t\t\t\t\t   accept="{{action.accept}}"\n\t\t\t\t\t   capture />\n\t\t\t\t<input ba-if="{{action.select && !action.capture}}"\n\t\t\t\t\t   type="file"\n\t\t\t\t\t   class="{{css}}-chooser-file"\n\t\t\t\t\t   onchange="{{select_file_action(action, domEvent)}}"\n\t\t\t\t\t   accept="{{action.accept}}"\n\t\t\t\t\t   />\n\t\t\t\t<i class="{{csscommon}}-icon-{{action.icon}}"\n\t\t\t\t   ba-if="{{action.icon}}"></i>\n\t\t\t\t<span>\n\t\t\t\t\t{{action.label}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n',attrs:{css:"ba-audiorecorder",cssrecorder:"ba-recorder",allowrecord:!0,allowupload:!0,primaryrecord:!0,recordviafilecapture:!1,allowcustomupload:!0,allowedextensions:null},types:{allowedextensions:"array",recordviafilecapture:"boolean"},collections:["actions"],create:function(){var i="",e=(this.get("allowedextensions")&&0<this.get("allowedextensions").length?(n.isEdge()||n.isChrome()||n.isOpera()||n.isFirefox()&&42<=n.firefoxVersion()||n.isInternetExplorer()&&10<=n.internetExplorerVersion())&&(i="."+this.get("allowedextensions").join(",.")):this.get("allowcustomupload")||(i="audio/*,audio/mp3"),[]),s=(this.get("primaryrecord")?(this.get("allowrecord")&&e.push("record"),this.get("allowupload")&&e.push("upload")):(this.get("allowupload")&&e.push("upload"),this.get("allowrecord")&&e.push("record")),this.get("actions"));e.forEach(function(e,t){switch(e){case"record":s.add({type:"record",index:t,icon:"volume-up",label:this.string("record-audio"),select:n.isMobile()&&!(n.isAndroid()&&n.isCordova())&&this.get("recordviafilecapture"),capture:!0,accept:"audio/*,audio/mp3;capture=camcorder"});break;case"upload":s.add({type:"upload",index:t,icon:"upload",label:this.string("upload-audio"),select:!(n.isiOS()&&n.isCordova()),accept:!n.isMobile()||n.isAndroid()&&n.isCordova()?i:"audio/*,audio/mp3"})}},this)},functions:{click_action:function(e){var t;e.get("select")||(n.isMobile()&&n.isCordova()?(t=this,n.isAndroid()?navigator.device.capture.captureAudio(function(e){t.trigger("upload",e[0])},function(e){},{limit:1,duration:this.get("timelimit")}):n.isiOS()&&navigator.camera.getPicture(function(e){t.trigger("upload",{localURL:e,fullPath:e})},function(e){},{destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,mediaType:Camera.MediaType.AUDIO})):this.trigger("record"))},select_file_action:function(e,t){e.get("select")&&this.trigger("upload",t[0].target)}}}}).registerFunctions({css:function(e){return e.css},actions:function(e){return e.actions},"click_action(action)":function(e){return e.click_action(e.action)},"action.index":function(e){return e.action.index},"action.select && action.capture":function(e){return e.action.select&&e.action.capture},"select_file_action(action, domEvent)":function(e){return e.select_file_action(e.action,e.domEvent)},"action.accept":function(e){return e.action.accept},"action.select && !action.capture":function(e){return e.action.select&&!e.action.capture},csscommon:function(e){return e.csscommon},"action.icon":function(e){return e.action.icon},"action.label":function(e){return e.action.label}}).register("ba-audiorecorder-chooser").attachStringTable(t.strings).addStrings({"record-audio":"Record Audio","upload-audio":"Upload Audio"})}),e.define("module:AudioRecorder.Dynamics.Controlbar",["dynamics:Dynamic","module:Assets","base:Timers.Timer"],["dynamics:Partials.ShowPartial","dynamics:Partials.RepeatPartial"],function(e,t,i,s){return e.extend({scoped:s},function(e){return{template:'<div class="{{css}}-dashboard">\n\t<div class="{{css}}-backbar"></div>\n\t<div data-selector="recorder-settings" class="{{css}}-settings" ba-show="{{settingsvisible && settingsopen}}">\n\t\t<div class="{{css}}-settings-backbar"></div>\n\t\t<div data-selector="settings-list-front" class="{{css}}-settings-front">\n\t\t\t<ul data-selector="microphone-settings" ba-repeat="{{microphone :: microphones}}">\n\t\t\t\t<li tabindex="0"\n\t\t\t\t\tba-hotkey:space^enter="{{selectMicrophone(microphone.id)}}" onmouseout="this.blur()"\n\t\t\t\t\tonclick="{{selectMicrophone(microphone.id)}}"\n\t\t\t\t>\n\t\t\t\t\t<input type=\'radio\' name=\'microphone\' value="{{selectedmicrophone == microphone.id}}" />\n\t\t\t\t\t<span></span>\n\t\t\t\t\t<label>\n\t\t\t\t\t\t{{microphone.label}}\n\t\t\t\t\t</label>\n\t\t\t\t </li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div data-selector="controlbar" class="{{css}}-controlbar">\n\n        <div class="{{css}}-leftbutton-container" ba-show="{{settingsvisible}}">\n            <div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{settingsopen=!settingsopen}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="record-button-icon-cog" class="{{css}}-button-inner {{css}}-button-{{settingsopen ? \'selected\' : \'unselected\'}}"\n                 onclick="{{settingsopen=!settingsopen}}"\n                 onmouseenter="{{hover(string(\'settings\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n                <i class="{{csscommon}}-icon-cog"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-lefticon-container" ba-show="{{settingsvisible}}">\n            <div data-selector="record-button-icon-mic" class="{{csscommon}}-icon-inner"\n                 onmouseenter="{{hover(string(microphonehealthy ? \'microphonehealthy\' : \'microphoneunhealthy\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n                <i class="{{csscommon}}-icon-mic {{csscommon}}-icon-state-{{microphonehealthy ? \'good\' : \'bad\' }}"></i>\n            </div>\n        </div>\n\n        <div class="{{css}}-lefticon-container" ba-show="{{stopvisible && recordingindication}}">\n            <div data-selector="recording-indicator" class="{{css}}-recording-indication">\n            </div>\n        </div>\n\n        <div class="{{css}}-label-container" ba-show="{{controlbarlabel}}">\n        \t<div data-selector="record-label-block" class="{{css}}-label-label">\n        \t\t{{controlbarlabel}}\n        \t</div>\n        </div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{recordvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{record()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="record-primary-button" class="{{css}}-button-primary"\n                 onclick="{{record()}}"\n                 onmouseenter="{{hover(string(\'record-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'record\')}}\n        \t</div>\n        </div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{rerecordvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{rerecord()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="rerecord-primary-button" class="{{css}}-button-primary"\n                 onclick="{{rerecord()}}"\n                 onmouseenter="{{hover(string(\'rerecord-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'rerecord\')}}\n        \t</div>\n        </div>\n\n\t\t<div class="{{css}}-rightbutton-container" ba-show="{{cancelvisible}}">\n\t\t\t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{cancel()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="cancel-primary-button" class="{{css}}-button-primary"\n\t\t\t\t onclick="{{cancel()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'cancel-tooltip\'))}}"\n\t\t\t\t onmouseleave="{{unhover()}}"\n\t\t\t>\n\t\t\t\t{{string(\'cancel\')}}\n\t\t\t</div>\n\t\t</div>\n\n        <div class="{{css}}-rightbutton-container" ba-show="{{stopvisible}}">\n        \t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{stop()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="stop-primary-button" class="{{css}}-button-primary {{mintimeindicator ? css + \'-disabled\': \'\'}}"\n\t\t\t\t title="{{mintimeindicator ? string(\'stop-available-after\').replace(\'%d\', timeminlimit) : string(\'stop-tooltip\')}}"\n                 onclick="{{stop()}}"\n                 onmouseenter="{{hover( mintimeindicator ? string(\'stop-available-after\').replace(\'%d\', timeminlimit) : string(\'stop-tooltip\'))}}"\n                 onmouseleave="{{unhover()}}"\n\t\t\t>\n        \t\t{{string(\'stop\')}}\n        \t</div>\n        </div>\n\n\t\t<div class="{{css}}-rightbutton-container" ba-show="{{pausable && !resumevisible && stopvisible}}">\n\t\t\t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{pause()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="pause-primary-button" class="{{css}}-button-primary"\n\t\t\t\t title="{{string(\'pause-recorder\')}}"\n\t\t\t\t onclick="{{pause()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'pause-recorder\'))}}"\n\t\t\t\t onmouseleave="{{unhover()}}"\n\t\t\t>\n\t\t\t\t<i class="{{csscommon}}-icon-pause"></i>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="{{css}}-rightbutton-container" ba-show="{{pausable && resumevisible}}">\n\t\t\t<div tabindex="0"\n\t\t\t\t ba-hotkey:space^enter="{{resume()}}" onmouseout="this.blur()"\n\t\t\t\t data-selector="resume-primary-button" class="{{css}}-button-primary"\n\t\t\t\t title="{{string(\'resume-recorder\')}}"\n\t\t\t\t onclick="{{resume()}}"\n\t\t\t\t onmouseenter="{{hover(string(\'resume-recorder\'))}}"\n\t\t\t\t onmouseleave="{{unhover()}}"\n\t\t\t>\n\t\t\t\t<i class="{{csscommon}}-icon-ccw"></i>\n\t\t\t</div>\n\t\t</div>\n\n\n\t</div>\n</div>\n',attrs:{css:"ba-audiorecorder",csscommon:"ba-commoncss",cssrecorder:"ba-recorder",hovermessage:"",recordingindication:!0},create:function(){this.auto_destroy(new i({context:this,fire:function(){this.set("recordingindication",!this.get("recordingindication")&&!this.__parent.__paused)},delay:500}))},functions:{selectMicrophone:function(e){this.set("settingsopen",!1),this.trigger("select-microphone",e)},hover:function(e){this.set("hovermessage",e)},unhover:function(){this.set("hovermessage","")},record:function(){this.trigger("invoke-record")},rerecord:function(){this.trigger("invoke-rerecord")},pause:function(){this.trigger("invoke-pause")},resume:function(){this.trigger("invoke-resume")},stop:function(){this.trigger("invoke-stop")},cancel:function(){this.trigger("invoke-cancel")}}}}).register("ba-audiorecorder-controlbar").registerFunctions({css:function(e){return e.css},"settingsvisible && settingsopen":function(e){return e.settingsvisible&&e.settingsopen},microphones:function(e){return e.microphones},"selectMicrophone(microphone.id)":function(e){return e.selectMicrophone(e.microphone.id)},"selectedmicrophone == microphone.id":function(e){return e.selectedmicrophone==e.microphone.id},"microphone.label":function(e){return e.microphone.label},settingsvisible:function(e){return e.settingsvisible},"settingsopen=!settingsopen":function(e){return e.settingsopen=!e.settingsopen},"settingsopen ? 'selected' : 'unselected'":function(e){return e.settingsopen?"selected":"unselected"},"hover(string('settings'))":function(e){return e.hover(e.string("settings"))},"unhover()":function(e){return e.unhover()},csscommon:function(e){return e.csscommon},"hover(string(microphonehealthy ? 'microphonehealthy' : 'microphoneunhealthy'))":function(e){return e.hover(e.string(e.microphonehealthy?"microphonehealthy":"microphoneunhealthy"))},"microphonehealthy ? 'good' : 'bad'":function(e){return e.microphonehealthy?"good":"bad"},"stopvisible && recordingindication":function(e){return e.stopvisible&&e.recordingindication},controlbarlabel:function(e){return e.controlbarlabel},recordvisible:function(e){return e.recordvisible},"record()":function(e){return e.record()},"hover(string('record-tooltip'))":function(e){return e.hover(e.string("record-tooltip"))},"string('record')":function(e){return e.string("record")},rerecordvisible:function(e){return e.rerecordvisible},"rerecord()":function(e){return e.rerecord()},"hover(string('rerecord-tooltip'))":function(e){return e.hover(e.string("rerecord-tooltip"))},"string('rerecord')":function(e){return e.string("rerecord")},cancelvisible:function(e){return e.cancelvisible},"cancel()":function(e){return e.cancel()},"hover(string('cancel-tooltip'))":function(e){return e.hover(e.string("cancel-tooltip"))},"string('cancel')":function(e){return e.string("cancel")},stopvisible:function(e){return e.stopvisible},"stop()":function(e){return e.stop()},"mintimeindicator ? css + '-disabled': ''":function(e){return e.mintimeindicator?e.css+"-disabled":""},"mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip')":function(e){return e.mintimeindicator?e.string("stop-available-after").replace("%d",e.timeminlimit):e.string("stop-tooltip")},"hover( mintimeindicator ? string('stop-available-after').replace('%d', timeminlimit) : string('stop-tooltip'))":function(e){return e.hover(e.mintimeindicator?e.string("stop-available-after").replace("%d",e.timeminlimit):e.string("stop-tooltip"))},"string('stop')":function(e){return e.string("stop")},"pausable && !resumevisible && stopvisible":function(e){return e.pausable&&!e.resumevisible&&e.stopvisible},"pause()":function(e){return e.pause()},"string('pause-recorder')":function(e){return e.string("pause-recorder")},"hover(string('pause-recorder'))":function(e){return e.hover(e.string("pause-recorder"))},"pausable && resumevisible":function(e){return e.pausable&&e.resumevisible},"resume()":function(e){return e.resume()},"string('resume-recorder')":function(e){return e.string("resume-recorder")},"hover(string('resume-recorder'))":function(e){return e.hover(e.string("resume-recorder"))}}).attachStringTable(t.strings).addStrings({settings:"Settings",microphonehealthy:"Sound is good",microphoneunhealthy:"Cannot pick up any sound",record:"Record","record-tooltip":"Click here to record.",rerecord:"Redo","rerecord-tooltip":"Click here to redo.",stop:"Stop","stop-tooltip":"Click here to stop.","stop-available-after":"Minimum recording time is %d seconds",cancel:"Cancel","cancel-tooltip":"Click here to cancel.","pause-recorder":"Pause Recorder","resume-recorder":"Resume Recorder"})}),e.define("module:AudioRecorder.Dynamics.Loader",["dynamics:Dynamic","module:Assets"],["dynamics:Partials.ShowPartial"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'\n<div class="{{cssrecorder}}-loader-container">\n    <div data-selector="recorder-loader-block" class="{{cssrecorder}}-loader-loader" title="{{tooltip || \'\'}}">\n    </div>\n</div>\n<div data-selector="recorder-loader-label-container" class="{{cssrecorder}}-loader-label" ba-show="{{label}}">\n\t{{label}}\n</div>\n',attrs:{css:"ba-audiorecorder",tooltip:"",label:"",message:"",hovermessage:""}}}).registerFunctions({cssrecorder:function(e){return e.cssrecorder},"tooltip || ''":function(e){return e.tooltip||""},label:function(e){return e.label}}).register("ba-audiorecorder-loader").attachStringTable(t.strings).addStrings({})}),e.define("module:AudioRecorder.Dynamics.Message",["dynamics:Dynamic"],["dynamics:Partials.ClickPartial"],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'\n<div data-selector="recorder-message-container" class="{{css}}-message-container" ba-click="{{click()}}">\n    <div data-selector="recorder-message-block" class=\'{{css}}-message-message\'>\n        <p>\n            {{message || ""}}\n        </p>\n        <ul ba-if="{{links && links.length > 0}}" ba-repeat="{{link :: links}}">\n            <li>\n                <a href="javascript:;" ba-click="{{linkClick(link)}}">\n                    {{link.title}}\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>\n',attrs:{css:"ba-audiorecorder",message:"",links:null},functions:{click:function(){this.trigger("click")},linkClick:function(e){this.trigger("link",e)}}}}).registerFunctions({css:function(e){return e.css},"click()":function(e){return e.click()},'message || ""':function(e){return e.message||""},"links && links.length > 0":function(e){return e.links&&0<e.links.length},links:function(e){return e.links},"linkClick(link)":function(e){return e.linkClick(e.link)},"link.title":function(e){return e.link.title}}).register("ba-audiorecorder-message")}),e.define("module:AudioRecorder.Dynamics.Recorder",["dynamics:Dynamic","module:Assets","module:AudioVisualization","browser:Info","browser:Dom","browser:Upload.MultiUploader","browser:Upload.FileUploader","media:AudioRecorder.AudioRecorderWrapper","media:WebRTC.Support","base:Types","base:Objs","base:Strings","base:Time","base:Timers","base:States.Host","base:Classes.ClassRegistry","base:Collections.Collection","base:Promise","module:AudioRecorder.Dynamics.RecorderStates.Initial","module:AudioRecorder.Dynamics.RecorderStates"],["module:AudioRecorder.Dynamics.Loader","module:AudioRecorder.Dynamics.Controlbar","module:AudioRecorder.Dynamics.Message","module:AudioRecorder.Dynamics.Chooser","dynamics:Partials.ShowPartial","dynamics:Partials.IfPartial","dynamics:Partials.EventPartial","dynamics:Partials.OnPartial","dynamics:Partials.DataPartial","dynamics:Partials.AttrsPartial","dynamics:Partials.StylesPartial","dynamics:Partials.TemplatePartial","dynamics:Partials.HotkeyPartial"],function(e,i,s,n,r,o,a,c,l,t,d,u,h,m,g,p,f,y,b,v,x){return e.extend({scoped:x},function(t){return{template:'\n<div data-selector="audio-recorder-container" ba-show="{{!player_active}}"\n     class="{{css}}-container {{csstheme}} {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? \'ie8\' : \'noie8\'}}\n     \t{{cssrecorder}}-{{ firefox ? \'firefox\' : \'common\'}}-browser {{cssaudio}}\n    \t{{cssrecorder}}-{{themecolor}}-color"\n     ba-styles="{{widthHeightStyles}}"\n>\n\n\t<canvas data-selector="visualization-canvas" class="{{css}}-visualization-canvas"></canvas>\n    <audio tabindex="-1" data-selector="recorder-status" class="{{css}}-audio {{css}}-{{hasrecorder ? \'hasrecorder\' : \'norecorder\'}}" data-audio="audio" playsinline></audio>\n    <div data-selector="audio-recorder-overlay" class=\'{{cssrecorder}}-overlay\' ba-show="{{!hideoverlay}}" data-overlay="overlay">\n\t\t<ba-{{dynloader}}\n\t\t    ba-css="{{cssloader || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t    ba-template="{{tmplloader}}"\n\t\t    ba-show="{{loader_active}}"\n\t\t    ba-tooltip="{{loadertooltip}}"\n\t\t\tba-hovermessage="{{=hovermessage}}"\n\t\t    ba-label="{{loaderlabel}}"\n\t\t></ba-{{dynloader}}>\n\n\t\t<ba-{{dynmessage}}\n\t\t    ba-css="{{cssmessage || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t    ba-template="{{tmplmessage}}"\n\t\t    ba-show="{{message_active}}"\n\t\t    ba-message="{{message}}"\n\t\t\tba-links="{{message_links}}"\n\t\t    ba-event:click="message_click"\n\t\t\tba-event:link="message_link_click"\n\t\t></ba-{{dynmessage}}>\n\n\t\t<ba-{{dynchooser}}\n\t\t\tba-recordviafilecapture="{{recordviafilecapture}}"\n\t\t    ba-css="{{csschooser || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t    ba-template="{{tmplchooser}}"\n\t\t    ba-if="{{chooser_active && !is_initial_state}}"\n\t\t    ba-allowrecord="{{allowrecord}}"\n\t\t    ba-allowupload="{{allowupload}}"\n\t\t    ba-allowcustomupload="{{allowcustomupload}}"\n\t\t    ba-allowedextensions="{{allowedextensions}}"\n\t\t    ba-primaryrecord="{{primaryrecord}}"\n\t\t    ba-timelimit="{{timelimit}}"\n\t\t    ba-event:record="record_audio"\n\t\t    ba-event:upload="upload_audio"\n\t\t></ba-{{dynchooser}}>\n\n\t\t<ba-{{dyncontrolbar}}\n\t\t    ba-css="{{csscontrolbar || css}}"\n\t\t\tba-csstheme="{{csstheme || css}}"\n\t\t\tba-themecolor="{{themecolor}}"\n\t\t\tba-cssrecorder="{{cssrecorder || css}}"\n\t\t    ba-template="{{tmplcontrolbar}}"\n\t\t    ba-show="{{controlbar_active}}"\n\t\t    ba-microphones="{{microphones}}"\n\t\t\tba-pausable="{{pausable}}"\n\t\t\tba-resumevisible="{{resumevisible}}"\n\t\t\tba-selectedmicrophone="{{selectedmicrophone || 0}}"\n\t\t    ba-microphonehealthy="{{microphonehealthy}}"\n\t\t    ba-hovermessage="{{=hovermessage}}"\n\t\t    ba-settingsvisible="{{settingsvisible}}"\n\t\t    ba-recordvisible="{{recordvisible}}"\n\t\t\tba-cancelvisible="{{allowcancel && cancancel}}"\n\t\t    ba-rerecordvisible="{{rerecordvisible}}"\n\t\t    ba-stopvisible="{{stopvisible}}"\n\t\t    ba-controlbarlabel="{{controlbarlabel}}"\n\t\t\tba-mintimeindicator="{{mintimeindicator}}"\n\t\t\tba-timeminlimit="{{timeminlimit}}"\n\t\t    ba-event:select-microphone="select_microphone"\n\t\t    ba-event:invoke-record="record"\n\t\t    ba-event:invoke-rerecord="rerecord"\n\t\t    ba-event:invoke-stop="stop"\n\t\t\tba-event:invoke-pause="pause_recorder"\n\t\t\tba-event:invoke-resume="resume"\n\t\t></ba-{{dyncontrolbar}}>\n    </div>\n</div>\n\n<div data-selector="recorder-player" ba-if="{{player_active}}" ba-styles="{{widthHeightStyles}}">\n\t<span ba-show="{{ie8}}">&nbsp;</span>\n\t<ba-{{dynaudioplayer}}\n\t    ba-theme="{{theme || \'default\'}}"\n        ba-themecolor="{{themecolor}}"\n        ba-source="{{playbacksource}}"\n        ba-hideoninactivity="{{false}}"\n\t\tba-visualeffectheight="{{visualeffectheight}}"\n\t\tba-visualeffecttheme="{{visualeffecttheme}}"\n        ba-attrs="{{playerattrs}}"\n        ba-data:id="player"\n        ba-width="{{width}}"\n        ba-height="{{height}}"\n        ba-totalduration="{{duration}}"\n        ba-rerecordable="{{rerecordable && (recordings === null || recordings > 0)}}"\n        ba-submittable="{{manualsubmit && verified}}"\n        ba-reloadonplay="{{true}}"\n        ba-autoplay="{{autoplay}}"\n\t\tba-visualeffectvisible="{{visualeffectvisible}}"\n\t\tba-event:loaded="ready_to_play"\n        ba-event:rerecord="rerecord"\n        ba-event:playing="playing"\n        ba-event:paused="paused"\n        ba-event:ended="ended"\n        ba-event:submit="manual_submit"\n\t>\n\t</ba-{{dynaudioplayer}}>\n</div>\n',attrs:{css:"ba-videorecorder",cssaudio:"ba-audiorecorder",cssrecorder:"ba-recorder",csscommon:"ba-commoncss",iecss:"ba-audiorecorder",cssimagegallery:"",cssloader:"",csscontrolbar:"",cssmessage:"",csstopmessage:"",csschooser:"",width:"",height:"",gallerysnapshots:3,theme:"",csstheme:"",dynloader:"audiorecorder-loader",dyncontrolbar:"audiorecorder-controlbar",dynmessage:"audiorecorder-message",dynchooser:"audiorecorder-chooser",dynaudioplayer:"audioplayer",tmplloader:"",tmplcontrolbar:"",tmplmessage:"",tmplchooser:"",autorecord:!1,autoplay:!1,allowrecord:!0,allowupload:!0,allowcustomupload:!0,primaryrecord:!0,countdown:3,audiobitrate:null,playbacksource:"",recordermode:!0,skipinitial:!1,skipinitialonrerecord:!1,timelimit:null,timeminlimit:null,webrtcstreaming:!1,webrtconmobile:!1,webrtcstreamingifnecessary:!0,"microphone-volume":1,"early-rerecord":!1,manualsubmit:!1,allowedextensions:null,filesizelimit:null,"display-timer":!0,pausable:!1,visualeffectvisible:!0,visualeffectsupported:!1,visualeffectheight:null,visualeffectminheight:120,visualeffecttheme:"red-bars",simulate:!1,"enforce-duration":null,localplayback:!1,uploadoptions:{},playerattrs:{},shortMessage:!0,rerecordable:!0,allowcancel:!1,recordings:null,ready:!0,"audio-test-mandatory":!1},scopes:{player:">[id='player']"},computed:{"widthHeightStyles:width,height":function(){var e={},t=this.get("width"),i=this.get("height");return t&&(e.width=t+((t+"").match(/^\d+$/g)?"px":"")),i&&(e.height=i+((i+"").match(/^\d+$/g)?"px":"")),e}},types:{rerecordable:"boolean",ready:"boolean",autorecord:"boolean",autoplay:"boolean",allowrecord:"boolean",allowupload:"boolean",allowcustomupload:"boolean",primaryrecord:"boolean",recordermode:"boolean",skipinitialonrerecord:"boolean",localplayback:"boolean",skipinitial:"boolean",pausable:"boolean","enforce-duration":"bool",webrtcstreaming:"boolean",webrtconmobile:"boolean",webrtcstreamingifnecessary:"boolean","microphone-volume":"float",audiobitrate:"int","early-rerecord":"boolean",manualsubmit:"boolean",simulate:"boolean",allowedextensions:"array",allowcancel:"boolean","display-timer":"boolean","audio-test-mandatory":"boolean",visualeffectvisible:"boolean"},extendables:["states"],remove_on_destroy:!0,events:{"change:microphonehealthy":function(e){this.trigger("microphonehealth",e)},"change:webrtconmobile":function(){this.set("recordviafilecapture",n.isMobile()&&(!this.get("webrtconmobile")||!c.anySupport(this._audioRecorderWrapperOptions())))},"change:recordviafilecapture":function(){this.get("recordviafilecapture")&&(this.set("skipinitial",!1),this.set("skipinitialonrerecord",!1),this.set("autorecord",!1))},"change:visualeffectsupported":function(e){!e&&this.audioVisualization&&this.audioVisualization.destroy()}},create:function(){l.globals(),this.get("theme")&&this.set("theme",this.get("theme").toLowerCase()),this.get("theme")in i.recorderthemes&&d.iter(i.recorderthemes[this.get("theme")],function(e,t){this.isArgumentAttr(t)||this.set(t,e)},this),this.set("ie8",n.isInternetExplorer()&&n.internetExplorerVersion()<9),this.set("hideoverlay",!1),this.set("recordviafilecapture",n.isMobile()&&(!this.get("webrtconmobile")||!c.anySupport(this._audioRecorderWrapperOptions()))),this.get("recordviafilecapture")&&(this.set("skipinitial",!1),this.set("skipinitialonrerecord",!1),this.set("autorecord",!1)),this.get("pausable")&&this.set("resumevisible",!1),this.__attachRequested=!1,this.__activated=!1,this._bound=!1,this.__recording=!1,this.__error=null,this.host=new g({stateRegistry:new p(this.cls.recorderStates())}),(this.host.dynamic=this).host.initialize(this._initialState),this._timer=new m.Timer({context:this,fire:this._timerFire,delay:250,start:!0}),this._initSettings()},getMediaType:function(){return"audio"},getAudioFile:function(){return this._audioFile||this.recorder&&this.recorder.localPlaybackSource()||null},_initialState:b,state:function(){return this.host.state()},recorderAttached:function(){return!!this.recorder},audioError:function(){return this.__error},_error:function(e,t){this.__error={error_type:e,error_code:t},this.trigger("error:"+e,t),this.trigger("error",e,t)},_clearError:function(){this.__error=null},_detachRecorder:function(){this.recorder&&this.recorder.weakDestroy(),this.recorder=null,this.set("hasrecorder",!1)},_audioRecorderWrapperOptions:function(){return{simulate:this.get("simulate"),audioBitrate:this.get("audiobitrate"),webrtcStreaming:!!this.get("webrtcstreaming"),webrtcStreamingIfNecessary:!!this.get("webrtcstreamingifnecessary"),localPlaybackRequested:this.get("localplayback")}},_attachRecorder:function(){var e;this.recorderAttached()||(this.__activated?(this.set("hasrecorder",!0),this.__attachRequested=!1,e=this.activeElement().querySelector("[data-audio='audio']"),this._clearError(),this.recorder=c.create(d.extend({element:e},this._audioRecorderWrapperOptions())),this.recorder?(this.trigger("attached"),this.set("pausable",this.get("pausable")&&this.recorder.canPause())):this._error("attach")):this.__attachRequested=!0)},_softwareDependencies:function(){return this.recorderAttached()&&this.recorder?this.recorder.softwareDependencies():y.error("No recorder attached.")},_bindMedia:function(){!this._bound&&this.recorderAttached()&&this.recorder&&this.recorder.ready.success(function(){this.recorder.on("require_display",function(){this.set("hideoverlay",!0)},this),this.recorder.bindMedia().error(function(e){this.trigger("access_forbidden",e),this.set("hideoverlay",!1),this.off("require_display",null,this),this._error("bind",e)},this).success(function(){var t;this.trigger("access_granted"),this.recorder.setVolumeGain(this.get("microphone-volume")),this.set("hideoverlay",!1),this.off("require_display",null,this),this.get("visualeffectvisible")&&s.supported()&&(this.get("height")&&this.get("height")>this.get("visualeffectminheight")?this.set("visualeffectheight",this.get("height")):this.get("visualeffectheight")<this.get("visualeffectminheight")&&this.set("visualeffectheight",this.get("visualeffectminheight")),this.audioVisualization=new s(this.recorder._recorder.stream(),{element:this.activeElement(),recorder:this.recorder,height:this.get("visualeffectheight"),theme:this.get("visualeffecttheme")}),t=new m.Timer({context:this,immediate:!0,delay:50,fire:function(){if(this.recorder._analyser){try{this.audioVisualization.initializeVisualEffect(),this.audioVisualization.start(),this.set("visualeffectsupported",!0)}catch(e){this.set("visualeffectsupported",!1),console.warn(e)}t.stop()}}}),this.auto_destroy(t)),this.recorder.enumerateDevices().success(function(e){var t=this.recorder.currentDevices();this.set("selectedmicrophone",t.audio),this.set("microphones",new f(d.values(e.audio)))},this),this.recorder.testSoundLevel(!0),this.set("devicetesting",!0),this._bound=!0,this.trigger("bound")},this)},this)},isWebrtcStreaming:function(){return this.recorder&&this.recorder.isWebrtcStreaming()},isFormatSupported:function(){return this.recorder&&this.recorder.supportsLocalPlayback()||this._audioFilePlaybackable},_initSettings:function(){this.set("duration",0)},_initializeUploader:function(){this._audioUploader&&this._audioUploader.weakDestroy(),this._dataUploader&&this._dataUploader.weakDestroy(),this._dataUploader=new o},_unbindMedia:function(){this._bound&&(this.recorder.unbindMedia(),this._bound=!1)},_uploadAudioFile:function(e){this.get("simulate")||((e=a.create(d.extend({source:e},this.get("uploadoptions").audio))).upload(),this._audioUploader=e,this._dataUploader.addUploader(e))},_prepareRecording:function(){return y.create(!0)},_startRecording:function(){return this.__recording?y.error(!0):(this.set("devicetesting",!1),this.recorder.startRecord({audio:this.get("uploadoptions").audio,webrtcStreaming:this.get("uploadoptions").webrtcStreaming}).success(function(){this.__recording=!0,this.__recording_start_time=h.now()},this))},_stopRecording:function(){return this.__recording?(this.audioVisualization&&this.audioVisualization.stop(),this.recorder.stopRecord({audio:this.get("uploadoptions").audio,webrtcStreaming:this.get("uploadoptions").webrtcStreaming,noUploading:this.get("uploadoptions").noUploading}).success(function(e){this.__recording=!1,e.upload(),this._dataUploader.addUploader(e)},this)):y.error(!0)},isRecording:function(){return this.__recording},_verifyRecording:function(){return y.create(!0)},_afterActivate:function(e){t._afterActivate.call(this,e),this.__activated=!0,this.__attachRequested&&this._attachRecorder(),this.persistentTrigger("loaded")},object_functions:["record","rerecord","stop","play","pause","reset","pause_recorder","resume"],functions:{cancel:function(){confirm(this.stringUnicode("cancel-confirm"))&&this.execute("reset")},record:function(){this.host.state().record()},record_audio:function(){this.host.state().selectRecord()},upload_audio:function(e){this.host.state().selectUpload(e)},select_microphone:function(e){this.recorder&&(this.recorder.setCurrentDevices({audio:e}),this.recorder.testSoundLevel(!0),this.set("selectedmicrophone",e),this.audioVisualization)&&this.recorder._recorder.on("bound",function(){this.audioVisualization.updateSourceStream()},this),this.set("microphonehealthy",!1)},rerecord:function(){confirm(this.stringUnicode("rerecord-confirm"))&&(this.host.state().rerecord(),this._initSettings())},stop:function(){this.__paused&&this._resume(),this.host.state().stop()},pause_recorder:function(){"undefined"!=typeof this.recorder&&(this.recorder.pauseRecord(),this.recorder._recorder.once("paused",function(){this.__paused=!0,this.__recording=!1,this.set("resumevisible",!0)},this))},resume:function(){"undefined"!=typeof this.recorder&&this._resume()},play:function(){this.host.state().play()},pause:function(){this.host.state().pause()},message_click:function(){this.trigger("message-click")},message_link_click:function(e){this.trigger("message-link-click",e)},playing:function(){this.trigger("playing")},paused:function(){this.trigger("paused")},ended:function(){this.trigger("ended")},reset:function(){this._stopRecording().callback(function(){this._unbindMedia(),this._detachRecorder(),this._initSettings(),this.host.state().next("Initial")},this)},manual_submit:function(){this.set("rerecordable",!1),this.set("manualsubmit",!1),this.trigger("manually_submitted")},ready_to_play:function(){this.trigger("ready_to_play")}},_resume:function(){this.__paused=!1,this.__recording=!0,this.recorder.resumeRecord(),this.recorder._recorder.once("resumed",function(){this.set("resumevisible",!1)},this)},destroy:function(){this._timer.destroy(),this.host.destroy(),this._detachRecorder(),t.destroy.call(this)},soundLevel:function(){return this.recorderAttached()?this.recorder.soundLevel():null},_timerFire:function(){if(!this.destroyed()){try{this.recorderAttached()&&this.get("devicetesting")&&!this.get("microphonehealthy")&&1.01<=this.soundLevel()&&(this.set("microphonehealthy",!0),this.recorder.testSoundLevel(!1))}catch(e){}this._updateCSSSize()}},_updateCSSSize:function(){var e=r.elementDimensions(this.activeElement()).width;this.set("csssize",400<e?"normal":300<e?"medium":"small")},parentWidth:function(){return this.get("width")||r.elementDimensions(this.activeElement()).width},parentHeight:function(){return this.get("height")||r.elementDimensions(this.activeElement()).height},parentAspectRatio:function(){return this.parentWidth()/this.parentHeight()}}},{recorderStates:function(){return[v]}}).register("ba-audiorecorder").registerFunctions({"!player_active":function(e){return!e.player_active},css:function(e){return e.css},csstheme:function(e){return e.csstheme},csssize:function(e){return e.csssize},iecss:function(e){return e.iecss},"ie8 ? 'ie8' : 'noie8'":function(e){return e.ie8?"ie8":"noie8"},cssrecorder:function(e){return e.cssrecorder},"firefox ? 'firefox' : 'common'":function(e){return e.firefox?"firefox":"common"},cssaudio:function(e){return e.cssaudio},themecolor:function(e){return e.themecolor},widthHeightStyles:function(e){return e.widthHeightStyles},"hasrecorder ? 'hasrecorder' : 'norecorder'":function(e){return e.hasrecorder?"hasrecorder":"norecorder"},"!hideoverlay":function(e){return!e.hideoverlay},dynloader:function(e){return e.dynloader},"cssloader || css":function(e){return e.cssloader||e.css},"cssrecorder || css":function(e){return e.cssrecorder||e.css},tmplloader:function(e){return e.tmplloader},loader_active:function(e){return e.loader_active},loadertooltip:function(e){return e.loadertooltip},hovermessage:function(e){return e.hovermessage},loaderlabel:function(e){return e.loaderlabel},dynmessage:function(e){return e.dynmessage},"cssmessage || css":function(e){return e.cssmessage||e.css},tmplmessage:function(e){return e.tmplmessage},message_active:function(e){return e.message_active},message:function(e){return e.message},message_links:function(e){return e.message_links},dynchooser:function(e){return e.dynchooser},recordviafilecapture:function(e){return e.recordviafilecapture},"csschooser || css":function(e){return e.csschooser||e.css},tmplchooser:function(e){return e.tmplchooser},"chooser_active && !is_initial_state":function(e){return e.chooser_active&&!e.is_initial_state},allowrecord:function(e){return e.allowrecord},allowupload:function(e){return e.allowupload},allowcustomupload:function(e){return e.allowcustomupload},allowedextensions:function(e){return e.allowedextensions},primaryrecord:function(e){return e.primaryrecord},timelimit:function(e){return e.timelimit},dyncontrolbar:function(e){return e.dyncontrolbar},"csscontrolbar || css":function(e){return e.csscontrolbar||e.css},"csstheme || css":function(e){return e.csstheme||e.css},tmplcontrolbar:function(e){return e.tmplcontrolbar},controlbar_active:function(e){return e.controlbar_active},microphones:function(e){return e.microphones},pausable:function(e){return e.pausable},resumevisible:function(e){return e.resumevisible},"selectedmicrophone || 0":function(e){return e.selectedmicrophone||0},microphonehealthy:function(e){return e.microphonehealthy},settingsvisible:function(e){return e.settingsvisible},recordvisible:function(e){return e.recordvisible},"allowcancel && cancancel":function(e){return e.allowcancel&&e.cancancel},rerecordvisible:function(e){return e.rerecordvisible},stopvisible:function(e){return e.stopvisible},controlbarlabel:function(e){return e.controlbarlabel},mintimeindicator:function(e){return e.mintimeindicator},timeminlimit:function(e){return e.timeminlimit},player_active:function(e){return e.player_active},ie8:function(e){return e.ie8},dynaudioplayer:function(e){return e.dynaudioplayer},"theme || 'default'":function(e){return e.theme||"default"},playbacksource:function(e){return e.playbacksource},"false":function(e){return!1},visualeffectheight:function(e){return e.visualeffectheight},visualeffecttheme:function(e){return e.visualeffecttheme},playerattrs:function(e){return e.playerattrs},width:function(e){return e.width},height:function(e){return e.height},duration:function(e){return e.duration},"rerecordable && (recordings === null || recordings > 0)":function(e){return e.rerecordable&&(null===e.recordings||0<e.recordings)},"manualsubmit && verified":function(e){return e.manualsubmit&&e.verified},"true":function(e){return!0},autoplay:function(e){return e.autoplay},visualeffectvisible:function(e){return e.visualeffectvisible}}).attachStringTable(i.strings).addStrings({"recorder-error":"An error occurred, please try again later. Click to retry.","attach-error":"We could not access the media interface. Depending on the device and browser, you might need to access the page via SSL.","software-required":"Please click below to install / activate the following requirements in order to proceed.","software-waiting":"Waiting for the requirements to be installed / activated. You might need to refresh the page after completion.","access-forbidden":"Access to the media was forbidden. Click to retry.",uploading:"Uploading","uploading-failed":"Uploading failed - click here to retry.","upload-error-duration":"Length of the uploaded audio does not meet the requirements - click here to retry.",verifying:"Verifying","verifying-failed":"Verifying failed - click here to retry.","rerecord-confirm":"Do you really want to redo your audio?","cancel-confirm":"Do you really want to cancel your audio upload?",audio_file_too_large:"Your audio file is too large (%s) - click here to try again with a smaller audio file.",unsupported_audio_type:"Please upload: %s - click here to retry.","uploading-src-error":"Unable to play back audio now, uploading is still in progress","missing-track":"Required audio track is missing","device-already-in-use":"At least one of your input devices are already in use","browser-permission-denied":"Permission denied by browser, please grant access and reload page"})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.State",["base:States.State","base:Events.ListenMixin","base:Objs"],function(e,t,i,s){return e.extend({scoped:s},[t,{dynamics:[],_start:function(){this.dyn=this.host.dynamic,i.iter(i.extend({message:!1,chooser:!1,controlbar:!1,loader:!1},i.objectify(this.dynamics)),function(e,t){this.dyn.set(t+"_active",e)},this),this.dyn.set("message_links",null),this.dyn._accessing_microphone=!1,this._started()},_started:function(){},record:function(){this.dyn.set("autorecord",!0)},stop:function(){this.dyn.scopes.player.execute("stop")},play:function(){this.dyn.scopes.player.execute("play")},pause:function(){this.dyn.scopes.player.execute("pause")},rerecord:function(){},selectRecord:function(){},selectUpload:function(e){}}])}),e.define("module:AudioRecorder.Dynamics.RecorderStates.FatalError",["module:AudioRecorder.Dynamics.RecorderStates.State","browser:Info","base:Timers.Timer"],function(e,t,i,s){return e.extend({scoped:s},{dynamics:["message"],_locals:["message","retry"],_started:function(){this.dyn.set("message",this._message||this.dyn.string("recorder-error")),this.dyn.set("shortMessage",this.dyn.get("message").length<30),this.listenOn(this.dyn,"message-click",function(){this._retry&&this.next(this._retry)})}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.Initial",["module:AudioRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{_started:function(){this.dyn.set("is_initial_state",!0),this.dyn.set("verified",!1),this.dyn.set("playbacksource",null),this.dyn.set("player_active",!1),this.dyn._audioFileName=null,this.dyn._audioFile=null,this.dyn._audioFilePlaybackable=!1,this.dyn._initializeUploader(),this.dyn.get("recordermode")?this.dyn.get("autorecord")||this.dyn.get("skipinitial")?this.eventualNext("RequiredSoftwareCheck"):this.next("Chooser"):this.dyn.get("audio")?this.next("Player"):(console.warn("recordermode:false requires an existing audio to be present and provided."),this.dyn.set("recordermode",!0))},_end:function(){this.dyn.set("is_initial_state",!1)}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.Player",["module:AudioRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{rerecord:function(){this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")},_started:function(){this.dyn.set("player_active",!0)},_end:function(){this.dyn.set("player_active",!1)}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.Chooser",["module:AudioRecorder.Dynamics.RecorderStates.State","base:Strings","browser:Info","media:Player.Support"],function(e,a,c,l,t){return e.extend({scoped:t},{dynamics:["chooser"],record:function(){this.dyn.set("autorecord",!0),this.selectRecord()},selectRecord:function(){this.dyn.set("record_media","microphone"),this.next("RequiredSoftwareCheck")},selectUpload:function(t){if(!(c.isMobile()&&c.isAndroid()&&c.isCordova())){if(this.dyn.get("allowedextensions")){var i=(t.files[0].name||"").toLowerCase(),s=!1;if(this.dyn.get("allowedextensions").forEach(function(e){a.ends_with(i,"."+e.toLowerCase())&&(s=!0)},this),!s)return void this.next("FatalError",{message:this.dyn.string("unsupported_audio_type").replace("%s",this.dyn.get("allowedextensions").join(" / ")),retry:"Chooser"})}var e,n,r;if(this.dyn.get("filesizelimit")&&t.files&&0<t.files.length&&t.files[0].size&&t.files[0].size>this.dyn.get("filesizelimit"))return e="KB",n=Math.round(t.files[0].size/1e3),r=Math.round(this.dyn.get("filesizelimit")/1e3),999<n&&(e="MB",n=Math.round(n/1e3),r=Math.round(r/1e3)),void this.next("FatalError",{message:this.dyn.string("audio_file_too_large").replace("%s",n+e+" / "+r+e),retry:"Chooser"})}try{l.audioFileInfo(t.files[0]).success(function(e){e.duration&&this.dyn.get("enforce-duration")&&(this.dyn.get("timeminlimit")&&e.duration<this.dyn.get("timeminlimit")||this.dyn.get("timelimit")&&e.duration>this.dyn.get("timelimit"))?this.next("FatalError",{message:this.dyn.string("upload-error-duration"),retry:"Chooser"}):(this.dyn._audioFilePlaybackable=!0,this.dyn.set("duration",e.duration),this._uploadFile(t))},this).error(function(e){e.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED&&(this.dyn.get("localplayback")&&(this.dyn.set("localplayback",!1),this.dyn.set("was_localplayback",!0)),this.dyn.set("media_src_not_supported",!0)),this._uploadFile(t)},this)}catch(o){this._uploadFile(t)}},_uploadFile:function(t){this.dyn.set("creation-type",c.isMobile()?"mobile":"upload");try{this.dyn._audioFileName=t.files[0].name,this.dyn._audioFile=t.files[0]}catch(e){}this.dyn._prepareRecording().success(function(){this.dyn.trigger("upload_selected",t),this.dyn._uploadAudioFile(t),this._setValueToEmpty(t),this.next("Uploading")},this).error(function(e){this._setValueToEmpty(t),this.next("FatalError",{message:e,retry:"Chooser"})},this)},_setValueToEmpty:function(e){try{e.value=""}catch(t){}}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.RequiredSoftwareCheck",["module:AudioRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("skipvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.listenOn(this.dyn,"error",function(e){this.next("FatalError",{message:this.dyn.string("attach-error"),retry:"Initial"})},this),this.dyn._attachRecorder(),this.dyn&&(this.dyn.on("message-link-click",function(e){e.execute(),this.next("RequiredSoftwareWait")},this),this.dyn._softwareDependencies().error(function(e){this.dyn.set("message_links",e),this.dyn.set("loader_active",!1),this.dyn.set("message_active",!0),this.dyn.set("message",this.dyn.string("software-required"))},this).success(function(){this.next("MicrophoneAccess")},this))}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.RequiredSoftwareWait",["module:AudioRecorder.Dynamics.RecorderStates.State","base:Promise","browser:Dom"],function(e,t,i,s){return e.extend({scoped:s},{dynamics:["message"],_started:function(){this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.dyn.set("message",this.dyn.string("software-waiting")),t.resilience(function(){return i.isTabHidden()?t.error("Not ready"):this.dyn._softwareDependencies()},this,120,[],1e3).success(function(){this.next("MicrophoneAccess")},this).error(function(){this.next("RequiredSoftwareCheck")},this),this.dyn.on("message-click",function(){this.next("RequiredSoftwareCheck")},this)}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.MicrophoneAccess",["module:AudioRecorder.Dynamics.RecorderStates.State","base:Timers.Timer"],function(e,t,i){return e.extend({scoped:i},{dynamics:["loader"],_started:function(){this.dyn.set("settingsvisible",!0),this.dyn.set("recordvisible",!0),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.set("loaderlabel",""),this.listenOn(this.dyn,"bound",function(){this.dyn.set("creation-type","webrtc"),this.next("MicrophoneHasAccess")},this),this.listenOn(this.dyn,"error",function(e){this.next("FatalError",{message:this.dyn.string("attach-error"),retry:"Initial"})},this),this.listenOn(this.dyn,"access_forbidden",function(){this.next("FatalError",{message:this.dyn.string("access-forbidden"),retry:"Initial"})},this),this.dyn._bindMedia()}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.MicrophoneHasAccess",["module:AudioRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["controlbar"],_started:function(){this.dyn.trigger("ready_to_record"),this._preparePromise=null,0<this.dyn.get("countdown")&&this.dyn.recorder&&this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions"))>1e3*this.dyn.get("countdown")&&(this._preparePromise=this.dyn._prepareRecording()),this.dyn.get("pausable")&&this.dyn.set("pausable",this.dyn.recorder.canPause()),this.dyn.set("hovermessage",""),this.dyn.set("settingsvisible",!0),this.dyn.set("recordvisible",!0),this.dyn.set("rerecordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("controlbarlabel",""),this.dyn.get("autorecord")&&this.next("RecordPrepare",{preparePromise:this._preparePromise})},record:function(){this.dyn.get("autorecord")||this.dyn.get("audio-test-mandatory")&&!this.dyn.get("microphonehealthy")&&!this._preparePromise||this.next("RecordPrepare",{preparePromise:this._preparePromise})}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.RecordPrepare",["module:AudioRecorder.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time"],function(e,t,l,i){return e.extend({scoped:i},{dynamics:["loader"],_locals:["preparePromise"],_started:function(){this.dyn.set("message",""),this.dyn.set("loaderlabel","");var i,s,n,r,o,a=!1,e=(this.dyn._accessing_microphone=!0,this._preparePromise=this._preparePromise||this.dyn._prepareRecording(),this.dyn.get("countdown")?1e3*this.dyn.get("countdown"):0),c=this.dyn.recorder.recordDelay(this.dyn.get("uploadoptions"))||0;e?(i=1e3,s=0,n=l.now(),r=n+Math.max(c,e),e<c?(s=Math.min(500,c-e),i=(c-s)/e*1e3):this.dyn.set("loaderlabel",this.dyn.get("countdown")),o=new t({context:this,delay:50,fire:function(){var e=l.now(),t=Math.max(0,r-e);s+n<e&&(this.dyn.set("loaderlabel",""+Math.ceil((t-s)/i)),this.dyn.trigger("countdown",Math.round((t-s)/i*1e3))),r<=e&&(this.dyn.set("loaderlabel",""),o.stop()),t<=c&&!a&&(a=!0,this._startRecording())}}),this.auto_destroy(o)):this._startRecording()},record:function(){this._startRecording()},_startRecording:function(){this._preparePromise.success(function(){this.dyn._startRecording().success(function(){this.next("Recording")},this).error(function(e){this.next("FatalError",{message:e,retry:"RequiredSoftwareCheck"})},this)},this).error(function(e){this.next("FatalError",{message:e,retry:"RequiredSoftwareCheck"})},this)}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.Recording",["module:AudioRecorder.Dynamics.RecorderStates.State","base:Timers.Timer","base:Time","base:TimeFormat","base:Async","browser:Info"],function(e,t,s,n,i,r,o){return e.extend({scoped:o},{dynamics:["controlbar"],_started:function(){this.dyn.set("hovermessage",""),this.dyn.set("topmessage",""),this.dyn._accessing_microphone=!0,this.dyn.trigger("recording"),this.dyn.set("settingsvisible",!1),this.dyn.set("rerecordvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("stopvisible",!0),this._startTime=s.now(),this._stopping=!1,this.__firedTimes=0,this.__pauseDelta=0,this.__timerDelay=10,this._timer=this.auto_destroy(new t({immediate:!0,delay:this.__timerDelay,context:this,fire:this._timerFire}))},_timerFire:function(){this.__firedTimes+=1;var e=this.dyn.get("timelimit"),t=s.now()-this.__pauseDelta,i=Math.max(0,e?this._startTime+1e3*e-t:t-this._startTime);this.dyn.trigger("recording_progress",t-this._startTime,!!this.dyn.__paused),this.dyn.set("controlbarlabel",this.dyn.get("display-timer")?n.format(n.ELAPSED_MINUTES_SECONDS,i):""),this.dyn.__paused&&(this.__pauseDelta+=this.__timerDelay),this.dyn.get("timeminlimit")&&this.dyn.set("mintimeindicator",(s.now()-this._startTime)/1e3<=this.dyn.get("timeminlimit")),e&&this._startTime+1e3*e<=t&&(this._timer.stop(),this.stop())},stop:function(){var e=this.dyn.get("timeminlimit");if(e){var t=(s.now()-this._startTime-this.__pauseDelta)/1e3;if(t<e){e=this.dyn.get("timelimit");if(!e||t<e)return}}this._stopping||(this.dyn.set("loader_active",!0),this.dyn.set("controlbar_active",!1),this.dyn.set("message_active",!0),this.dyn.set("message",""),this._stopping=!0,i.eventually(function(){this.dyn._stopRecording().success(function(){this._hasStopped(),this.next("Uploading")},this).error(function(e){this.next("FatalError",{message:e,retry:"RequiredSoftwareCheck"})},this)},this))},_hasStopped:function(){this.dyn.set("duration",(s.now()-this._startTime-this.__pauseDelta)/1e3),this.dyn._unbindMedia(),this.dyn.trigger("recording_stopped")}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.Uploading",["module:AudioRecorder.Dynamics.RecorderStates.State","base:Time","base:Async","base:Objs"],function(e,t,i,s,n){return e.extend({scoped:n},{dynamics:["loader","message"],_started:function(){this.dyn.set("cancancel",!0),this.dyn.set("skipinitial",this.dyn.get("skipinitial")||this.dyn.get("skipinitialonrerecord")),this.dyn.set("settingsvisible",!1),this.dyn.set("recordvisible",!1),this.dyn.set("stopvisible",!1),this.dyn.set("loadlabel",""),this.dyn.set("controlbarlabel",""),this.dyn.trigger("uploading"),this.dyn.set("rerecordvisible",this.dyn.get("early-rerecord")),this.dyn.get("media_src_not_supported")&&this.dyn.get("was_localplayback")?this.dyn.set("uploading-message",this.dyn.string("uploading-src-error")):this.dyn.set("uploading-message",this.dyn.string("uploading")),this.dyn.get("early-rerecord")&&this.dyn.set("controlbar_active",!0),this.dyn.set("hovermessage",""),this.dyn.set("message",this.dyn.get("uploading-message"));var e=this.dyn._dataUploader;this.listenOn(e,"success",function(){i.eventually(function(){this.destroyed()||(this._finished(),this.next("Verifying"))},this)}),this.listenOn(e,"error",function(e){var i=this.dyn.string("uploading-failed");try{e.forEach(function(e){for(var t in e)this.dyn.string("upload-error-"+t)&&(i=this.dyn.string("upload-error-"+t))},this)}catch(t){}this.dyn.set("player_active",!1),this.next("FatalError",{message:i,retry:this.dyn.recorderAttached()?"Uploading":"Initial"})}),this.listenOn(e,"progress",function(e,t){this.dyn.trigger("upload_progress",e,t),0!==t&&0<t&&0<=e&&(e=Math.min(100,Math.round(e/t*100)),isNaN(e)||(this.dyn.set("message",this.dyn.get("uploading-message")+": "+e+"%"),this.dyn.set("playertopmessage",this.dyn.get("message"))))}),this.dyn.get("localplayback")&&this.dyn.isFormatSupported()&&(this.dyn.recorder&&this.dyn.recorder.supportsLocalPlayback()?this.dyn.set("playbacksource",this.dyn.recorder.localPlaybackSource()):this.dyn.set("playbacksource",(window.URL||window.webkitURL).createObjectURL(this.dyn._audioFile)),this.dyn.set("loader_active",!1),this.dyn.set("message_active",!1),this.dyn.set("player_active",!0)),this.dyn.set("start-upload-time",t.now()),e.reset(),e.upload()},rerecord:function(){this.dyn._detachRecorder(),this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")},_finished:function(){this.dyn.set("cancancel",!1),this.dyn.trigger("uploaded"),this.dyn.set("end-upload-time",t.now())}})}),e.define("module:AudioRecorder.Dynamics.RecorderStates.Verifying",["module:AudioRecorder.Dynamics.RecorderStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader","message"],_started:function(){this.dyn.set("loadlabel",""),this.dyn.trigger("verifying"),this.dyn.set("message",this.dyn.string("verifying")+"..."),this.dyn.set("playertopmessage",this.dyn.get("message")),this.dyn.get("localplayback")&&this.dyn.isFormatSupported()?(this.dyn.set("loader_active",!1),this.dyn.set("message_active",!1)):(this.dyn.set("rerecordvisible",this.dyn.get("early-rerecord")),this.dyn.get("early-rerecord")&&this.dyn.set("controlbar_active",!0)),this.dyn._verifyRecording().success(function(){this.dyn.trigger("verified"),this.dyn._detachRecorder(),this.dyn.get("recordings")&&this.dyn.set("recordings",this.dyn.get("recordings")-1),this.dyn.set("message",""),this.dyn.set("verified",!0),this.next("Player")},this).error(function(){this.dyn.set("player_active",!1),this.next("FatalError",{message:this.dyn.string("verifying-failed"),retry:this.dyn.recorderAttached()?"Verifying":"Initial"})},this)},rerecord:function(){this.dyn._detachRecorder(),this.dyn.trigger("rerecord"),this.dyn.set("recordermode",!0),this.next("Initial")}})}),e.define("module:VideoCall.Dynamics.CallViewer",["dynamics:Dynamic"],function(e,t){return e.extend({scoped:t},{template:'<div class="ba-commoncss-full-width">\n\t<ba-local-view  ba-stream="{{=local_stream}}"\n\t\t\t\t\tba-camera_active={{local_camera_active}}\n\t\t\t\t\tba-microphone_active="{{local_microphone_active}}"\n\t></ba-local-view>\n\t<ba-remote-view ba-stream="{{=remote_stream}}"\n\t\t\t\t\tba-camera_active={{remote_camera_active}}\n\t\t\t\t\tba-microphone_active="{{remote_microphone_active}}"\n\t></ba-remote-view>\n\t<ba-call-controlbar></ba-call-controlbar>\n</div>'}).register("ba-call-view").registerFunctions({local_stream:function(e){return e.local_stream},local_camera_active:function(e){return e.local_camera_active},local_microphone_active:function(e){return e.local_microphone_active},remote_stream:function(e){return e.remote_stream},remote_camera_active:function(e){return e.remote_camera_active},remote_microphone_active:function(e){return e.remote_microphone_active}})}),e.define("module:VideoCall.Dynamics.BaseView",["dynamics:Dynamic"],[],function(e,t){return e.extend({scoped:t},function(e){return{template:'<div class="{{cssclass}}">\n\t\n\t<video ba-if="{{camera_active}}"></video>\n</div>\n',attrs:{cssclass:"ba-call-camera-view"},events:{"change:stream":function(e){e&&this.video&&(this.video.srcObject=e,this.video.play())}},create:function(){this.video=this.activeElement().querySelector("video"),this.get("stream")&&(this.video.srcObject=this.get("stream"),this.video.play())}}}).registerFunctions({cssclass:function(e){return e.cssclass},camera_active:function(e){return e.camera_active}})}),e.define("module:VideoCall.Dynamics.LocalView",["module:Assets","module:VideoCall.Dynamics.BaseView"],[],function(e,t,i){return t.extend({scoped:i},function(e){return{template:e.template.replace("<video",'<div ba-if="{{error}}" ba-click="{{retry()}}">\n    <p>{{error}}</p>\n</div>\n<video muted'),attrs:{cssclass:"ba-call-local-view"},channels:{"errors:local_camera_error":function(){this.set("error",this.string("local-camera-connection-error"))}},functions:{retry:function(){this.set("error",""),this.channel("local_camera").trigger("retry")}}}}).register("ba-local-view").registerFunctions({error:function(e){return e.error},"retry()":function(e){return e.retry()}}).attachStringTable(e.strings).addStrings({"local-camera-connection-error":"There was an error when connecting to local camera. Click to try again."})}),e.define("module:VideoCall.Dynamics.RemoteView",["module:VideoCall.Dynamics.BaseView"],[],function(e,t){return e.extend({scoped:t},function(e){return{template:e.template.replace("<video","<video"),attrs:{cssclass:"ba-call-remote-view"},create:function(){e.create.call(this)}}}).register("ba-remote-view").registerFunctions({})}),e.define("module:VideoCall.Dynamics.Controlbar",["dynamics:Dynamic","module:Assets"],[],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'<div class="ba-call-controlbar">\n\t<button class="ba-call-mute-btn" ba-click="{{toggle_mute()}}">{{string(\'mute-button\')}}</button>\n\t<button class="ba-call-camera-btn" ba-click="{{toggle_camera()}}">{{string(\'camera-button\')}}</button>\n\t<button class="ba-call-leave-btn" ba-click="{{leave_call()}}">Leave Call</button>\n</div>',functions:{toggle_mute:function(){this.channel("call").trigger("toggle_mute")},toggle_camera:function(){this.channel("call").trigger("toggle_camera")},leave_call:function(){this.channel("call").trigger("leave_call")}}}}).register("ba-call-controlbar").registerFunctions({"toggle_mute()":function(e){return e.toggle_mute()},"string('mute-button')":function(e){return e.string("mute-button")},"toggle_camera()":function(e){return e.toggle_camera()},"string('camera-button')":function(e){return e.string("camera-button")},"leave_call()":function(e){return e.leave_call()}}).attachStringTable(t.strings).addStrings({"camera-button":"Show/Hide Camera","leave-button":"Leave Call","mute-button":"Mute/Unmute"})}),e.define("module:VideoCall.Dynamics.Lobby",["dynamics:Dynamic","module:Assets"],[],function(e,t,i){return e.extend({scoped:i},function(e){return{template:'<div class="ba-video-call-lobby">\n\t<h1>{{title}}</h1>\n\t<p>{{description}}</p>\n\t<button ba-click="{{connect()}}">{{button}}</button>\n\t<div class="ba-call-lobby-camera">\n\t\t<button class="ba-call-lobby-mute-btn" ba-click="{{toggle_mute()}}">{{string(\'mute-button\')}}</button>\n\t\t<button class="ba-call-lobby-camera-btn" ba-click="{{toggle_camera()}}">{{string(\'camera-button\')}}</button>\n\t\t<ba-local-view ba-stream="{{=stream}}"\n\t\t\t\t\t   ba-camera_active="{{camera_active}}"\n\t\t\t\t\t   ba-microphone_active="{{microphone_active}}"\n\t\t></ba-local-view>\n\t</div>\n</div>\n',attrs:{mode:"join"},computed:{"title:mode":function(e){return"create"===e?this.string("title-create"):this.string("title-join")},"description:mode":function(e){return"create"===e?this.string("description-create"):this.string("description-join")},"button:mode":function(e){return"create"===e?this.string("create-button"):this.string("join-button")}},functions:{connect:function(){this.channel("call").trigger("connect")},toggle_mute:function(){this.channel("call").trigger("toggle_mute")},toggle_camera:function(){this.channel("call").trigger("toggle_camera")}}}}).register("ba-call-lobby").registerFunctions({title:function(e){return e.title},description:function(e){return e.description},"connect()":function(e){return e.connect()},button:function(e){return e.button},"toggle_mute()":function(e){return e.toggle_mute()},"string('mute-button')":function(e){return e.string("mute-button")},"toggle_camera()":function(e){return e.toggle_camera()},"string('camera-button')":function(e){return e.string("camera-button")},stream:function(e){return e.stream},camera_active:function(e){return e.camera_active},microphone_active:function(e){return e.microphone_active}}).attachStringTable(t.strings).addStrings({"camera-button":"Camera","description-create":"When you're ready click on the button below to create a call.","description-join":"When you're ready click on the button below to join the call.","join-button":"Join","create-button":"Create","mute-button":"Mute","title-create":"Create Call","title-join":"Join Call"})}),e.define("module:VideoCall.Dynamics.CallStates.State",["base:States.State"],function(e,t){return e.extend({scoped:t},{_start:function(){this.dyn=this.host.dynamic,this._started()}})}),e.define("module:VideoCall.Dynamics.CallStates.Initial",["module:VideoCall.Dynamics.CallStates.State"],function(e,t){return e.extend({scoped:t},{_started:function(){this.dyn._getUserMedia({audio:!0,video:!0}),this.dyn.get("skipinitial")?this.next("Connecting"):(this.dyn.channel("call").on("connect",function(){this.next("Connecting")}.bind(this)),this.dyn.set("lobby_active",!0))},_end:function(){this.dyn.set("lobby_active",!1)}})}),e.define("module:VideoCall.Dynamics.CallStates.Connecting",["module:VideoCall.Dynamics.CallStates.State"],function(e,t){return e.extend({scoped:t},{_started:function(){this.dyn.set("message",this.dyn.string("connecting")),this.dyn.trigger("connecting"),this.dyn._connect().success(function(){this.dyn.set("connected",!0),this.dyn.trigger("connected",this.dyn.get("call_data")),this.next("Active")}.bind(this)).error(function(){this.next("ConnectionFailed")}.bind(this))},_end:function(){this.dyn.set("message","")}})}),e.define("module:VideoCall.Dynamics.CallStates.ConnectionFailed",["module:VideoCall.Dynamics.CallStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.set("message",this.dyn.string("connection-error")),this.dyn.activeElement().addEventListener("click",function(){this.next("Connecting")}.bind(this),{once:!0})},_end:function(){this.dyn.set("message","")}})}),e.define("module:VideoCall.Dynamics.CallStates.Active",["module:VideoCall.Dynamics.CallStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.set("call_active",!0),this.dyn.on("ended",function(){this.next("Ended")}.bind(this))},_end:function(){this.dyn.set("call_active",!1)}})}),e.define("module:VideoCall.Dynamics.CallStates.Ended",["module:VideoCall.Dynamics.CallStates.State"],function(e,t){return e.extend({scoped:t},{dynamics:["loader"],_started:function(){this.dyn.get("local_stream").getVideoTracks()[0].stop(),this.dyn.set("message",this.dyn.string("call-ended"))},_end:function(){this.set("message","")}})}),e.define("module:VideoCall.Dynamics.Call",["base:Classes.ClassRegistry","base:Promise","base:States.Host","dynamics:Dynamic","media:WebRTC.Support","module:Assets","module:VideoCall.Dynamics.CallStates.Initial","module:VideoCall.Dynamics.CallStates"],function(i,s,n,e,r,t,o,a,c){return e.extend({scoped:c},function(t){return{template:'<div class="video-call-container ba-commoncss-full-width ba-commoncss-landscape-aspect-ratio">\n\t\n\t<ba-call-lobby ba-if="{{lobby_active}}"\n\t\t\t\t   ba-stream="{{=local_stream}}"\n\t\t\t\t   ba-camera_active="{{local_camera_active}}"\n\t\t\t\t   ba-microphone_active="{{local_microphone_active}}"\n\t\t\t\t   ba-mode="{{mode}}"\n\t></ba-call-lobby>\n\n\t\n\t<p ba-if="{{message}}"\n\t   class="ba-commoncss-full-width ba-commoncss-full-height"\n\t>{{message}}</p>\n\n\t\n\t<ba-call-view ba-if="{{call_active}}"\n\t\t\t\t  ba-local_stream="{{=local_stream}}"\n\t\t\t\t  ba-remote_stream="{{=remote_stream}}"\n\t\t\t\t  ba-local_camera_active="{{local_camera_active}}"\n\t\t\t\t  ba-local_microphone_active="{{local_microphone_active}}"\n\t\t\t\t  ba-remote_camera_active="{{remote_camera_active}}"\n\t\t\t\t  ba-remote_microphone_active="{{remote_microphone_active}}"\n\t></ba-call-view>\n</div>',attrs:{local_camera_active:!1,local_microphone_active:!1,local_stream:undefined,remote_camera_active:!1,remote_microphone_active:!1,remote_stream:undefined,skipinitial:!1},registerchannels:["call","local_camera","errors"],channels:{"call:leave_call":function(){this.trigger("ended")},"call:toggle_camera":function(){this.set("local_camera_active",!this.get("local_camera_active"))},"call:toggle_mute":function(){this.set("local_microphone_active",!this.get("local_microphone_active"))},"local_camera:retry":function(){this._getUserMedia({audio:!0,video:!0})}},object_functions:["leave"],functions:{leave:function(){this.get("connected")&&this.channel("call").trigger("leave_call")}},events:{"change:local_camera_active":function(e){this.get("local_stream")&&(this.get("local_stream").getVideoTracks()[0].enabled=e,this._dataChannelIsReady())&&this._dataChannel.send(JSON.stringify({remote_camera_active:e}))},"change:local_microphone_active":function(e){this.get("local_stream")&&(this.get("local_stream").getAudioTracks()[0].enabled=e,this._dataChannelIsReady())&&this._dataChannel.send(JSON.stringify({remote_microphone_active:e}))},"change:local_stream":function(e){e&&(this.get("local_stream").getVideoTracks()[0].enabled=!!this.get("local_camera_active"),this.get("local_stream").getAudioTracks()[0].enabled=!!this.get("local_microphone_active"))},error:function(e,t){this.channel("errors").trigger(e),this.trigger(e,t)}},_afterActivate:function(e){t._afterActivate.call(this,e),this.persistentTrigger("loaded")},create:function(){this._initStateMachine()},_initStateMachine:function(){var e=new n({stateRegistry:new i(this.cls.callStates())});e.dynamic=this,e.initialize(o)},_getUserMedia:function(e){return r.userMediaSupported()?r.userMedia(e).success(function(e){return this.trigger("access_granted"),this.set("local_stream",e),e},this).error(function(e){"Permission denied"===e.message?this.trigger("error","access_forbidden"):this.trigger("error","local_camera_error",e)},this):(e=new Error("Camera access is only available in secure contexts (HTTPS)."),console.error(e),this.trigger("error","camera_access_unsupported",e),s.error(e))},_connect:function(){var e=s.create();return setTimeout(function(){s.conditional(!this.get("local_stream"),function(){var t=s.create();return this.once("change:local_stream",function(e){e&&t.asyncSuccess(e)}),t}.bind(this),this.get("local_stream")).success(function(e){this.set("remote_stream",e),this.set("remote_camera_active",!0),this.set("remote_microphone_active",!0)},this),e.asyncSuccess()}.bind(this),1e3),e},_createPeerConnection:function(e){this._peerConnection||(this._peerConnection=new RTCPeerConnection(e),this._createDataChannel())},_createDataChannel:function(){this._peerConnection&&(this._dataChannel=this._peerConnection.createDataChannel("call",{negotiated:!0,id:0}),this._dataChannel.onopen=function(e){this._dataChannel.send(JSON.stringify({remote_camera_active:this.get("local_camera_active"),remote_microphone_active:this.get("local_microphone_active")}))}.bind(this),this._dataChannel.onmessage=function(e){this.setAll(JSON.parse(e.data))}.bind(this))},_dataChannelIsReady:function(){return this._dataChannel&&"open"===this._dataChannel.readyState}}},{callStates:function(){return[a]}}).register("ba-video-call").registerFunctions({lobby_active:function(e){return e.lobby_active},local_stream:function(e){return e.local_stream},local_camera_active:function(e){return e.local_camera_active},local_microphone_active:function(e){return e.local_microphone_active},mode:function(e){return e.mode},message:function(e){return e.message},call_active:function(e){return e.call_active},remote_stream:function(e){return e.remote_stream},remote_camera_active:function(e){return e.remote_camera_active},remote_microphone_active:function(e){return e.remote_microphone_active}}).attachStringTable(t.strings).addStrings({"call-ended":"Call ended",connecting:"Connecting...","connection-error":"There was an error while connecting, please click to try again."})})}.call(Scoped);